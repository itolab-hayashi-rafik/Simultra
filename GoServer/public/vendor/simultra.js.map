{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap d45a300f32de83911a36","webpack:///./src/simultra.js","webpack:///external \"VIZI\"","webpack:///./~/eventemitter3/index.js","webpack:///./src/layer/BasemapLayer.js","webpack:///./~/extend/index.js","webpack:///./src/layer/Layer.js","webpack:///./src/util/index.js","webpack:///./src/util/BuildingUtils.js","webpack:///./src/util/FootwayUtils.js","webpack:///./src/util/HighwayUtils.js","webpack:///./src/util/WorkerUtils.js","webpack:///./src/layer/BuildingLayer.js","webpack:///./src/layer/FootwayLayer.js","webpack:///./src/layer/HighwayLayer.js","webpack:///./src/layer/PedestrianLayer.js","webpack:///./src/io/API.js","webpack:///./src/io/WebClient.js","webpack:///./src/layer/VehicleLayer.js","webpack:///external \"operative\""],"names":[],"mappings":"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Y;AAC3B;;AAEA;AACA,4DAA2D;AAC3D,gEAA+D;AAC/D,oEAAmE;AACnE;AACA,2DAA0D,SAAS;AACnE;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,SAAS;AACpB,YAAW,MAAM;AACjB;AACA;AACA;AACA;AACA;;AAEA,gDAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,SAAS;AACpB,YAAW,MAAM;AACjB;AACA;AACA;AACA;AACA;;AAEA,gDAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,SAAS;AACpB,YAAW,MAAM;AACjB,YAAW,QAAQ;AACnB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,iDAAgD,YAAY;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA,kCAAiC;;AAEjC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AChSA;;;;AACA;;;;AAEA;;;;AAEA;;;;;;;;;;;;KAEM,Y;;;AACJ,yBAAY,OAAZ,EAAqB;AAAA;;AACnB,SAAI,iBAAiB,EAArB;;AAEA,SAAI,WAAW,sBAAO,EAAP,EAAW,cAAX,EAA2B,OAA3B,CAAf;;AAHmB,iGAIb,QAJa;;AAMnB,WAAK,MAAL;AANmB;AAOpB;;;;8BAEQ;AACP;AACA,WAAI,YAAY,eAAK,cAAL,CAAoB,iEAApB,EAAuF;AACrG,sBAAa;AADwF,QA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","file":"simultra.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"VIZI\"), require(\"operative\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"VIZI\", \"operative\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Simultra\"] = factory(require(\"VIZI\"), require(\"operative\"));\n\telse\n\t\troot[\"Simultra\"] = factory(root[\"VIZI\"], root[\"operative\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_18__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap d45a300f32de83911a36\n **/","import VIZI from 'vizi';\nimport EventEmitter from 'eventemitter3';\n\nimport BasemapLayer from './layer/BasemapLayer';\nimport BuildingLayer from './layer/BuildingLayer';\nimport FootwayLayer from './layer/FootwayLayer';\nimport HighwayLayer from './layer/HighwayLayer';\nimport PedestrianLayer from './layer/PedestrianLayer';\nimport VehicleLayer from './layer/VehicleLayer';\n\nimport API from './io/API';\nimport Util from './util/index';\n\nclass Simultra extends EventEmitter {\n  constructor(baseUrl, defaultCoords) {\n    super();\n\n    this._api = new API(baseUrl);\n    this._isRunning = false;\n\n    var coords = defaultCoords || [35.156324, 136.923108];\n\n    this._setupWorld(coords);\n    this._setupLayers();\n  }\n\n  _setupWorld(coords) {\n    // create a world\n    var world = VIZI.world('world', {\n      skybox: true,\n      postProcessing: false\n    }).setView(coords);\n    world._environment._skybox.setInclination(0.1);\n\n    // obtain the camera\n    var camera = world.getCamera();\n    camera.position.set(-150, 175, 125);\n\n    // Add controls\n    VIZI.Controls.orbit().addTo(world);\n\n    // set the instance properties\n    this._world = world;\n  }\n\n  _setupLayers() {\n    // Basemap\n    this._basemapLayer = new BasemapLayer().addTo(this);\n    // Highway\n    this._highwayLayer = new HighwayLayer().addTo(this);\n    // Footway\n    this._footwayLayer = new FootwayLayer().addTo(this);\n    // Building\n    this._buildingLayer = new BuildingLayer().addTo(this);\n    // Vehicle\n    this._vehicleLayer = new VehicleLayer().addTo(this);\n    // Pedestrian\n    this._pedestrianLayer = new PedestrianLayer().addTo(this);\n  }\n\n  /**\n   * Sets the center coordinate of the view\n   * @param lat latitude\n   * @param lon longitude\n   */\n  setView(lat, lon) {\n    this._world.setView([lat, lon]);\n  }\n\n  /**\n   * Starts updating the view\n   */\n  start() {\n    this._vehicleLayer.start();\n    this._pedestrianLayer.start();\n    this._isRunning = true;\n  }\n\n  /**\n   * Stops updating the view\n   */\n  stop() {\n    this._vehicleLayer.stop();\n    this._pedestrianLayer.stop();\n    this._isRunning = false;\n  }\n\n  /**\n   * Returns if the view updating loop is running\n   *\n   * @returns {boolean}\n   */\n  isRunning() {\n    return this._isRunning;\n  }\n}\n\nexport default Simultra;\nwindow.Simultra = Simultra;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/simultra.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"VIZI\"\n ** module id = 1\n ** module chunks = 0\n **/","'use strict';\n\nvar has = Object.prototype.hasOwnProperty;\n\n//\n// We store our EE objects in a plain object whose properties are event names.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// `~` to make sure that the built-in object properties are not overridden or\n// used as an attack vector.\n// We also assume that `Object.create(null)` is available when the event name\n// is an ES6 Symbol.\n//\nvar prefix = typeof Object.create !== 'function' ? '~' : false;\n\n/**\n * Representation of a single EventEmitter function.\n *\n * @param {Function} fn Event handler to be called.\n * @param {Mixed} context Context for function execution.\n * @param {Boolean} [once=false] Only emit once\n * @api private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Minimal EventEmitter interface that is molded against the Node.js\n * EventEmitter interface.\n *\n * @constructor\n * @api public\n */\nfunction EventEmitter() { /* Nothing to set */ }\n\n/**\n * Hold the assigned EventEmitters by name.\n *\n * @type {Object}\n * @private\n */\nEventEmitter.prototype._events = undefined;\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @api public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var events = this._events\n    , names = []\n    , name;\n\n  if (!events) return names;\n\n  for (name in events) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return a list of assigned event listeners.\n *\n * @param {String} event The events that should be listed.\n * @param {Boolean} exists We only need to know if there are listeners.\n * @returns {Array|Boolean}\n * @api public\n */\nEventEmitter.prototype.listeners = function listeners(event, exists) {\n  var evt = prefix ? prefix + event : event\n    , available = this._events && this._events[evt];\n\n  if (exists) return !!available;\n  if (!available) return [];\n  if (available.fn) return [available.fn];\n\n  for (var i = 0, l = available.length, ee = new Array(l); i < l; i++) {\n    ee[i] = available[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Emit an event to all registered event listeners.\n *\n * @param {String} event The name of the event.\n * @returns {Boolean} Indication if we've emitted an event.\n * @api public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events || !this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if ('function' === typeof listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Register a new EventListener for the given event.\n *\n * @param {String} event Name of the event.\n * @param {Function} fn Callback function.\n * @param {Mixed} [context=this] The context of the function.\n * @api public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  var listener = new EE(fn, context || this)\n    , evt = prefix ? prefix + event : event;\n\n  if (!this._events) this._events = prefix ? {} : Object.create(null);\n  if (!this._events[evt]) this._events[evt] = listener;\n  else {\n    if (!this._events[evt].fn) this._events[evt].push(listener);\n    else this._events[evt] = [\n      this._events[evt], listener\n    ];\n  }\n\n  return this;\n};\n\n/**\n * Add an EventListener that's only called once.\n *\n * @param {String} event Name of the event.\n * @param {Function} fn Callback function.\n * @param {Mixed} [context=this] The context of the function.\n * @api public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  var listener = new EE(fn, context || this, true)\n    , evt = prefix ? prefix + event : event;\n\n  if (!this._events) this._events = prefix ? {} : Object.create(null);\n  if (!this._events[evt]) this._events[evt] = listener;\n  else {\n    if (!this._events[evt].fn) this._events[evt].push(listener);\n    else this._events[evt] = [\n      this._events[evt], listener\n    ];\n  }\n\n  return this;\n};\n\n/**\n * Remove event listeners.\n *\n * @param {String} event The event we want to remove.\n * @param {Function} fn The listener that we need to find.\n * @param {Mixed} context Only remove listeners matching this context.\n * @param {Boolean} once Only remove once listeners.\n * @api public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events || !this._events[evt]) return this;\n\n  var listeners = this._events[evt]\n    , events = [];\n\n  if (fn) {\n    if (listeners.fn) {\n      if (\n           listeners.fn !== fn\n        || (once && !listeners.once)\n        || (context && listeners.context !== context)\n      ) {\n        events.push(listeners);\n      }\n    } else {\n      for (var i = 0, length = listeners.length; i < length; i++) {\n        if (\n             listeners[i].fn !== fn\n          || (once && !listeners[i].once)\n          || (context && listeners[i].context !== context)\n        ) {\n          events.push(listeners[i]);\n        }\n      }\n    }\n  }\n\n  //\n  // Reset the array, or remove it completely if we have no more listeners.\n  //\n  if (events.length) {\n    this._events[evt] = events.length === 1 ? events[0] : events;\n  } else {\n    delete this._events[evt];\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners or only the listeners for the specified event.\n *\n * @param {String} event The event want to remove all listeners for.\n * @api public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  if (!this._events) return this;\n\n  if (event) delete this._events[prefix ? prefix + event : event];\n  else this._events = prefix ? {} : Object.create(null);\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// This function doesn't apply anymore.\n//\nEventEmitter.prototype.setMaxListeners = function setMaxListeners() {\n  return this;\n};\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/eventemitter3/index.js\n ** module id = 2\n ** module chunks = 0\n **/","import VIZI from 'vizi';\nimport extend from 'extend';\n\nimport Layer from './Layer';\n\nimport Util from '../util/index';\n\nclass BasemapLayer extends Layer {\n  constructor(options) {\n    var defaultOptions = {};\n\n    var _options = extend({}, defaultOptions, options);\n    super(_options);\n\n    this._setup();\n  }\n\n  _setup() {\n    // CartoDB basemap\n    var viziLayer = VIZI.imageTileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png', {\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, &copy; <a href=\"http://cartodb.com/attributions\">CartoDB</a>'\n    });\n\n    this._setViziLayer(viziLayer);\n  }\n}\n\nexport default BasemapLayer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/BasemapLayer.js\n **/","'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) {/**/}\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone,\n\t\ttarget = arguments[0],\n\t\ti = 1,\n\t\tlength = arguments.length,\n\t\tdeep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t} else if ((typeof target !== 'object' && typeof target !== 'function') || target == null) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = target[name];\n\t\t\t\tcopy = options[name];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\ttarget[name] = extend(deep, clone, copy);\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/extend/index.js\n ** module id = 4\n ** module chunks = 0\n **/","import VIZI from 'vizi';\nimport EventEmitter from 'eventemitter3';\n\n/**\n * Base Layer class\n */\nclass Layer extends EventEmitter {\n  constructor(options) {\n    super();\n\n    // delegate layer\n    this._viziLayer = null;\n    this._options = options;\n\n    this._simultra = null;\n    this._api = null;\n  }\n\n  _setViziLayer(viziLayer) {\n    this._viziLayer = viziLayer;\n  }\n\n  _getViziLayer() {\n    return this._viziLayer;\n  }\n\n  _getViziWorld() {\n    return this._simultra._world;\n  }\n\n  addTo(simultra) {\n    if (this._viziLayer === undefined) {\n      throw new Error('Layer not initialized');\n    }\n    if (simultra._world === undefined) {\n      throw new Error('Simultra not initialized');\n    }\n\n    this._simultra = simultra;\n    this._onAdd(simultra);\n\n    this._viziLayer.addTo(simultra._world);\n\n    return this;\n  }\n\n  _onAdd(simultra) {\n    this._api = simultra._api;\n  }\n\n  remove() {\n    this._simultra = null;\n    this._onRemove();\n\n    return this;\n  }\n\n  _onRemove() {\n    // do something when this layer is removed from simultra\n  }\n}\n\nexport default Layer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/Layer.js\n **/","/**\n * Utility\n */\nimport BuildingUtils from './BuildingUtils';\nimport FootwayUtils from './FootwayUtils';\nimport HighwayUtils from './HighwayUtils';\nimport WorkerUtils from './WorkerUtils';\n\nconst Util = {};\n\nUtil.BuildingUtils = BuildingUtils;\nUtil.FootwayUtils = FootwayUtils;\nUtil.HighwayUtils = HighwayUtils;\nUtil.WorkerUtils = WorkerUtils;\n\nexport default Util;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/index.js\n **/","/**\n * Building Utilities\n */\nimport VIZI from 'vizi';\nimport extend from 'extend';\n\nvar BuildingUtils = (function() {\n\n  /**\n   * Return the style for a specific building\n   *\n   * @param {Object} feature\n   * @param {Object} defaultValue\n   */\n  var style = function(feature, defaultValue) {\n    var height;\n\n    if (feature.properties.height) {\n      height = feature.properties.height;\n    } else {\n      height = 10 + Math.random() * 10;\n    }\n\n    // construct the style\n    var style = {\n      height: height || defaultValue.height\n    };\n\n    return extend({}, defaultValue, style);\n  };\n\n  // return the utility object\n  return {\n    style: style\n  };\n})();\n\nexport default BuildingUtils;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/BuildingUtils.js\n **/","/**\n * Footway Utilities\n */\nimport VIZI from 'vizi';\nimport extend from 'extend';\n\nvar FootwayUtils = (function() {\n\n  /**\n   * Return the style for a specific footway\n   *\n   * @param {Object} feature\n   * @param {Object} defaultValues\n   */\n  var style = function(feature, defaultValues) {\n    var style;\n\n    // Polygon\n    if (feature.geometry.type === 'Polygon') {\n      style = {\n        color: '#ecebe9',\n        transparent: true,\n        opacity: 0.2\n      };\n    }\n    // Line\n    else if (feature.geometry.type === 'LineString') {\n      style = {\n        lineColor: '#cad9d4',\n        lineWidth: 1,\n        lineTransparent: true,\n        lineOpacity: 0.2,\n        lineBlending: THREE.AdditiveBlending,\n        lineRenderOrder: 2\n      };\n    }\n    // Point\n    else {\n      style = {\n        pointWidth: 1.0,\n        pointHeight: 1.0,\n        pointColor: '#0000ff'\n      };\n    }\n\n    return extend({}, defaultValues, style);\n  };\n\n  // return utility object\n  return {\n    style: style\n  };\n})();\n\nexport default FootwayUtils;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/FootwayUtils.js\n **/","/**\n * Highway Utilities\n */\nimport VIZI from 'vizi';\nimport extend from 'extend';\n\n// --- constants\n// jscs:disable disallowSpaceAfterObjectKeys\nconst HIGHWAY_COLOR_MAP = {\n  'motorway'      : '#9e250e', // express way\n  'major'         : '#f7c616', // main road\n  'primary'       : '#ffe104', // national highway\n  'secondary'     : '#ffffff', // sub road\n  'tertiary'      : '#ffffff', // sub road\n  'residental'    : '#ffffff', // minor road\n  'living_street' : '#ffffff', // minor road\n  'track'         : '#ffffff', // ?\n  'trunk'         : '#ffffff', // ?\n  'footway'       : '#ffffff', // footway\n  'pedestrian'    : '#f0ebeb', // pedestrian\n};\nconst KIND_COLOR_MAP = {\n  'major_road': '#f7c616',\n  'minor_road': '#ffffff',\n  'highway'   : '#888785',\n  'path'      : '#888785',\n  'rail'      : '#888785',\n};\nconst HIGHWAY_WIDTH_MAP = {\n  'motorway'      : 10, // express way\n  'major'         : 10, // main road\n  'primary'       : 10, // national highway\n  'secondary'     : 7,  // sub road\n  'tertiary'      : 6,  // sub road\n  'residental'    : 5,  // minor road\n  'living_street' : 4,  // minor road\n  'track'         : 3,  // ?\n  'trunk'         : 3,  // ?\n  'footway'       : 1,  // footway\n  'pedestrian'    : 1,  // pedestrian\n};\n// jscs:enable disallowSpaceAfterObjectKeys\n// ---\n\nvar HighwayUtils = (function() {\n\n  /**\n   * Return the style for a specific highway\n   *\n   * @param {Object} feature\n   */\n  var style = function(feature, defaultValue) {\n    var color;\n\n    // ---- color\n    // based on 'highway' property\n    if (feature.properties.highway) {\n      if (feature.properties.highway in HIGHWAY_COLOR_MAP) {\n        color = HIGHWAY_COLOR_MAP[feature.properties.highway];\n      } else {\n        // unknown highway\n        console.info('Unknown highway: ' + feature.properties.highway);\n      }\n    }\n    // based on 'kind' property\n    else if (feature.properties.kind) {\n      if (feature.properties.kind in KIND_COLOR_MAP) {\n        color = KIND_COLOR_MAP[feature.properties.kind];\n      } else {\n        // unknown highway kind\n        console.info('Unknown highway kind: ' + feature.properties.kind);\n      }\n    }\n    // ---\n\n    // construct the style\n    var style = {\n      color: color || defaultValue.color\n    };\n\n    return extend({}, defaultValue, style);\n  };\n\n  /**\n   * Return the line width for a specific highway\n   *\n   * @param {Object} feature\n   */\n  var lineWidth = function(feature, defaultValue) {\n    var lineWidth;\n    // look for the line weight in the property\n    if (feature.properties.width) {\n      lineWidth = feature.properties.width;\n    }\n    // guess lineWidth from the highway type\n    else if (feature.properties.highway) {\n      if (feature.properties.highway in HIGHWAY_WIDTH_MAP) {\n        lineWidth = HIGHWAY_WIDTH_MAP[feature.properties.highway];\n      } else {\n        // unknown highway type\n        console.info('Unknown highway: ' + feature.properties.highway);\n        lineWidth = defaultValue;\n      }\n    }\n    // no way to find out the width\n    else {\n      // no highway type mentioned\n      lineWidth = defaultValue;\n    }\n    return lineWidth;\n  };\n\n  /**\n   * Convert LineString to Polygon\n   *\n   * @param {Object} world VIZI.World object\n   * @param {Array} coords LineString, e.g. [[lon, lat], [lon, lat], ...]\n   * @param {Number} lineWidth the width of the lines\n   */\n  var lineStringToPolygon = function(world, coords, lineWidth) {\n    return multiLineStringToPolygon(world, [coords], lineWidth);\n  };\n\n  /**\n   * Convert MultiLineString to Polygon\n   *\n   * @param {Object} world VIZI.World object\n   * @param {Array} coordss Array of LineStrings, e.g. [[[lon, lat], [lon, lat], ...], ...]\n   * @param {Number} lineWidth the width of the lines\n   * @returns {Array}\n   */\n  var multiLineStringToPolygon = function(world, coordss, lineWidth) {\n    if (lineWidth === undefined) {\n      lineWidth = 1.0;\n    }\n\n    // jscs:disable disallowMultipleVarDecl\n    var cLatLon, pLatLon, nLatLon;\n    var cGeoCoord, pGeoCoord, nGeoCoord;\n    var vVert = new VIZI.Point(), _vVert   = new VIZI.Point();\n    var vMean = new VIZI.Point(), vPadding = new VIZI.Point(), _vPadding = new VIZI.Point();\n    var p = new VIZI.Point(), _p;\n    // jscs:enable disallowMultipleVarDecl\n\n    var outCoordss = [];\n\n    coordss.forEach(function(coords) {\n      var outCoords = [];\n\n      cLatLon = pLatLon = nLatLon = null;\n      cGeoCoord = pGeoCoord = nGeoCoord = null;\n\n      for (var i = 0; i < coords.length; i++) {\n        cLatLon   = nLatLon   || new VIZI.LatLon(coords[i][1], coords[i][0]);\n        cGeoCoord = nGeoCoord || world.latLonToPoint(cLatLon);\n\n        // project the next coordinate\n        if (i < coords.length - 1) {\n          nLatLon = new VIZI.LatLon(coords[i + 1][1], coords[i + 1][0]);\n          nGeoCoord = world.latLonToPoint(nLatLon);\n\n          // calculate the vertical vector\n          vVert.x = -(nGeoCoord.y - cGeoCoord.y);\n          vVert.y =  (nGeoCoord.x - cGeoCoord.x);\n          normalize(vVert);\n\n          // incorpolate the vertical vector with the previous one\n          if (i == 0) {\n            _vVert.x = vVert.x; _vVert.y = vVert.y;\n          }\n          vMean.x = (vVert.x + _vVert.x) / 2.0; vMean.y = (vVert.y + _vVert.y) / 2.0;\n          normalize(vMean);\n          vPadding.x =  vMean.x * lineWidth; vPadding.y =  vMean.y * lineWidth;\n        } else {\n          vPadding.x = _vVert.x * lineWidth; vPadding.y = _vVert.y * lineWidth;\n        }\n\n        // construct polygons\n        if (0 < i) {\n          if (i == 1) {\n            // left top\n            p.x = pGeoCoord.x - _vPadding.x; p.y = pGeoCoord.y - _vPadding.y;\n            _p = world.pointToLatLon(p);\n            outCoords.splice(0, 0, [_p.lon, _p.lat]);\n\n            // left bottom\n            p.x = pGeoCoord.x + _vPadding.x; p.y = pGeoCoord.y + _vPadding.y;\n            _p = world.pointToLatLon(p);\n            outCoords.splice(0, 0, [_p.lon, _p.lat]);\n          }\n\n          var idx = outCoords.length / 2;\n          // right bottom\n          p.x = cGeoCoord.x + vPadding.x; p.y = cGeoCoord.y + vPadding.y;\n          _p = world.pointToLatLon(p);\n          outCoords.splice(idx, 0, [_p.lon, _p.lat]);\n\n          // right top\n          p.x = cGeoCoord.x - vPadding.x; p.y = cGeoCoord.y - vPadding.y;\n          _p = world.pointToLatLon(p);\n          outCoords.splice(idx + 1, 0, [_p.lon, _p.lat]);\n        }\n\n        // keep the vectors as the previous one\n        pLatLon = cLatLon;\n        pGeoCoord = cGeoCoord;\n        _vVert.x = vVert.x; _vVert.y = vVert.y;\n        _vPadding.x = vPadding.x; _vPadding.y = vPadding.y;\n      }\n\n      // add the first vertice at the end to make the polygon closed\n      outCoords.push(outCoords[0]);\n\n      // add this polygon to the array of polygons\n      outCoordss.push([outCoords]);\n    });\n\n    return outCoordss;\n  };\n\n  // --- internal helper methods\n  /** Normalize VIZI.Point */\n  function normalize(p) {\n    var l = Math.sqrt(Math.pow(p.x, 2) + Math.pow(p.y, 2));\n    l = (l === 0.0) ? 1.0 : l;\n    p.x /= l;\n    p.y /= l;\n  }\n  // ---\n\n  // return the utility object\n  return {\n    style: style,\n    lineWidth: lineWidth,\n    lineStringToPolygon: lineStringToPolygon,\n    multiLineStringToPolygon: multiLineStringToPolygon\n  };\n})();\n\nexport default HighwayUtils;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/HighwayUtils.js\n **/","/**\n * Worker Utils\n */\n\nvar WorkerUtils = (function() {\n\n  /** base directory */\n  var base = (function() {\n    var current = (function() {\n      if (document.currentScript) {\n        return document.currentScript.src;\n      } else {\n        var scripts = document.getElementsByTagName('script');\n        var script = scripts[scripts.length - 1];\n        if (script.src) {\n          return script.src;\n        }\n      }\n    })();\n    if (current) {\n      return dirname(current);\n    }\n  })();\n\n  /** Definition: Worker dependencies */\n  var dependencies = [\n    base + '/simultra-worker.js'\n  ];\n\n  /**\n   * Returns worker dependencies\n   *\n   * @returns {string[]}\n   */\n  var getDependencies = function() {\n    return dependencies;\n  };\n\n  // --- internal helper methods\n  function basename(path) {\n    return path.replace(/\\\\/g, '/').replace(/.*\\//, '');\n  }\n  function dirname(path) {\n    return path.replace(/\\\\/g, '/').replace(/\\/[^\\/]*$/, '');;\n  }\n  // ---\n\n  // return the utility object\n  return {\n    getDependencies: getDependencies\n  };\n})();\n\nexport default WorkerUtils;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/WorkerUtils.js\n **/","import VIZI from 'vizi';\nimport extend from 'extend';\n\nimport Layer from './Layer';\n\nimport BuildingUtils from '../util/BuildingUtils';\n\nclass BuildingLayer extends Layer {\n  constructor(options) {\n    var defaultOptions = {\n\n    };\n\n    var _options = extend({}, defaultOptions, options);\n    super(_options);\n\n    this._setup();\n  }\n\n  _setup() {\n\n    // Buildings from Mapzen\n    var viziLayer = VIZI.topoJSONTileLayer('https://vector.mapzen.com/osm/buildings/{z}/{x}/{y}.topojson?api_key=vector-tiles-NT5Emiw', {\n      interactive: false,\n      maxLOD: 16,\n      style: function(feature) {\n        return BuildingUtils.style(feature, {\n          height: 1,\n          lineColor: '#f7c616',\n          lineWidth: 1,\n          lineTransparent: true,\n          lineOpacity: 0.2,\n          lineBlending: THREE.AdditiveBlending,\n          lineRenderOrder: 2\n        });\n      },\n      filter: function(feature) {\n        // Don't show points\n        return feature.geometry.type !== 'Point';\n      },\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, <a href=\"http://whosonfirst.mapzen.com#License\">Who\\'s On First</a>.'\n    });\n\n    // set the instance properties\n    this._setViziLayer(viziLayer);\n\n  }\n}\n\nexport default BuildingLayer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/BuildingLayer.js\n **/","import VIZI from 'vizi';\nimport extend from 'extend';\n\nimport Layer from './Layer';\nimport FootwayUtils from '../util/FootwayUtils';\n\nclass FootwayLayer extends Layer {\n  constructor(options) {\n    var defaultOptions = {\n\n    };\n\n    var _options = extend({}, defaultOptions, options);\n    super(_options);\n\n    this._setup();\n  }\n\n  _setup() {\n\n    var self = this;\n\n    // Landuses from Mapzen\n    var viziLayer = VIZI.topoJSONTileLayer('https://vector.mapzen.com/osm/landuse,roads/{z}/{x}/{y}.topojson?api_key=vector-tiles-NT5Emiw', {\n      interactive: false,\n      maxLOD: 18,\n      style: function(feature) {\n        if (feature.properties.lanes) {\n          console.log(feature);\n        }\n        if (feature.properties.width) {\n          console.log(feature);\n        }\n\n        return FootwayUtils.style(feature, {\n          height: 0.5\n        });\n      },\n      filter: function(feature) {\n        // Don't show points\n        if (feature.geometry.type === 'Point') {\n          return false;\n        }\n\n        // pedestrian (Polygon)\n        if (feature.properties.kind === 'pedestrian') {\n          return true;\n        }\n\n        // footway (LineString)\n        if (feature.properties.highway === 'footway') {\n          return true;\n        }\n\n        return false;\n      },\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, <a href=\"http://whosonfirst.mapzen.com#License\">Who\\'s On First</a>.'\n    });\n\n    // set the instance properties\n    this._setViziLayer(viziLayer);\n\n  }\n}\n\nexport default FootwayLayer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/FootwayLayer.js\n **/","import VIZI from 'vizi';\nimport extend from 'extend';\n\nimport Layer from './Layer';\n\nimport HighwayUtils from '../util/HighwayUtils';\n\nclass HighwayLayer extends Layer {\n  constructor(options) {\n    var defaultOptions = {};\n\n    var _options = extend({}, defaultOptions, options);\n    super(_options);\n\n    this._setup();\n  }\n\n  _setup() {\n\n    var self = this;\n\n    // Roads from Mapzen\n    var viziLayer = VIZI.topoJSONTileLayer('https://vector.mapzen.com/osm/roads/{z}/{x}/{y}.topojson?api_key=vector-tiles-NT5Emiw', {\n      interactive: false,\n      maxLOD: 18,\n      style: function(feature) {\n        if (feature.properties.lanes) {\n          console.log(feature);\n        }\n        if (feature.properties.width) {\n          console.log(feature);\n        }\n\n        return HighwayUtils.style(feature, {\n          height: 0,\n          opacity: 0.2\n        });\n      },\n      filter: function(feature) {\n        // Don't show points\n        if (feature.geometry.type === 'Point') {\n          return false;\n        }\n\n        // Convert LineString to polygon\n        if (feature.geometry.type === 'LineString') {\n          var lineWidth = HighwayUtils.lineWidth(feature, 1.0);\n          var outCoordss = HighwayUtils.lineStringToPolygon(self._getViziWorld(), feature.geometry.coordinates, lineWidth);\n\n          feature.geometry.type = 'MultiPolygon';\n          feature.geometry.coordinates = outCoordss;\n        }\n        // Convert MultiLineString to Polygon\n        else if (feature.geometry.type === 'MultiLineString') {\n          var lineWidth = HighwayUtils.lineWidth(feature, 1.0);\n          var outCoordss = HighwayUtils.multiLineStringToPolygon(self._getViziWorld(), feature.geometry.coordinates, lineWidth);\n\n          feature.geometry.type = 'MultiPolygon';\n          feature.geometry.coordinates = outCoordss;\n        }\n\n        return true;\n      },\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, <a href=\"http://whosonfirst.mapzen.com#License\">Who\\'s On First</a>.'\n    });\n\n    // set the instance properties\n    this._setViziLayer(viziLayer);\n\n  }\n}\n\nexport default HighwayLayer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/HighwayLayer.js\n **/","import VIZI from 'vizi';\nimport extend from 'extend';\n\nimport Layer from './Layer';\n\nimport API from '../io/API';\n\nimport WorkerUtils from '../util/WorkerUtils';\n\nconst UPDATE_INTERVAL_MS = 1000;\n\nclass PedestrianLayer extends Layer {\n  constructor(options) {\n    var defaultOptions = {};\n\n    var _options = extend({}, defaultOptions, options);\n    super(_options);\n\n    this._pedestrians = [];\n\n    this._setup();\n  }\n\n  _setup() {\n\n    // pedestrian layer\n    var viziLayer = VIZI.pedestrianLayer({\n      'monkey': {\n        file: {\n          body: '/javascripts/maps/json/monkey/monkey.json',\n        },\n        scale: 1.0,\n        translation: {x: 0, y: 0, z: 0},\n        rotation: {x: 0, y: 0, z: 0}\n      }\n    }, {\n      simWidth: 32,\n      style: {\n        height: 0\n      }\n    });\n\n    // set the instance property\n    this._setViziLayer(viziLayer);\n\n  }\n\n  /**\n   * Starts updating the view\n   */\n  start() {\n    this._isRunning = true;\n\n    var self = this;\n\n    // start all of the workers\n    this._pedestrians.forEach((pedestrian,id) => {\n      if (pedestrian.worker) {\n        pedestrian.worker.start(id, self._createWorkerCallback());\n      }\n    });\n\n    // start pedestrian manager\n    var ws = this._api.wsPedestrians();\n    ws.onclose = function(event) {\n      console.log('closed pedestrian manager');\n    };\n    ws.onmessage = function(event) {\n      self._onMessage(event.data);\n    };\n    ws.onopen = function() {\n      console.log('opened pedestrian manager');\n    };\n    this._ws = ws;\n\n    setTimeout(function() { self._update(); }, 0);\n  }\n\n  /**\n   * Stops updating the view\n   */\n  stop() {\n    this._isRunning = false;\n\n    // terminate pedestrian manager\n    if (this._ws) {\n      this._ws.close();\n    }\n\n    // terminate all of the workers\n    this._pedestrians.forEach(pedestrian => {\n      if (pedestrian.worker) {\n        pedestrian.worker.stop();\n      }\n    });\n  }\n\n  _onMessage(data) {\n    var self = this;\n    if (data === 'creation') {\n      setTimeout(function() { self._update(); }, 0);\n    } else if (data === 'deletion') {\n      setTImeout(function() { self._update(); }, 0);\n    } else {\n      console.error('unknown message ' + data);\n    }\n  }\n\n  // (rest)\n  // _update() {\n  //   var self = this;\n  //\n  //   if (this._isRunning) {\n  //\n  //     this._lastUpdatedAt = Date.now();\n  //\n  //     this._api.getPedestrians()\n  //       .then(function(data) {\n  //\n  //         self._performUpdate(data);\n  //\n  //       }).catch(function(err) {\n  //\n  //       console.error('Error updating the pedestrian layer:' + err);\n  //\n  //     }).then(function() {\n  //\n  //       if (self._isRunning) {\n  //         // calculate the delay\n  //         var lastUpdate = self._lastUpdatedAt;\n  //         var now = Date.now();\n  //         var delay = UPDATE_INTERVAL_MS - (now - lastUpdate);\n  //\n  //         // register the next update\n  //         setTimeout(function() { self._update(); }, (delay > 0) ? delay : 0);\n  //       }\n  //\n  //     });\n  //\n  //   }\n  // }\n\n  // (websocket)\n  _update() {\n    var self = this;\n\n    if (this._isRunning) {\n\n      this._lastUpdatedAt = Date.now();\n\n      this._api.getPedestrians()\n        .then(function(data) {\n\n          self._performUpdate(data);\n\n        }).catch(function(err) {\n\n        console.error('Error updating the pedestrian layer:' + err);\n\n      });\n    }\n  }\n\n  _performUpdate(data) {\n    var self = this;\n    var viziLayer = this._getViziLayer();\n\n    // map pedestrian parameters into dictionaries\n    data.forEach(pedestrian => {\n      // if pedestrian does not exist\n      if (!self._hasPedestrian(pedestrian)) {\n        // add to pedestrian layer\n        self._addPedestrian(pedestrian);\n      }\n    });\n\n  }\n\n  _hasPedestrian(pedestrian) {\n    return (pedestrian.id in this._pedestrians);\n  }\n\n  _addPedestrian(pedestrian) {\n    var viziLayer = this._getViziLayer();\n\n    // add pedestrian to the vizi layer\n    var object = viziLayer.addPedestrian(\n      pedestrian.type,\n      new VIZI.LatLon(pedestrian.location.lat, pedestrian.location.lon),\n      pedestrian.angle\n    );\n\n    // create a new updating thread\n    var worker = operative(this._createWorker(), WorkerUtils.getDependencies());\n\n    // add entry to dictionary\n    this._pedestrians[pedestrian.id] = {\n      data: pedestrian,\n      object: object,\n      worker: worker\n    };\n\n    // start the worker\n    worker.start(pedestrian.id, this._createWorkerCallback());\n\n    console.log('added pedestrian: ' + JSON.stringify(pedestrian));\n  }\n\n  // (websocket)\n  _createWorker() {\n    var baseUrl = this._api.baseUrl;\n    return {\n      _baseUrl: baseUrl,\n      _api: null,\n      _id: null,\n      _callback: null,\n      _isRunning: false,\n\n      /** start updating the pedestrian */\n      start: function(id, callback) {\n        this._api = new SimWorker.API(this._baseUrl);\n        this._id = id;\n        this._callback = callback;\n        this._isRunning = true;\n\n        var self = this;\n        setTimeout(function() { self._update(); }, self._interval);\n      },\n\n      _update: function() {\n        var self = this;\n\n        var socket = this._api.wsPedestrian(this._id);\n        socket.onclose = function(event) {\n          self._isRunning = false;\n          console.log('closed pedestrian ' + self._id);\n        };\n        socket.onmessage = function(event) {\n          // here, \"event\" is an instance of MessageEvent, which cannot be serialized to send to the UI thread,\n          // hence, we just extract the data object (sent by another peer) and transfer it to the UI thread.\n          // console.log(event.data);\n          if (event.data) {\n            self._callback(JSON.parse(event.data));\n          }\n        };\n        socket.onopen = function() {\n          console.log('opened pedestrian ' + self._id);\n        };\n      },\n\n      /** stop updating */\n      stop: function() {\n        this._isRunning = false;\n      }\n    };\n  }\n\n  _createWorkerCallback() {\n    return (function(that) {\n      var prevSender = '';\n      return function(msg) {\n        var sender = msg.sender;\n        var pedestrian = msg.data;\n\n        var viziLayer = that._getViziLayer();\n\n        // update the object in vizi layer\n        if (prevSender !== sender) {\n          viziLayer.setLabelText(pedestrian.id, sender);\n          prevSender = sender;\n        }\n        viziLayer.setLocation(pedestrian.id, pedestrian.location.lat, pedestrian.location.lon, -pedestrian.angle);\n        viziLayer.setVelocity(pedestrian.id, pedestrian.velocity, 0, 0, 0);\n      };\n    })(this);\n  }\n\n}\n\nexport default PedestrianLayer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/PedestrianLayer.js\n **/","/**\n * API Helper\n */\nimport WebClient from './WebClient';\n\n// --- API endpoint definitions\nconst GET_VEHICLES = '/api/v1/vehicles';\nconst UPDATE_VEHICLES = '/api/v1/vehicles';\nconst GET_VEHICLE = function(vid) { return '/api/v1/vehicles/' + vid; };\nconst WS_VEHICLES = '/api/v1/vehicles-ws';\nconst WS_VEHICLE = function(vid) { return '/api/v1/vehicles/' + vid + '/ws'; };\n\nconst GET_PEDESTRIANS = '/api/v1/pedestrians';\nconst UPDATE_PEDESTRIANS = '/api/v1/pedestrians';\nconst GET_PEDESTRIAN = function(pid) { return '/api/v1/pedestrians/' + pid; };\nconst WS_PEDESTRIANS = '/api/v1/pedestrians-ws';\nconst WS_PEDESTRIAN = function(pid) { return '/api/v1/pedestrians/' + pid + '/ws'; };\n// ---\n\nclass API extends WebClient {\n  constructor(baseUrl) {\n    super();\n    this.baseUrl = baseUrl;\n    this.wsBaseUrl = baseUrl.replace(/^https?:\\/\\//, 'ws://');\n  }\n\n  // --- Vehicles\n  getVehicles() {\n    return this._ajax({\n      url: this.baseUrl + GET_VEHICLES,\n      method: 'get'\n    });\n  }\n\n  updateVehicles(data) {\n    return this._ajax({\n      url: this.baseUrl + UPDATE_VEHICLES,\n      method: 'put',\n      data: data\n    });\n  }\n\n  getVehicle(vid) {\n    return this._ajax({\n      url: this.baseUrl + GET_VEHICLE(vid),\n      method: 'get'\n    });\n  }\n\n  wsVehicles() {\n    return new WebSocket(this.wsBaseUrl + WS_VEHICLES);\n  }\n\n  wsVehicle(vid) {\n    return new WebSocket(this.wsBaseUrl + WS_VEHICLE(vid));\n  }\n  // ---\n\n  // --- Pedestrians\n  getPedestrians() {\n    return this._ajax({\n      url: this.baseUrl + GET_PEDESTRIANS,\n      method: 'get'\n    });\n  }\n\n  updatePedestrians(data) {\n    return this._ajax({\n      url: this.baseUrl + UPDATE_PEDESTRIANS,\n      method: 'put',\n      data: data\n    });\n  }\n\n  getPedestrian(pid) {\n    return this._ajax({\n      url: this.baseUrl + GET_PEDESTRIAN(pid),\n      method: 'get'\n    });\n  }\n\n  wsPedestrians() {\n    return new WebSocket(this.wsBaseUrl + WS_PEDESTRIANS);\n  }\n\n  wsPedestrian(pid) {\n    return new WebSocket(this.wsBaseUrl + WS_PEDESTRIAN(pid));\n  }\n  // ---\n\n}\n\nexport default API;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/io/API.js\n **/","/**\n * Created by masayuki on 28/07/2016.\n */\nimport extend from 'extend';\n\nclass WebClient {\n  constructor() {\n\n  }\n\n  _ajax(param) {\n    var defaultParam = {\n      url: null,\n      method: 'GET',\n      data: null,\n      type: 'json'\n    };\n    param = extend({}, defaultParam, param);\n\n    return new Promise(function(resolve, reject) {\n      var method = param.method.toUpperCase();\n\n      var xhr = new XMLHttpRequest();\n      xhr.open(method, param.url);\n      xhr.responseType = param.type;\n\n      // set callbacks\n      xhr.onload = function() {\n        if (xhr.status === 200) {\n          resolve(xhr.response);\n        } else {\n          reject(Error(xhr.statusText));\n        }\n      };\n      xhr.onerror = function() {\n        reject(Error('Network Error'));\n      };\n\n      // send data if exists\n      if ((method === 'POST' || method === 'PUT') && param.data) {\n        xhr.send(param.data);\n      }\n      // or send the request without data\n      else {\n        xhr.send();\n      }\n    });\n  }\n\n}\n\nexport default WebClient;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/io/WebClient.js\n **/","import VIZI from 'vizi';\nimport extend from 'extend';\nimport operative from 'operative';\n\nimport Layer from './Layer';\n\nimport API from '../io/API';\n\nimport WorkerUtils from '../util/WorkerUtils';\n\nconst UPDATE_INTERVAL_MS = 10000;\n\nclass VehicleLayer extends Layer {\n  constructor(options) {\n    var defaultOptions = {};\n\n    var _options = extend({}, defaultOptions, options);\n    super(_options);\n\n    this._vehicles = [];\n\n    this._setup();\n  }\n\n  _setup() {\n\n    // car layer\n    var viziLayer = VIZI.vehicleLayer({\n      'veyron': {\n        file: {\n          body: '/javascripts/maps/objs/veyron/parts/veyron_body_bin.js',\n          wheel: '/javascripts/maps/objs/veyron/parts/veyron_wheel_bin.js'\n        },\n        textureFile: '/javascripts/maps/objs/veyron/texture.png',\n        scale: 0.025,\n        translation: {x: 0, y: 0, z: 0},\n        rotation: {x: 0, y: 90 * Math.PI / 180, z: 0}\n      }\n    }, {\n      simWidth: 32,\n      style: {\n        height: 0\n      }\n    });\n\n    // set the instance property\n    this._setViziLayer(viziLayer);\n\n  }\n\n  /**\n   * Starts updating the view\n   */\n  start() {\n    this._isRunning = true;\n\n    var self = this;\n\n    // start all of the workers\n    this._vehicles.forEach((vehicle,id) => {\n      if (vehicle.worker) {\n        vehicle.worker.start(id, self._createWorkerCallback());\n      }\n    });\n\n    // start vehicle manager\n    var ws = this._api.wsVehicles();\n    ws.onclose = function(event) {\n      console.log('closed vehicle manager');\n    };\n    ws.onmessage = function(event) {\n      self._onMessage(event.data);\n    };\n    ws.onopen = function() {\n      console.log('opened vehicle manager');\n    };\n    this._ws = ws;\n\n    setTimeout(function() { self._update(); }, 0);\n  }\n\n  /**\n   * Stops updating the view\n   */\n  stop() {\n    this._isRunning = false;\n\n    // terminate vehicle manager\n    if (this._ws) {\n      this._ws.close();\n    }\n\n    // terminate all of the workers\n    this._vehicles.forEach(vehicle => {\n      if (vehicle.worker) {\n        vehicle.worker.stop();\n      }\n    });\n  }\n\n  _onMessage(data) {\n    var self = this;\n    if (data === 'creation') {\n      setTimeout(function() { self._update(); }, 0);\n    } else if (data === 'deletion') {\n      setTImeout(function() { self._update(); }, 0);\n    } else {\n      console.error('unknown message ' + data);\n    }\n  }\n\n  // (rest)\n  // _update() {\n  //   var self = this;\n  //\n  //   if (this._isRunning) {\n  //\n  //     this._lastUpdatedAt = Date.now();\n  //\n  //     this._api.getVehicles()\n  //       .then(function(data) {\n  //\n  //         self._performUpdate(data);\n  //\n  //       }).catch(function(err) {\n  //\n  //       console.error('Error updating the vehicle layer: ' + err);\n  //\n  //     }).then(function() {\n  //\n  //       if (self._isRunning) {\n  //         // calculate the delay\n  //         var lastUpdate = self._lastUpdatedAt;\n  //         var now = Date.now();\n  //         var delay = UPDATE_INTERVAL_MS - (now - lastUpdate);\n  //\n  //         // register the next update\n  //         setTimeout(function() { self._update(); }, (delay > 0) ? delay : 0);\n  //       }\n  //\n  //     });\n  //\n  //   }\n  // }\n\n  // (websocket)\n  _update() {\n    var self = this;\n\n    if (this._isRunning) {\n\n      this._lastUpdatedAt = Date.now();\n\n      this._api.getVehicles()\n        .then(function(data) {\n\n          self._performUpdate(data);\n\n        }).catch(function(err) {\n\n          console.error('Error updating the vehicle layer: ' + err);\n\n        });\n\n    }\n  }\n\n  _performUpdate(data) {\n    var self = this;\n\n    // map vehicle parameters into dictionaries\n    data.forEach(vehicle => {\n      // if vehicle does not exist\n      if (!self._hasVehicle(vehicle)) {\n        // add to vehicle layer\n        self._addVehicle(vehicle);\n      }\n    });\n  }\n\n  _hasVehicle(vehicle) {\n    return (vehicle.id in this._vehicles);\n  }\n\n  _addVehicle(vehicle) {\n    var viziLayer = this._getViziLayer();\n\n    // add vehicle to the vizi layer\n    var object = viziLayer.addVehicle(\n      vehicle.type,\n      new VIZI.LatLon(vehicle.location.lat, vehicle.location.lon),\n      vehicle.angle\n    );\n\n    // create a new updating thread\n    var worker = operative(this._createWorker(), WorkerUtils.getDependencies());\n\n    // add entry to dictionary\n    this._vehicles[vehicle.id] = {\n      data: vehicle,\n      object: object,\n      worker: worker\n    };\n\n    // start the worker\n    worker.start(vehicle.id, this._createWorkerCallback());\n\n    console.log('added vehicle: ' + JSON.stringify(vehicle));\n  }\n\n  // (rest)\n  // _createWorker() {\n  //   var baseUrl = this._api.baseUrl;\n  //   return {\n  //     _interval: 10,\n  //     _baseUrl: baseUrl,\n  //     _api: null,\n  //     _id: null,\n  //     _callback: null,\n  //     _isRunning: false,\n  //\n  //     /** start updating the vehicle */\n  //     start: function(id, callback) {\n  //       this._api = new SimWorker.API(this._baseUrl);\n  //       this._id = id;\n  //       this._callback = callback;\n  //       this._isRunning = true;\n  //\n  //       var self = this;\n  //       setTimeout(function() { self._update(); }, self._interval);\n  //     },\n  //\n  //     _update: function() {\n  //       var id = this._id;\n  //       var self = this;\n  //       this._api.getVehicle(id)\n  //         .then(function(data) {\n  //           self._callback(data);\n  //         })\n  //         .catch(function(err) {\n  //           console.error(err);\n  //         })\n  //         .then(function() {\n  //           if (self._isRunning) {\n  //             setTimeout(function() { self._update(); }, self._interval);\n  //           }\n  //         });\n  //     },\n  //\n  //     /** stop updating */\n  //     stop: function() {\n  //       this._isRunning = false;\n  //     }\n  //   };\n  // }\n\n  // (websocket)\n  _createWorker() {\n    var baseUrl = this._api.baseUrl;\n    return {\n      _baseUrl: baseUrl,\n      _api: null,\n      _id: null,\n      _socket: null,\n      _callback: null,\n      _isRunning: false,\n\n      /** start updating the vehicle */\n      start: function(id, callback) {\n        this._api = new SimWorker.API(this._baseUrl);\n        this._id = id;\n        this._callback = callback;\n        this._isRunning = true;\n\n        var self = this;\n        setTimeout(function() { self._update(); }, 0);\n      },\n\n      _update: function() {\n        var self = this;\n\n        var socket = this._api.wsVehicle(this._id);\n        socket.onclose = function(event) {\n          self._isRunning = false;\n          console.log('closed vehicle ' + self._id);\n        };\n        socket.onmessage = function(event) {\n          // here, \"event\" is an instance of MessageEvent, which cannot be serialized to send to the UI thread,\n          // hence, we just extract the data object (sent by another peer) and transfer it to the UI thread.\n          // console.log(event.data);\n          if (event.data) {\n            self._callback(JSON.parse(event.data));\n          }\n        };\n        socket.onopen = function() {\n          console.log('opened vehicle ' + self._id);\n        };\n        self._socket = socket;\n      },\n\n      /** stop updating */\n      stop: function() {\n        this._isRunning = false;\n      }\n    };\n  }\n\n  _createWorkerCallback() {\n    return (function(that) {\n      var prevSender = '';\n      return function(msg) {\n        var sender = msg.sender;\n        var vehicle = msg.data;\n\n        var viziLayer = that._getViziLayer();\n\n        // update the object in vizi layer\n        if (prevSender !== sender) {\n          viziLayer.setLabelText(vehicle.id, sender);\n          prevSender = sender;\n        }\n        viziLayer.setLocation(vehicle.id, vehicle.location.lat, vehicle.location.lon, -vehicle.angle);\n        viziLayer.setVelocity(vehicle.id, vehicle.velocity, 0, 0, vehicle.wheel);\n      };\n    })(this);\n  }\n\n}\n\nexport default VehicleLayer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/VehicleLayer.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_18__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"operative\"\n ** module id = 18\n ** module chunks = 0\n **/"],"sourceRoot":""}