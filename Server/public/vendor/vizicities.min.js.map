{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","vizicities.min.js","webpack:/webpack/bootstrap caf8c35838d39d5cb7ab","webpack:///src/vizicities.js","webpack:///src/World.js","webpack:///~/eventemitter3/index.js","webpack:///~/lodash.assign/index.js","webpack:///src/geo/Geo.js","webpack:///src/geo/LatLon.js","webpack:///src/geo/Point.js","webpack:///src/engine/Engine.js","webpack:/external \"THREE\"","webpack:///src/engine/Scene.js","webpack:///src/engine/DOMScene3D.js","webpack:///src/engine/DOMScene2D.js","webpack:///src/engine/Renderer.js","webpack:///src/engine/DOMRenderer3D.js","webpack:///src/vendor/CSS3DRenderer.js","webpack:///src/engine/DOMRenderer2D.js","webpack:///src/vendor/CSS2DRenderer.js","webpack:///src/engine/Camera.js","webpack:///src/engine/Picking.js","webpack:///src/engine/PickingScene.js","webpack:///src/engine/EffectComposer.js","webpack:///src/vendor/EffectComposer.js","webpack:///src/vendor/CopyShader.js","webpack:///src/vendor/ShaderPass.js","webpack:///src/vendor/MaskPass.js","webpack:///src/vendor/RenderPass.js","webpack:///src/vendor/HorizontalTiltShiftShader.js","webpack:///src/vendor/VerticalTiltShiftShader.js","webpack:///src/vendor/FXAAShader.js","webpack:///src/layer/environment/EnvironmentLayer.js","webpack:///src/layer/Layer.js","webpack:///src/layer/environment/Skybox.js","webpack:///src/layer/environment/Sky.js","webpack:///~/lodash.throttle/index.js","webpack:///src/controls/index.js","webpack:///src/controls/Controls.Orbit.js","webpack:///src/vendor/OrbitControls.js","webpack:///~/hammerjs/hammer.js","webpack:/external \"TweenLite\"","webpack:///src/layer/tile/ImageTileLayer.js","webpack:///src/layer/tile/TileLayer.js","webpack:///src/layer/tile/TileCache.js","webpack:///~/lru-cache/lib/lru-cache.js","webpack:///~/pseudomap/map.js","webpack:///~/process/browser.js","webpack:///~/pseudomap/pseudomap.js","webpack:///~/util/util.js","webpack:///~/util/support/isBufferBrowser.js","webpack:///~/util/~/inherits/inherits_browser.js","webpack:///~/yallist/yallist.js","webpack:///src/layer/tile/ImageTile.js","webpack:///src/layer/tile/Tile.js","webpack:///src/vendor/BoxHelper.js","webpack:///src/layer/tile/ImageTileLayerBaseMaterial.js","webpack:///src/layer/tile/GeoJSONTileLayer.js","webpack:///src/layer/tile/GeoJSONTile.js","webpack:///src/layer/GeoJSONLayer.js","webpack:///src/layer/LayerGroup.js","webpack:///~/reqwest/reqwest.js","webpack:///src/util/GeoJSON.js","webpack:///~/topojson/build/topojson.js","webpack:///~/geojson-merge/index.js","webpack:///~/geojson-normalize/index.js","webpack:///~/earcut/src/earcut.js","webpack:///src/util/extrudePolygon.js","webpack:///src/util/Buffer.js","webpack:///src/engine/PickingMaterial.js","webpack:///src/engine/PickingShader.js","webpack:///src/layer/geometry/PolygonLayer.js","webpack:///src/layer/geometry/PolylineLayer.js","webpack:///src/layer/geometry/PointLayer.js","webpack:///src/layer/tile/TopoJSONTileLayer.js","webpack:///src/layer/TopoJSONLayer.js","webpack:///src/layer/object/PedestrianLayer.js","webpack:///src/layer/object/SimObjectLayer.js","webpack:///src/vendor/GPUComputationRenderer.js","webpack:///src/layer/object/SimObject.js","webpack:///src/layer/object/VehicleVelocityShader.js","webpack:///src/layer/object/VehiclePositionShader.js","webpack:///src/layer/object/VehicleShader.js","webpack:///src/util/ObjectUtils.js","webpack:/external \"operative\"","webpack:///src/vendor/SimplifyModifier.js","webpack:///src/util/WorkerUtils.js","webpack:///src/layer/object/ModelRepository.js","webpack:///src/layer/object/PedestrianModel.js","webpack:///src/vendor/BinaryLoader.js","webpack:///src/layer/object/Pedestrian.js","webpack:///src/layer/object/VehicleLayer.js","webpack:///src/layer/object/VehicleModel.js","webpack:///src/layer/object/Vehicle.js","webpack:///src/util/index.js","webpack:///src/util/wrapNum.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_8__","__WEBPACK_EXTERNAL_MODULE_38__","__WEBPACK_EXTERNAL_MODULE_82__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_World","_World2","_controlsIndex","_controlsIndex2","_geoGeoJs","_geoGeoJs2","_layerLayer","_layerLayer2","_layerEnvironmentEnvironmentLayer","_layerEnvironmentEnvironmentLayer2","_layerTileImageTileLayer","_layerTileImageTileLayer2","_layerTileGeoJSONTileLayer","_layerTileGeoJSONTileLayer2","_layerTileTopoJSONTileLayer","_layerTileTopoJSONTileLayer2","_layerGeoJSONLayer","_layerGeoJSONLayer2","_layerTopoJSONLayer","_layerTopoJSONLayer2","_layerGeometryPolygonLayer","_layerGeometryPolygonLayer2","_layerGeometryPolylineLayer","_layerGeometryPolylineLayer2","_layerGeometryPointLayer","_layerGeometryPointLayer2","_layerObjectPedestrianLayer","_layerObjectPedestrianLayer2","_layerObjectVehicleLayer","_layerObjectVehicleLayer2","_geoPoint","_geoPoint2","_geoLatLon","_geoLatLon2","_enginePickingMaterial","_enginePickingMaterial2","_utilIndex","_utilIndex2","VIZI","version","World","world","Controls","Geo","Layer","layer","EnvironmentLayer","environmentLayer","ImageTileLayer","imageTileLayer","GeoJSONTileLayer","geoJSONTileLayer","TopoJSONTileLayer","topoJSONTileLayer","GeoJSONLayer","geoJSONLayer","TopoJSONLayer","topoJSONLayer","PolygonLayer","polygonLayer","PolylineLayer","polylineLayer","PointLayer","pointLayer","PedestrianLayer","pedestrianLayer","VehicleLayer","vehicleLayer","Point","point","LatLon","latLon","PickingMaterial","Util","_classCallCheck","instance","Constructor","TypeError","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","_get","_x","_x2","_x3","_again","object","property","receiver","Function","desc","getOwnPropertyDescriptor","undefined","getter","get","parent","getPrototypeOf","_eventemitter3","_eventemitter32","_lodashAssign","_lodashAssign2","_geoGeo","_geoGeo2","_engineEngine","_engineEngine2","_EventEmitter","domId","options","defaults","skybox","postProcessing","_layers","_controls","_initContainer","_initAttribution","_initEngine","_initEnvironment","_initEvents","_pause","_update","_container","document","getElementById","message","element","createElement","classList","add","innerHTML","appendChild","_engine","_environment","addTo","on","_onControlsMoveEnd","_point","x","z","_resetView","pointToLatLon","latlon","emit","_moveStart","_move","_moveEnd","_lastPosition","delta","clock","getDelta","window","requestAnimationFrame","bind","forEach","controls","update","_originLatlon","_originPoint","project","latLonToPoint","projectedPoint","_subtract","unproject","accurate","pointScale","metres","zoom","metresToWorld","worldUnits","worldToMetres","_camera","_addToWorld","push","isOutput","isOutputToScene","_scene","_object3D","_domScene3D","_domObject3D","_domScene2D","_domObject2D","layerIndex","indexOf","splice","remove","controlsIndex","stop","off","removeControls","destroy","removeLayer","firstChild","removeChild","noNew","EE","fn","context","once","EventEmitter","has","hasOwnProperty","prefix","_events","eventNames","name","events","names","slice","getOwnPropertySymbols","concat","listeners","event","exists","evt","available","l","ee","Array","a1","a2","a3","a4","a5","args","len","arguments","removeListener","apply","j","listener","removeAllListeners","addListener","setMaxListeners","prefixed","func","thisArg","baseTimes","n","iteratee","index","result","overArg","transform","arg","arrayLikeKeys","inherited","isArray","isArguments","String","skipIndexes","isIndex","assignValue","objValue","eq","baseKeys","isPrototype","nativeKeys","baseRest","start","nativeMax","array","otherArgs","copyObject","source","customizer","newValue","createAssigner","assigner","sources","guard","isIterateeCall","MAX_SAFE_INTEGER","reIsUint","test","isObject","type","isArrayLike","Ctor","proto","objectProto","other","isArrayLikeObject","propertyIsEnumerable","objectToString","argsTag","isLength","isFunction","isObjectLike","tag","funcTag","genTag","keys","toString","Math","max","nonEnumShadows","valueOf","assign","_LatLon","_Point","R","MAX_LATITUDE","ECC","ECC2","d","PI","lat","min","sin","lon","log","atan","exp","y","projected","k","rad","a","sinLat","sinLat2","cosLat","cos","pow","v","sqrt","h","metresToProjected","projectedToMetres","projectedUnits","projectedMetres","scale","scaledMetres","realMetres","LN2","distance","latlon1","latlon2","lat1","lat2","lon1","lon2","deltaLat","deltaLon","halfDeltaLat","halfDeltaLon","atan2","acos","bounds","alt","isNaN","Error","b","lng","round","clone","_add","_three","_three2","_Scene","_Scene2","_DOMScene3D","_DOMScene3D2","_DOMScene2D","_DOMScene2D2","_Renderer","_Renderer2","_DOMRenderer3D","_DOMRenderer3D2","_DOMRenderer2D","_DOMRenderer2D2","_Camera","_Camera2","_Picking","_Picking2","_EffectComposer","_EffectComposer2","_vendorRenderPass","_vendorRenderPass2","_vendorShaderPass","_vendorShaderPass2","_vendorCopyShader","_vendorCopyShader2","_vendorHorizontalTiltShiftShader","_vendorHorizontalTiltShiftShader2","_vendorVerticalTiltShiftShader","_vendorVerticalTiltShiftShader2","_vendorFXAAShader","_vendorFXAAShader2","Engine","container","console","_world","antialias","_renderer","_domRenderer3D","_domRenderer2D","_picking","Clock","_frustum","Frustum","_initPostProcessing","renderPass","fxaaPass","hblurPass","vblurPass","bluriness","uniforms","r","copyPass","renderToScreen","_composer","addPass","self","updatePostProcessingSize","width","clientWidth","height","clientHeight","pixelRatio","resolution","set","addEventListener","render","child","children","geometry","dispose","material","map","_clock","scene","Scene","renderer","WebGLRenderer","setClearColor","setPixelRatio","gammaInput","gammaOutput","shadowMap","enabled","domElement","updateSize","setSize","_vendorCSS3DRenderer","CSS3DRenderer","style","position","top","CSS3DObject","Object3D","parentNode","CSS3DSprite","REVISION","_width","_height","_widthHalf","_heightHalf","matrix","Matrix4","cache","camera","fov","objects","overflow","WebkitTransformStyle","MozTransformStyle","oTransformStyle","transformStyle","cameraElement","getSize","epsilon","abs","Number","EPSILON","getCameraCSSMatrix","elements","getObjectCSSMatrix","renderObject","copy","matrixWorldInverse","transpose","copyPosition","matrixWorld","cachedStyle","WebkitTransform","MozTransform","oTransform","tan","degToRad","WebkitPerspective","MozPerspective","oPerspective","perspective","updateMatrixWorld","getInverse","_vendorCSS2DRenderer","CSS2DRenderer","CSS2DObject","vector","Vector3","viewMatrix","viewProjectionMatrix","frustum","setFromMatrixPosition","applyProjection","containsPoint","display","multiplyMatrices","projectionMatrix","setFromMatrix","PerspectiveCamera","aspect","updateProjectionMatrix","_PickingScene","_PickingScene2","nextId","Picking","_raycaster","Raycaster","linePrecision","_pickingScene","_pickingTexture","WebGLRenderTarget","texture","minFilter","LinearFilter","generateMipmaps","_nextId","_resizeTexture","_resizeHandler","_mouseUpHandler","_onMouseUp","_onWorldMove","button","clientX","clientY","normalisedPoint","_pick","_needUpdate","size","_pixelBuffer","Uint8Array","readRenderTargetPixels","setFromCamera","_point3d","intersects","intersectObjects","_point2d","mesh","removeEventListener","_vendorEffectComposer","_vendorEffectComposer2","composer","_CopyShader","_CopyShader2","_ShaderPass","_ShaderPass2","_MaskPass","_MaskPass2","EffectComposer","renderTarget","getPixelRatio","floor","canvas","parameters","magFilter","format","RGBAFormat","stencilBuffer","renderTarget1","renderTarget2","writeBuffer","readBuffer","passes","error","swapBuffers","tmp","pass","insertPass","maskActive","il","needsSwap","stencilFunc","NOTEQUAL","EQUAL","ClearMaskPass","reset","CopyShader","tDiffuse","opacity","vertexShader","join","fragmentShader","ShaderPass","shader","textureID","ShaderMaterial","UniformsUtils","defines","clear","OrthographicCamera","quad","Mesh","PlaneBufferGeometry","MaskPass","inverse","colorMask","depthMask","writeValue","clearValue","enable","STENCIL_TEST","stencilOp","REPLACE","ALWAYS","clearStencil","KEEP","disable","RenderPass","overrideMaterial","clearColor","clearAlpha","oldClearColor","Color","oldClearAlpha","getClearColor","getClearAlpha","HorizontalTiltShiftShader","VerticalTiltShiftShader","FXAAShader","Vector2","_Layer2","_Layer3","_Skybox","_Skybox2","_Layer","_options","_initLights","_initSkybox","_skyboxLight","DirectionalLight","castShadow","shadow","left","right","bottom","near","far","mapSize","directionalLight","directionalLight2","directionalLight3","_skybox","_mesh","step","gridHelper","GridHelper","_engineScene","output","outputToScene","_dom3D","_dom2D","addLayer","_onAdd","getNextId","removeDOM3D","removeDOM2D","_Sky","_Sky2","_lodashThrottle","_lodashThrottle2","cubemap","Skybox","light","_light","_settings","turbidity","reileigh","mieCoefficient","mieDirectionalG","luminance","inclination","azimuth","_updateUniforms","_throttledWorldUpdate","_cubeCamera","CubeCamera","cubeTarget","_sky","_skyScene","_sunSphere","SphereBufferGeometry","MeshBasicMaterial","color","skyboxUniforms","skyboxMat","side","BackSide","BoxGeometry","_updateSkybox","settings","theta","phi","sunPosition","intensity","updateCubeMap","ShaderLib","Sky","skyShader","skyUniforms","skyMat","skyGeo","skyMesh","global","debounce","wait","invokeFunc","time","lastArgs","lastThis","lastInvokeTime","leadingEdge","timerId","setTimeout","timerExpired","leading","remainingWait","timeSinceLastCall","lastCallTime","timeSinceLastInvoke","maxing","nativeMin","maxWait","shouldInvoke","now","trailingEdge","trailing","cancel","clearTimeout","flush","debounced","isInvoking","FUNC_ERROR_TEXT","toNumber","throttle","isSymbol","symbolTag","NAN","replace","reTrim","isBinary","reIsBinary","reIsOctal","freeParseInt","reIsBadHex","parseInt","freeGlobal","freeSelf","Date","_ControlsOrbit","_ControlsOrbit2","Orbit","orbit","_vendorOrbitControls","_vendorOrbitControls2","_TweenLite","_TweenLite2","lagSmoothing","_this","animate","pointDelta","metresDelta","angle","angleDelta","duration","animationTime","_flyTarget","diff","subVectors","_flyTween","prev","onUpdate","tween","deltaX","deltaZ","panLeft","panUp","onComplete","onUpdateParams","onCompleteParams","callbackScope","ease","Power1","easeInOut","zoomTime","_zoomTweenIn","dollyIn","_zoomTweenOut","delay","dollyOut","noZoom","flyToPoint","addControls","maxPolarAngle","_hammerjs","_hammerjs2","OrbitControls","getAutoRotationAngle","scope","autoRotateSpeed","getZoomScale","zoomSpeed","rotateLeft","thetaDelta","rotateUp","phiDelta","dollyScale","minZoom","maxZoom","zoomChanged","warn","enableZoom","handleMouseDownRotate","rotateStart","handleMouseDownDolly","dollyStart","handleMouseDownPan","panStart","handleMouseMoveRotate","rotateEnd","rotateDelta","body","rotateSpeed","handleMouseMoveDolly","dollyEnd","dollyDelta","handleMouseMovePan","panEnd","panDelta","pan","handleMouseUp","handleMouseWheel","wheelDelta","detail","handleKeyDown","keyCode","UP","keyPanSpeed","BOTTOM","LEFT","RIGHT","handleTouchStartRotate","pointers","pageX","pageY","handleTouchStartDolly","dx","dy","handleTouchStartPan","deltaY","handleTouchMoveRotate","handleTouchMoveDolly","handleTouchMovePan","handleTouchEnd","onMouseDown","preventDefault","mouseButtons","ORBIT","enableRotate","state","STATE","ROTATE","ZOOM","DOLLY","PAN","enablePan","NONE","onMouseMove","onMouseUp","dispatchEvent","startEvent","endEvent","onMouseWheel","stopPropagation","onKeyDown","enableKeys","onTouchStart","touches","TOUCH_ROTATE","TOUCH_DOLLY","TOUCH_PAN","onTouchMove","onTouchEnd","onContextMenu","minDistance","maxDistance","Infinity","minPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","autoRotate","MOUSE","MIDDLE","target0","position0","zoom0","getPolarAngle","getAzimuthalAngle","changeEvent","offset","quat","Quaternion","setFromUnitVectors","up","quatInverse","lastPosition","lastQuaternion","sub","applyQuaternion","EPS","radius","panOffset","lookAt","distanceToSquared","dot","quaternion","objectMatrix","te","multiplyScalar","adjDist","targetDistance","hammer","direction","DIRECTION_ALL","threshold","pointerType","EventDispatcher","center","noRotate","noPan","noKeys","staticMoving","constraint","dynamicDampingFactor","__WEBPACK_AMD_DEFINE_RESULT__","exportName","setTimeoutContext","timeout","bindFn","invokeArrayArg","each","iterator","deprecate","method","deprecationMessage","e","stack","inherit","base","properties","childP","baseP","_super","boolOrFn","val","TYPE_FUNCTION","ifUndefined","val1","val2","addEventListeners","types","handler","splitStr","removeEventListeners","hasParent","node","inStr","str","find","trim","split","inArray","src","findByKey","toArray","uniqueArray","sort","results","values","prop","camelProp","toUpperCase","VENDOR_PREFIXES","uniqueId","_uniqueId","getWindowForElement","doc","ownerDocument","defaultView","parentWindow","Input","manager","callback","inputTarget","domHandler","ev","init","createInputInstance","Type","inputClass","SUPPORT_POINTER_EVENTS","PointerEventInput","SUPPORT_ONLY_TOUCH","TouchInput","SUPPORT_TOUCH","TouchMouseInput","MouseInput","inputHandler","eventType","input","pointersLen","changedPointersLen","changedPointers","isFirst","INPUT_START","isFinal","INPUT_END","INPUT_CANCEL","session","computeInputData","recognize","prevInput","pointersLength","firstInput","simpleCloneInputData","firstMultiple","offsetCenter","getCenter","timeStamp","deltaTime","getAngle","getDistance","computeDeltaXY","offsetDirection","getDirection","overallVelocity","getVelocity","overallVelocityX","overallVelocityY","getScale","rotation","getRotation","maxPointers","computeIntervalInputData","srcEvent","offsetDelta","prevDelta","velocity","velocityX","velocityY","last","lastInterval","COMPUTE_INTERVAL","DIRECTION_NONE","DIRECTION_LEFT","DIRECTION_RIGHT","DIRECTION_UP","DIRECTION_DOWN","p1","p2","PROPS_XY","end","PROPS_CLIENT_XY","evEl","MOUSE_ELEMENT_EVENTS","evWin","MOUSE_WINDOW_EVENTS","pressed","POINTER_ELEMENT_EVENTS","POINTER_WINDOW_EVENTS","store","pointerEvents","SingleTouchInput","evTarget","SINGLE_TOUCH_TARGET_EVENTS","SINGLE_TOUCH_WINDOW_EVENTS","started","normalizeSingleTouches","all","changed","changedTouches","TOUCH_TARGET_EVENTS","targetIds","getTouches","allTouches","INPUT_MOVE","identifier","targetTouches","changedTargetTouches","filter","touch","mouse","primaryTouch","lastTouches","recordTouches","eventData","setLastTouch","lastTouch","lts","removeLastTouch","DEDUP_TIMEOUT","isSyntheticEvent","t","DEDUP_DISTANCE","TouchAction","cleanTouchActions","actions","TOUCH_ACTION_NONE","hasPanX","TOUCH_ACTION_PAN_X","hasPanY","TOUCH_ACTION_PAN_Y","TOUCH_ACTION_MANIPULATION","TOUCH_ACTION_AUTO","getTouchActionProps","NATIVE_TOUCH_ACTION","touchMap","cssSupports","CSS","supports","Recognizer","STATE_POSSIBLE","simultaneous","requireFail","stateStr","STATE_CANCELLED","STATE_ENDED","STATE_CHANGED","STATE_BEGAN","directionStr","getRecognizerByNameIfManager","otherRecognizer","recognizer","AttrRecognizer","PanRecognizer","pX","pY","PinchRecognizer","PressRecognizer","_timer","_input","RotateRecognizer","SwipeRecognizer","TapRecognizer","pTime","pCenter","count","Hammer","recognizers","preset","Manager","handlers","oldCssProps","touchAction","toggleCssProps","item","recognizeWith","requireFailure","cssProps","triggerDomEvent","data","gestureEvent","createEvent","initEvent","gesture","TEST_ELEMENT","nextKey","extend","dest","merge","MOBILE_REGEX","navigator","userAgent","INPUT_TYPE_TOUCH","INPUT_TYPE_PEN","INPUT_TYPE_MOUSE","INPUT_TYPE_KINECT","DIRECTION_HORIZONTAL","DIRECTION_VERTICAL","MOUSE_INPUT_MAP","mousedown","mousemove","mouseup","which","POINTER_INPUT_MAP","pointerdown","pointermove","pointerup","pointercancel","pointerout","IE10_POINTER_TYPE_ENUM","2","3","4","5","MSPointerEvent","PointerEvent","removePointer","eventTypeNormalized","toLowerCase","isTouch","storeIndex","pointerId","SINGLE_TOUCH_INPUT_MAP","touchstart","touchmove","touchend","touchcancel","TOUCH_INPUT_MAP","inputEvent","inputData","isMouse","sourceCapabilities","firesTouchEvents","PREFIXED_TOUCH_ACTION","TOUCH_ACTION_COMPUTE","TOUCH_ACTION_MAP","compute","getTouchAction","preventDefaults","prevented","hasNone","isTapPointer","isTapMovement","isTapTouchTime","preventSrc","STATE_RECOGNIZED","STATE_FAILED","dropRecognizeWith","dropRequireFailure","hasRequireFailures","canRecognizeWith","additionalEvent","tryEmit","canEmit","inputDataClone","process","attrTest","optionPointers","isRecognized","isValid","directionTest","hasMoved","inOut","validPointers","validMovement","validTime","taps","interval","posThreshold","validTouchTime","failTimeout","validInterval","validMultiTap","tapCount","VERSION","domEvents","userSelect","touchSelect","touchCallout","contentZooming","userDrag","tapHighlightColor","STOP","FORCED_STOP","force","stopped","curRecognizer","existing","Tap","Pan","Swipe","Pinch","Rotate","Press","_TileLayer2","_TileLayer3","_ImageTile","_ImageTile2","_ImageTileLayerBaseMaterial","_ImageTileLayerBaseMaterial2","_TileLayer","path","_path","baseMaterial","geom","getRenderTarget","renderOrder","receiveShadow","_baseLayer","_calculateLOD","_onWorldUpdate","_outputTiles","_moveBaseLayer","quadcode","_TileCache","_TileCache2","TileLayer","picking","maxCache","maxLOD","_tileCache","tile","_destroyTile","_tileList","_minLOD","_maxLOD","_tiles","_tilesPicking","addToPicking","getCamera","projScreenMatrix","getBounds","intersectsBox","Box3","_this2","_removeTiles","isReady","getMesh","getPickingMesh","_this3","_stop","_updateFrustum","checkList","_checklist","_requestTile","_divide","_quadcode","_tileInFrustum","dist","requestTileAsync","currentItem","getQuadcode","_screenSpaceError","minDepth","maxDepth","quality","getSide","getTile","_createTile","setTile","removeFromPicking","_lruCache","_lruCache2","TileCache","cacheLimit","onDestroyTile","_cache","tileCache","priv","sym","symbols","makeSymbol","naiveLength","LRUCache","lc","stale","maxAge","forEachStep","thisp","hit","isStale","del","doUse","unshiftNode","walker","tail","removeNode","Entry","Map","util","Yallist","hasSymbol","Symbol","mL","allowStale","mA","lC","rforEach","head","next","dump","dumpLru","inspect","opts","extras","as","didFirst","unshift","peek","pop","load","arr","expiresAt","prune","env","npm_package_name","npm_lifecycle_script","TEST_PSEUDOMAP","defaultSetTimout","defaultClearTimeout","runTimeout","fun","cachedSetTimeout","runClearTimeout","marker","cachedClearTimeout","cleanUpNextTick","draining","currentQueue","queue","queueIndex","drainQueue","run","Item","noop","nextTick","title","browser","argv","versions","binding","cwd","chdir","dir","umask","PseudoMap","kv","same","_index","s","_data","res","entries","ctx","seen","stylize","stylizeNoColor","depth","colors","isBoolean","showHidden","_extend","isUndefined","customInspect","stylizeWithColor","formatValue","styleType","styles","arrayToHash","hash","idx","recurseTimes","ret","isString","primitive","formatPrimitive","visibleKeys","getOwnPropertyNames","isError","formatError","isRegExp","RegExp","isDate","braces","toUTCString","formatArray","formatProperty","reduceToSingleString","simple","JSON","stringify","isNumber","isNull","match","line","substr","numLinesEst","reduce","cur","ar","isNullOrUndefined","re","isPrimitive","o","pad","timestamp","getHours","getMinutes","getSeconds","getDate","months","getMonth","formatRegExp","f","_","msg","deprecated","warned","throwDeprecation","traceDeprecation","trace","noDeprecation","debugEnviron","debugs","debuglog","NODE_DEBUG","pid","bold","italic","underline","white","grey","black","blue","cyan","green","magenta","red","yellow","special","number","boolean","null","string","date","regexp","isBuffer","inherits","origin","fill","readUInt8","ctor","superCtor","super_","TempCtor","list","Node","pushNode","shift","forEachReverse","getReverse","mapReverse","initial","acc","reduceReverse","toArrayReverse","from","to","sliceReverse","reverse","_Tile2","_Tile3","_vendorBoxHelper","ImageTile","_Tile","_createMesh","_abortRequest","_image","_center","_side","MeshStandardMaterial","depthWrite","roughness","metalness","envMap","localMesh","getContext","font","fillStyle","fillText","_tile","Texture","LinearMipMapLinearFilter","anisotropy","needsUpdate","transparent","urlParams","url","_getTileURL","image","_texture","_ready","crossOrigin","imageTile","r2d","tileURLRegex","Tile","_layer","_quadcodeToTile","_boundsLatLon","_tileBoundsWGS84","_boundsWorld","_tileBoundsFromWGS84","_boundsToCenter","_centerLatlon","_getSide","_pointScale","_pickingMesh","fromCharCode","random","lastIndex","mask","q","boundsWGS84","sw","ne","_tile2lon","w","_tile2lat","BoxHelper","indices","Uint16Array","positions","Float32Array","BufferGeometry","setIndex","BufferAttribute","addAttribute","LineSegments","LineBasicMaterial","linewidth","box","setFromObject","isEmpty","attributes","computeBoundingSphere","colour","skyboxTarget","fillRect","_GeoJSONTile","_GeoJSONTile2","_onControlsMove","_pauseOutput","_GeoJSONLayer","_reqwest","_reqwest2","_utilGeoJSON","_utilGeoJSON2","_utilBuffer","GeoJSONTile","_defaultStyle","defaultStyle","interactive","topojson","onEachFeature","polygonMaterial","onPolygonMesh","onPolygonBufferAttributes","polylineMaterial","onPolylineMesh","onPolylineBufferAttributes","pointGeometry","pointMaterial","onPointMesh","keepFeatures","_request","_geojsonLayer","then","_processTileData","err","_geojson","timeEnd","abort","geoJSONTile","_LayerGroup2","_LayerGroup3","_utilBuffer2","_geometryPolygonLayer","_geometryPolygonLayer2","_geometryPolylineLayer","_geometryPolylineLayer2","_geometryPointLayer","_geometryPointLayer2","_LayerGroup","geojson","THREE","_requestData","_processData","collectFeatures","features","feature","_featureToLayer","polygonAttributes","polygonFlat","polylineAttributes","pointAttributes","getBufferAttributes","isFlat","mergedPolygonAttributes","mergeAttributes","_setPolygonMesh","_polygonMesh","mergedPolylineAttributes","_setPolylineMesh","_polylineMesh","mergedPointAttributes","_setPointMesh","_pointMesh","clearBufferAttributes","clearCoordinates","flat","vertices","normals","colours","pickingIds","computeBoundingBox","Material","vertexColors","VertexColors","blending","envMapIntensity","MeshPhongMaterial","pickingMesh","lineWidth","lineTransparent","lineOpacity","lineBlending","lineRenderOrder","linePadding","coordinates","onMesh","onBufferAttributes","lineMaterial","LayerGroup","layerGroup","__WEBPACK_AMD_DEFINE_FACTORY__","definition","succeed","protocol","protocolRe","exec","location","httpsRe","twoHundo","request","status","response","handleReadyState","success","_aborted","_timedOut","readyState","onreadystatechange","setHeaders","http","headers","defaultHeaders","isAFormData","FormData","requestedWith","contentType","setRequestHeader","setCredentials","withCredentials","generalCallback","lastValue","urlappend","handleJsonp","reqId","uniqid","cbkey","cbval","reqwest","getcallbackPrefix","cbreg","script","isIE10","async","htmlFor","onload","onclick","getRequest","toQueryString","sendWait","xhr","open","xDomainRequest","onerror","onprogress","send","Reqwest","setType","header","complete","resp","_completeHandlers","getResponseHeader","filteredResponse","globalSetupOptions","dataFilter","responseText","parse","eval","responseXML","parseError","errorCode","reason","_responseArgs","_fulfilled","_successHandler","_fulfillmentHandlers","timedOut","_erred","_errorHandlers","normalize","serial","el","cb","ch","ra","tagName","optCb","disabled","checked","selectedIndex","selected","eachFormElement","serializeSubtags","tags","fa","byTag","serializeQueryString","serializeArray","serializeHash","buildParams","traditional","rbracket","XHR2","ex","callbackPrefix","xmlHttpRequest","accept","*","xml","html","text","json","js","XMLHttpRequest","XDomainRequest","ActiveXObject","retry","fail","always","catch","serialize","opt","nodeType","trad","enc","encodeURIComponent","compat","ajaxSetup","_topojson2","_topojson3","_geojsonMerge","_geojsonMerge2","_earcut","_earcut2","_extrudePolygon","_extrudePolygon2","GeoJSON","NormalBlending","lineColor","_topojson","collections","tk","gk","lineStringAttributes","nextCoord","_coords","_colours","coordinate","g","multiLineStringAttributes","coord","earcutData","_toEarcut","faces","_triangulate","holes","dimensions","groupedVertices","_colour","extruded","topColor","multiply","bottomColor","_vertices","_faces","face","fi","allFlat","sides","dim","holeIndex","contour","transformAbsolute","x0","y0","kx","ky","translate","transformRelative","x1","y1","bisect","lo","hi","mid","topology","geometries","feature$1","arc","points","arcs","absolute","ring","polygon","geometryType","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","stitchArcs","ends","p0","dp","fragmentByEnd","fragmentByStart","stitchedArcs","fragments","emptyIndex","fg","gf","meshArcs","geomsByArc","geoms","cartesianTriangleArea","triangle","area","mergeArcs","register","ring$$","polygonsByArc","polygons","components","component","neighbors","ki","indexesByArc","indexes","ij","ik","compareArea","minAreaHeap","down","heap","removed","presimplify","triangleArea","relative","triangles","maxArea","previous","inputs","memo","gj","GeometryCollection","Feature","FeatureCollection","earcut","holeIndices","hasHoles","outerLen","outerNode","linkedList","minX","minY","maxX","maxY","eliminateHoles","earcutLinked","clockwise","signedArea","insertNode","equals","filterPoints","again","steiner","ear","indexCurve","isEarHashed","isEar","cureLocalIntersections","splitEarcut","pointInTriangle","minTX","minTY","maxTX","maxTY","minZ","zOrder","maxZ","nextZ","prevZ","locallyInside","isValidDiagonal","splitPolygon","getLeftmost","compareX","eliminateHole","hole","findHoleBridge","hx","hy","qx","mx","my","tanMin","sortLinked","numMerges","pSize","qSize","inSize","leftmost","ax","ay","bx","by","cx","cy","px","py","intersectsPolygon","middleInside","q1","q2","inside","b2","an","bp","sum","deviation","polygonArea","trianglesArea","flatten","extrudePolygon","cells","topCells","full","sideCells","closed","bottomCells","Buffer","lengths","_attributes","mergedAttributes","lastLengths","createLineGeometry","lines","verticesCount","_pickingId","az","c1","createGeometry","facesCount","pA","pB","pC","ab","bz","c2","cz","c3","cross","nx","ny","nz","_PickingShader","_PickingShader2","setPointSize","setPointScale","PickingShader","_earcut3","_utilExtrudePolygon","_utilExtrudePolygon2","_coordinates","isSingle","_setCoordinates","_setPickingId","_addPickingEvents","_setBufferAttributes","_setMesh","_bufferAttributes","getPickingId","point2d","point3d","_projectedCoordinates","_flat","pickingId","_toAttributes","_bounds","_convertCoordinates","_projectedBounds","_projectCoordinates","_offset","lineHeight","_normals","pointColor","pointHeight","Geometry","geometryWidth","geometryHeight","_geometry","fromGeometry","normal","_GeoJSONTileLayer2","_GeoJSONTileLayer3","_GeoJSONTileLayer","_GeoJSONLayer2","_GeoJSONLayer3","_SimObjectLayer2","_SimObjectLayer3","_ModelRepository","_ModelRepository2","_PedestrianModel","_PedestrianModel2","_Pedestrian","_Pedestrian2","MODEL_PREFIX","_SimObjectLayer","models","modelDefaults","file","translation","rx","ry","rz","_modelsLoaded","_models","_entries","_onLoadCompleted","_loadModels","counter","modelName","model","pedestrianModel","bodyURL","entry","pedestrian","_addPedestrianInternal","contains","total","setLocation","_vendorGPUComputationRenderer","_vendorGPUComputationRenderer2","_SimObject","_VehicleVelocityShader","_VehicleVelocityShader2","_VehiclePositionShader","_VehiclePositionShader2","_VehicleShader","_utilObjectUtils","SimObjectLayer","dynamic","enableGpuComputation","simWidth","_simObjects","_gpuCompute","gpuCompute","textureAcceleration","createTexture","textureVelocity","texturePosition","velocityVariable","addVariable","positionVariable","setVariableDependencies","positionUniforms","velocityUniforms","wrapS","RepeatWrapping","wrapT","_textureAcceleration","_textureVelocity","_texturePosition","_positionVariable","_velocityVariable","_positionUniforms","_velocityUniforms","simObject","updatePosition","addDOM2D","label","_initComputeRenderer","_performUpdate","_performSimUpdate","performance","readVariable","setPosition","setAngle","setVelocity","_setPosition","_setSimPosition","updateVariable","vx","vy","vz","wheel","_setVelocity","_setSimVelocity","aw","locations","_setSimPositions","velocities","accelerations","className","setLabelClass","setLabelText","setLabelOffset","GPUComputationRenderer","sizeX","sizeY","addResolutionDefine","materialShader","toFixed","createShaderMaterial","computeFragmentShader","getPassThroughVertexShader","getPassThroughFragmentShader","variables","currentTextureIndex","Camera","passThruUniforms","passThruShader","variableName","initialValueTexture","variable","dependencies","renderTargets","NearestFilter","extensions","capabilities","maxVertexTextures","createRenderTarget","renderTexture","depVar","found","nextTextureIndex","dl","doRenderTarget","getCurrentRenderTarget","getAlternateRenderTarget","sizeXTexture","sizeYTexture","ClampToEdgeWrapping","FloatType","DataTexture","forceClear","gl","readPixels","RGBA","FLOAT","SimObject","labelOffset","_createSimObject","textContent","forwardDelta","arrowHelper","ArrowHelper","bbox","VehicleVelocityShader","VehiclePositionShader","VehicleShader","reference","_operative","_operative2","_vendorSimplifyModifier","_vendorSimplifyModifier2","_WorkerUtils","_WorkerUtils2","ObjectUtils","createUV","boundingBox","range","faceVertexUvs","v1","v2","v3","uvsNeedUpdate","objectToGeometry","newGeo","Face3","materialIndex","simplifyGeometry","reduceCount","assert","deferred","modifier","SimplifyModifier","modify","getDependencies","pushIfUnique","removeFromArray","computeEdgeCollapseCost","u","sideFace","edgelength","distanceTo","curvature","sideFaces","hasVertex","minCurvature","dotProd","borders","amt","computeEdgeCostAtVertex","collapseNeighbor","collapseCost","minCost","totalCost","costCount","removeVertex","removeFace","vs","removeIfNonNeighbor","collapse","tmpVertices","replaceVertex","minimumCostEdge","least","Triangle","computeNormal","addUniqueNeighbor","Vertex","vA","vB","vC","oldv","newv","vertex","fromBufferGeometry","mergeVertices","oldVertices","oldFaces","nextVertex","tri","WorkerUtils","dirname","current","isWorker","currentScript","scripts","getElementsByTagName","ModelRepository","_map","modelRepository","_vendorBinaryLoader","PedestrianModel","createBody","materials","bodyGeometry","bodyMaterials","morphTargets","onCreated","jloader","JSONLoader","BinaryLoader","DefaultLoadingManager","onLoad","onProgress","onError","texturePath","Loader","extractUrlBase","binaryPath","jsonloader","XHRLoader","bufferUrl","buffers","bufferLoader","setResponseType","bufData","setBinaryPath","setCrossOrigin","setTexturePath","jsonMaterials","Model","handlePadding","parseMetaData","metaData","signature","parseString","header_bytes","parseUChar8","vertex_coordinate_bytes","normal_coordinate_bytes","uv_coordinate_bytes","vertex_index_bytes","normal_index_bytes","uv_index_bytes","material_index_bytes","nvertices","parseUInt32","nnormals","nuvs","ntri_flat","ntri_smooth","ntri_flat_uv","ntri_smooth_uv","nquad_flat","nquad_smooth","nquad_flat_uv","nquad_smooth_uv","charArray","intArray","Uint32Array","init_vertices","nElements","md","coordArray","BYTES_PER_ELEMENT","init_normals","normalArray","Int8Array","init_uvs","uvArray","uvs","init_uvs3","uva","uvb","uvc","u1","u2","u3","uvIndexBuffer","init_uvs4","uvd","u4","v4","init_faces3_flat","offsetVertices","offsetMaterials","vertexIndexBuffer","materialIndexBuffer","init_faces4_flat","init_faces3_smooth","offsetNormals","na","nb","nc","normalIndexBuffer","nax","nay","naz","nbx","nby","nbz","ncx","ncy","ncz","init_faces4_smooth","nd","ndx","ndy","ndz","init_triangles_flat","init_triangles_flat_uv","offsetUvs","init_triangles_smooth","init_triangles_smooth_uv","init_quads_flat","init_quads_flat_uv","init_quads_smooth","init_quads_smooth_uv","start_tri_flat","start_tri_smooth","start_tri_flat_uv","start_tri_smooth_uv","start_quad_flat","start_quad_smooth","start_quad_flat_uv","start_quad_smooth_uv","tri_size","quad_size","len_tri_flat","len_tri_smooth","len_tri_flat_uv","len_tri_smooth_uv","len_quad_flat","len_quad_smooth","len_quad_flat_uv","len_quad_smooth_uv","currentOffset","computeFaceNormals","initMaterials","_SimObject2","_SimObject3","Pedestrian","lastKeyFrame","currentKeyFrame","updateMorph","bodyMesh","_createPedestrian","modelScale","modelTranslation","modelRotation","bodyFaceMaterial","MeshFaceMaterial","MorphBlendMesh","animationsList","animation","active","_adjustLabelOffset","_VehicleModel","_VehicleModel2","_Vehicle","_Vehicle2","wheelOffset","vehicleModel","wheelURL","vehicle","_addVehicleInternal","setWheelAngle","VehicleModel","sortFacesByMaterialIndex","computeVertexNormals","createWheel","wheelGeometry","wheelMaterials","wbb","wheelDiameter","autoWheelOffset","addVectors","bloader","Vehicle","wheelAngle","updateWheel","frontLeftWheelRoot","frontRightWheelRoot","frontLeftWheelMesh","frontRightWheelMesh","rearLeftWheelMesh","rearRightWheelMesh","STEERING_RADIUS_RATIO","_createVehicle","angularSpeedRatio","MultiMaterial","wheelFaceMaterial","multiplyVectors","rotateY","_wrapNum","_wrapNum2","_GeoJSON","_GeoJSON2","_Buffer","_Buffer2","_ObjectUtils","_ObjectUtils2","wrapNum","includeMax"],"mappings":"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","file":"vizicities.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"THREE\"), require(\"TweenLite\"), require(\"operative\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"THREE\", \"TweenLite\", \"operative\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"VIZI\"] = factory(require(\"THREE\"), require(\"TweenLite\"), require(\"operative\"));\n\telse\n\t\troot[\"VIZI\"] = factory(root[\"THREE\"], root[\"TweenLite\"], root[\"operative\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_8__, __WEBPACK_EXTERNAL_MODULE_38__, __WEBPACK_EXTERNAL_MODULE_82__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"THREE\"), require(\"TweenLite\"), require(\"operative\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"THREE\", \"TweenLite\", \"operative\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"VIZI\"] = factory(require(\"THREE\"), require(\"TweenLite\"), require(\"operative\"));\n\telse\n\t\troot[\"VIZI\"] = factory(root[\"THREE\"], root[\"TweenLite\"], root[\"operative\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_8__, __WEBPACK_EXTERNAL_MODULE_38__, __WEBPACK_EXTERNAL_MODULE_82__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _World = __webpack_require__(1);\n\t\n\tvar _World2 = _interopRequireDefault(_World);\n\t\n\tvar _controlsIndex = __webpack_require__(34);\n\t\n\tvar _controlsIndex2 = _interopRequireDefault(_controlsIndex);\n\t\n\tvar _geoGeoJs = __webpack_require__(4);\n\t\n\tvar _geoGeoJs2 = _interopRequireDefault(_geoGeoJs);\n\t\n\tvar _layerLayer = __webpack_require__(30);\n\t\n\tvar _layerLayer2 = _interopRequireDefault(_layerLayer);\n\t\n\tvar _layerEnvironmentEnvironmentLayer = __webpack_require__(29);\n\t\n\tvar _layerEnvironmentEnvironmentLayer2 = _interopRequireDefault(_layerEnvironmentEnvironmentLayer);\n\t\n\tvar _layerTileImageTileLayer = __webpack_require__(39);\n\t\n\tvar _layerTileImageTileLayer2 = _interopRequireDefault(_layerTileImageTileLayer);\n\t\n\tvar _layerTileGeoJSONTileLayer = __webpack_require__(54);\n\t\n\tvar _layerTileGeoJSONTileLayer2 = _interopRequireDefault(_layerTileGeoJSONTileLayer);\n\t\n\tvar _layerTileTopoJSONTileLayer = __webpack_require__(72);\n\t\n\tvar _layerTileTopoJSONTileLayer2 = _interopRequireDefault(_layerTileTopoJSONTileLayer);\n\t\n\tvar _layerGeoJSONLayer = __webpack_require__(56);\n\t\n\tvar _layerGeoJSONLayer2 = _interopRequireDefault(_layerGeoJSONLayer);\n\t\n\tvar _layerTopoJSONLayer = __webpack_require__(73);\n\t\n\tvar _layerTopoJSONLayer2 = _interopRequireDefault(_layerTopoJSONLayer);\n\t\n\tvar _layerGeometryPolygonLayer = __webpack_require__(69);\n\t\n\tvar _layerGeometryPolygonLayer2 = _interopRequireDefault(_layerGeometryPolygonLayer);\n\t\n\tvar _layerGeometryPolylineLayer = __webpack_require__(70);\n\t\n\tvar _layerGeometryPolylineLayer2 = _interopRequireDefault(_layerGeometryPolylineLayer);\n\t\n\tvar _layerGeometryPointLayer = __webpack_require__(71);\n\t\n\tvar _layerGeometryPointLayer2 = _interopRequireDefault(_layerGeometryPointLayer);\n\t\n\tvar _layerObjectPedestrianLayer = __webpack_require__(74);\n\t\n\tvar _layerObjectPedestrianLayer2 = _interopRequireDefault(_layerObjectPedestrianLayer);\n\t\n\tvar _layerObjectVehicleLayer = __webpack_require__(89);\n\t\n\tvar _layerObjectVehicleLayer2 = _interopRequireDefault(_layerObjectVehicleLayer);\n\t\n\tvar _geoPoint = __webpack_require__(6);\n\t\n\tvar _geoPoint2 = _interopRequireDefault(_geoPoint);\n\t\n\tvar _geoLatLon = __webpack_require__(5);\n\t\n\tvar _geoLatLon2 = _interopRequireDefault(_geoLatLon);\n\t\n\tvar _enginePickingMaterial = __webpack_require__(67);\n\t\n\tvar _enginePickingMaterial2 = _interopRequireDefault(_enginePickingMaterial);\n\t\n\tvar _utilIndex = __webpack_require__(92);\n\t\n\tvar _utilIndex2 = _interopRequireDefault(_utilIndex);\n\t\n\tvar VIZI = {\n\t  version: '0.3',\n\t\n\t  // Public API\n\t  World: _World2['default'],\n\t  world: _World.world,\n\t  Controls: _controlsIndex2['default'],\n\t  Geo: _geoGeoJs2['default'],\n\t  Layer: _layerLayer2['default'],\n\t  layer: _layerLayer.layer,\n\t  EnvironmentLayer: _layerEnvironmentEnvironmentLayer2['default'],\n\t  environmentLayer: _layerEnvironmentEnvironmentLayer.environmentLayer,\n\t  ImageTileLayer: _layerTileImageTileLayer2['default'],\n\t  imageTileLayer: _layerTileImageTileLayer.imageTileLayer,\n\t  GeoJSONTileLayer: _layerTileGeoJSONTileLayer2['default'],\n\t  geoJSONTileLayer: _layerTileGeoJSONTileLayer.geoJSONTileLayer,\n\t  TopoJSONTileLayer: _layerTileTopoJSONTileLayer2['default'],\n\t  topoJSONTileLayer: _layerTileTopoJSONTileLayer.topoJSONTileLayer,\n\t  GeoJSONLayer: _layerGeoJSONLayer2['default'],\n\t  geoJSONLayer: _layerGeoJSONLayer.geoJSONLayer,\n\t  TopoJSONLayer: _layerTopoJSONLayer2['default'],\n\t  topoJSONLayer: _layerTopoJSONLayer.topoJSONLayer,\n\t  PolygonLayer: _layerGeometryPolygonLayer2['default'],\n\t  polygonLayer: _layerGeometryPolygonLayer.polygonLayer,\n\t  PolylineLayer: _layerGeometryPolylineLayer2['default'],\n\t  polylineLayer: _layerGeometryPolylineLayer.polylineLayer,\n\t  PointLayer: _layerGeometryPointLayer2['default'],\n\t  pointLayer: _layerGeometryPointLayer.pointLayer,\n\t  PedestrianLayer: _layerObjectPedestrianLayer2['default'],\n\t  pedestrianLayer: _layerObjectPedestrianLayer.pedestrianLayer,\n\t  VehicleLayer: _layerObjectVehicleLayer2['default'],\n\t  vehicleLayer: _layerObjectVehicleLayer.vehicleLayer,\n\t  Point: _geoPoint2['default'],\n\t  point: _geoPoint.point,\n\t  LatLon: _geoLatLon2['default'],\n\t  latLon: _geoLatLon.latLon,\n\t  PickingMaterial: _enginePickingMaterial2['default'],\n\t  Util: _utilIndex2['default']\n\t};\n\t\n\texports['default'] = VIZI;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _eventemitter3 = __webpack_require__(2);\n\t\n\tvar _eventemitter32 = _interopRequireDefault(_eventemitter3);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar _geoGeo = __webpack_require__(4);\n\t\n\tvar _geoGeo2 = _interopRequireDefault(_geoGeo);\n\t\n\tvar _geoPoint = __webpack_require__(6);\n\t\n\tvar _geoLatLon = __webpack_require__(5);\n\t\n\tvar _engineEngine = __webpack_require__(7);\n\t\n\tvar _engineEngine2 = _interopRequireDefault(_engineEngine);\n\t\n\tvar _layerEnvironmentEnvironmentLayer = __webpack_require__(29);\n\t\n\tvar _layerEnvironmentEnvironmentLayer2 = _interopRequireDefault(_layerEnvironmentEnvironmentLayer);\n\t\n\t// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\t\n\t// Pretty much any event someone using ViziCities would need will be emitted or\n\t// proxied by World (eg. render events, etc)\n\t\n\tvar World = (function (_EventEmitter) {\n\t  _inherits(World, _EventEmitter);\n\t\n\t  function World(domId, options) {\n\t    _classCallCheck(this, World);\n\t\n\t    _get(Object.getPrototypeOf(World.prototype), 'constructor', this).call(this);\n\t\n\t    var defaults = {\n\t      skybox: false,\n\t      postProcessing: false\n\t    };\n\t\n\t    this.options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    this._layers = [];\n\t    this._controls = [];\n\t\n\t    this._initContainer(domId);\n\t    this._initAttribution();\n\t    this._initEngine();\n\t    this._initEnvironment();\n\t    this._initEvents();\n\t\n\t    this._pause = false;\n\t\n\t    // Kick off the update and render loop\n\t    this._update();\n\t  }\n\t\n\t  _createClass(World, [{\n\t    key: '_initContainer',\n\t    value: function _initContainer(domId) {\n\t      this._container = document.getElementById(domId);\n\t    }\n\t  }, {\n\t    key: '_initAttribution',\n\t    value: function _initAttribution() {\n\t      var message = '<a href=\"http://vizicities.com\" target=\"_blank\">Powered by ViziCities</a>';\n\t\n\t      var element = document.createElement('div');\n\t      element.classList.add('vizicities-attribution');\n\t\n\t      element.innerHTML = message;\n\t\n\t      this._container.appendChild(element);\n\t    }\n\t  }, {\n\t    key: '_initEngine',\n\t    value: function _initEngine() {\n\t      this._engine = new _engineEngine2['default'](this._container, this);\n\t\n\t      // Engine events\n\t      //\n\t      // Consider proxying these through events on World for public access\n\t      // this._engine.on('preRender', () => {});\n\t      // this._engine.on('postRender', () => {});\n\t    }\n\t  }, {\n\t    key: '_initEnvironment',\n\t    value: function _initEnvironment() {\n\t      // Not sure if I want to keep this as a private API\n\t      //\n\t      // Makes sense to allow others to customise their environment so perhaps\n\t      // add some method of disable / overriding the environment settings\n\t      this._environment = new _layerEnvironmentEnvironmentLayer2['default']({\n\t        skybox: this.options.skybox\n\t      }).addTo(this);\n\t    }\n\t  }, {\n\t    key: '_initEvents',\n\t    value: function _initEvents() {\n\t      this.on('controlsMoveEnd', this._onControlsMoveEnd);\n\t    }\n\t  }, {\n\t    key: '_onControlsMoveEnd',\n\t    value: function _onControlsMoveEnd(point) {\n\t      var _point = (0, _geoPoint.point)(point.x, point.z);\n\t      this._resetView(this.pointToLatLon(_point), _point);\n\t    }\n\t\n\t    // Reset world view\n\t  }, {\n\t    key: '_resetView',\n\t    value: function _resetView(latlon, point) {\n\t      this.emit('preResetView');\n\t\n\t      this._moveStart();\n\t      this._move(latlon, point);\n\t      this._moveEnd();\n\t\n\t      this.emit('postResetView');\n\t    }\n\t  }, {\n\t    key: '_moveStart',\n\t    value: function _moveStart() {\n\t      this.emit('moveStart');\n\t    }\n\t  }, {\n\t    key: '_move',\n\t    value: function _move(latlon, point) {\n\t      this._lastPosition = latlon;\n\t      this.emit('move', latlon, point);\n\t    }\n\t  }, {\n\t    key: '_moveEnd',\n\t    value: function _moveEnd() {\n\t      this.emit('moveEnd');\n\t    }\n\t  }, {\n\t    key: '_update',\n\t    value: function _update() {\n\t      if (this._pause) {\n\t        return;\n\t      }\n\t\n\t      var delta = this._engine.clock.getDelta();\n\t\n\t      // Once _update is called it will run forever, for now\n\t      window.requestAnimationFrame(this._update.bind(this));\n\t\n\t      // Update controls\n\t      this._controls.forEach(function (controls) {\n\t        controls.update(delta);\n\t      });\n\t\n\t      this.emit('preUpdate', delta);\n\t      this._engine.update(delta);\n\t      this.emit('postUpdate', delta);\n\t    }\n\t\n\t    // Set world view\n\t  }, {\n\t    key: 'setView',\n\t    value: function setView(latlon) {\n\t      // Store initial geographic coordinate for the [0,0,0] world position\n\t      //\n\t      // The origin point doesn't move in three.js / 3D space so only set it once\n\t      // here instead of every time _resetView is called\n\t      //\n\t      // If it was updated every time then coorindates would shift over time and\n\t      // would be out of place / context with previously-placed points (0,0 would\n\t      // refer to a different point each time)\n\t      this._originLatlon = latlon;\n\t      this._originPoint = this.project(latlon);\n\t\n\t      this._resetView(latlon);\n\t      return this;\n\t    }\n\t\n\t    // Return world geographic position\n\t  }, {\n\t    key: 'getPosition',\n\t    value: function getPosition() {\n\t      return this._lastPosition;\n\t    }\n\t\n\t    // Transform geographic coordinate to world point\n\t    //\n\t    // This doesn't take into account the origin offset\n\t    //\n\t    // For example, this takes a geographic coordinate and returns a point\n\t    // relative to the origin point of the projection (not the world)\n\t  }, {\n\t    key: 'project',\n\t    value: function project(latlon) {\n\t      return _geoGeo2['default'].latLonToPoint((0, _geoLatLon.latLon)(latlon));\n\t    }\n\t\n\t    // Transform world point to geographic coordinate\n\t    //\n\t    // This doesn't take into account the origin offset\n\t    //\n\t    // For example, this takes a point relative to the origin point of the\n\t    // projection (not the world) and returns a geographic coordinate\n\t  }, {\n\t    key: 'unproject',\n\t    value: function unproject(point) {\n\t      return _geoGeo2['default'].pointToLatLon((0, _geoPoint.point)(point));\n\t    }\n\t\n\t    // Takes into account the origin offset\n\t    //\n\t    // For example, this takes a geographic coordinate and returns a point\n\t    // relative to the three.js / 3D origin (0,0)\n\t  }, {\n\t    key: 'latLonToPoint',\n\t    value: function latLonToPoint(latlon) {\n\t      var projectedPoint = this.project((0, _geoLatLon.latLon)(latlon));\n\t      return projectedPoint._subtract(this._originPoint);\n\t    }\n\t\n\t    // Takes into account the origin offset\n\t    //\n\t    // For example, this takes a point relative to the three.js / 3D origin (0,0)\n\t    // and returns the exact geographic coordinate at that point\n\t  }, {\n\t    key: 'pointToLatLon',\n\t    value: function pointToLatLon(point) {\n\t      var projectedPoint = (0, _geoPoint.point)(point).add(this._originPoint);\n\t      return this.unproject(projectedPoint);\n\t    }\n\t\n\t    // Return pointscale for a given geographic coordinate\n\t  }, {\n\t    key: 'pointScale',\n\t    value: function pointScale(latlon, accurate) {\n\t      return _geoGeo2['default'].pointScale(latlon, accurate);\n\t    }\n\t\n\t    // Convert from real meters to world units\n\t    //\n\t    // TODO: Would be nice not to have to pass in a pointscale here\n\t  }, {\n\t    key: 'metresToWorld',\n\t    value: function metresToWorld(metres, pointScale, zoom) {\n\t      return _geoGeo2['default'].metresToWorld(metres, pointScale, zoom);\n\t    }\n\t\n\t    // Convert from real meters to world units\n\t    //\n\t    // TODO: Would be nice not to have to pass in a pointscale here\n\t  }, {\n\t    key: 'worldToMetres',\n\t    value: function worldToMetres(worldUnits, pointScale, zoom) {\n\t      return _geoGeo2['default'].worldToMetres(worldUnits, pointScale, zoom);\n\t    }\n\t\n\t    // Unsure if it's a good idea to expose this here for components like\n\t    // GridLayer to use (eg. to keep track of a frustum)\n\t  }, {\n\t    key: 'getCamera',\n\t    value: function getCamera() {\n\t      return this._engine._camera;\n\t    }\n\t  }, {\n\t    key: 'addLayer',\n\t    value: function addLayer(layer) {\n\t      layer._addToWorld(this);\n\t\n\t      this._layers.push(layer);\n\t\n\t      if (layer.isOutput() && layer.isOutputToScene()) {\n\t        // Could move this into Layer but it'll do here for now\n\t        this._engine._scene.add(layer._object3D);\n\t        this._engine._domScene3D.add(layer._domObject3D);\n\t        this._engine._domScene2D.add(layer._domObject2D);\n\t      }\n\t\n\t      this.emit('layerAdded', layer);\n\t      return this;\n\t    }\n\t\n\t    // Remove layer from world and scene but don't destroy it entirely\n\t  }, {\n\t    key: 'removeLayer',\n\t    value: function removeLayer(layer) {\n\t      var layerIndex = this._layers.indexOf(layer);\n\t\n\t      if (layerIndex > -1) {\n\t        // Remove from this._layers\n\t        this._layers.splice(layerIndex, 1);\n\t      };\n\t\n\t      if (layer.isOutput() && layer.isOutputToScene()) {\n\t        this._engine._scene.remove(layer._object3D);\n\t        this._engine._domScene3D.remove(layer._domObject3D);\n\t        this._engine._domScene2D.remove(layer._domObject2D);\n\t      }\n\t\n\t      this.emit('layerRemoved');\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'addControls',\n\t    value: function addControls(controls) {\n\t      controls._addToWorld(this);\n\t\n\t      this._controls.push(controls);\n\t\n\t      this.emit('controlsAdded', controls);\n\t      return this;\n\t    }\n\t\n\t    // Remove controls from world but don't destroy them entirely\n\t  }, {\n\t    key: 'removeControls',\n\t    value: function removeControls(controls) {\n\t      var controlsIndex = this._controls.indexOf(controlsIndex);\n\t\n\t      if (controlsIndex > -1) {\n\t        this._controls.splice(controlsIndex, 1);\n\t      };\n\t\n\t      this.emit('controlsRemoved', controls);\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'stop',\n\t    value: function stop() {\n\t      this._pause = true;\n\t    }\n\t  }, {\n\t    key: 'start',\n\t    value: function start() {\n\t      this._pause = false;\n\t      this._update();\n\t    }\n\t\n\t    // Destroys the world(!) and removes it from the scene and memory\n\t    //\n\t    // TODO: World out why so much three.js stuff is left in the heap after this\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      this.stop();\n\t\n\t      // Remove listeners\n\t      this.off('controlsMoveEnd', this._onControlsMoveEnd);\n\t\n\t      var i;\n\t\n\t      // Remove all controls\n\t      var controls;\n\t      for (i = this._controls.length - 1; i >= 0; i--) {\n\t        controls = this._controls[0];\n\t        this.removeControls(controls);\n\t        controls.destroy();\n\t      };\n\t\n\t      // Remove all layers\n\t      var layer;\n\t      for (i = this._layers.length - 1; i >= 0; i--) {\n\t        layer = this._layers[0];\n\t        this.removeLayer(layer);\n\t        layer.destroy();\n\t      };\n\t\n\t      // Environment layer is removed with the other layers\n\t      this._environment = null;\n\t\n\t      this._engine.destroy();\n\t      this._engine = null;\n\t\n\t      // Clean the container / remove the canvas\n\t      while (this._container.firstChild) {\n\t        this._container.removeChild(this._container.firstChild);\n\t      }\n\t\n\t      this._container = null;\n\t    }\n\t  }]);\n\t\n\t  return World;\n\t})(_eventemitter32['default']);\n\t\n\texports['default'] = World;\n\t\n\tvar noNew = function noNew(domId, options) {\n\t  return new World(domId, options);\n\t};\n\t\n\t// Initialise without requiring new keyword\n\texports.world = noNew;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar has = Object.prototype.hasOwnProperty;\n\t\n\t//\n\t// We store our EE objects in a plain object whose properties are event names.\n\t// If `Object.create(null)` is not supported we prefix the event names with a\n\t// `~` to make sure that the built-in object properties are not overridden or\n\t// used as an attack vector.\n\t// We also assume that `Object.create(null)` is available when the event name\n\t// is an ES6 Symbol.\n\t//\n\tvar prefix = typeof Object.create !== 'function' ? '~' : false;\n\t\n\t/**\n\t * Representation of a single EventEmitter function.\n\t *\n\t * @param {Function} fn Event handler to be called.\n\t * @param {Mixed} context Context for function execution.\n\t * @param {Boolean} [once=false] Only emit once\n\t * @api private\n\t */\n\tfunction EE(fn, context, once) {\n\t  this.fn = fn;\n\t  this.context = context;\n\t  this.once = once || false;\n\t}\n\t\n\t/**\n\t * Minimal EventEmitter interface that is molded against the Node.js\n\t * EventEmitter interface.\n\t *\n\t * @constructor\n\t * @api public\n\t */\n\tfunction EventEmitter() { /* Nothing to set */ }\n\t\n\t/**\n\t * Hold the assigned EventEmitters by name.\n\t *\n\t * @type {Object}\n\t * @private\n\t */\n\tEventEmitter.prototype._events = undefined;\n\t\n\t/**\n\t * Return an array listing the events for which the emitter has registered\n\t * listeners.\n\t *\n\t * @returns {Array}\n\t * @api public\n\t */\n\tEventEmitter.prototype.eventNames = function eventNames() {\n\t  var events = this._events\n\t    , names = []\n\t    , name;\n\t\n\t  if (!events) return names;\n\t\n\t  for (name in events) {\n\t    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n\t  }\n\t\n\t  if (Object.getOwnPropertySymbols) {\n\t    return names.concat(Object.getOwnPropertySymbols(events));\n\t  }\n\t\n\t  return names;\n\t};\n\t\n\t/**\n\t * Return a list of assigned event listeners.\n\t *\n\t * @param {String} event The events that should be listed.\n\t * @param {Boolean} exists We only need to know if there are listeners.\n\t * @returns {Array|Boolean}\n\t * @api public\n\t */\n\tEventEmitter.prototype.listeners = function listeners(event, exists) {\n\t  var evt = prefix ? prefix + event : event\n\t    , available = this._events && this._events[evt];\n\t\n\t  if (exists) return !!available;\n\t  if (!available) return [];\n\t  if (available.fn) return [available.fn];\n\t\n\t  for (var i = 0, l = available.length, ee = new Array(l); i < l; i++) {\n\t    ee[i] = available[i].fn;\n\t  }\n\t\n\t  return ee;\n\t};\n\t\n\t/**\n\t * Emit an event to all registered event listeners.\n\t *\n\t * @param {String} event The name of the event.\n\t * @returns {Boolean} Indication if we've emitted an event.\n\t * @api public\n\t */\n\tEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n\t  var evt = prefix ? prefix + event : event;\n\t\n\t  if (!this._events || !this._events[evt]) return false;\n\t\n\t  var listeners = this._events[evt]\n\t    , len = arguments.length\n\t    , args\n\t    , i;\n\t\n\t  if ('function' === typeof listeners.fn) {\n\t    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\t\n\t    switch (len) {\n\t      case 1: return listeners.fn.call(listeners.context), true;\n\t      case 2: return listeners.fn.call(listeners.context, a1), true;\n\t      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n\t      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n\t      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n\t      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n\t    }\n\t\n\t    for (i = 1, args = new Array(len -1); i < len; i++) {\n\t      args[i - 1] = arguments[i];\n\t    }\n\t\n\t    listeners.fn.apply(listeners.context, args);\n\t  } else {\n\t    var length = listeners.length\n\t      , j;\n\t\n\t    for (i = 0; i < length; i++) {\n\t      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\t\n\t      switch (len) {\n\t        case 1: listeners[i].fn.call(listeners[i].context); break;\n\t        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n\t        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n\t        default:\n\t          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n\t            args[j - 1] = arguments[j];\n\t          }\n\t\n\t          listeners[i].fn.apply(listeners[i].context, args);\n\t      }\n\t    }\n\t  }\n\t\n\t  return true;\n\t};\n\t\n\t/**\n\t * Register a new EventListener for the given event.\n\t *\n\t * @param {String} event Name of the event.\n\t * @param {Function} fn Callback function.\n\t * @param {Mixed} [context=this] The context of the function.\n\t * @api public\n\t */\n\tEventEmitter.prototype.on = function on(event, fn, context) {\n\t  var listener = new EE(fn, context || this)\n\t    , evt = prefix ? prefix + event : event;\n\t\n\t  if (!this._events) this._events = prefix ? {} : Object.create(null);\n\t  if (!this._events[evt]) this._events[evt] = listener;\n\t  else {\n\t    if (!this._events[evt].fn) this._events[evt].push(listener);\n\t    else this._events[evt] = [\n\t      this._events[evt], listener\n\t    ];\n\t  }\n\t\n\t  return this;\n\t};\n\t\n\t/**\n\t * Add an EventListener that's only called once.\n\t *\n\t * @param {String} event Name of the event.\n\t * @param {Function} fn Callback function.\n\t * @param {Mixed} [context=this] The context of the function.\n\t * @api public\n\t */\n\tEventEmitter.prototype.once = function once(event, fn, context) {\n\t  var listener = new EE(fn, context || this, true)\n\t    , evt = prefix ? prefix + event : event;\n\t\n\t  if (!this._events) this._events = prefix ? {} : Object.create(null);\n\t  if (!this._events[evt]) this._events[evt] = listener;\n\t  else {\n\t    if (!this._events[evt].fn) this._events[evt].push(listener);\n\t    else this._events[evt] = [\n\t      this._events[evt], listener\n\t    ];\n\t  }\n\t\n\t  return this;\n\t};\n\t\n\t/**\n\t * Remove event listeners.\n\t *\n\t * @param {String} event The event we want to remove.\n\t * @param {Function} fn The listener that we need to find.\n\t * @param {Mixed} context Only remove listeners matching this context.\n\t * @param {Boolean} once Only remove once listeners.\n\t * @api public\n\t */\n\tEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n\t  var evt = prefix ? prefix + event : event;\n\t\n\t  if (!this._events || !this._events[evt]) return this;\n\t\n\t  var listeners = this._events[evt]\n\t    , events = [];\n\t\n\t  if (fn) {\n\t    if (listeners.fn) {\n\t      if (\n\t           listeners.fn !== fn\n\t        || (once && !listeners.once)\n\t        || (context && listeners.context !== context)\n\t      ) {\n\t        events.push(listeners);\n\t      }\n\t    } else {\n\t      for (var i = 0, length = listeners.length; i < length; i++) {\n\t        if (\n\t             listeners[i].fn !== fn\n\t          || (once && !listeners[i].once)\n\t          || (context && listeners[i].context !== context)\n\t        ) {\n\t          events.push(listeners[i]);\n\t        }\n\t      }\n\t    }\n\t  }\n\t\n\t  //\n\t  // Reset the array, or remove it completely if we have no more listeners.\n\t  //\n\t  if (events.length) {\n\t    this._events[evt] = events.length === 1 ? events[0] : events;\n\t  } else {\n\t    delete this._events[evt];\n\t  }\n\t\n\t  return this;\n\t};\n\t\n\t/**\n\t * Remove all listeners or only the listeners for the specified event.\n\t *\n\t * @param {String} event The event want to remove all listeners for.\n\t * @api public\n\t */\n\tEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n\t  if (!this._events) return this;\n\t\n\t  if (event) delete this._events[prefix ? prefix + event : event];\n\t  else this._events = prefix ? {} : Object.create(null);\n\t\n\t  return this;\n\t};\n\t\n\t//\n\t// Alias methods names because people roll like that.\n\t//\n\tEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\tEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\t\n\t//\n\t// This function doesn't apply anymore.\n\t//\n\tEventEmitter.prototype.setMaxListeners = function setMaxListeners() {\n\t  return this;\n\t};\n\t\n\t//\n\t// Expose the prefix.\n\t//\n\tEventEmitter.prefixed = prefix;\n\t\n\t//\n\t// Expose the module.\n\t//\n\tif (true) {\n\t  module.exports = EventEmitter;\n\t}\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t/**\n\t * lodash (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modularize exports=\"npm\" -o ./`\n\t * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n\t * Released under MIT license <https://lodash.com/license>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t */\n\t\n\t/** Used as references for various `Number` constants. */\n\tvar MAX_SAFE_INTEGER = 9007199254740991;\n\t\n\t/** `Object#toString` result references. */\n\tvar argsTag = '[object Arguments]',\n\t    funcTag = '[object Function]',\n\t    genTag = '[object GeneratorFunction]';\n\t\n\t/** Used to detect unsigned integer values. */\n\tvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\t\n\t/**\n\t * A faster alternative to `Function#apply`, this function invokes `func`\n\t * with the `this` binding of `thisArg` and the arguments of `args`.\n\t *\n\t * @private\n\t * @param {Function} func The function to invoke.\n\t * @param {*} thisArg The `this` binding of `func`.\n\t * @param {Array} args The arguments to invoke `func` with.\n\t * @returns {*} Returns the result of `func`.\n\t */\n\tfunction apply(func, thisArg, args) {\n\t  switch (args.length) {\n\t    case 0: return func.call(thisArg);\n\t    case 1: return func.call(thisArg, args[0]);\n\t    case 2: return func.call(thisArg, args[0], args[1]);\n\t    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n\t  }\n\t  return func.apply(thisArg, args);\n\t}\n\t\n\t/**\n\t * The base implementation of `_.times` without support for iteratee shorthands\n\t * or max array length checks.\n\t *\n\t * @private\n\t * @param {number} n The number of times to invoke `iteratee`.\n\t * @param {Function} iteratee The function invoked per iteration.\n\t * @returns {Array} Returns the array of results.\n\t */\n\tfunction baseTimes(n, iteratee) {\n\t  var index = -1,\n\t      result = Array(n);\n\t\n\t  while (++index < n) {\n\t    result[index] = iteratee(index);\n\t  }\n\t  return result;\n\t}\n\t\n\t/**\n\t * Creates a unary function that invokes `func` with its argument transformed.\n\t *\n\t * @private\n\t * @param {Function} func The function to wrap.\n\t * @param {Function} transform The argument transform.\n\t * @returns {Function} Returns the new function.\n\t */\n\tfunction overArg(func, transform) {\n\t  return function(arg) {\n\t    return func(transform(arg));\n\t  };\n\t}\n\t\n\t/** Used for built-in method references. */\n\tvar objectProto = Object.prototype;\n\t\n\t/** Used to check objects for own properties. */\n\tvar hasOwnProperty = objectProto.hasOwnProperty;\n\t\n\t/**\n\t * Used to resolve the\n\t * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n\t * of values.\n\t */\n\tvar objectToString = objectProto.toString;\n\t\n\t/** Built-in value references. */\n\tvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\t\n\t/* Built-in method references for those with the same name as other `lodash` methods. */\n\tvar nativeKeys = overArg(Object.keys, Object),\n\t    nativeMax = Math.max;\n\t\n\t/** Detect if properties shadowing those on `Object.prototype` are non-enumerable. */\n\tvar nonEnumShadows = !propertyIsEnumerable.call({ 'valueOf': 1 }, 'valueOf');\n\t\n\t/**\n\t * Creates an array of the enumerable property names of the array-like `value`.\n\t *\n\t * @private\n\t * @param {*} value The value to query.\n\t * @param {boolean} inherited Specify returning inherited property names.\n\t * @returns {Array} Returns the array of property names.\n\t */\n\tfunction arrayLikeKeys(value, inherited) {\n\t  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n\t  // Safari 9 makes `arguments.length` enumerable in strict mode.\n\t  var result = (isArray(value) || isArguments(value))\n\t    ? baseTimes(value.length, String)\n\t    : [];\n\t\n\t  var length = result.length,\n\t      skipIndexes = !!length;\n\t\n\t  for (var key in value) {\n\t    if ((inherited || hasOwnProperty.call(value, key)) &&\n\t        !(skipIndexes && (key == 'length' || isIndex(key, length)))) {\n\t      result.push(key);\n\t    }\n\t  }\n\t  return result;\n\t}\n\t\n\t/**\n\t * Assigns `value` to `key` of `object` if the existing value is not equivalent\n\t * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n\t * for equality comparisons.\n\t *\n\t * @private\n\t * @param {Object} object The object to modify.\n\t * @param {string} key The key of the property to assign.\n\t * @param {*} value The value to assign.\n\t */\n\tfunction assignValue(object, key, value) {\n\t  var objValue = object[key];\n\t  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n\t      (value === undefined && !(key in object))) {\n\t    object[key] = value;\n\t  }\n\t}\n\t\n\t/**\n\t * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n\t *\n\t * @private\n\t * @param {Object} object The object to query.\n\t * @returns {Array} Returns the array of property names.\n\t */\n\tfunction baseKeys(object) {\n\t  if (!isPrototype(object)) {\n\t    return nativeKeys(object);\n\t  }\n\t  var result = [];\n\t  for (var key in Object(object)) {\n\t    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n\t      result.push(key);\n\t    }\n\t  }\n\t  return result;\n\t}\n\t\n\t/**\n\t * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n\t *\n\t * @private\n\t * @param {Function} func The function to apply a rest parameter to.\n\t * @param {number} [start=func.length-1] The start position of the rest parameter.\n\t * @returns {Function} Returns the new function.\n\t */\n\tfunction baseRest(func, start) {\n\t  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n\t  return function() {\n\t    var args = arguments,\n\t        index = -1,\n\t        length = nativeMax(args.length - start, 0),\n\t        array = Array(length);\n\t\n\t    while (++index < length) {\n\t      array[index] = args[start + index];\n\t    }\n\t    index = -1;\n\t    var otherArgs = Array(start + 1);\n\t    while (++index < start) {\n\t      otherArgs[index] = args[index];\n\t    }\n\t    otherArgs[start] = array;\n\t    return apply(func, this, otherArgs);\n\t  };\n\t}\n\t\n\t/**\n\t * Copies properties of `source` to `object`.\n\t *\n\t * @private\n\t * @param {Object} source The object to copy properties from.\n\t * @param {Array} props The property identifiers to copy.\n\t * @param {Object} [object={}] The object to copy properties to.\n\t * @param {Function} [customizer] The function to customize copied values.\n\t * @returns {Object} Returns `object`.\n\t */\n\tfunction copyObject(source, props, object, customizer) {\n\t  object || (object = {});\n\t\n\t  var index = -1,\n\t      length = props.length;\n\t\n\t  while (++index < length) {\n\t    var key = props[index];\n\t\n\t    var newValue = customizer\n\t      ? customizer(object[key], source[key], key, object, source)\n\t      : undefined;\n\t\n\t    assignValue(object, key, newValue === undefined ? source[key] : newValue);\n\t  }\n\t  return object;\n\t}\n\t\n\t/**\n\t * Creates a function like `_.assign`.\n\t *\n\t * @private\n\t * @param {Function} assigner The function to assign values.\n\t * @returns {Function} Returns the new assigner function.\n\t */\n\tfunction createAssigner(assigner) {\n\t  return baseRest(function(object, sources) {\n\t    var index = -1,\n\t        length = sources.length,\n\t        customizer = length > 1 ? sources[length - 1] : undefined,\n\t        guard = length > 2 ? sources[2] : undefined;\n\t\n\t    customizer = (assigner.length > 3 && typeof customizer == 'function')\n\t      ? (length--, customizer)\n\t      : undefined;\n\t\n\t    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n\t      customizer = length < 3 ? undefined : customizer;\n\t      length = 1;\n\t    }\n\t    object = Object(object);\n\t    while (++index < length) {\n\t      var source = sources[index];\n\t      if (source) {\n\t        assigner(object, source, index, customizer);\n\t      }\n\t    }\n\t    return object;\n\t  });\n\t}\n\t\n\t/**\n\t * Checks if `value` is a valid array-like index.\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n\t * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n\t */\n\tfunction isIndex(value, length) {\n\t  length = length == null ? MAX_SAFE_INTEGER : length;\n\t  return !!length &&\n\t    (typeof value == 'number' || reIsUint.test(value)) &&\n\t    (value > -1 && value % 1 == 0 && value < length);\n\t}\n\t\n\t/**\n\t * Checks if the given arguments are from an iteratee call.\n\t *\n\t * @private\n\t * @param {*} value The potential iteratee value argument.\n\t * @param {*} index The potential iteratee index or key argument.\n\t * @param {*} object The potential iteratee object argument.\n\t * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n\t *  else `false`.\n\t */\n\tfunction isIterateeCall(value, index, object) {\n\t  if (!isObject(object)) {\n\t    return false;\n\t  }\n\t  var type = typeof index;\n\t  if (type == 'number'\n\t        ? (isArrayLike(object) && isIndex(index, object.length))\n\t        : (type == 'string' && index in object)\n\t      ) {\n\t    return eq(object[index], value);\n\t  }\n\t  return false;\n\t}\n\t\n\t/**\n\t * Checks if `value` is likely a prototype object.\n\t *\n\t * @private\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n\t */\n\tfunction isPrototype(value) {\n\t  var Ctor = value && value.constructor,\n\t      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\t\n\t  return value === proto;\n\t}\n\t\n\t/**\n\t * Performs a\n\t * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n\t * comparison between two values to determine if they are equivalent.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 4.0.0\n\t * @category Lang\n\t * @param {*} value The value to compare.\n\t * @param {*} other The other value to compare.\n\t * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n\t * @example\n\t *\n\t * var object = { 'a': 1 };\n\t * var other = { 'a': 1 };\n\t *\n\t * _.eq(object, object);\n\t * // => true\n\t *\n\t * _.eq(object, other);\n\t * // => false\n\t *\n\t * _.eq('a', 'a');\n\t * // => true\n\t *\n\t * _.eq('a', Object('a'));\n\t * // => false\n\t *\n\t * _.eq(NaN, NaN);\n\t * // => true\n\t */\n\tfunction eq(value, other) {\n\t  return value === other || (value !== value && other !== other);\n\t}\n\t\n\t/**\n\t * Checks if `value` is likely an `arguments` object.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 0.1.0\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n\t *  else `false`.\n\t * @example\n\t *\n\t * _.isArguments(function() { return arguments; }());\n\t * // => true\n\t *\n\t * _.isArguments([1, 2, 3]);\n\t * // => false\n\t */\n\tfunction isArguments(value) {\n\t  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n\t  return isArrayLikeObject(value) && hasOwnProperty.call(value, 'callee') &&\n\t    (!propertyIsEnumerable.call(value, 'callee') || objectToString.call(value) == argsTag);\n\t}\n\t\n\t/**\n\t * Checks if `value` is classified as an `Array` object.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 0.1.0\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n\t * @example\n\t *\n\t * _.isArray([1, 2, 3]);\n\t * // => true\n\t *\n\t * _.isArray(document.body.children);\n\t * // => false\n\t *\n\t * _.isArray('abc');\n\t * // => false\n\t *\n\t * _.isArray(_.noop);\n\t * // => false\n\t */\n\tvar isArray = Array.isArray;\n\t\n\t/**\n\t * Checks if `value` is array-like. A value is considered array-like if it's\n\t * not a function and has a `value.length` that's an integer greater than or\n\t * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 4.0.0\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n\t * @example\n\t *\n\t * _.isArrayLike([1, 2, 3]);\n\t * // => true\n\t *\n\t * _.isArrayLike(document.body.children);\n\t * // => true\n\t *\n\t * _.isArrayLike('abc');\n\t * // => true\n\t *\n\t * _.isArrayLike(_.noop);\n\t * // => false\n\t */\n\tfunction isArrayLike(value) {\n\t  return value != null && isLength(value.length) && !isFunction(value);\n\t}\n\t\n\t/**\n\t * This method is like `_.isArrayLike` except that it also checks if `value`\n\t * is an object.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 4.0.0\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is an array-like object,\n\t *  else `false`.\n\t * @example\n\t *\n\t * _.isArrayLikeObject([1, 2, 3]);\n\t * // => true\n\t *\n\t * _.isArrayLikeObject(document.body.children);\n\t * // => true\n\t *\n\t * _.isArrayLikeObject('abc');\n\t * // => false\n\t *\n\t * _.isArrayLikeObject(_.noop);\n\t * // => false\n\t */\n\tfunction isArrayLikeObject(value) {\n\t  return isObjectLike(value) && isArrayLike(value);\n\t}\n\t\n\t/**\n\t * Checks if `value` is classified as a `Function` object.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 0.1.0\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n\t * @example\n\t *\n\t * _.isFunction(_);\n\t * // => true\n\t *\n\t * _.isFunction(/abc/);\n\t * // => false\n\t */\n\tfunction isFunction(value) {\n\t  // The use of `Object#toString` avoids issues with the `typeof` operator\n\t  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n\t  var tag = isObject(value) ? objectToString.call(value) : '';\n\t  return tag == funcTag || tag == genTag;\n\t}\n\t\n\t/**\n\t * Checks if `value` is a valid array-like length.\n\t *\n\t * **Note:** This method is loosely based on\n\t * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 4.0.0\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n\t * @example\n\t *\n\t * _.isLength(3);\n\t * // => true\n\t *\n\t * _.isLength(Number.MIN_VALUE);\n\t * // => false\n\t *\n\t * _.isLength(Infinity);\n\t * // => false\n\t *\n\t * _.isLength('3');\n\t * // => false\n\t */\n\tfunction isLength(value) {\n\t  return typeof value == 'number' &&\n\t    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n\t}\n\t\n\t/**\n\t * Checks if `value` is the\n\t * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n\t * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 0.1.0\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n\t * @example\n\t *\n\t * _.isObject({});\n\t * // => true\n\t *\n\t * _.isObject([1, 2, 3]);\n\t * // => true\n\t *\n\t * _.isObject(_.noop);\n\t * // => true\n\t *\n\t * _.isObject(null);\n\t * // => false\n\t */\n\tfunction isObject(value) {\n\t  var type = typeof value;\n\t  return !!value && (type == 'object' || type == 'function');\n\t}\n\t\n\t/**\n\t * Checks if `value` is object-like. A value is object-like if it's not `null`\n\t * and has a `typeof` result of \"object\".\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 4.0.0\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n\t * @example\n\t *\n\t * _.isObjectLike({});\n\t * // => true\n\t *\n\t * _.isObjectLike([1, 2, 3]);\n\t * // => true\n\t *\n\t * _.isObjectLike(_.noop);\n\t * // => false\n\t *\n\t * _.isObjectLike(null);\n\t * // => false\n\t */\n\tfunction isObjectLike(value) {\n\t  return !!value && typeof value == 'object';\n\t}\n\t\n\t/**\n\t * Assigns own enumerable string keyed properties of source objects to the\n\t * destination object. Source objects are applied from left to right.\n\t * Subsequent sources overwrite property assignments of previous sources.\n\t *\n\t * **Note:** This method mutates `object` and is loosely based on\n\t * [`Object.assign`](https://mdn.io/Object/assign).\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 0.10.0\n\t * @category Object\n\t * @param {Object} object The destination object.\n\t * @param {...Object} [sources] The source objects.\n\t * @returns {Object} Returns `object`.\n\t * @see _.assignIn\n\t * @example\n\t *\n\t * function Foo() {\n\t *   this.a = 1;\n\t * }\n\t *\n\t * function Bar() {\n\t *   this.c = 3;\n\t * }\n\t *\n\t * Foo.prototype.b = 2;\n\t * Bar.prototype.d = 4;\n\t *\n\t * _.assign({ 'a': 0 }, new Foo, new Bar);\n\t * // => { 'a': 1, 'c': 3 }\n\t */\n\tvar assign = createAssigner(function(object, source) {\n\t  if (nonEnumShadows || isPrototype(source) || isArrayLike(source)) {\n\t    copyObject(source, keys(source), object);\n\t    return;\n\t  }\n\t  for (var key in source) {\n\t    if (hasOwnProperty.call(source, key)) {\n\t      assignValue(object, key, source[key]);\n\t    }\n\t  }\n\t});\n\t\n\t/**\n\t * Creates an array of the own enumerable property names of `object`.\n\t *\n\t * **Note:** Non-object values are coerced to objects. See the\n\t * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n\t * for more details.\n\t *\n\t * @static\n\t * @since 0.1.0\n\t * @memberOf _\n\t * @category Object\n\t * @param {Object} object The object to query.\n\t * @returns {Array} Returns the array of property names.\n\t * @example\n\t *\n\t * function Foo() {\n\t *   this.a = 1;\n\t *   this.b = 2;\n\t * }\n\t *\n\t * Foo.prototype.c = 3;\n\t *\n\t * _.keys(new Foo);\n\t * // => ['a', 'b'] (iteration order is not guaranteed)\n\t *\n\t * _.keys('hi');\n\t * // => ['0', '1']\n\t */\n\tfunction keys(object) {\n\t  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n\t}\n\t\n\tmodule.exports = assign;\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _LatLon = __webpack_require__(5);\n\t\n\tvar _Point = __webpack_require__(6);\n\t\n\tvar Geo = {};\n\t\n\t// Radius / WGS84 semi-major axis\n\tGeo.R = 6378137;\n\tGeo.MAX_LATITUDE = 85.0511287798;\n\t\n\t// WGS84 eccentricity\n\tGeo.ECC = 0.081819191;\n\tGeo.ECC2 = 0.081819191 * 0.081819191;\n\t\n\tGeo.project = function (latlon) {\n\t  var d = Math.PI / 180;\n\t  var max = Geo.MAX_LATITUDE;\n\t  var lat = Math.max(Math.min(max, latlon.lat), -max);\n\t  var sin = Math.sin(lat * d);\n\t\n\t  return (0, _Point.point)(Geo.R * latlon.lon * d, Geo.R * Math.log((1 + sin) / (1 - sin)) / 2);\n\t}, Geo.unproject = function (point) {\n\t  var d = 180 / Math.PI;\n\t\n\t  return (0, _LatLon.latLon)((2 * Math.atan(Math.exp(point.y / Geo.R)) - Math.PI / 2) * d, point.x * d / Geo.R);\n\t};\n\t\n\t// Converts geo coords to pixel / WebGL ones\n\t// This just reverses the Y axis to match WebGL\n\tGeo.latLonToPoint = function (latlon) {\n\t  var projected = Geo.project(latlon);\n\t  projected.y *= -1;\n\t\n\t  return projected;\n\t};\n\t\n\t// Converts pixel / WebGL coords to geo coords\n\t// This just reverses the Y axis to match WebGL\n\tGeo.pointToLatLon = function (point) {\n\t  var _point = (0, _Point.point)(point.x, point.y * -1);\n\t  return Geo.unproject(_point);\n\t};\n\t\n\t// Scale factor for converting between real metres and projected metres\n\t//\n\t// projectedMetres = realMetres * pointScale\n\t// realMetres = projectedMetres / pointScale\n\t//\n\t// Accurate scale factor uses proper Web Mercator scaling\n\t// See pg.9: http://www.hydrometronics.com/downloads/Web%20Mercator%20-%20Non-Conformal,%20Non-Mercator%20(notes).pdf\n\t// See: http://jsfiddle.net/robhawkes/yws924cf/\n\tGeo.pointScale = function (latlon, accurate) {\n\t  var rad = Math.PI / 180;\n\t\n\t  var k;\n\t\n\t  if (!accurate) {\n\t    k = 1 / Math.cos(latlon.lat * rad);\n\t\n\t    // [scaleX, scaleY]\n\t    return [k, k];\n\t  } else {\n\t    var lat = latlon.lat * rad;\n\t    var lon = latlon.lon * rad;\n\t\n\t    var a = Geo.R;\n\t\n\t    var sinLat = Math.sin(lat);\n\t    var sinLat2 = sinLat * sinLat;\n\t\n\t    var cosLat = Math.cos(lat);\n\t\n\t    // Radius meridian\n\t    var p = a * (1 - Geo.ECC2) / Math.pow(1 - Geo.ECC2 * sinLat2, 3 / 2);\n\t\n\t    // Radius prime meridian\n\t    var v = a / Math.sqrt(1 - Geo.ECC2 * sinLat2);\n\t\n\t    // Scale N/S\n\t    var h = a / p / cosLat;\n\t\n\t    // Scale E/W\n\t    k = a / v / cosLat;\n\t\n\t    // [scaleX, scaleY]\n\t    return [k, h];\n\t  }\n\t};\n\t\n\t// Convert real metres to projected units\n\t//\n\t// Latitude scale is chosen because it fluctuates more than longitude\n\tGeo.metresToProjected = function (metres, pointScale) {\n\t  return metres * pointScale[1];\n\t};\n\t\n\t// Convert projected units to real metres\n\t//\n\t// Latitude scale is chosen because it fluctuates more than longitude\n\tGeo.projectedToMetres = function (projectedUnits, pointScale) {\n\t  return projectedUnits / pointScale[1];\n\t};\n\t\n\t// Convert real metres to a value in world (WebGL) units\n\tGeo.metresToWorld = function (metres, pointScale) {\n\t  // Transform metres to projected metres using the latitude point scale\n\t  //\n\t  // Latitude scale is chosen because it fluctuates more than longitude\n\t  var projectedMetres = Geo.metresToProjected(metres, pointScale);\n\t\n\t  var scale = Geo.scale();\n\t\n\t  // Scale projected metres\n\t  var scaledMetres = scale * projectedMetres;\n\t\n\t  return scaledMetres;\n\t};\n\t\n\t// Convert world (WebGL) units to a value in real metres\n\tGeo.worldToMetres = function (worldUnits, pointScale) {\n\t  var scale = Geo.scale();\n\t\n\t  var projectedUnits = worldUnits / scale;\n\t  var realMetres = Geo.projectedToMetres(projectedUnits, pointScale);\n\t\n\t  return realMetres;\n\t};\n\t\n\t// If zoom is provided, returns the map width in pixels for a given zoom\n\t// Else, provides fixed scale value\n\tGeo.scale = function (zoom) {\n\t  // If zoom is provided then return scale based on map tile zoom\n\t  if (zoom >= 0) {\n\t    return 256 * Math.pow(2, zoom);\n\t    // Else, return fixed scale value to expand projected coordinates from\n\t    // their 0 to 1 range into something more practical\n\t  } else {\n\t      return 1;\n\t    }\n\t};\n\t\n\t// Returns zoom level for a given scale value\n\t// This only works with a scale value that is based on map pixel width\n\tGeo.zoom = function (scale) {\n\t  return Math.log(scale / 256) / Math.LN2;\n\t};\n\t\n\t// Distance between two geographical points using spherical law of cosines\n\t// approximation or Haversine\n\t//\n\t// See: http://www.movable-type.co.uk/scripts/latlong.html\n\tGeo.distance = function (latlon1, latlon2, accurate) {\n\t  var rad = Math.PI / 180;\n\t\n\t  var lat1;\n\t  var lat2;\n\t\n\t  var a;\n\t\n\t  if (!accurate) {\n\t    lat1 = latlon1.lat * rad;\n\t    lat2 = latlon2.lat * rad;\n\t\n\t    a = Math.sin(lat1) * Math.sin(lat2) + Math.cos(lat1) * Math.cos(lat2) * Math.cos((latlon2.lon - latlon1.lon) * rad);\n\t\n\t    return Geo.R * Math.acos(Math.min(a, 1));\n\t  } else {\n\t    lat1 = latlon1.lat * rad;\n\t    lat2 = latlon2.lat * rad;\n\t\n\t    var lon1 = latlon1.lon * rad;\n\t    var lon2 = latlon2.lon * rad;\n\t\n\t    var deltaLat = lat2 - lat1;\n\t    var deltaLon = lon2 - lon1;\n\t\n\t    var halfDeltaLat = deltaLat / 2;\n\t    var halfDeltaLon = deltaLon / 2;\n\t\n\t    a = Math.sin(halfDeltaLat) * Math.sin(halfDeltaLat) + Math.cos(lat1) * Math.cos(lat2) * Math.sin(halfDeltaLon) * Math.sin(halfDeltaLon);\n\t\n\t    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n\t\n\t    return Geo.R * c;\n\t  }\n\t};\n\t\n\tGeo.bounds = (function () {\n\t  var d = Geo.R * Math.PI;\n\t  return [[-d, -d], [d, d]];\n\t})();\n\t\n\texports['default'] = Geo;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\t/*\n\t * LatLon is a helper class for ensuring consistent geographic coordinates.\n\t *\n\t * Based on:\n\t * https://github.com/Leaflet/Leaflet/blob/master/src/geo/LatLng.js\n\t */\n\t\n\tvar LatLon = (function () {\n\t  function LatLon(lat, lon, alt) {\n\t    _classCallCheck(this, LatLon);\n\t\n\t    if (isNaN(lat) || isNaN(lon)) {\n\t      throw new Error('Invalid LatLon object: (' + lat + ', ' + lon + ')');\n\t    }\n\t\n\t    this.lat = +lat;\n\t    this.lon = +lon;\n\t\n\t    if (alt !== undefined) {\n\t      this.alt = +alt;\n\t    }\n\t  }\n\t\n\t  _createClass(LatLon, [{\n\t    key: 'clone',\n\t    value: function clone() {\n\t      return new LatLon(this.lat, this.lon, this.alt);\n\t    }\n\t  }]);\n\t\n\t  return LatLon;\n\t})();\n\t\n\texports['default'] = LatLon;\n\t\n\t// Accepts (LatLon), ([lat, lon, alt]), ([lat, lon]) and (lat, lon, alt)\n\t// Also converts between lng and lon\n\tvar noNew = function noNew(a, b, c) {\n\t  if (a instanceof LatLon) {\n\t    return a;\n\t  }\n\t  if (Array.isArray(a) && typeof a[0] !== 'object') {\n\t    if (a.length === 3) {\n\t      return new LatLon(a[0], a[1], a[2]);\n\t    }\n\t    if (a.length === 2) {\n\t      return new LatLon(a[0], a[1]);\n\t    }\n\t    return null;\n\t  }\n\t  if (a === undefined || a === null) {\n\t    return a;\n\t  }\n\t  if (typeof a === 'object' && 'lat' in a) {\n\t    return new LatLon(a.lat, 'lng' in a ? a.lng : a.lon, a.alt);\n\t  }\n\t  if (b === undefined) {\n\t    return null;\n\t  }\n\t  return new LatLon(a, b, c);\n\t};\n\t\n\t// Initialise without requiring new keyword\n\texports.latLon = noNew;\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/*\n\t * Point is a helper class for ensuring consistent world positions.\n\t *\n\t * Based on:\n\t * https://github.com/Leaflet/Leaflet/blob/master/src/geo/Point.js\n\t */\n\t\n\tvar Point = (function () {\n\t  function Point(x, y, round) {\n\t    _classCallCheck(this, Point);\n\t\n\t    this.x = round ? Math.round(x) : x;\n\t    this.y = round ? Math.round(y) : y;\n\t  }\n\t\n\t  _createClass(Point, [{\n\t    key: \"clone\",\n\t    value: function clone() {\n\t      return new Point(this.x, this.y);\n\t    }\n\t\n\t    // Non-destructive\n\t  }, {\n\t    key: \"add\",\n\t    value: function add(point) {\n\t      return this.clone()._add(_point(point));\n\t    }\n\t\n\t    // Destructive\n\t  }, {\n\t    key: \"_add\",\n\t    value: function _add(point) {\n\t      this.x += point.x;\n\t      this.y += point.y;\n\t      return this;\n\t    }\n\t\n\t    // Non-destructive\n\t  }, {\n\t    key: \"subtract\",\n\t    value: function subtract(point) {\n\t      return this.clone()._subtract(_point(point));\n\t    }\n\t\n\t    // Destructive\n\t  }, {\n\t    key: \"_subtract\",\n\t    value: function _subtract(point) {\n\t      this.x -= point.x;\n\t      this.y -= point.y;\n\t      return this;\n\t    }\n\t  }]);\n\t\n\t  return Point;\n\t})();\n\t\n\texports[\"default\"] = Point;\n\t\n\t// Accepts (point), ([x, y]) and (x, y, round)\n\tvar _point = function _point(x, y, round) {\n\t  if (x instanceof Point) {\n\t    return x;\n\t  }\n\t  if (Array.isArray(x)) {\n\t    return new Point(x[0], x[1]);\n\t  }\n\t  if (x === undefined || x === null) {\n\t    return x;\n\t  }\n\t  return new Point(x, y, round);\n\t};\n\t\n\t// Initialise without requiring new keyword\n\texports.point = _point;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _eventemitter3 = __webpack_require__(2);\n\t\n\tvar _eventemitter32 = _interopRequireDefault(_eventemitter3);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _Scene = __webpack_require__(9);\n\t\n\tvar _Scene2 = _interopRequireDefault(_Scene);\n\t\n\tvar _DOMScene3D = __webpack_require__(10);\n\t\n\tvar _DOMScene3D2 = _interopRequireDefault(_DOMScene3D);\n\t\n\tvar _DOMScene2D = __webpack_require__(11);\n\t\n\tvar _DOMScene2D2 = _interopRequireDefault(_DOMScene2D);\n\t\n\tvar _Renderer = __webpack_require__(12);\n\t\n\tvar _Renderer2 = _interopRequireDefault(_Renderer);\n\t\n\tvar _DOMRenderer3D = __webpack_require__(13);\n\t\n\tvar _DOMRenderer3D2 = _interopRequireDefault(_DOMRenderer3D);\n\t\n\tvar _DOMRenderer2D = __webpack_require__(15);\n\t\n\tvar _DOMRenderer2D2 = _interopRequireDefault(_DOMRenderer2D);\n\t\n\tvar _Camera = __webpack_require__(17);\n\t\n\tvar _Camera2 = _interopRequireDefault(_Camera);\n\t\n\tvar _Picking = __webpack_require__(18);\n\t\n\tvar _Picking2 = _interopRequireDefault(_Picking);\n\t\n\tvar _EffectComposer = __webpack_require__(20);\n\t\n\tvar _EffectComposer2 = _interopRequireDefault(_EffectComposer);\n\t\n\tvar _vendorRenderPass = __webpack_require__(25);\n\t\n\tvar _vendorRenderPass2 = _interopRequireDefault(_vendorRenderPass);\n\t\n\tvar _vendorShaderPass = __webpack_require__(23);\n\t\n\tvar _vendorShaderPass2 = _interopRequireDefault(_vendorShaderPass);\n\t\n\tvar _vendorCopyShader = __webpack_require__(22);\n\t\n\tvar _vendorCopyShader2 = _interopRequireDefault(_vendorCopyShader);\n\t\n\tvar _vendorHorizontalTiltShiftShader = __webpack_require__(26);\n\t\n\tvar _vendorHorizontalTiltShiftShader2 = _interopRequireDefault(_vendorHorizontalTiltShiftShader);\n\t\n\tvar _vendorVerticalTiltShiftShader = __webpack_require__(27);\n\t\n\tvar _vendorVerticalTiltShiftShader2 = _interopRequireDefault(_vendorVerticalTiltShiftShader);\n\t\n\tvar _vendorFXAAShader = __webpack_require__(28);\n\t\n\tvar _vendorFXAAShader2 = _interopRequireDefault(_vendorFXAAShader);\n\t\n\tvar Engine = (function (_EventEmitter) {\n\t  _inherits(Engine, _EventEmitter);\n\t\n\t  function Engine(container, world) {\n\t    _classCallCheck(this, Engine);\n\t\n\t    console.log('Init Engine');\n\t\n\t    _get(Object.getPrototypeOf(Engine.prototype), 'constructor', this).call(this);\n\t\n\t    this._world = world;\n\t\n\t    this._scene = _Scene2['default'];\n\t    this._domScene3D = _DOMScene3D2['default'];\n\t    this._domScene2D = _DOMScene2D2['default'];\n\t\n\t    var antialias = this._world.options.postProcessing ? false : true;\n\t    this._renderer = (0, _Renderer2['default'])(container, antialias);\n\t    this._domRenderer3D = (0, _DOMRenderer3D2['default'])(container);\n\t    this._domRenderer2D = (0, _DOMRenderer2D2['default'])(container);\n\t\n\t    this._camera = (0, _Camera2['default'])(container);\n\t\n\t    this._container = container;\n\t\n\t    // TODO: Make this optional\n\t    this._picking = (0, _Picking2['default'])(this._world, this._renderer, this._camera);\n\t\n\t    this.clock = new _three2['default'].Clock();\n\t\n\t    this._frustum = new _three2['default'].Frustum();\n\t\n\t    if (this._world.options.postProcessing) {\n\t      this._initPostProcessing();\n\t    }\n\t  }\n\t\n\t  // TODO: Set up composer to automatically resize on viewport change\n\t  // TODO: Update passes that rely on width / height on resize\n\t  // TODO: Merge default passes into a single shader / pass for performance\n\t\n\t  _createClass(Engine, [{\n\t    key: '_initPostProcessing',\n\t    value: function _initPostProcessing() {\n\t      var renderPass = new _vendorRenderPass2['default'](this._scene, this._camera);\n\t\n\t      // TODO: Look at using @mattdesl's optimised FXAA shader\n\t      // https://github.com/mattdesl/three-shader-fxaa\n\t      var fxaaPass = new _vendorShaderPass2['default'](_vendorFXAAShader2['default']);\n\t\n\t      var hblurPass = new _vendorShaderPass2['default'](_vendorHorizontalTiltShiftShader2['default']);\n\t      var vblurPass = new _vendorShaderPass2['default'](_vendorVerticalTiltShiftShader2['default']);\n\t      var bluriness = 5;\n\t\n\t      hblurPass.uniforms.r.value = vblurPass.uniforms.r.value = 0.6;\n\t\n\t      var copyPass = new _vendorShaderPass2['default'](_vendorCopyShader2['default']);\n\t      copyPass.renderToScreen = true;\n\t\n\t      this._composer = (0, _EffectComposer2['default'])(this._renderer, this._container);\n\t\n\t      this._composer.addPass(renderPass);\n\t      this._composer.addPass(fxaaPass);\n\t      this._composer.addPass(hblurPass);\n\t      this._composer.addPass(vblurPass);\n\t      this._composer.addPass(copyPass);\n\t\n\t      var self = this;\n\t      var updatePostProcessingSize = function updatePostProcessingSize() {\n\t        var width = self._container.clientWidth;\n\t        var height = self._container.clientHeight;\n\t\n\t        // TODO: Re-enable this when perf issues can be solved\n\t        //\n\t        // Rendering double the resolution of the screen can be really slow\n\t        // var pixelRatio = window.devicePixelRatio;\n\t        var pixelRatio = 1;\n\t\n\t        fxaaPass.uniforms.resolution.value.set(1 / (width * pixelRatio), 1 / (height * pixelRatio));\n\t\n\t        hblurPass.uniforms.h.value = bluriness / (width * pixelRatio);\n\t        vblurPass.uniforms.v.value = bluriness / (height * pixelRatio);\n\t      };\n\t\n\t      updatePostProcessingSize();\n\t      window.addEventListener('resize', updatePostProcessingSize, false);\n\t    }\n\t  }, {\n\t    key: 'update',\n\t    value: function update(delta) {\n\t      this.emit('preRender');\n\t\n\t      if (this._world.options.postProcessing) {\n\t        this._composer.render(delta);\n\t      } else {\n\t        this._renderer.render(this._scene, this._camera);\n\t      }\n\t\n\t      // Render picking scene\n\t      // this._renderer.render(this._picking._pickingScene, this._camera);\n\t\n\t      // Render DOM scenes\n\t      this._domRenderer3D.render(this._domScene3D, this._camera);\n\t      this._domRenderer2D.render(this._domScene2D, this._camera);\n\t\n\t      this.emit('postRender');\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      // Remove any remaining objects from scene\n\t      var child;\n\t      for (var i = this._scene.children.length - 1; i >= 0; i--) {\n\t        child = this._scene.children[i];\n\t\n\t        if (!child) {\n\t          continue;\n\t        }\n\t\n\t        this._scene.remove(child);\n\t\n\t        if (child.geometry) {\n\t          // Dispose of mesh and materials\n\t          child.geometry.dispose();\n\t          child.geometry = null;\n\t        }\n\t\n\t        if (child.material) {\n\t          if (child.material.map) {\n\t            child.material.map.dispose();\n\t            child.material.map = null;\n\t          }\n\t\n\t          child.material.dispose();\n\t          child.material = null;\n\t        }\n\t      };\n\t\n\t      for (var i = this._domScene3D.children.length - 1; i >= 0; i--) {\n\t        child = this._domScene3D.children[i];\n\t\n\t        if (!child) {\n\t          continue;\n\t        }\n\t\n\t        this._domScene3D.remove(child);\n\t      };\n\t\n\t      for (var i = this._domScene2D.children.length - 1; i >= 0; i--) {\n\t        child = this._domScene2D.children[i];\n\t\n\t        if (!child) {\n\t          continue;\n\t        }\n\t\n\t        this._domScene2D.remove(child);\n\t      };\n\t\n\t      this._picking.destroy();\n\t      this._picking = null;\n\t\n\t      this._world = null;\n\t      this._scene = null;\n\t      this._domScene3D = null;\n\t      this._domScene2D = null;\n\t\n\t      this._composer = null;\n\t      this._renderer = null;\n\t\n\t      this._domRenderer3D = null;\n\t      this._domRenderer2D = null;\n\t      this._camera = null;\n\t      this._clock = null;\n\t      this._frustum = null;\n\t    }\n\t  }]);\n\t\n\t  return Engine;\n\t})(_eventemitter32['default']);\n\t\n\texports['default'] = Engine;\n\t\n\t// // Initialise without requiring new keyword\n\t// export default function(container, world) {\n\t//   return new Engine(container, world);\n\t// };\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_8__;\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t// This can be imported from anywhere and will still reference the same scene,\n\t// though there is a helper reference in Engine.scene\n\t\n\texports['default'] = (function () {\n\t  var scene = new _three2['default'].Scene();\n\t\n\t  // TODO: Re-enable when this works with the skybox\n\t  // scene.fog = new THREE.Fog(0xffffff, 1, 15000);\n\t  return scene;\n\t})();\n\t\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t// This can be imported from anywhere and will still reference the same scene,\n\t// though there is a helper reference in Engine.scene\n\t\n\texports['default'] = (function () {\n\t  var scene = new _three2['default'].Scene();\n\t  return scene;\n\t})();\n\t\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t// This can be imported from anywhere and will still reference the same scene,\n\t// though there is a helper reference in Engine.scene\n\t\n\texports['default'] = (function () {\n\t  var scene = new _three2['default'].Scene();\n\t  return scene;\n\t})();\n\t\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _Scene = __webpack_require__(9);\n\t\n\tvar _Scene2 = _interopRequireDefault(_Scene);\n\t\n\t// This can only be accessed from Engine.renderer if you want to reference the\n\t// same scene in multiple places\n\t\n\texports['default'] = function (container, antialias) {\n\t  var renderer = new _three2['default'].WebGLRenderer({\n\t    antialias: antialias\n\t  });\n\t\n\t  // TODO: Re-enable when this works with the skybox\n\t  // renderer.setClearColor(Scene.fog.color, 1);\n\t\n\t  renderer.setClearColor(0xffffff, 1);\n\t\n\t  // TODO: Re-enable this when perf issues can be solved\n\t  //\n\t  // Rendering double the resolution of the screen can be really slow\n\t  // var pixelRatio = window.devicePixelRatio;\n\t  var pixelRatio = 1;\n\t\n\t  renderer.setPixelRatio(pixelRatio);\n\t\n\t  // Gamma settings make things look nicer\n\t  renderer.gammaInput = true;\n\t  renderer.gammaOutput = true;\n\t\n\t  renderer.shadowMap.enabled = true;\n\t\n\t  // TODO: Work out which of the shadowmap types is best\n\t  // https://github.com/mrdoob/three.js/blob/r56/src/Three.js#L107\n\t  // renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n\t\n\t  // TODO: Check that leaving this as default (CullFrontFace) is right\n\t  // renderer.shadowMap.cullFace = THREE.CullFaceBack;\n\t\n\t  container.appendChild(renderer.domElement);\n\t\n\t  var updateSize = function updateSize() {\n\t    renderer.setSize(container.clientWidth, container.clientHeight);\n\t  };\n\t\n\t  window.addEventListener('resize', updateSize, false);\n\t  updateSize();\n\t\n\t  return renderer;\n\t};\n\t\n\t;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _vendorCSS3DRenderer = __webpack_require__(14);\n\t\n\tvar _DOMScene3D = __webpack_require__(10);\n\t\n\tvar _DOMScene3D2 = _interopRequireDefault(_DOMScene3D);\n\t\n\t// This can only be accessed from Engine.renderer if you want to reference the\n\t// same scene in multiple places\n\t\n\texports['default'] = function (container) {\n\t  var renderer = new _vendorCSS3DRenderer.CSS3DRenderer();\n\t\n\t  renderer.domElement.style.position = 'absolute';\n\t  renderer.domElement.style.top = 0;\n\t\n\t  container.appendChild(renderer.domElement);\n\t\n\t  var updateSize = function updateSize() {\n\t    renderer.setSize(container.clientWidth, container.clientHeight);\n\t  };\n\t\n\t  window.addEventListener('resize', updateSize, false);\n\t  updateSize();\n\t\n\t  return renderer;\n\t};\n\t\n\t;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\t/**\n\t * Based on http://www.emagix.net/academic/mscs-project/item/camera-sync-with-css3-and-webgl-threejs\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar CSS3DObject = function CSS3DObject(element) {\n\t\n\t\t_three2['default'].Object3D.call(this);\n\t\n\t\tthis.element = element;\n\t\tthis.element.style.position = 'absolute';\n\t\n\t\tthis.addEventListener('removed', function (event) {\n\t\n\t\t\tif (this.element.parentNode !== null) {\n\t\n\t\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t\t}\n\t\t});\n\t};\n\t\n\tCSS3DObject.prototype = Object.create(_three2['default'].Object3D.prototype);\n\tCSS3DObject.prototype.constructor = CSS3DObject;\n\t\n\tvar CSS3DSprite = function CSS3DSprite(element) {\n\t\n\t\tCSS3DObject.call(this, element);\n\t};\n\t\n\tCSS3DSprite.prototype = Object.create(CSS3DObject.prototype);\n\tCSS3DSprite.prototype.constructor = CSS3DSprite;\n\t\n\t//\n\t\n\tvar CSS3DRenderer = function CSS3DRenderer() {\n\t\n\t\tconsole.log('THREE.CSS3DRenderer', _three2['default'].REVISION);\n\t\n\t\tvar _width, _height;\n\t\tvar _widthHalf, _heightHalf;\n\t\n\t\tvar matrix = new _three2['default'].Matrix4();\n\t\n\t\tvar cache = {\n\t\t\tcamera: { fov: 0, style: '' },\n\t\t\tobjects: {}\n\t\t};\n\t\n\t\tvar domElement = document.createElement('div');\n\t\tdomElement.style.overflow = 'hidden';\n\t\n\t\tdomElement.style.WebkitTransformStyle = 'preserve-3d';\n\t\tdomElement.style.MozTransformStyle = 'preserve-3d';\n\t\tdomElement.style.oTransformStyle = 'preserve-3d';\n\t\tdomElement.style.transformStyle = 'preserve-3d';\n\t\n\t\tthis.domElement = domElement;\n\t\n\t\tvar cameraElement = document.createElement('div');\n\t\n\t\tcameraElement.style.WebkitTransformStyle = 'preserve-3d';\n\t\tcameraElement.style.MozTransformStyle = 'preserve-3d';\n\t\tcameraElement.style.oTransformStyle = 'preserve-3d';\n\t\tcameraElement.style.transformStyle = 'preserve-3d';\n\t\n\t\tdomElement.appendChild(cameraElement);\n\t\n\t\tthis.setClearColor = function () {};\n\t\n\t\tthis.getSize = function () {\n\t\n\t\t\treturn {\n\t\t\t\twidth: _width,\n\t\t\t\theight: _height\n\t\t\t};\n\t\t};\n\t\n\t\tthis.setSize = function (width, height) {\n\t\n\t\t\t_width = width;\n\t\t\t_height = height;\n\t\n\t\t\t_widthHalf = _width / 2;\n\t\t\t_heightHalf = _height / 2;\n\t\n\t\t\tdomElement.style.width = width + 'px';\n\t\t\tdomElement.style.height = height + 'px';\n\t\n\t\t\tcameraElement.style.width = width + 'px';\n\t\t\tcameraElement.style.height = height + 'px';\n\t\t};\n\t\n\t\tvar epsilon = function epsilon(value) {\n\t\n\t\t\treturn Math.abs(value) < Number.EPSILON ? 0 : value;\n\t\t};\n\t\n\t\tvar getCameraCSSMatrix = function getCameraCSSMatrix(matrix) {\n\t\n\t\t\tvar elements = matrix.elements;\n\t\n\t\t\treturn 'matrix3d(' + epsilon(elements[0]) + ',' + epsilon(-elements[1]) + ',' + epsilon(elements[2]) + ',' + epsilon(elements[3]) + ',' + epsilon(elements[4]) + ',' + epsilon(-elements[5]) + ',' + epsilon(elements[6]) + ',' + epsilon(elements[7]) + ',' + epsilon(elements[8]) + ',' + epsilon(-elements[9]) + ',' + epsilon(elements[10]) + ',' + epsilon(elements[11]) + ',' + epsilon(elements[12]) + ',' + epsilon(-elements[13]) + ',' + epsilon(elements[14]) + ',' + epsilon(elements[15]) + ')';\n\t\t};\n\t\n\t\tvar getObjectCSSMatrix = function getObjectCSSMatrix(matrix) {\n\t\n\t\t\tvar elements = matrix.elements;\n\t\n\t\t\treturn 'translate3d(-50%,-50%,0) matrix3d(' + epsilon(elements[0]) + ',' + epsilon(elements[1]) + ',' + epsilon(elements[2]) + ',' + epsilon(elements[3]) + ',' + epsilon(-elements[4]) + ',' + epsilon(-elements[5]) + ',' + epsilon(-elements[6]) + ',' + epsilon(-elements[7]) + ',' + epsilon(elements[8]) + ',' + epsilon(elements[9]) + ',' + epsilon(elements[10]) + ',' + epsilon(elements[11]) + ',' + epsilon(elements[12]) + ',' + epsilon(elements[13]) + ',' + epsilon(elements[14]) + ',' + epsilon(elements[15]) + ')';\n\t\t};\n\t\n\t\tvar renderObject = function renderObject(object, camera) {\n\t\n\t\t\tif (object instanceof CSS3DObject) {\n\t\n\t\t\t\tvar style;\n\t\n\t\t\t\tif (object instanceof CSS3DSprite) {\n\t\n\t\t\t\t\t// http://swiftcoder.wordpress.com/2008/11/25/constructing-a-billboard-matrix/\n\t\n\t\t\t\t\tmatrix.copy(camera.matrixWorldInverse);\n\t\t\t\t\tmatrix.transpose();\n\t\t\t\t\tmatrix.copyPosition(object.matrixWorld);\n\t\t\t\t\tmatrix.scale(object.scale);\n\t\n\t\t\t\t\tmatrix.elements[3] = 0;\n\t\t\t\t\tmatrix.elements[7] = 0;\n\t\t\t\t\tmatrix.elements[11] = 0;\n\t\t\t\t\tmatrix.elements[15] = 1;\n\t\n\t\t\t\t\tstyle = getObjectCSSMatrix(matrix);\n\t\t\t\t} else {\n\t\n\t\t\t\t\tstyle = getObjectCSSMatrix(object.matrixWorld);\n\t\t\t\t}\n\t\n\t\t\t\tvar element = object.element;\n\t\t\t\tvar cachedStyle = cache.objects[object.id];\n\t\n\t\t\t\tif (cachedStyle === undefined || cachedStyle !== style) {\n\t\n\t\t\t\t\telement.style.WebkitTransform = style;\n\t\t\t\t\telement.style.MozTransform = style;\n\t\t\t\t\telement.style.oTransform = style;\n\t\t\t\t\telement.style.transform = style;\n\t\n\t\t\t\t\tcache.objects[object.id] = style;\n\t\t\t\t}\n\t\n\t\t\t\tif (element.parentNode !== cameraElement) {\n\t\n\t\t\t\t\tcameraElement.appendChild(element);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfor (var i = 0, l = object.children.length; i < l; i++) {\n\t\n\t\t\t\trenderObject(object.children[i], camera);\n\t\t\t}\n\t\t};\n\t\n\t\tthis.render = function (scene, camera) {\n\t\n\t\t\tvar fov = 0.5 / Math.tan(_three2['default'].Math.degToRad(camera.fov * 0.5)) * _height;\n\t\n\t\t\tif (cache.camera.fov !== fov) {\n\t\n\t\t\t\tdomElement.style.WebkitPerspective = fov + 'px';\n\t\t\t\tdomElement.style.MozPerspective = fov + 'px';\n\t\t\t\tdomElement.style.oPerspective = fov + 'px';\n\t\t\t\tdomElement.style.perspective = fov + 'px';\n\t\n\t\t\t\tcache.camera.fov = fov;\n\t\t\t}\n\t\n\t\t\tscene.updateMatrixWorld();\n\t\n\t\t\tif (camera.parent === null) camera.updateMatrixWorld();\n\t\n\t\t\tcamera.matrixWorldInverse.getInverse(camera.matrixWorld);\n\t\n\t\t\tvar style = 'translate3d(0,0,' + fov + 'px)' + getCameraCSSMatrix(camera.matrixWorldInverse) + ' translate3d(' + _widthHalf + 'px,' + _heightHalf + 'px, 0)';\n\t\n\t\t\tif (cache.camera.style !== style) {\n\t\n\t\t\t\tcameraElement.style.WebkitTransform = style;\n\t\t\t\tcameraElement.style.MozTransform = style;\n\t\t\t\tcameraElement.style.oTransform = style;\n\t\t\t\tcameraElement.style.transform = style;\n\t\n\t\t\t\tcache.camera.style = style;\n\t\t\t}\n\t\n\t\t\trenderObject(scene, camera);\n\t\t};\n\t};\n\t\n\texports.CSS3DObject = CSS3DObject;\n\texports.CSS3DSprite = CSS3DSprite;\n\texports.CSS3DRenderer = CSS3DRenderer;\n\t\n\t_three2['default'].CSS3DObject = CSS3DObject;\n\t_three2['default'].CSS3DSprite = CSS3DSprite;\n\t_three2['default'].CSS3DRenderer = CSS3DRenderer;\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _vendorCSS2DRenderer = __webpack_require__(16);\n\t\n\tvar _DOMScene2D = __webpack_require__(11);\n\t\n\tvar _DOMScene2D2 = _interopRequireDefault(_DOMScene2D);\n\t\n\t// This can only be accessed from Engine.renderer if you want to reference the\n\t// same scene in multiple places\n\t\n\texports['default'] = function (container) {\n\t  var renderer = new _vendorCSS2DRenderer.CSS2DRenderer();\n\t\n\t  renderer.domElement.style.position = 'absolute';\n\t  renderer.domElement.style.top = 0;\n\t\n\t  container.appendChild(renderer.domElement);\n\t\n\t  var updateSize = function updateSize() {\n\t    renderer.setSize(container.clientWidth, container.clientHeight);\n\t  };\n\t\n\t  window.addEventListener('resize', updateSize, false);\n\t  updateSize();\n\t\n\t  return renderer;\n\t};\n\t\n\t;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar CSS2DObject = function CSS2DObject(element) {\n\t\n\t\t_three2['default'].Object3D.call(this);\n\t\n\t\tthis.element = element;\n\t\tthis.element.style.position = 'absolute';\n\t\n\t\tthis.addEventListener('removed', function (event) {\n\t\n\t\t\tif (this.element.parentNode !== null) {\n\t\n\t\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t\t}\n\t\t});\n\t};\n\t\n\tCSS2DObject.prototype = Object.create(_three2['default'].Object3D.prototype);\n\tCSS2DObject.prototype.constructor = CSS2DObject;\n\t\n\t//\n\t\n\tvar CSS2DRenderer = function CSS2DRenderer() {\n\t\n\t\tconsole.log('THREE.CSS2DRenderer', _three2['default'].REVISION);\n\t\n\t\tvar _width, _height;\n\t\tvar _widthHalf, _heightHalf;\n\t\n\t\tvar vector = new _three2['default'].Vector3();\n\t\tvar viewMatrix = new _three2['default'].Matrix4();\n\t\tvar viewProjectionMatrix = new _three2['default'].Matrix4();\n\t\n\t\tvar frustum = new _three2['default'].Frustum();\n\t\n\t\tvar domElement = document.createElement('div');\n\t\tdomElement.style.overflow = 'hidden';\n\t\n\t\tthis.domElement = domElement;\n\t\n\t\tthis.setSize = function (width, height) {\n\t\n\t\t\t_width = width;\n\t\t\t_height = height;\n\t\n\t\t\t_widthHalf = _width / 2;\n\t\t\t_heightHalf = _height / 2;\n\t\n\t\t\tdomElement.style.width = width + 'px';\n\t\t\tdomElement.style.height = height + 'px';\n\t\t};\n\t\n\t\tvar renderObject = function renderObject(object, camera) {\n\t\n\t\t\tif (object instanceof CSS2DObject) {\n\t\n\t\t\t\tvector.setFromMatrixPosition(object.matrixWorld);\n\t\t\t\tvector.applyProjection(viewProjectionMatrix);\n\t\n\t\t\t\tvar element = object.element;\n\t\t\t\tvar style = 'translate(-50%,-50%) translate(' + (vector.x * _widthHalf + _widthHalf) + 'px,' + (-vector.y * _heightHalf + _heightHalf) + 'px)';\n\t\n\t\t\t\telement.style.WebkitTransform = style;\n\t\t\t\telement.style.MozTransform = style;\n\t\t\t\telement.style.oTransform = style;\n\t\t\t\telement.style.transform = style;\n\t\n\t\t\t\tif (element.parentNode !== domElement) {\n\t\n\t\t\t\t\tdomElement.appendChild(element);\n\t\t\t\t}\n\t\n\t\t\t\t// Hide if outside view frustum\n\t\t\t\tif (!frustum.containsPoint(object.position)) {\n\t\t\t\t\telement.style.display = 'none';\n\t\t\t\t} else {\n\t\t\t\t\telement.style.display = 'block';\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfor (var i = 0, l = object.children.length; i < l; i++) {\n\t\n\t\t\t\trenderObject(object.children[i], camera);\n\t\t\t}\n\t\t};\n\t\n\t\tthis.render = function (scene, camera) {\n\t\n\t\t\tscene.updateMatrixWorld();\n\t\n\t\t\tif (camera.parent === null) camera.updateMatrixWorld();\n\t\n\t\t\tcamera.matrixWorldInverse.getInverse(camera.matrixWorld);\n\t\n\t\t\tviewMatrix.copy(camera.matrixWorldInverse.getInverse(camera.matrixWorld));\n\t\t\tviewProjectionMatrix.multiplyMatrices(camera.projectionMatrix, viewMatrix);\n\t\n\t\t\tfrustum.setFromMatrix(new _three2['default'].Matrix4().multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse));\n\t\n\t\t\trenderObject(scene, camera);\n\t\t};\n\t};\n\t\n\texports.CSS2DObject = CSS2DObject;\n\texports.CSS2DRenderer = CSS2DRenderer;\n\t\n\t_three2['default'].CSS2DObject = CSS2DObject;\n\t_three2['default'].CSS2DRenderer = CSS2DRenderer;\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t// This can only be accessed from Engine.camera if you want to reference the\n\t// same scene in multiple places\n\t\n\t// TODO: Ensure that FOV looks natural on all aspect ratios\n\t// http://stackoverflow.com/q/26655930/997339\n\t\n\texports['default'] = function (container) {\n\t  var camera = new _three2['default'].PerspectiveCamera(45, 1, 1, 2000000);\n\t  // var camera = new THREE.PerspectiveCamera(45, 1, 1, 10000);\n\t  camera.position.y = 4000;\n\t  camera.position.z = 4000;\n\t\n\t  var updateSize = function updateSize() {\n\t    camera.aspect = container.clientWidth / container.clientHeight;\n\t    camera.updateProjectionMatrix();\n\t  };\n\t\n\t  window.addEventListener('resize', updateSize, false);\n\t  updateSize();\n\t\n\t  return camera;\n\t};\n\t\n\t;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 18 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _geoPoint = __webpack_require__(6);\n\t\n\tvar _PickingScene = __webpack_require__(19);\n\t\n\tvar _PickingScene2 = _interopRequireDefault(_PickingScene);\n\t\n\t// TODO: Look into a way of setting this up without passing in a renderer and\n\t// camera from the engine\n\t\n\t// TODO: Add a basic indicator on or around the mouse pointer when it is over\n\t// something pickable / clickable\n\t//\n\t// A simple transparent disc or ring at the mouse point should work to start, or\n\t// even just changing the cursor to the CSS 'pointer' style\n\t//\n\t// Probably want this on mousemove with a throttled update as not to spam the\n\t// picking method\n\t//\n\t// Relies upon the picking method not redrawing the scene every call due to\n\t// the way TileLayer invalidates the picking scene\n\t\n\tvar nextId = 1;\n\t\n\tvar Picking = (function () {\n\t  function Picking(world, renderer, camera) {\n\t    _classCallCheck(this, Picking);\n\t\n\t    this._world = world;\n\t    this._renderer = renderer;\n\t    this._camera = camera;\n\t\n\t    this._raycaster = new _three2['default'].Raycaster();\n\t\n\t    // TODO: Match this with the line width used in the picking layers\n\t    this._raycaster.linePrecision = 3;\n\t\n\t    this._pickingScene = _PickingScene2['default'];\n\t    this._pickingTexture = new _three2['default'].WebGLRenderTarget();\n\t    this._pickingTexture.texture.minFilter = _three2['default'].LinearFilter;\n\t    this._pickingTexture.texture.generateMipmaps = false;\n\t\n\t    this._nextId = 1;\n\t\n\t    this._resizeTexture();\n\t    this._initEvents();\n\t  }\n\t\n\t  // Initialise without requiring new keyword\n\t\n\t  _createClass(Picking, [{\n\t    key: '_initEvents',\n\t    value: function _initEvents() {\n\t      this._resizeHandler = this._resizeTexture.bind(this);\n\t      window.addEventListener('resize', this._resizeHandler, false);\n\t\n\t      this._mouseUpHandler = this._onMouseUp.bind(this);\n\t      this._world._container.addEventListener('mouseup', this._mouseUpHandler, false);\n\t\n\t      this._world.on('move', this._onWorldMove, this);\n\t    }\n\t  }, {\n\t    key: '_onMouseUp',\n\t    value: function _onMouseUp(event) {\n\t      // Only react to main button click\n\t      if (event.button !== 0) {\n\t        return;\n\t      }\n\t\n\t      var point = (0, _geoPoint.point)(event.clientX, event.clientY);\n\t\n\t      var normalisedPoint = (0, _geoPoint.point)(0, 0);\n\t      normalisedPoint.x = point.x / this._width * 2 - 1;\n\t      normalisedPoint.y = -(point.y / this._height) * 2 + 1;\n\t\n\t      this._pick(point, normalisedPoint);\n\t    }\n\t  }, {\n\t    key: '_onWorldMove',\n\t    value: function _onWorldMove() {\n\t      this._needUpdate = true;\n\t    }\n\t\n\t    // TODO: Ensure this doesn't get out of sync issue with the renderer resize\n\t  }, {\n\t    key: '_resizeTexture',\n\t    value: function _resizeTexture() {\n\t      var size = this._renderer.getSize();\n\t\n\t      this._width = size.width;\n\t      this._height = size.height;\n\t\n\t      this._pickingTexture.setSize(this._width, this._height);\n\t      this._pixelBuffer = new Uint8Array(4 * this._width * this._height);\n\t\n\t      this._needUpdate = true;\n\t    }\n\t\n\t    // TODO: Make this only re-draw the scene if both an update is needed and the\n\t    // camera has moved since the last update\n\t    //\n\t    // Otherwise it re-draws the scene on every click due to the way LOD updates\n\t    // work in TileLayer – spamming this.add() and this.remove()\n\t    //\n\t    // TODO: Pause updates during map move / orbit / zoom as this is unlikely to\n\t    // be a point in time where the user cares for picking functionality\n\t  }, {\n\t    key: '_update',\n\t    value: function _update() {\n\t      if (this._needUpdate) {\n\t        var texture = this._pickingTexture;\n\t\n\t        this._renderer.render(this._pickingScene, this._camera, this._pickingTexture);\n\t\n\t        // Read the rendering texture\n\t        this._renderer.readRenderTargetPixels(texture, 0, 0, texture.width, texture.height, this._pixelBuffer);\n\t\n\t        this._needUpdate = false;\n\t      }\n\t    }\n\t  }, {\n\t    key: '_pick',\n\t    value: function _pick(point, normalisedPoint) {\n\t      this._update();\n\t\n\t      var index = point.x + (this._pickingTexture.height - point.y) * this._pickingTexture.width;\n\t\n\t      // Interpret the pixel as an ID\n\t      var id = this._pixelBuffer[index * 4 + 2] * 255 * 255 + this._pixelBuffer[index * 4 + 1] * 255 + this._pixelBuffer[index * 4 + 0];\n\t\n\t      // Skip if ID is 16646655 (white) as the background returns this\n\t      if (id === 16646655) {\n\t        return;\n\t      }\n\t\n\t      this._raycaster.setFromCamera(normalisedPoint, this._camera);\n\t\n\t      // Perform ray intersection on picking scene\n\t      //\n\t      // TODO: Only perform intersection test on the relevant picking mesh\n\t      var intersects = this._raycaster.intersectObjects(this._pickingScene.children, true);\n\t\n\t      var _point2d = point.clone();\n\t\n\t      var _point3d;\n\t      if (intersects.length > 0) {\n\t        _point3d = intersects[0].point.clone();\n\t      }\n\t\n\t      // Pass along as much data as possible for now until we know more about how\n\t      // people use the picking API and what the returned data should be\n\t      //\n\t      // TODO: Look into the leak potential for passing so much by reference here\n\t      this._world.emit('pick', id, _point2d, _point3d, intersects);\n\t      this._world.emit('pick-' + id, _point2d, _point3d, intersects);\n\t    }\n\t\n\t    // Add mesh to picking scene\n\t    //\n\t    // Picking ID should already be added as an attribute\n\t  }, {\n\t    key: 'add',\n\t    value: function add(mesh) {\n\t      this._pickingScene.add(mesh);\n\t      this._needUpdate = true;\n\t    }\n\t\n\t    // Remove mesh from picking scene\n\t  }, {\n\t    key: 'remove',\n\t    value: function remove(mesh) {\n\t      this._pickingScene.remove(mesh);\n\t      this._needUpdate = true;\n\t    }\n\t\n\t    // Returns next ID to use for picking\n\t  }, {\n\t    key: 'getNextId',\n\t    value: function getNextId() {\n\t      return nextId++;\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      // TODO: Find a way to properly remove these listeners as they stay\n\t      // active at the moment\n\t      window.removeEventListener('resize', this._resizeHandler, false);\n\t      this._world._container.removeEventListener('mouseup', this._mouseUpHandler, false);\n\t\n\t      this._world.off('move', this._onWorldMove);\n\t\n\t      if (this._pickingScene.children) {\n\t        // Remove everything else in the layer\n\t        var child;\n\t        for (var i = this._pickingScene.children.length - 1; i >= 0; i--) {\n\t          child = this._pickingScene.children[i];\n\t\n\t          if (!child) {\n\t            continue;\n\t          }\n\t\n\t          this._pickingScene.remove(child);\n\t\n\t          // Probably not a good idea to dispose of geometry due to it being\n\t          // shared with the non-picking scene\n\t          // if (child.geometry) {\n\t          //   // Dispose of mesh and materials\n\t          //   child.geometry.dispose();\n\t          //   child.geometry = null;\n\t          // }\n\t\n\t          if (child.material) {\n\t            if (child.material.map) {\n\t              child.material.map.dispose();\n\t              child.material.map = null;\n\t            }\n\t\n\t            child.material.dispose();\n\t            child.material = null;\n\t          }\n\t        }\n\t      }\n\t\n\t      this._pickingScene = null;\n\t      this._pickingTexture = null;\n\t      this._pixelBuffer = null;\n\t\n\t      this._world = null;\n\t      this._renderer = null;\n\t      this._camera = null;\n\t    }\n\t  }]);\n\t\n\t  return Picking;\n\t})();\n\t\n\texports['default'] = function (world, renderer, camera) {\n\t  return new Picking(world, renderer, camera);\n\t};\n\t\n\t;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t// This can be imported from anywhere and will still reference the same scene,\n\t// though there is a helper reference in Engine.pickingScene\n\t\n\texports['default'] = (function () {\n\t  var scene = new _three2['default'].Scene();\n\t  return scene;\n\t})();\n\t\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 20 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _vendorEffectComposer = __webpack_require__(21);\n\t\n\tvar _vendorEffectComposer2 = _interopRequireDefault(_vendorEffectComposer);\n\t\n\texports['default'] = function (renderer, container) {\n\t  var composer = new _vendorEffectComposer2['default'](renderer);\n\t\n\t  var updateSize = function updateSize() {\n\t    // TODO: Re-enable this when perf issues can be solved\n\t    //\n\t    // Rendering double the resolution of the screen can be really slow\n\t    // var pixelRatio = window.devicePixelRatio;\n\t    var pixelRatio = 1;\n\t\n\t    composer.setSize(container.clientWidth * pixelRatio, container.clientHeight * pixelRatio);\n\t  };\n\t\n\t  window.addEventListener('resize', updateSize, false);\n\t  updateSize();\n\t\n\t  return composer;\n\t};\n\t\n\t;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _CopyShader = __webpack_require__(22);\n\t\n\tvar _CopyShader2 = _interopRequireDefault(_CopyShader);\n\t\n\tvar _ShaderPass = __webpack_require__(23);\n\t\n\tvar _ShaderPass2 = _interopRequireDefault(_ShaderPass);\n\t\n\tvar _MaskPass = __webpack_require__(24);\n\t\n\tvar _MaskPass2 = _interopRequireDefault(_MaskPass);\n\t\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\t\n\tvar EffectComposer = function EffectComposer(renderer, renderTarget) {\n\t\n\t\tthis.renderer = renderer;\n\t\n\t\tif (renderTarget === undefined) {\n\t\n\t\t\tvar pixelRatio = renderer.getPixelRatio();\n\t\n\t\t\tvar width = Math.floor(renderer.context.canvas.width / pixelRatio) || 1;\n\t\t\tvar height = Math.floor(renderer.context.canvas.height / pixelRatio) || 1;\n\t\t\tvar parameters = { minFilter: _three2['default'].LinearFilter, magFilter: _three2['default'].LinearFilter, format: _three2['default'].RGBAFormat, stencilBuffer: false };\n\t\n\t\t\trenderTarget = new _three2['default'].WebGLRenderTarget(width, height, parameters);\n\t\t}\n\t\n\t\tthis.renderTarget1 = renderTarget;\n\t\tthis.renderTarget2 = renderTarget.clone();\n\t\n\t\tthis.writeBuffer = this.renderTarget1;\n\t\tthis.readBuffer = this.renderTarget2;\n\t\n\t\tthis.passes = [];\n\t\n\t\tif (_CopyShader2['default'] === undefined) console.error(\"EffectComposer relies on THREE.CopyShader\");\n\t\n\t\tthis.copyPass = new _ShaderPass2['default'](_CopyShader2['default']);\n\t};\n\t\n\tEffectComposer.prototype = {\n\t\n\t\tswapBuffers: function swapBuffers() {\n\t\n\t\t\tvar tmp = this.readBuffer;\n\t\t\tthis.readBuffer = this.writeBuffer;\n\t\t\tthis.writeBuffer = tmp;\n\t\t},\n\t\n\t\taddPass: function addPass(pass) {\n\t\n\t\t\tthis.passes.push(pass);\n\t\t},\n\t\n\t\tinsertPass: function insertPass(pass, index) {\n\t\n\t\t\tthis.passes.splice(index, 0, pass);\n\t\t},\n\t\n\t\trender: function render(delta) {\n\t\n\t\t\tthis.writeBuffer = this.renderTarget1;\n\t\t\tthis.readBuffer = this.renderTarget2;\n\t\n\t\t\tvar maskActive = false;\n\t\n\t\t\tvar pass,\n\t\t\t    i,\n\t\t\t    il = this.passes.length;\n\t\n\t\t\tfor (i = 0; i < il; i++) {\n\t\n\t\t\t\tpass = this.passes[i];\n\t\n\t\t\t\tif (!pass.enabled) continue;\n\t\n\t\t\t\tpass.render(this.renderer, this.writeBuffer, this.readBuffer, delta, maskActive);\n\t\n\t\t\t\tif (pass.needsSwap) {\n\t\n\t\t\t\t\tif (maskActive) {\n\t\n\t\t\t\t\t\tvar context = this.renderer.context;\n\t\n\t\t\t\t\t\tcontext.stencilFunc(context.NOTEQUAL, 1, 0xffffffff);\n\t\n\t\t\t\t\t\tthis.copyPass.render(this.renderer, this.writeBuffer, this.readBuffer, delta);\n\t\n\t\t\t\t\t\tcontext.stencilFunc(context.EQUAL, 1, 0xffffffff);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tthis.swapBuffers();\n\t\t\t\t}\n\t\n\t\t\t\tif (pass instanceof _MaskPass2['default']) {\n\t\n\t\t\t\t\tmaskActive = true;\n\t\t\t\t} else if (pass instanceof _MaskPass.ClearMaskPass) {\n\t\n\t\t\t\t\tmaskActive = false;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\treset: function reset(renderTarget) {\n\t\n\t\t\tif (renderTarget === undefined) {\n\t\n\t\t\t\trenderTarget = this.renderTarget1.clone();\n\t\n\t\t\t\tvar pixelRatio = this.renderer.getPixelRatio();\n\t\n\t\t\t\trenderTarget.setSize(Math.floor(this.renderer.context.canvas.width / pixelRatio), Math.floor(this.renderer.context.canvas.height / pixelRatio));\n\t\t\t}\n\t\n\t\t\tthis.renderTarget1.dispose();\n\t\t\tthis.renderTarget1 = renderTarget;\n\t\t\tthis.renderTarget2.dispose();\n\t\t\tthis.renderTarget2 = renderTarget.clone();\n\t\n\t\t\tthis.writeBuffer = this.renderTarget1;\n\t\t\tthis.readBuffer = this.renderTarget2;\n\t\t},\n\t\n\t\tsetSize: function setSize(width, height) {\n\t\n\t\t\tthis.renderTarget1.setSize(width, height);\n\t\t\tthis.renderTarget2.setSize(width, height);\n\t\t}\n\t\n\t};\n\t\n\texports['default'] = EffectComposer;\n\t\n\t_three2['default'].EffectComposer = EffectComposer;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 22 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * Full-screen textured quad shader\n\t */\n\t\n\tvar CopyShader = {\n\t\n\t\tuniforms: {\n\t\n\t\t\t\"tDiffuse\": { type: \"t\", value: null },\n\t\t\t\"opacity\": { type: \"f\", value: 1.0 }\n\t\n\t\t},\n\t\n\t\tvertexShader: [\"varying vec2 vUv;\", \"void main() {\", \"vUv = uv;\", \"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\", \"}\"].join(\"\\n\"),\n\t\n\t\tfragmentShader: [\"uniform float opacity;\", \"uniform sampler2D tDiffuse;\", \"varying vec2 vUv;\", \"void main() {\", \"vec4 texel = texture2D( tDiffuse, vUv );\", \"gl_FragColor = opacity * texel;\", \"}\"].join(\"\\n\")\n\t\n\t};\n\t\n\texports[\"default\"] = CopyShader;\n\t\n\t_three2[\"default\"].CopyShader = CopyShader;\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 23 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\t\n\tvar ShaderPass = function ShaderPass(shader, textureID) {\n\t\n\t\tthis.textureID = textureID !== undefined ? textureID : \"tDiffuse\";\n\t\n\t\tif (shader instanceof _three2[\"default\"].ShaderMaterial) {\n\t\n\t\t\tthis.uniforms = shader.uniforms;\n\t\n\t\t\tthis.material = shader;\n\t\t} else if (shader) {\n\t\n\t\t\tthis.uniforms = _three2[\"default\"].UniformsUtils.clone(shader.uniforms);\n\t\n\t\t\tthis.material = new _three2[\"default\"].ShaderMaterial({\n\t\n\t\t\t\tdefines: shader.defines || {},\n\t\t\t\tuniforms: this.uniforms,\n\t\t\t\tvertexShader: shader.vertexShader,\n\t\t\t\tfragmentShader: shader.fragmentShader\n\t\n\t\t\t});\n\t\t}\n\t\n\t\tthis.renderToScreen = false;\n\t\n\t\tthis.enabled = true;\n\t\tthis.needsSwap = true;\n\t\tthis.clear = false;\n\t\n\t\tthis.camera = new _three2[\"default\"].OrthographicCamera(-1, 1, 1, -1, 0, 1);\n\t\tthis.scene = new _three2[\"default\"].Scene();\n\t\n\t\tthis.quad = new _three2[\"default\"].Mesh(new _three2[\"default\"].PlaneBufferGeometry(2, 2), null);\n\t\tthis.scene.add(this.quad);\n\t};\n\t\n\tShaderPass.prototype = {\n\t\n\t\trender: function render(renderer, writeBuffer, readBuffer, delta) {\n\t\n\t\t\tif (this.uniforms[this.textureID]) {\n\t\n\t\t\t\tthis.uniforms[this.textureID].value = readBuffer;\n\t\t\t}\n\t\n\t\t\tthis.quad.material = this.material;\n\t\n\t\t\tif (this.renderToScreen) {\n\t\n\t\t\t\trenderer.render(this.scene, this.camera);\n\t\t\t} else {\n\t\n\t\t\t\trenderer.render(this.scene, this.camera, writeBuffer, this.clear);\n\t\t\t}\n\t\t}\n\t\n\t};\n\t\n\texports[\"default\"] = ShaderPass;\n\t\n\t_three2[\"default\"].ShaderPass = ShaderPass;\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 24 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\t\n\tvar MaskPass = function MaskPass(scene, camera) {\n\t\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\t\n\t\tthis.enabled = true;\n\t\tthis.clear = true;\n\t\tthis.needsSwap = false;\n\t\n\t\tthis.inverse = false;\n\t};\n\t\n\tMaskPass.prototype = {\n\t\n\t\trender: function render(renderer, writeBuffer, readBuffer, delta) {\n\t\n\t\t\tvar context = renderer.context;\n\t\n\t\t\t// don't update color or depth\n\t\n\t\t\tcontext.colorMask(false, false, false, false);\n\t\t\tcontext.depthMask(false);\n\t\n\t\t\t// set up stencil\n\t\n\t\t\tvar writeValue, clearValue;\n\t\n\t\t\tif (this.inverse) {\n\t\n\t\t\t\twriteValue = 0;\n\t\t\t\tclearValue = 1;\n\t\t\t} else {\n\t\n\t\t\t\twriteValue = 1;\n\t\t\t\tclearValue = 0;\n\t\t\t}\n\t\n\t\t\tcontext.enable(context.STENCIL_TEST);\n\t\t\tcontext.stencilOp(context.REPLACE, context.REPLACE, context.REPLACE);\n\t\t\tcontext.stencilFunc(context.ALWAYS, writeValue, 0xffffffff);\n\t\t\tcontext.clearStencil(clearValue);\n\t\n\t\t\t// draw into the stencil buffer\n\t\n\t\t\trenderer.render(this.scene, this.camera, readBuffer, this.clear);\n\t\t\trenderer.render(this.scene, this.camera, writeBuffer, this.clear);\n\t\n\t\t\t// re-enable update of color and depth\n\t\n\t\t\tcontext.colorMask(true, true, true, true);\n\t\t\tcontext.depthMask(true);\n\t\n\t\t\t// only render where stencil is set to 1\n\t\n\t\t\tcontext.stencilFunc(context.EQUAL, 1, 0xffffffff); // draw if == 1\n\t\t\tcontext.stencilOp(context.KEEP, context.KEEP, context.KEEP);\n\t\t}\n\t\n\t};\n\t\n\tvar ClearMaskPass = function ClearMaskPass() {\n\t\n\t\tthis.enabled = true;\n\t};\n\t\n\tClearMaskPass.prototype = {\n\t\n\t\trender: function render(renderer, writeBuffer, readBuffer, delta) {\n\t\n\t\t\tvar context = renderer.context;\n\t\n\t\t\tcontext.disable(context.STENCIL_TEST);\n\t\t}\n\t\n\t};\n\t\n\texports['default'] = MaskPass;\n\texports.ClearMaskPass = ClearMaskPass;\n\t\n\t_three2['default'].MaskPass = MaskPass;\n\t_three2['default'].ClearMaskPass = ClearMaskPass;\n\n/***/ },\n/* 25 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\t\n\tvar RenderPass = function RenderPass(scene, camera, overrideMaterial, clearColor, clearAlpha) {\n\t\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\t\n\t\tthis.overrideMaterial = overrideMaterial;\n\t\n\t\tthis.clearColor = clearColor;\n\t\tthis.clearAlpha = clearAlpha !== undefined ? clearAlpha : 1;\n\t\n\t\tthis.oldClearColor = new _three2['default'].Color();\n\t\tthis.oldClearAlpha = 1;\n\t\n\t\tthis.enabled = true;\n\t\tthis.clear = true;\n\t\tthis.needsSwap = false;\n\t};\n\t\n\tRenderPass.prototype = {\n\t\n\t\trender: function render(renderer, writeBuffer, readBuffer, delta) {\n\t\n\t\t\tthis.scene.overrideMaterial = this.overrideMaterial;\n\t\n\t\t\tif (this.clearColor) {\n\t\n\t\t\t\tthis.oldClearColor.copy(renderer.getClearColor());\n\t\t\t\tthis.oldClearAlpha = renderer.getClearAlpha();\n\t\n\t\t\t\trenderer.setClearColor(this.clearColor, this.clearAlpha);\n\t\t\t}\n\t\n\t\t\trenderer.render(this.scene, this.camera, readBuffer, this.clear);\n\t\n\t\t\tif (this.clearColor) {\n\t\n\t\t\t\trenderer.setClearColor(this.oldClearColor, this.oldClearAlpha);\n\t\t\t}\n\t\n\t\t\tthis.scene.overrideMaterial = null;\n\t\t}\n\t\n\t};\n\t\n\texports['default'] = RenderPass;\n\t\n\t_three2['default'].RenderPass = RenderPass;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 26 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * Simple fake tilt-shift effect, modulating two pass Gaussian blur (see above) by vertical position\n\t *\n\t * - 9 samples per pass\n\t * - standard deviation 2.7\n\t * - \"h\" and \"v\" parameters should be set to \"1 / width\" and \"1 / height\"\n\t * - \"r\" parameter control where \"focused\" horizontal line lies\n\t */\n\t\n\tvar HorizontalTiltShiftShader = {\n\t\n\t\tuniforms: {\n\t\n\t\t\t\"tDiffuse\": { type: \"t\", value: null },\n\t\t\t\"h\": { type: \"f\", value: 1.0 / 512.0 },\n\t\t\t\"r\": { type: \"f\", value: 0.35 }\n\t\n\t\t},\n\t\n\t\tvertexShader: [\"varying vec2 vUv;\", \"void main() {\", \"vUv = uv;\", \"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\", \"}\"].join(\"\\n\"),\n\t\n\t\tfragmentShader: [\"uniform sampler2D tDiffuse;\", \"uniform float h;\", \"uniform float r;\", \"varying vec2 vUv;\", \"void main() {\", \"vec4 sum = vec4( 0.0 );\", \"float hh = h * abs( r - vUv.y );\", \"sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * hh, vUv.y ) ) * 0.051;\", \"sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * hh, vUv.y ) ) * 0.0918;\", \"sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * hh, vUv.y ) ) * 0.12245;\", \"sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * hh, vUv.y ) ) * 0.1531;\", \"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\", \"sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * hh, vUv.y ) ) * 0.1531;\", \"sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * hh, vUv.y ) ) * 0.12245;\", \"sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * hh, vUv.y ) ) * 0.0918;\", \"sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * hh, vUv.y ) ) * 0.051;\", \"gl_FragColor = sum;\", \"}\"].join(\"\\n\")\n\t\n\t};\n\t\n\texports[\"default\"] = HorizontalTiltShiftShader;\n\t\n\t_three2[\"default\"].HorizontalTiltShiftShader = HorizontalTiltShiftShader;\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * Simple fake tilt-shift effect, modulating two pass Gaussian blur (see above) by vertical position\n\t *\n\t * - 9 samples per pass\n\t * - standard deviation 2.7\n\t * - \"h\" and \"v\" parameters should be set to \"1 / width\" and \"1 / height\"\n\t * - \"r\" parameter control where \"focused\" horizontal line lies\n\t */\n\t\n\tvar VerticalTiltShiftShader = {\n\t\n\t\tuniforms: {\n\t\n\t\t\t\"tDiffuse\": { type: \"t\", value: null },\n\t\t\t\"v\": { type: \"f\", value: 1.0 / 512.0 },\n\t\t\t\"r\": { type: \"f\", value: 0.35 }\n\t\n\t\t},\n\t\n\t\tvertexShader: [\"varying vec2 vUv;\", \"void main() {\", \"vUv = uv;\", \"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\", \"}\"].join(\"\\n\"),\n\t\n\t\tfragmentShader: [\"uniform sampler2D tDiffuse;\", \"uniform float v;\", \"uniform float r;\", \"varying vec2 vUv;\", \"void main() {\", \"vec4 sum = vec4( 0.0 );\", \"float vv = v * abs( r - vUv.y );\", \"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;\", \"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;\", \"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;\", \"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;\", \"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\", \"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;\", \"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;\", \"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;\", \"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;\", \"gl_FragColor = sum;\", \"}\"].join(\"\\n\")\n\t\n\t};\n\t\n\texports[\"default\"] = VerticalTiltShiftShader;\n\t\n\t_three2[\"default\"].VerticalTiltShiftShader = VerticalTiltShiftShader;\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 28 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author davidedc / http://www.sketchpatch.net/\n\t *\n\t * NVIDIA FXAA by Timothy Lottes\n\t * http://timothylottes.blogspot.com/2011/06/fxaa3-source-released.html\n\t * - WebGL port by @supereggbert\n\t * http://www.glge.org/demos/fxaa/\n\t */\n\t\n\tvar FXAAShader = {\n\t\n\t\tuniforms: {\n\t\n\t\t\t\"tDiffuse\": { type: \"t\", value: null },\n\t\t\t\"resolution\": { type: \"v2\", value: new _three2[\"default\"].Vector2(1 / 1024, 1 / 512) }\n\t\n\t\t},\n\t\n\t\tvertexShader: [\"void main() {\", \"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\", \"}\"].join(\"\\n\"),\n\t\n\t\tfragmentShader: [\"uniform sampler2D tDiffuse;\", \"uniform vec2 resolution;\", \"#define FXAA_REDUCE_MIN   (1.0/128.0)\", \"#define FXAA_REDUCE_MUL   (1.0/8.0)\", \"#define FXAA_SPAN_MAX     8.0\", \"void main() {\", \"vec3 rgbNW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ).xyz;\", \"vec3 rgbNE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ).xyz;\", \"vec3 rgbSW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ).xyz;\", \"vec3 rgbSE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ).xyz;\", \"vec4 rgbaM  = texture2D( tDiffuse,  gl_FragCoord.xy  * resolution );\", \"vec3 rgbM  = rgbaM.xyz;\", \"vec3 luma = vec3( 0.299, 0.587, 0.114 );\", \"float lumaNW = dot( rgbNW, luma );\", \"float lumaNE = dot( rgbNE, luma );\", \"float lumaSW = dot( rgbSW, luma );\", \"float lumaSE = dot( rgbSE, luma );\", \"float lumaM  = dot( rgbM,  luma );\", \"float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );\", \"float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );\", \"vec2 dir;\", \"dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\", \"dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\", \"float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );\", \"float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );\", \"dir = min( vec2( FXAA_SPAN_MAX,  FXAA_SPAN_MAX),\", \"max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\", \"dir * rcpDirMin)) * resolution;\", \"vec4 rgbA = (1.0/2.0) * (\", \"texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (1.0/3.0 - 0.5)) +\", \"texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (2.0/3.0 - 0.5)));\", \"vec4 rgbB = rgbA * (1.0/2.0) + (1.0/4.0) * (\", \"texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (0.0/3.0 - 0.5)) +\", \"texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (3.0/3.0 - 0.5)));\", \"float lumaB = dot(rgbB, vec4(luma, 0.0));\", \"if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) ) {\", \"gl_FragColor = rgbA;\", \"} else {\", \"gl_FragColor = rgbB;\", \"}\", \"}\"].join(\"\\n\")\n\t\n\t};\n\t\n\texports[\"default\"] = FXAAShader;\n\t\n\t_three2[\"default\"].FXAAShader = FXAAShader;\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 29 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _Layer2 = __webpack_require__(30);\n\t\n\tvar _Layer3 = _interopRequireDefault(_Layer2);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _Skybox = __webpack_require__(31);\n\t\n\tvar _Skybox2 = _interopRequireDefault(_Skybox);\n\t\n\t// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\t\n\tvar EnvironmentLayer = (function (_Layer) {\n\t  _inherits(EnvironmentLayer, _Layer);\n\t\n\t  function EnvironmentLayer(options) {\n\t    _classCallCheck(this, EnvironmentLayer);\n\t\n\t    var defaults = {\n\t      skybox: false\n\t    };\n\t\n\t    var _options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    _get(Object.getPrototypeOf(EnvironmentLayer.prototype), 'constructor', this).call(this, _options);\n\t  }\n\t\n\t  _createClass(EnvironmentLayer, [{\n\t    key: '_onAdd',\n\t    value: function _onAdd() {\n\t      this._initLights();\n\t\n\t      if (this._options.skybox) {\n\t        this._initSkybox();\n\t      }\n\t\n\t      // this._initGrid();\n\t    }\n\t\n\t    // Not fleshed out or thought through yet\n\t    //\n\t    // Lights could potentially be put it their own 'layer' to keep this class\n\t    // much simpler and less messy\n\t  }, {\n\t    key: '_initLights',\n\t    value: function _initLights() {\n\t      // Position doesn't really matter (the angle is important), however it's\n\t      // used here so the helpers look more natural.\n\t\n\t      if (!this._options.skybox) {\n\t        var directionalLight = new _three2['default'].DirectionalLight(0xffffff, 1);\n\t        directionalLight.position.x = 10000;\n\t        directionalLight.position.y = 10000;\n\t        directionalLight.position.z = 10000;\n\t\n\t        // TODO: Get shadows working in non-PBR scenes\n\t\n\t        // directionalLight.castShadow = true;\n\t        //\n\t        // var d = 100;\n\t        // directionalLight.shadow.camera.left = -d;\n\t        // directionalLight.shadow.camera.right = d;\n\t        // directionalLight.shadow.camera.top = d;\n\t        // directionalLight.shadow.camera.bottom = -d;\n\t        //\n\t        // directionalLight.shadow.camera.near = 10;\n\t        // directionalLight.shadow.camera.far = 100;\n\t        //\n\t        // // TODO: Need to dial in on a good shadowmap size\n\t        // directionalLight.shadow.mapSize.width = 2048;\n\t        // directionalLight.shadow.mapSize.height = 2048;\n\t        //\n\t        // // directionalLight.shadowBias = -0.0010;\n\t        // // directionalLight.shadow.darkness = 0.15;\n\t\n\t        var directionalLight2 = new _three2['default'].DirectionalLight(0xffffff, 0.5);\n\t        directionalLight2.position.x = -10000;\n\t        directionalLight2.position.y = 10000;\n\t        directionalLight2.position.z = 0;\n\t\n\t        var directionalLight3 = new _three2['default'].DirectionalLight(0xffffff, 0.5);\n\t        directionalLight3.position.x = 10000;\n\t        directionalLight3.position.y = 10000;\n\t        directionalLight3.position.z = -10000;\n\t\n\t        this.add(directionalLight);\n\t        this.add(directionalLight2);\n\t        this.add(directionalLight3);\n\t\n\t        // var helper = new THREE.DirectionalLightHelper(directionalLight, 10);\n\t        // var helper2 = new THREE.DirectionalLightHelper(directionalLight2, 10);\n\t        // var helper3 = new THREE.DirectionalLightHelper(directionalLight3, 10);\n\t        //\n\t        // this.add(helper);\n\t        // this.add(helper2);\n\t        // this.add(helper3);\n\t      } else {\n\t          // Directional light that will be projected from the sun\n\t          this._skyboxLight = new _three2['default'].DirectionalLight(0xffffff, 1);\n\t\n\t          this._skyboxLight.castShadow = true;\n\t\n\t          var d = 10000;\n\t          this._skyboxLight.shadow.camera.left = -d;\n\t          this._skyboxLight.shadow.camera.right = d;\n\t          this._skyboxLight.shadow.camera.top = d;\n\t          this._skyboxLight.shadow.camera.bottom = -d;\n\t\n\t          this._skyboxLight.shadow.camera.near = 10000;\n\t          this._skyboxLight.shadow.camera.far = 70000;\n\t\n\t          // TODO: Need to dial in on a good shadowmap size\n\t          this._skyboxLight.shadow.mapSize.width = 2048;\n\t          this._skyboxLight.shadow.mapSize.height = 2048;\n\t\n\t          // this._skyboxLight.shadowBias = -0.0010;\n\t          // this._skyboxLight.shadow.darkness = 0.15;\n\t\n\t          // this._object3D.add(new THREE.CameraHelper(this._skyboxLight.shadow.camera));\n\t\n\t          this.add(this._skyboxLight);\n\t        }\n\t    }\n\t  }, {\n\t    key: '_initSkybox',\n\t    value: function _initSkybox() {\n\t      this._skybox = new _Skybox2['default'](this._world, this._skyboxLight);\n\t      this.add(this._skybox._mesh);\n\t    }\n\t\n\t    // Add grid helper for context during initial development\n\t  }, {\n\t    key: '_initGrid',\n\t    value: function _initGrid() {\n\t      var size = 4000;\n\t      var step = 100;\n\t\n\t      var gridHelper = new _three2['default'].GridHelper(size, step);\n\t      this.add(gridHelper);\n\t    }\n\t\n\t    // Clean up environment\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      this._skyboxLight = null;\n\t\n\t      this.remove(this._skybox._mesh);\n\t      this._skybox.destroy();\n\t      this._skybox = null;\n\t\n\t      _get(Object.getPrototypeOf(EnvironmentLayer.prototype), 'destroy', this).call(this);\n\t    }\n\t  }]);\n\t\n\t  return EnvironmentLayer;\n\t})(_Layer3['default']);\n\t\n\texports['default'] = EnvironmentLayer;\n\t\n\tvar noNew = function noNew(options) {\n\t  return new EnvironmentLayer(options);\n\t};\n\t\n\t// Initialise without requiring new keyword\n\texports.environmentLayer = noNew;\n\n/***/ },\n/* 30 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _eventemitter3 = __webpack_require__(2);\n\t\n\tvar _eventemitter32 = _interopRequireDefault(_eventemitter3);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _engineScene = __webpack_require__(9);\n\t\n\tvar _engineScene2 = _interopRequireDefault(_engineScene);\n\t\n\tvar _vendorCSS3DRenderer = __webpack_require__(14);\n\t\n\tvar _vendorCSS2DRenderer = __webpack_require__(16);\n\t\n\t// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\t\n\t// TODO: Need a single move method that handles moving all the various object\n\t// layers so that the DOM layers stay in sync with the 3D layer\n\t\n\t// TODO: Double check that objects within the _object3D Object3D parent are frustum\n\t// culled even if the layer position stays at the default (0,0,0) and the child\n\t// objects are positioned much further away\n\t//\n\t// Or does the layer being at (0,0,0) prevent the child objects from being\n\t// culled because the layer parent is effectively always in view even if the\n\t// child is actually out of camera\n\t\n\tvar Layer = (function (_EventEmitter) {\n\t  _inherits(Layer, _EventEmitter);\n\t\n\t  function Layer(options) {\n\t    _classCallCheck(this, Layer);\n\t\n\t    _get(Object.getPrototypeOf(Layer.prototype), 'constructor', this).call(this);\n\t\n\t    var defaults = {\n\t      output: true,\n\t      outputToScene: true\n\t    };\n\t\n\t    this._options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    if (this.isOutput()) {\n\t      this._object3D = new _three2['default'].Object3D();\n\t\n\t      this._dom3D = document.createElement('div');\n\t      this._domObject3D = new _vendorCSS3DRenderer.CSS3DObject(this._dom3D);\n\t\n\t      this._dom2D = document.createElement('div');\n\t      this._domObject2D = new _vendorCSS2DRenderer.CSS2DObject(this._dom2D);\n\t    }\n\t  }\n\t\n\t  // Add THREE object directly to layer\n\t\n\t  _createClass(Layer, [{\n\t    key: 'add',\n\t    value: function add(object) {\n\t      this._object3D.add(object);\n\t    }\n\t\n\t    // Remove THREE object from to layer\n\t  }, {\n\t    key: 'remove',\n\t    value: function remove(object) {\n\t      this._object3D.remove(object);\n\t    }\n\t  }, {\n\t    key: 'addDOM3D',\n\t    value: function addDOM3D(object) {\n\t      this._domObject3D.add(object);\n\t    }\n\t  }, {\n\t    key: 'removeDOM3D',\n\t    value: function removeDOM3D(object) {\n\t      this._domObject3D.remove(object);\n\t    }\n\t  }, {\n\t    key: 'addDOM2D',\n\t    value: function addDOM2D(object) {\n\t      this._domObject2D.add(object);\n\t    }\n\t  }, {\n\t    key: 'removeDOM2D',\n\t    value: function removeDOM2D(object) {\n\t      this._domObject2D.remove(object);\n\t    }\n\t\n\t    // Add layer to world instance and store world reference\n\t  }, {\n\t    key: 'addTo',\n\t    value: function addTo(world) {\n\t      world.addLayer(this);\n\t      return this;\n\t    }\n\t\n\t    // Internal method called by World.addLayer to actually add the layer\n\t  }, {\n\t    key: '_addToWorld',\n\t    value: function _addToWorld(world) {\n\t      this._world = world;\n\t      this._onAdd(world);\n\t      this.emit('added');\n\t    }\n\t  }, {\n\t    key: '_onAdd',\n\t    value: function _onAdd(world) {}\n\t  }, {\n\t    key: 'getPickingId',\n\t    value: function getPickingId() {\n\t      if (this._world._engine._picking) {\n\t        return this._world._engine._picking.getNextId();\n\t      }\n\t\n\t      return false;\n\t    }\n\t\n\t    // TODO: Tidy this up and don't access so many private properties to work\n\t  }, {\n\t    key: 'addToPicking',\n\t    value: function addToPicking(object) {\n\t      if (!this._world._engine._picking) {\n\t        return;\n\t      }\n\t\n\t      this._world._engine._picking.add(object);\n\t    }\n\t  }, {\n\t    key: 'removeFromPicking',\n\t    value: function removeFromPicking(object) {\n\t      if (!this._world._engine._picking) {\n\t        return;\n\t      }\n\t\n\t      this._world._engine._picking.remove(object);\n\t    }\n\t  }, {\n\t    key: 'isOutput',\n\t    value: function isOutput() {\n\t      return this._options.output;\n\t    }\n\t  }, {\n\t    key: 'isOutputToScene',\n\t    value: function isOutputToScene() {\n\t      return this._options.outputToScene;\n\t    }\n\t\n\t    // Destroys the layer and removes it from the scene and memory\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      if (this._object3D && this._object3D.children) {\n\t        // Remove everything else in the layer\n\t        var child;\n\t        for (var i = this._object3D.children.length - 1; i >= 0; i--) {\n\t          child = this._object3D.children[i];\n\t\n\t          if (!child) {\n\t            continue;\n\t          }\n\t\n\t          this.remove(child);\n\t\n\t          if (child.geometry) {\n\t            // Dispose of mesh and materials\n\t            child.geometry.dispose();\n\t            child.geometry = null;\n\t          }\n\t\n\t          if (child.material) {\n\t            if (child.material.map) {\n\t              child.material.map.dispose();\n\t              child.material.map = null;\n\t            }\n\t\n\t            child.material.dispose();\n\t            child.material = null;\n\t          }\n\t        }\n\t      }\n\t\n\t      if (this._domObject3D && this._domObject3D.children) {\n\t        // Remove everything else in the layer\n\t        var child;\n\t        for (var i = this._domObject3D.children.length - 1; i >= 0; i--) {\n\t          child = this._domObject3D.children[i];\n\t\n\t          if (!child) {\n\t            continue;\n\t          }\n\t\n\t          this.removeDOM3D(child);\n\t        }\n\t      }\n\t\n\t      if (this._domObject2D && this._domObject2D.children) {\n\t        // Remove everything else in the layer\n\t        var child;\n\t        for (var i = this._domObject2D.children.length - 1; i >= 0; i--) {\n\t          child = this._domObject2D.children[i];\n\t\n\t          if (!child) {\n\t            continue;\n\t          }\n\t\n\t          this.removeDOM2D(child);\n\t        }\n\t      }\n\t\n\t      this._domObject3D = null;\n\t      this._domObject2D = null;\n\t\n\t      this._world = null;\n\t      this._object3D = null;\n\t    }\n\t  }]);\n\t\n\t  return Layer;\n\t})(_eventemitter32['default']);\n\t\n\texports['default'] = Layer;\n\t\n\tvar noNew = function noNew(options) {\n\t  return new Layer(options);\n\t};\n\t\n\texports.layer = noNew;\n\n/***/ },\n/* 31 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _Sky = __webpack_require__(32);\n\t\n\tvar _Sky2 = _interopRequireDefault(_Sky);\n\t\n\tvar _lodashThrottle = __webpack_require__(33);\n\t\n\tvar _lodashThrottle2 = _interopRequireDefault(_lodashThrottle);\n\t\n\t// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\t\n\tvar cubemap = {\n\t  vertexShader: ['varying vec3 vPosition;', 'void main() {', 'vPosition = position;', 'gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );', '}'].join('\\n'),\n\t\n\t  fragmentShader: ['uniform samplerCube cubemap;', 'varying vec3 vPosition;', 'void main() {', 'gl_FragColor = textureCube(cubemap, normalize(vPosition));', '}'].join('\\n')\n\t};\n\t\n\tvar Skybox = (function () {\n\t  function Skybox(world, light) {\n\t    _classCallCheck(this, Skybox);\n\t\n\t    this._world = world;\n\t    this._light = light;\n\t\n\t    this._settings = {\n\t      distance: 38000,\n\t      turbidity: 10,\n\t      reileigh: 2,\n\t      mieCoefficient: 0.005,\n\t      mieDirectionalG: 0.8,\n\t      luminance: 1,\n\t      // 0.48 is a cracking dusk / sunset\n\t      // 0.4 is a beautiful early-morning / late-afternoon\n\t      // 0.2 is a nice day time\n\t      inclination: 0.48, // Elevation / inclination\n\t      azimuth: 0.25 };\n\t\n\t    // Facing front\n\t    this._initSkybox();\n\t    this._updateUniforms();\n\t    this._initEvents();\n\t  }\n\t\n\t  _createClass(Skybox, [{\n\t    key: '_initEvents',\n\t    value: function _initEvents() {\n\t      // Throttled to 1 per 100ms\n\t      this._throttledWorldUpdate = (0, _lodashThrottle2['default'])(this._update, 100);\n\t      this._world.on('preUpdate', this._throttledWorldUpdate, this);\n\t    }\n\t  }, {\n\t    key: '_initSkybox',\n\t    value: function _initSkybox() {\n\t      // Cube camera for skybox\n\t      this._cubeCamera = new _three2['default'].CubeCamera(1, 20000000, 128);\n\t\n\t      // Cube material\n\t      var cubeTarget = this._cubeCamera.renderTarget;\n\t\n\t      // Add Sky Mesh\n\t      this._sky = new _Sky2['default']();\n\t      this._skyScene = new _three2['default'].Scene();\n\t      this._skyScene.add(this._sky.mesh);\n\t\n\t      // Add Sun Helper\n\t      this._sunSphere = new _three2['default'].Mesh(new _three2['default'].SphereBufferGeometry(2000, 16, 8), new _three2['default'].MeshBasicMaterial({\n\t        color: 0xffffff\n\t      }));\n\t\n\t      // TODO: This isn't actually visible because it's not added to the layer\n\t      // this._sunSphere.visible = true;\n\t\n\t      var skyboxUniforms = {\n\t        cubemap: { type: 't', value: cubeTarget }\n\t      };\n\t\n\t      var skyboxMat = new _three2['default'].ShaderMaterial({\n\t        uniforms: skyboxUniforms,\n\t        vertexShader: cubemap.vertexShader,\n\t        fragmentShader: cubemap.fragmentShader,\n\t        side: _three2['default'].BackSide\n\t      });\n\t\n\t      this._mesh = new _three2['default'].Mesh(new _three2['default'].BoxGeometry(1900000, 1900000, 1900000), skyboxMat);\n\t\n\t      this._updateSkybox = true;\n\t    }\n\t  }, {\n\t    key: '_updateUniforms',\n\t    value: function _updateUniforms() {\n\t      var settings = this._settings;\n\t      var uniforms = this._sky.uniforms;\n\t      uniforms.turbidity.value = settings.turbidity;\n\t      uniforms.reileigh.value = settings.reileigh;\n\t      uniforms.luminance.value = settings.luminance;\n\t      uniforms.mieCoefficient.value = settings.mieCoefficient;\n\t      uniforms.mieDirectionalG.value = settings.mieDirectionalG;\n\t\n\t      var theta = Math.PI * (settings.inclination - 0.5);\n\t      var phi = 2 * Math.PI * (settings.azimuth - 0.5);\n\t\n\t      this._sunSphere.position.x = settings.distance * Math.cos(phi);\n\t      this._sunSphere.position.y = settings.distance * Math.sin(phi) * Math.sin(theta);\n\t      this._sunSphere.position.z = settings.distance * Math.sin(phi) * Math.cos(theta);\n\t\n\t      // Move directional light to sun position\n\t      this._light.position.copy(this._sunSphere.position);\n\t\n\t      this._sky.uniforms.sunPosition.value.copy(this._sunSphere.position);\n\t    }\n\t  }, {\n\t    key: '_update',\n\t    value: function _update(delta) {\n\t      if (this._updateSkybox) {\n\t        this._updateSkybox = false;\n\t      } else {\n\t        return;\n\t      }\n\t\n\t      // if (!this._angle) {\n\t      //   this._angle = 0;\n\t      // }\n\t      //\n\t      // // Animate inclination\n\t      // this._angle += Math.PI * delta;\n\t      // this._settings.inclination = 0.5 * (Math.sin(this._angle) / 2 + 0.5);\n\t\n\t      // Update light intensity depending on elevation of sun (day to night)\n\t      this._light.intensity = 1 - 0.95 * (this._settings.inclination / 0.5);\n\t\n\t      // // console.log(delta, this._angle, this._settings.inclination);\n\t      //\n\t      // TODO: Only do this when the uniforms have been changed\n\t      this._updateUniforms();\n\t\n\t      // TODO: Only do this when the cubemap has actually changed\n\t      this._cubeCamera.updateCubeMap(this._world._engine._renderer, this._skyScene);\n\t    }\n\t  }, {\n\t    key: 'getRenderTarget',\n\t    value: function getRenderTarget() {\n\t      return this._cubeCamera.renderTarget;\n\t    }\n\t  }, {\n\t    key: 'setInclination',\n\t    value: function setInclination(inclination) {\n\t      this._settings.inclination = inclination;\n\t      this._updateSkybox = true;\n\t    }\n\t\n\t    // Destroy the skybox and remove it from memory\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      this._world.off('preUpdate', this._throttledWorldUpdate);\n\t      this._throttledWorldUpdate = null;\n\t\n\t      this._world = null;\n\t      this._light = null;\n\t\n\t      this._cubeCamera = null;\n\t\n\t      this._sky.mesh.geometry.dispose();\n\t      this._sky.mesh.geometry = null;\n\t\n\t      if (this._sky.mesh.material.map) {\n\t        this._sky.mesh.material.map.dispose();\n\t        this._sky.mesh.material.map = null;\n\t      }\n\t\n\t      this._sky.mesh.material.dispose();\n\t      this._sky.mesh.material = null;\n\t\n\t      this._sky.mesh = null;\n\t      this._sky = null;\n\t\n\t      this._skyScene = null;\n\t\n\t      this._sunSphere.geometry.dispose();\n\t      this._sunSphere.geometry = null;\n\t\n\t      if (this._sunSphere.material.map) {\n\t        this._sunSphere.material.map.dispose();\n\t        this._sunSphere.material.map = null;\n\t      }\n\t\n\t      this._sunSphere.material.dispose();\n\t      this._sunSphere.material = null;\n\t\n\t      this._sunSphere = null;\n\t\n\t      this._mesh.geometry.dispose();\n\t      this._mesh.geometry = null;\n\t\n\t      if (this._mesh.material.map) {\n\t        this._mesh.material.map.dispose();\n\t        this._mesh.material.map = null;\n\t      }\n\t\n\t      this._mesh.material.dispose();\n\t      this._mesh.material = null;\n\t    }\n\t  }]);\n\t\n\t  return Skybox;\n\t})();\n\t\n\texports['default'] = Skybox;\n\t\n\tvar noNew = function noNew(world, light) {\n\t  return new Skybox(world, light);\n\t};\n\t\n\t// Initialise without requiring new keyword\n\texports.skybox = noNew;\n\n/***/ },\n/* 32 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t// jscs:disable\n\t/*eslint eqeqeq:0*/\n\t\n\t/**\n\t * @author zz85 / https://github.com/zz85\n\t *\n\t * Based on 'A Practical Analytic Model for Daylight'\n\t * aka The Preetham Model, the de facto standard analytic skydome model\n\t * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\n\t *\n\t * First implemented by Simon Wallner\n\t * http://www.simonwallner.at/projects/atmospheric-scattering\n\t *\n\t * Improved by Martin Upitis\n\t * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\n\t *\n\t * Three.js integration by zz85 http://twitter.com/blurspline\n\t*/\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t_three2['default'].ShaderLib['sky'] = {\n\t\n\t\tuniforms: {\n\t\n\t\t\tluminance: { type: 'f', value: 1 },\n\t\t\tturbidity: { type: 'f', value: 2 },\n\t\t\treileigh: { type: 'f', value: 1 },\n\t\t\tmieCoefficient: { type: 'f', value: 0.005 },\n\t\t\tmieDirectionalG: { type: 'f', value: 0.8 },\n\t\t\tsunPosition: { type: 'v3', value: new _three2['default'].Vector3() }\n\t\n\t\t},\n\t\n\t\tvertexShader: ['varying vec3 vWorldPosition;', 'void main() {', 'vec4 worldPosition = modelMatrix * vec4( position, 1.0 );', 'vWorldPosition = worldPosition.xyz;', 'gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );', '}'].join('\\n'),\n\t\n\t\tfragmentShader: ['uniform sampler2D skySampler;', 'uniform vec3 sunPosition;', 'varying vec3 vWorldPosition;', 'vec3 cameraPos = vec3(0., 0., 0.);', '// uniform sampler2D sDiffuse;', '// const float turbidity = 10.0; //', '// const float reileigh = 2.; //', '// const float luminance = 1.0; //', '// const float mieCoefficient = 0.005;', '// const float mieDirectionalG = 0.8;', 'uniform float luminance;', 'uniform float turbidity;', 'uniform float reileigh;', 'uniform float mieCoefficient;', 'uniform float mieDirectionalG;', '// constants for atmospheric scattering', 'const float e = 2.71828182845904523536028747135266249775724709369995957;', 'const float pi = 3.141592653589793238462643383279502884197169;', 'const float n = 1.0003; // refractive index of air', 'const float N = 2.545E25; // number of molecules per unit volume for air at', '// 288.15K and 1013mb (sea level -45 celsius)', 'const float pn = 0.035;\t// depolatization factor for standard air', '// wavelength of used primaries, according to preetham', 'const vec3 lambda = vec3(680E-9, 550E-9, 450E-9);', '// mie stuff', '// K coefficient for the primaries', 'const vec3 K = vec3(0.686, 0.678, 0.666);', 'const float v = 4.0;', '// optical length at zenith for molecules', 'const float rayleighZenithLength = 8.4E3;', 'const float mieZenithLength = 1.25E3;', 'const vec3 up = vec3(0.0, 1.0, 0.0);', 'const float EE = 1000.0;', 'const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;', '// 66 arc seconds -> degrees, and the cosine of that', '// earth shadow hack', 'const float cutoffAngle = pi/1.95;', 'const float steepness = 1.5;', 'vec3 totalRayleigh(vec3 lambda)', '{', 'return (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn));', '}',\n\t\n\t\t// see http://blenderartists.org/forum/showthread.php?321110-Shaders-and-Skybox-madness\n\t\t'// A simplied version of the total Reayleigh scattering to works on browsers that use ANGLE', 'vec3 simplifiedRayleigh()', '{', 'return 0.0005 / vec3(94, 40, 18);',\n\t\t// return 0.00054532832366 / (3.0 * 2.545E25 * pow(vec3(680E-9, 550E-9, 450E-9), vec3(4.0)) * 6.245);\n\t\t'}', 'float rayleighPhase(float cosTheta)', '{\t ', 'return (3.0 / (16.0*pi)) * (1.0 + pow(cosTheta, 2.0));', '//\treturn (1.0 / (3.0*pi)) * (1.0 + pow(cosTheta, 2.0));', '//\treturn (3.0 / 4.0) * (1.0 + pow(cosTheta, 2.0));', '}', 'vec3 totalMie(vec3 lambda, vec3 K, float T)', '{', 'float c = (0.2 * T ) * 10E-18;', 'return 0.434 * c * pi * pow((2.0 * pi) / lambda, vec3(v - 2.0)) * K;', '}', 'float hgPhase(float cosTheta, float g)', '{', 'return (1.0 / (4.0*pi)) * ((1.0 - pow(g, 2.0)) / pow(1.0 - 2.0*g*cosTheta + pow(g, 2.0), 1.5));', '}', 'float sunIntensity(float zenithAngleCos)', '{', 'return EE * max(0.0, 1.0 - exp(-((cutoffAngle - acos(zenithAngleCos))/steepness)));', '}', '// float logLuminance(vec3 c)', '// {', '// \treturn log(c.r * 0.2126 + c.g * 0.7152 + c.b * 0.0722);', '// }', '// Filmic ToneMapping http://filmicgames.com/archives/75', 'float A = 0.15;', 'float B = 0.50;', 'float C = 0.10;', 'float D = 0.20;', 'float E = 0.02;', 'float F = 0.30;', 'float W = 1000.0;', 'vec3 Uncharted2Tonemap(vec3 x)', '{', 'return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;', '}', 'void main() ', '{', 'float sunfade = 1.0-clamp(1.0-exp((sunPosition.y/450000.0)),0.0,1.0);', '// luminance =  1.0 ;// vWorldPosition.y / 450000. + 0.5; //sunPosition.y / 450000. * 1. + 0.5;', '// gl_FragColor = vec4(sunfade, sunfade, sunfade, 1.0);', 'float reileighCoefficient = reileigh - (1.0* (1.0-sunfade));', 'vec3 sunDirection = normalize(sunPosition);', 'float sunE = sunIntensity(dot(sunDirection, up));', '// extinction (absorbtion + out scattering) ', '// rayleigh coefficients',\n\t\n\t\t// 'vec3 betaR = totalRayleigh(lambda) * reileighCoefficient;',\n\t\t'vec3 betaR = simplifiedRayleigh() * reileighCoefficient;', '// mie coefficients', 'vec3 betaM = totalMie(lambda, K, turbidity) * mieCoefficient;', '// optical length', '// cutoff angle at 90 to avoid singularity in next formula.', 'float zenithAngle = acos(max(0.0, dot(up, normalize(vWorldPosition - cameraPos))));', 'float sR = rayleighZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));', 'float sM = mieZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));', '// combined extinction factor\t', 'vec3 Fex = exp(-(betaR * sR + betaM * sM));', '// in scattering', 'float cosTheta = dot(normalize(vWorldPosition - cameraPos), sunDirection);', 'float rPhase = rayleighPhase(cosTheta*0.5+0.5);', 'vec3 betaRTheta = betaR * rPhase;', 'float mPhase = hgPhase(cosTheta, mieDirectionalG);', 'vec3 betaMTheta = betaM * mPhase;', 'vec3 Lin = pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * (1.0 - Fex),vec3(1.5));', 'Lin *= mix(vec3(1.0),pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * Fex,vec3(1.0/2.0)),clamp(pow(1.0-dot(up, sunDirection),5.0),0.0,1.0));', '//nightsky', 'vec3 direction = normalize(vWorldPosition - cameraPos);', 'float theta = acos(direction.y); // elevation --> y-axis, [-pi/2, pi/2]', 'float phi = atan(direction.z, direction.x); // azimuth --> x-axis [-pi/2, pi/2]', 'vec2 uv = vec2(phi, theta) / vec2(2.0*pi, pi) + vec2(0.5, 0.0);', '// vec3 L0 = texture2D(skySampler, uv).rgb+0.1 * Fex;', 'vec3 L0 = vec3(0.1) * Fex;', '// composition + solar disc', '//if (cosTheta > sunAngularDiameterCos)', 'float sundisk = smoothstep(sunAngularDiameterCos,sunAngularDiameterCos+0.00002,cosTheta);', '// if (normalize(vWorldPosition - cameraPos).y>0.0)', 'L0 += (sunE * 19000.0 * Fex)*sundisk;', 'vec3 whiteScale = 1.0/Uncharted2Tonemap(vec3(W));', 'vec3 texColor = (Lin+L0);   ', 'texColor *= 0.04 ;', 'texColor += vec3(0.0,0.001,0.0025)*0.3;', 'float g_fMaxLuminance = 1.0;', 'float fLumScaled = 0.1 / luminance;     ', 'float fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (g_fMaxLuminance * g_fMaxLuminance)))) / (1.0 + fLumScaled); ', 'float ExposureBias = fLumCompressed;', 'vec3 curr = Uncharted2Tonemap((log2(2.0/pow(luminance,4.0)))*texColor);', 'vec3 color = curr*whiteScale;', 'vec3 retColor = pow(color,vec3(1.0/(1.2+(1.2*sunfade))));', 'gl_FragColor.rgb = retColor;', 'gl_FragColor.a = 1.0;', '}'].join('\\n')\n\t\n\t};\n\t\n\tvar Sky = function Sky() {\n\t\n\t\tvar skyShader = _three2['default'].ShaderLib['sky'];\n\t\tvar skyUniforms = _three2['default'].UniformsUtils.clone(skyShader.uniforms);\n\t\n\t\tvar skyMat = new _three2['default'].ShaderMaterial({\n\t\t\tfragmentShader: skyShader.fragmentShader,\n\t\t\tvertexShader: skyShader.vertexShader,\n\t\t\tuniforms: skyUniforms,\n\t\t\tside: _three2['default'].BackSide\n\t\t});\n\t\n\t\tvar skyGeo = new _three2['default'].SphereBufferGeometry(450000, 32, 15);\n\t\tvar skyMesh = new _three2['default'].Mesh(skyGeo, skyMat);\n\t\n\t\t// Expose variables\n\t\tthis.mesh = skyMesh;\n\t\tthis.uniforms = skyUniforms;\n\t};\n\t\n\texports['default'] = Sky;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 33 */\n/***/ function(module, exports) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {/**\n\t * lodash (Custom Build) <https://lodash.com/>\n\t * Build: `lodash modularize exports=\"npm\" -o ./`\n\t * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n\t * Released under MIT license <https://lodash.com/license>\n\t * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n\t * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n\t */\n\t\n\t/** Used as the `TypeError` message for \"Functions\" methods. */\n\tvar FUNC_ERROR_TEXT = 'Expected a function';\n\t\n\t/** Used as references for various `Number` constants. */\n\tvar NAN = 0 / 0;\n\t\n\t/** `Object#toString` result references. */\n\tvar symbolTag = '[object Symbol]';\n\t\n\t/** Used to match leading and trailing whitespace. */\n\tvar reTrim = /^\\s+|\\s+$/g;\n\t\n\t/** Used to detect bad signed hexadecimal string values. */\n\tvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\t\n\t/** Used to detect binary string values. */\n\tvar reIsBinary = /^0b[01]+$/i;\n\t\n\t/** Used to detect octal string values. */\n\tvar reIsOctal = /^0o[0-7]+$/i;\n\t\n\t/** Built-in method references without a dependency on `root`. */\n\tvar freeParseInt = parseInt;\n\t\n\t/** Detect free variable `global` from Node.js. */\n\tvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\t\n\t/** Detect free variable `self`. */\n\tvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\t\n\t/** Used as a reference to the global object. */\n\tvar root = freeGlobal || freeSelf || Function('return this')();\n\t\n\t/** Used for built-in method references. */\n\tvar objectProto = Object.prototype;\n\t\n\t/**\n\t * Used to resolve the\n\t * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n\t * of values.\n\t */\n\tvar objectToString = objectProto.toString;\n\t\n\t/* Built-in method references for those with the same name as other `lodash` methods. */\n\tvar nativeMax = Math.max,\n\t    nativeMin = Math.min;\n\t\n\t/**\n\t * Gets the timestamp of the number of milliseconds that have elapsed since\n\t * the Unix epoch (1 January 1970 00:00:00 UTC).\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 2.4.0\n\t * @category Date\n\t * @returns {number} Returns the timestamp.\n\t * @example\n\t *\n\t * _.defer(function(stamp) {\n\t *   console.log(_.now() - stamp);\n\t * }, _.now());\n\t * // => Logs the number of milliseconds it took for the deferred invocation.\n\t */\n\tvar now = function() {\n\t  return root.Date.now();\n\t};\n\t\n\t/**\n\t * Creates a debounced function that delays invoking `func` until after `wait`\n\t * milliseconds have elapsed since the last time the debounced function was\n\t * invoked. The debounced function comes with a `cancel` method to cancel\n\t * delayed `func` invocations and a `flush` method to immediately invoke them.\n\t * Provide `options` to indicate whether `func` should be invoked on the\n\t * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n\t * with the last arguments provided to the debounced function. Subsequent\n\t * calls to the debounced function return the result of the last `func`\n\t * invocation.\n\t *\n\t * **Note:** If `leading` and `trailing` options are `true`, `func` is\n\t * invoked on the trailing edge of the timeout only if the debounced function\n\t * is invoked more than once during the `wait` timeout.\n\t *\n\t * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n\t * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n\t *\n\t * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n\t * for details over the differences between `_.debounce` and `_.throttle`.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 0.1.0\n\t * @category Function\n\t * @param {Function} func The function to debounce.\n\t * @param {number} [wait=0] The number of milliseconds to delay.\n\t * @param {Object} [options={}] The options object.\n\t * @param {boolean} [options.leading=false]\n\t *  Specify invoking on the leading edge of the timeout.\n\t * @param {number} [options.maxWait]\n\t *  The maximum time `func` is allowed to be delayed before it's invoked.\n\t * @param {boolean} [options.trailing=true]\n\t *  Specify invoking on the trailing edge of the timeout.\n\t * @returns {Function} Returns the new debounced function.\n\t * @example\n\t *\n\t * // Avoid costly calculations while the window size is in flux.\n\t * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n\t *\n\t * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n\t * jQuery(element).on('click', _.debounce(sendMail, 300, {\n\t *   'leading': true,\n\t *   'trailing': false\n\t * }));\n\t *\n\t * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n\t * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n\t * var source = new EventSource('/stream');\n\t * jQuery(source).on('message', debounced);\n\t *\n\t * // Cancel the trailing debounced invocation.\n\t * jQuery(window).on('popstate', debounced.cancel);\n\t */\n\tfunction debounce(func, wait, options) {\n\t  var lastArgs,\n\t      lastThis,\n\t      maxWait,\n\t      result,\n\t      timerId,\n\t      lastCallTime,\n\t      lastInvokeTime = 0,\n\t      leading = false,\n\t      maxing = false,\n\t      trailing = true;\n\t\n\t  if (typeof func != 'function') {\n\t    throw new TypeError(FUNC_ERROR_TEXT);\n\t  }\n\t  wait = toNumber(wait) || 0;\n\t  if (isObject(options)) {\n\t    leading = !!options.leading;\n\t    maxing = 'maxWait' in options;\n\t    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n\t    trailing = 'trailing' in options ? !!options.trailing : trailing;\n\t  }\n\t\n\t  function invokeFunc(time) {\n\t    var args = lastArgs,\n\t        thisArg = lastThis;\n\t\n\t    lastArgs = lastThis = undefined;\n\t    lastInvokeTime = time;\n\t    result = func.apply(thisArg, args);\n\t    return result;\n\t  }\n\t\n\t  function leadingEdge(time) {\n\t    // Reset any `maxWait` timer.\n\t    lastInvokeTime = time;\n\t    // Start the timer for the trailing edge.\n\t    timerId = setTimeout(timerExpired, wait);\n\t    // Invoke the leading edge.\n\t    return leading ? invokeFunc(time) : result;\n\t  }\n\t\n\t  function remainingWait(time) {\n\t    var timeSinceLastCall = time - lastCallTime,\n\t        timeSinceLastInvoke = time - lastInvokeTime,\n\t        result = wait - timeSinceLastCall;\n\t\n\t    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n\t  }\n\t\n\t  function shouldInvoke(time) {\n\t    var timeSinceLastCall = time - lastCallTime,\n\t        timeSinceLastInvoke = time - lastInvokeTime;\n\t\n\t    // Either this is the first call, activity has stopped and we're at the\n\t    // trailing edge, the system time has gone backwards and we're treating\n\t    // it as the trailing edge, or we've hit the `maxWait` limit.\n\t    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n\t      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n\t  }\n\t\n\t  function timerExpired() {\n\t    var time = now();\n\t    if (shouldInvoke(time)) {\n\t      return trailingEdge(time);\n\t    }\n\t    // Restart the timer.\n\t    timerId = setTimeout(timerExpired, remainingWait(time));\n\t  }\n\t\n\t  function trailingEdge(time) {\n\t    timerId = undefined;\n\t\n\t    // Only invoke if we have `lastArgs` which means `func` has been\n\t    // debounced at least once.\n\t    if (trailing && lastArgs) {\n\t      return invokeFunc(time);\n\t    }\n\t    lastArgs = lastThis = undefined;\n\t    return result;\n\t  }\n\t\n\t  function cancel() {\n\t    if (timerId !== undefined) {\n\t      clearTimeout(timerId);\n\t    }\n\t    lastInvokeTime = 0;\n\t    lastArgs = lastCallTime = lastThis = timerId = undefined;\n\t  }\n\t\n\t  function flush() {\n\t    return timerId === undefined ? result : trailingEdge(now());\n\t  }\n\t\n\t  function debounced() {\n\t    var time = now(),\n\t        isInvoking = shouldInvoke(time);\n\t\n\t    lastArgs = arguments;\n\t    lastThis = this;\n\t    lastCallTime = time;\n\t\n\t    if (isInvoking) {\n\t      if (timerId === undefined) {\n\t        return leadingEdge(lastCallTime);\n\t      }\n\t      if (maxing) {\n\t        // Handle invocations in a tight loop.\n\t        timerId = setTimeout(timerExpired, wait);\n\t        return invokeFunc(lastCallTime);\n\t      }\n\t    }\n\t    if (timerId === undefined) {\n\t      timerId = setTimeout(timerExpired, wait);\n\t    }\n\t    return result;\n\t  }\n\t  debounced.cancel = cancel;\n\t  debounced.flush = flush;\n\t  return debounced;\n\t}\n\t\n\t/**\n\t * Creates a throttled function that only invokes `func` at most once per\n\t * every `wait` milliseconds. The throttled function comes with a `cancel`\n\t * method to cancel delayed `func` invocations and a `flush` method to\n\t * immediately invoke them. Provide `options` to indicate whether `func`\n\t * should be invoked on the leading and/or trailing edge of the `wait`\n\t * timeout. The `func` is invoked with the last arguments provided to the\n\t * throttled function. Subsequent calls to the throttled function return the\n\t * result of the last `func` invocation.\n\t *\n\t * **Note:** If `leading` and `trailing` options are `true`, `func` is\n\t * invoked on the trailing edge of the timeout only if the throttled function\n\t * is invoked more than once during the `wait` timeout.\n\t *\n\t * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n\t * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n\t *\n\t * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n\t * for details over the differences between `_.throttle` and `_.debounce`.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 0.1.0\n\t * @category Function\n\t * @param {Function} func The function to throttle.\n\t * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n\t * @param {Object} [options={}] The options object.\n\t * @param {boolean} [options.leading=true]\n\t *  Specify invoking on the leading edge of the timeout.\n\t * @param {boolean} [options.trailing=true]\n\t *  Specify invoking on the trailing edge of the timeout.\n\t * @returns {Function} Returns the new throttled function.\n\t * @example\n\t *\n\t * // Avoid excessively updating the position while scrolling.\n\t * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n\t *\n\t * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n\t * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n\t * jQuery(element).on('click', throttled);\n\t *\n\t * // Cancel the trailing throttled invocation.\n\t * jQuery(window).on('popstate', throttled.cancel);\n\t */\n\tfunction throttle(func, wait, options) {\n\t  var leading = true,\n\t      trailing = true;\n\t\n\t  if (typeof func != 'function') {\n\t    throw new TypeError(FUNC_ERROR_TEXT);\n\t  }\n\t  if (isObject(options)) {\n\t    leading = 'leading' in options ? !!options.leading : leading;\n\t    trailing = 'trailing' in options ? !!options.trailing : trailing;\n\t  }\n\t  return debounce(func, wait, {\n\t    'leading': leading,\n\t    'maxWait': wait,\n\t    'trailing': trailing\n\t  });\n\t}\n\t\n\t/**\n\t * Checks if `value` is the\n\t * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n\t * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 0.1.0\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n\t * @example\n\t *\n\t * _.isObject({});\n\t * // => true\n\t *\n\t * _.isObject([1, 2, 3]);\n\t * // => true\n\t *\n\t * _.isObject(_.noop);\n\t * // => true\n\t *\n\t * _.isObject(null);\n\t * // => false\n\t */\n\tfunction isObject(value) {\n\t  var type = typeof value;\n\t  return !!value && (type == 'object' || type == 'function');\n\t}\n\t\n\t/**\n\t * Checks if `value` is object-like. A value is object-like if it's not `null`\n\t * and has a `typeof` result of \"object\".\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 4.0.0\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n\t * @example\n\t *\n\t * _.isObjectLike({});\n\t * // => true\n\t *\n\t * _.isObjectLike([1, 2, 3]);\n\t * // => true\n\t *\n\t * _.isObjectLike(_.noop);\n\t * // => false\n\t *\n\t * _.isObjectLike(null);\n\t * // => false\n\t */\n\tfunction isObjectLike(value) {\n\t  return !!value && typeof value == 'object';\n\t}\n\t\n\t/**\n\t * Checks if `value` is classified as a `Symbol` primitive or object.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 4.0.0\n\t * @category Lang\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n\t * @example\n\t *\n\t * _.isSymbol(Symbol.iterator);\n\t * // => true\n\t *\n\t * _.isSymbol('abc');\n\t * // => false\n\t */\n\tfunction isSymbol(value) {\n\t  return typeof value == 'symbol' ||\n\t    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n\t}\n\t\n\t/**\n\t * Converts `value` to a number.\n\t *\n\t * @static\n\t * @memberOf _\n\t * @since 4.0.0\n\t * @category Lang\n\t * @param {*} value The value to process.\n\t * @returns {number} Returns the number.\n\t * @example\n\t *\n\t * _.toNumber(3.2);\n\t * // => 3.2\n\t *\n\t * _.toNumber(Number.MIN_VALUE);\n\t * // => 5e-324\n\t *\n\t * _.toNumber(Infinity);\n\t * // => Infinity\n\t *\n\t * _.toNumber('3.2');\n\t * // => 3.2\n\t */\n\tfunction toNumber(value) {\n\t  if (typeof value == 'number') {\n\t    return value;\n\t  }\n\t  if (isSymbol(value)) {\n\t    return NAN;\n\t  }\n\t  if (isObject(value)) {\n\t    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n\t    value = isObject(other) ? (other + '') : other;\n\t  }\n\t  if (typeof value != 'string') {\n\t    return value === 0 ? value : +value;\n\t  }\n\t  value = value.replace(reTrim, '');\n\t  var isBinary = reIsBinary.test(value);\n\t  return (isBinary || reIsOctal.test(value))\n\t    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n\t    : (reIsBadHex.test(value) ? NAN : +value);\n\t}\n\t\n\tmodule.exports = throttle;\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 34 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _ControlsOrbit = __webpack_require__(35);\n\t\n\tvar _ControlsOrbit2 = _interopRequireDefault(_ControlsOrbit);\n\t\n\tvar Controls = {\n\t  Orbit: _ControlsOrbit2['default'],\n\t  orbit: _ControlsOrbit.orbit, orbit: _ControlsOrbit.orbit\n\t};\n\t\n\texports['default'] = Controls;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 35 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _eventemitter3 = __webpack_require__(2);\n\t\n\tvar _eventemitter32 = _interopRequireDefault(_eventemitter3);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _vendorOrbitControls = __webpack_require__(36);\n\t\n\tvar _vendorOrbitControls2 = _interopRequireDefault(_vendorOrbitControls);\n\t\n\tvar _TweenLite = __webpack_require__(38);\n\t\n\tvar _TweenLite2 = _interopRequireDefault(_TweenLite);\n\t\n\t// Prevent animation from pausing when tab is inactive\n\t_TweenLite2['default'].lagSmoothing(0);\n\t\n\tvar Orbit = (function (_EventEmitter) {\n\t  _inherits(Orbit, _EventEmitter);\n\t\n\t  function Orbit() {\n\t    _classCallCheck(this, Orbit);\n\t\n\t    _get(Object.getPrototypeOf(Orbit.prototype), 'constructor', this).call(this);\n\t  }\n\t\n\t  // Proxy control events\n\t  //\n\t  // There's currently no distinction between pan, orbit and zoom events\n\t\n\t  _createClass(Orbit, [{\n\t    key: '_initEvents',\n\t    value: function _initEvents() {\n\t      var _this = this;\n\t\n\t      this._controls.addEventListener('start', function (event) {\n\t        _this._world.emit('controlsMoveStart', event.target.target);\n\t      });\n\t\n\t      this._controls.addEventListener('change', function (event) {\n\t        _this._world.emit('controlsMove', event.target.target);\n\t      });\n\t\n\t      this._controls.addEventListener('end', function (event) {\n\t        _this._world.emit('controlsMoveEnd', event.target.target);\n\t      });\n\t    }\n\t\n\t    // Moving the camera along the [x,y,z] axis based on a target position\n\t  }, {\n\t    key: 'panTo',\n\t    value: function panTo(point, animate) {}\n\t  }, {\n\t    key: 'panBy',\n\t    value: function panBy(pointDelta, animate) {}\n\t\n\t    // Zooming the camera in and out\n\t  }, {\n\t    key: 'zoomTo',\n\t    value: function zoomTo(metres, animate) {}\n\t  }, {\n\t    key: 'zoomBy',\n\t    value: function zoomBy(metresDelta, animate) {}\n\t\n\t    // Force camera to look at something other than the target\n\t  }, {\n\t    key: 'lookAt',\n\t    value: function lookAt(point, animate) {}\n\t\n\t    // Make camera look at the target\n\t  }, {\n\t    key: 'lookAtTarget',\n\t    value: function lookAtTarget() {}\n\t\n\t    // Tilt (up and down)\n\t  }, {\n\t    key: 'tiltTo',\n\t    value: function tiltTo(angle, animate) {}\n\t  }, {\n\t    key: 'tiltBy',\n\t    value: function tiltBy(angleDelta, animate) {}\n\t\n\t    // Rotate (left and right)\n\t  }, {\n\t    key: 'rotateTo',\n\t    value: function rotateTo(angle, animate) {}\n\t  }, {\n\t    key: 'rotateBy',\n\t    value: function rotateBy(angleDelta, animate) {}\n\t\n\t    // Fly to the given point, animating pan and tilt/rotation to final position\n\t    // with nice zoom out and in\n\t    //\n\t    // TODO: Calling flyTo a second time before the previous animation has\n\t    // completed should immediately start the new animation from wherever the\n\t    // previous one has got to\n\t    //\n\t    // TODO: Long-distance pans should prevent the quadtree grid from trying to\n\t    // update by not firing the control update events every frame until the\n\t    // pan velocity calms down a bit\n\t    //\n\t    // TODO: Long-distance plans should zoom out further\n\t  }, {\n\t    key: 'flyToPoint',\n\t    value: function flyToPoint(point, duration, zoom) {\n\t      // Animation time in seconds\n\t      var animationTime = duration || 2;\n\t\n\t      var self = this;\n\t\n\t      this._flyTarget = new _three2['default'].Vector3(point.x, 0, point.y);\n\t\n\t      // Calculate delta from current position to fly target\n\t      var diff = new _three2['default'].Vector3().subVectors(this._controls.target, this._flyTarget);\n\t\n\t      this._flyTween = new _TweenLite2['default']({\n\t        x: 0,\n\t        z: 0,\n\t        // zoom: 0,\n\t        prev: {\n\t          x: 0,\n\t          z: 0\n\t        }\n\t      }, animationTime, {\n\t        x: diff.x,\n\t        z: diff.z,\n\t        // zoom: 1,\n\t        onUpdate: function onUpdate(tween) {\n\t          var controls = this._controls;\n\t\n\t          // Work out difference since last frame\n\t          var deltaX = tween.target.x - tween.target.prev.x;\n\t          var deltaZ = tween.target.z - tween.target.prev.z;\n\t\n\t          // Move some fraction toward the target point\n\t          controls.panLeft(deltaX, controls.object.matrix);\n\t          controls.panUp(deltaZ, controls.object.matrix);\n\t\n\t          tween.target.prev.x = tween.target.x;\n\t          tween.target.prev.z = tween.target.z;\n\t\n\t          // console.log(Math.sin((tween.target.zoom - 0.5) * Math.PI));\n\t\n\t          // TODO: Get zoom to dolly in and out on pan\n\t          // controls.object.zoom -= Math.sin((tween.target.zoom - 0.5) * Math.PI);\n\t          // controls.object.updateProjectionMatrix();\n\t        },\n\t        onComplete: function onComplete(tween) {\n\t          // console.log(`Arrived at flyTarget`);\n\t          self._flyTarget = null;\n\t        },\n\t        onUpdateParams: ['{self}'],\n\t        onCompleteParams: ['{self}'],\n\t        callbackScope: this,\n\t        ease: Power1.easeInOut\n\t      });\n\t\n\t      if (!zoom) {\n\t        return;\n\t      }\n\t\n\t      var zoomTime = animationTime / 2;\n\t\n\t      this._zoomTweenIn = new _TweenLite2['default']({\n\t        zoom: 0\n\t      }, zoomTime, {\n\t        zoom: 1,\n\t        onUpdate: function onUpdate(tween) {\n\t          var controls = this._controls;\n\t          controls.dollyIn(1 - 0.01 * tween.target.zoom);\n\t        },\n\t        onComplete: function onComplete(tween) {},\n\t        onUpdateParams: ['{self}'],\n\t        onCompleteParams: ['{self}'],\n\t        callbackScope: this,\n\t        ease: Power1.easeInOut\n\t      });\n\t\n\t      this._zoomTweenOut = new _TweenLite2['default']({\n\t        zoom: 0\n\t      }, zoomTime, {\n\t        zoom: 1,\n\t        delay: zoomTime,\n\t        onUpdate: function onUpdate(tween) {\n\t          var controls = this._controls;\n\t          controls.dollyOut(0.99 + 0.01 * tween.target.zoom);\n\t        },\n\t        onComplete: function onComplete(tween) {},\n\t        onUpdateParams: ['{self}'],\n\t        onCompleteParams: ['{self}'],\n\t        callbackScope: this,\n\t        ease: Power1.easeInOut\n\t      });\n\t    }\n\t  }, {\n\t    key: 'flyToLatLon',\n\t    value: function flyToLatLon(latlon, duration, noZoom) {\n\t      var point = this._world.latLonToPoint(latlon);\n\t      this.flyToPoint(point, duration, noZoom);\n\t    }\n\t\n\t    // TODO: Make this animate over a user-defined period of time\n\t    //\n\t    // Perhaps use TweenMax for now and implement as a more lightweight solution\n\t    // later on once it all works\n\t    // _animateFlyTo(delta) {\n\t    //   var controls = this._controls;\n\t    //\n\t    //   // this._controls.panLeft(50, controls._controls.object.matrix);\n\t    //   // this._controls.panUp(50, controls._controls.object.matrix);\n\t    //   // this._controls.dollyIn(this._controls.getZoomScale());\n\t    //   // this._controls.dollyOut(this._controls.getZoomScale());\n\t    //\n\t    //   // Calculate delta from current position to fly target\n\t    //   var diff = new THREE.Vector3().subVectors(this._controls.target, this._flyTarget);\n\t    //\n\t    //   // 1000 units per second\n\t    //   var speed = 1000 * (delta / 1000);\n\t    //\n\t    //   // Remove fly target after arrival and snap to target\n\t    //   if (diff.length() < 0.01) {\n\t    //     console.log(`Arrived at flyTarget`);\n\t    //     this._flyTarget = null;\n\t    //     speed = 1;\n\t    //   }\n\t    //\n\t    //   // Move some fraction toward the target point\n\t    //   controls.panLeft(diff.x * speed, controls.object.matrix);\n\t    //   controls.panUp(diff.z * speed, controls.object.matrix);\n\t    // }\n\t\n\t    // Proxy to OrbitControls.update()\n\t  }, {\n\t    key: 'update',\n\t    value: function update(delta) {\n\t      this._controls.update(delta);\n\t    }\n\t\n\t    // Add controls to world instance and store world reference\n\t  }, {\n\t    key: 'addTo',\n\t    value: function addTo(world) {\n\t      world.addControls(this);\n\t      return this;\n\t    }\n\t\n\t    // Internal method called by World.addControls to actually add the controls\n\t  }, {\n\t    key: '_addToWorld',\n\t    value: function _addToWorld(world) {\n\t      this._world = world;\n\t\n\t      // TODO: Override panLeft and panUp methods to prevent panning on Y axis\n\t      // See: http://stackoverflow.com/a/26188674/997339\n\t      this._controls = new _vendorOrbitControls2['default'](world._engine._camera, world._container);\n\t\n\t      // Disable keys for now as no events are fired for them anyway\n\t      this._controls.keys = false;\n\t\n\t      // 89 degrees\n\t      this._controls.maxPolarAngle = 1.5533;\n\t\n\t      // this._controls.enableDamping = true;\n\t      // this._controls.dampingFactor = 0.25;\n\t\n\t      this._initEvents();\n\t\n\t      this.emit('added');\n\t    }\n\t\n\t    // Destroys the controls and removes them from memory\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      // TODO: Remove event listeners\n\t\n\t      this._controls.dispose();\n\t\n\t      this._world = null;\n\t      this._controls = null;\n\t    }\n\t  }]);\n\t\n\t  return Orbit;\n\t})(_eventemitter32['default']);\n\t\n\texports['default'] = Orbit;\n\t\n\tvar noNew = function noNew() {\n\t  return new Orbit();\n\t};\n\t\n\t// Initialise without requiring new keyword\n\texports.orbit = noNew;\n\n/***/ },\n/* 36 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _hammerjs = __webpack_require__(37);\n\t\n\tvar _hammerjs2 = _interopRequireDefault(_hammerjs);\n\t\n\t/**\n\t * @author qiao / https://github.com/qiao\n\t * @author mrdoob / http://mrdoob.com\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author erich666 / http://erichaines.com\n\t */\n\t\n\t// This set of controls performs orbiting, dollying (zooming), and panning.\n\t// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n\t//\n\t//    Orbit - left mouse / touch: one finger move\n\t//    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n\t//    Pan - right mouse, or arrow keys / touch: three finter swipe\n\t\n\tvar OrbitControls = function OrbitControls(object, domElement) {\n\t\n\t\tthis.object = object;\n\t\n\t\tthis.domElement = domElement !== undefined ? domElement : document;\n\t\n\t\t// Set to false to disable this control\n\t\tthis.enabled = true;\n\t\n\t\t// \"target\" sets the location of focus, where the object orbits around\n\t\tthis.target = new _three2['default'].Vector3();\n\t\n\t\t// How far you can dolly in and out ( PerspectiveCamera only )\n\t\tthis.minDistance = 0;\n\t\tthis.maxDistance = Infinity;\n\t\n\t\t// How far you can zoom in and out ( OrthographicCamera only )\n\t\tthis.minZoom = 0;\n\t\tthis.maxZoom = Infinity;\n\t\n\t\t// How far you can orbit vertically, upper and lower limits.\n\t\t// Range is 0 to Math.PI radians.\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\t\n\t\t// How far you can orbit horizontally, upper and lower limits.\n\t\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n\t\tthis.minAzimuthAngle = -Infinity; // radians\n\t\tthis.maxAzimuthAngle = Infinity; // radians\n\t\n\t\t// Set to true to enable damping (inertia)\n\t\t// If damping is enabled, you must call controls.update() in your animation loop\n\t\tthis.enableDamping = false;\n\t\tthis.dampingFactor = 0.25;\n\t\n\t\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t\t// Set to false to disable zooming\n\t\tthis.enableZoom = true;\n\t\tthis.zoomSpeed = 1.0;\n\t\n\t\t// Set to false to disable rotating\n\t\tthis.enableRotate = true;\n\t\tthis.rotateSpeed = 1.0;\n\t\n\t\t// Set to false to disable panning\n\t\tthis.enablePan = true;\n\t\tthis.keyPanSpeed = 7.0; // pixels moved per arrow key push\n\t\n\t\t// Set to true to automatically rotate around the target\n\t\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\t\tthis.autoRotate = false;\n\t\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\t\n\t\t// Set to false to disable use of the keys\n\t\tthis.enableKeys = true;\n\t\n\t\t// The four arrow keys\n\t\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\t\n\t\t// Mouse buttons\n\t\tthis.mouseButtons = { ORBIT: _three2['default'].MOUSE.LEFT, ZOOM: _three2['default'].MOUSE.MIDDLE, PAN: _three2['default'].MOUSE.RIGHT };\n\t\n\t\t// for reset\n\t\tthis.target0 = this.target.clone();\n\t\tthis.position0 = this.object.position.clone();\n\t\tthis.zoom0 = this.object.zoom;\n\t\n\t\t//\n\t\t// public methods\n\t\t//\n\t\n\t\tthis.getPolarAngle = function () {\n\t\n\t\t\treturn phi;\n\t\t};\n\t\n\t\tthis.getAzimuthalAngle = function () {\n\t\n\t\t\treturn theta;\n\t\t};\n\t\n\t\tthis.reset = function () {\n\t\n\t\t\tscope.target.copy(scope.target0);\n\t\t\tscope.object.position.copy(scope.position0);\n\t\t\tscope.object.zoom = scope.zoom0;\n\t\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tscope.dispatchEvent(changeEvent);\n\t\n\t\t\tscope.update();\n\t\n\t\t\tstate = STATE.NONE;\n\t\t};\n\t\n\t\t// this method is exposed, but perhaps it would be better if we can make it private...\n\t\tthis.update = (function () {\n\t\n\t\t\tvar offset = new _three2['default'].Vector3();\n\t\n\t\t\t// so camera.up is the orbit axis\n\t\t\tvar quat = new _three2['default'].Quaternion().setFromUnitVectors(object.up, new _three2['default'].Vector3(0, 1, 0));\n\t\t\tvar quatInverse = quat.clone().inverse();\n\t\n\t\t\tvar lastPosition = new _three2['default'].Vector3();\n\t\t\tvar lastQuaternion = new _three2['default'].Quaternion();\n\t\n\t\t\treturn function () {\n\t\n\t\t\t\tvar position = scope.object.position;\n\t\n\t\t\t\toffset.copy(position).sub(scope.target);\n\t\n\t\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\t\toffset.applyQuaternion(quat);\n\t\n\t\t\t\t// angle from z-axis around y-axis\n\t\n\t\t\t\ttheta = Math.atan2(offset.x, offset.z);\n\t\n\t\t\t\t// angle from y-axis\n\t\n\t\t\t\tphi = Math.atan2(Math.sqrt(offset.x * offset.x + offset.z * offset.z), offset.y);\n\t\n\t\t\t\tif (scope.autoRotate && state === STATE.NONE) {\n\t\n\t\t\t\t\trotateLeft(getAutoRotationAngle());\n\t\t\t\t}\n\t\n\t\t\t\ttheta += thetaDelta;\n\t\t\t\tphi += phiDelta;\n\t\n\t\t\t\t// restrict theta to be between desired limits\n\t\t\t\ttheta = Math.max(scope.minAzimuthAngle, Math.min(scope.maxAzimuthAngle, theta));\n\t\n\t\t\t\t// restrict phi to be between desired limits\n\t\t\t\tphi = Math.max(scope.minPolarAngle, Math.min(scope.maxPolarAngle, phi));\n\t\n\t\t\t\t// restrict phi to be betwee EPS and PI-EPS\n\t\t\t\tphi = Math.max(EPS, Math.min(Math.PI - EPS, phi));\n\t\n\t\t\t\tvar radius = offset.length() * scale;\n\t\n\t\t\t\t// restrict radius to be between desired limits\n\t\t\t\tradius = Math.max(scope.minDistance, Math.min(scope.maxDistance, radius));\n\t\n\t\t\t\t// move target to panned location\n\t\t\t\tscope.target.add(panOffset);\n\t\n\t\t\t\toffset.x = radius * Math.sin(phi) * Math.sin(theta);\n\t\t\t\toffset.y = radius * Math.cos(phi);\n\t\t\t\toffset.z = radius * Math.sin(phi) * Math.cos(theta);\n\t\n\t\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\t\toffset.applyQuaternion(quatInverse);\n\t\n\t\t\t\tposition.copy(scope.target).add(offset);\n\t\n\t\t\t\tscope.object.lookAt(scope.target);\n\t\n\t\t\t\tif (scope.enableDamping === true) {\n\t\n\t\t\t\t\tthetaDelta *= 1 - scope.dampingFactor;\n\t\t\t\t\tphiDelta *= 1 - scope.dampingFactor;\n\t\t\t\t} else {\n\t\n\t\t\t\t\tthetaDelta = 0;\n\t\t\t\t\tphiDelta = 0;\n\t\t\t\t}\n\t\n\t\t\t\tscale = 1;\n\t\t\t\tpanOffset.set(0, 0, 0);\n\t\n\t\t\t\t// update condition is:\n\t\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\t\n\t\t\t\tif (zoomChanged || lastPosition.distanceToSquared(scope.object.position) > EPS || 8 * (1 - lastQuaternion.dot(scope.object.quaternion)) > EPS) {\n\t\n\t\t\t\t\tscope.dispatchEvent(changeEvent);\n\t\n\t\t\t\t\tlastPosition.copy(scope.object.position);\n\t\t\t\t\tlastQuaternion.copy(scope.object.quaternion);\n\t\t\t\t\tzoomChanged = false;\n\t\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\n\t\t\t\treturn false;\n\t\t\t};\n\t\t})();\n\t\n\t\tthis.dispose = function () {\n\t\n\t\t\tscope.domElement.removeEventListener('contextmenu', onContextMenu, false);\n\t\t\tscope.domElement.removeEventListener('mousedown', onMouseDown, false);\n\t\t\tscope.domElement.removeEventListener('mousewheel', onMouseWheel, false);\n\t\t\tscope.domElement.removeEventListener('MozMousePixelScroll', onMouseWheel, false); // firefox\n\t\n\t\t\tscope.domElement.removeEventListener('touchstart', onTouchStart, false);\n\t\t\tscope.domElement.removeEventListener('touchend', onTouchEnd, false);\n\t\t\tscope.domElement.removeEventListener('touchmove', onTouchMove, false);\n\t\n\t\t\tdocument.removeEventListener('mousemove', onMouseMove, false);\n\t\t\tdocument.removeEventListener('mouseup', onMouseUp, false);\n\t\t\tdocument.removeEventListener('mouseout', onMouseUp, false);\n\t\n\t\t\twindow.removeEventListener('keydown', onKeyDown, false);\n\t\n\t\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\t\t};\n\t\n\t\t//\n\t\t// internals\n\t\t//\n\t\n\t\tvar scope = this;\n\t\n\t\tvar changeEvent = { type: 'change' };\n\t\tvar startEvent = { type: 'start' };\n\t\tvar endEvent = { type: 'end' };\n\t\n\t\tvar STATE = { NONE: -1, ROTATE: 0, DOLLY: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_DOLLY: 4, TOUCH_PAN: 5 };\n\t\n\t\tvar state = STATE.NONE;\n\t\n\t\tvar EPS = 0.000001;\n\t\n\t\t// current position in spherical coordinates\n\t\tvar theta;\n\t\tvar phi;\n\t\n\t\tvar phiDelta = 0;\n\t\tvar thetaDelta = 0;\n\t\tvar scale = 1;\n\t\tvar panOffset = new _three2['default'].Vector3();\n\t\tvar zoomChanged = false;\n\t\n\t\tvar rotateStart = new _three2['default'].Vector2();\n\t\tvar rotateEnd = new _three2['default'].Vector2();\n\t\tvar rotateDelta = new _three2['default'].Vector2();\n\t\n\t\tvar panStart = new _three2['default'].Vector2();\n\t\tvar panEnd = new _three2['default'].Vector2();\n\t\tvar panDelta = new _three2['default'].Vector2();\n\t\n\t\tvar dollyStart = new _three2['default'].Vector2();\n\t\tvar dollyEnd = new _three2['default'].Vector2();\n\t\tvar dollyDelta = new _three2['default'].Vector2();\n\t\n\t\tfunction getAutoRotationAngle() {\n\t\n\t\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\t\t}\n\t\n\t\tfunction getZoomScale() {\n\t\n\t\t\treturn Math.pow(0.95, scope.zoomSpeed);\n\t\t}\n\t\n\t\tfunction rotateLeft(angle) {\n\t\n\t\t\tthetaDelta -= angle;\n\t\t}\n\t\n\t\tfunction rotateUp(angle) {\n\t\n\t\t\tphiDelta -= angle;\n\t\t}\n\t\n\t\tvar panLeft = (function () {\n\t\n\t\t\tvar v = new _three2['default'].Vector3();\n\t\n\t\t\t// return function panLeft( distance, objectMatrix ) {\n\t\t\t//\n\t\t\t// \tvar te = objectMatrix.elements;\n\t\t\t//\n\t\t\t// \t// get X column of objectMatrix\n\t\t\t// \tv.set( te[ 0 ], te[ 1 ], te[ 2 ] );\n\t\t\t//\n\t\t\t// \tv.multiplyScalar( - distance );\n\t\t\t//\n\t\t\t// \tpanOffset.add( v );\n\t\t\t//\n\t\t\t// };\n\t\n\t\t\t// Fixed panning to x/y plane\n\t\t\treturn function panLeft(distance, objectMatrix) {\n\t\t\t\tvar te = objectMatrix.elements;\n\t\t\t\t// var adjDist = distance / Math.cos(phi);\n\t\n\t\t\t\tv.set(te[0], 0, te[2]);\n\t\t\t\tv.multiplyScalar(-distance);\n\t\n\t\t\t\tpanOffset.add(v);\n\t\t\t};\n\t\t})();\n\t\n\t\t// Fixed panning to x/y plane\n\t\tvar panUp = (function () {\n\t\n\t\t\tvar v = new _three2['default'].Vector3();\n\t\n\t\t\t// return function panUp( distance, objectMatrix ) {\n\t\t\t//\n\t\t\t// \tvar te = objectMatrix.elements;\n\t\t\t//\n\t\t\t// \t// get Y column of objectMatrix\n\t\t\t// \tv.set( te[ 4 ], te[ 5 ], te[ 6 ] );\n\t\t\t//\n\t\t\t// \tv.multiplyScalar( distance );\n\t\t\t//\n\t\t\t// \tpanOffset.add( v );\n\t\t\t//\n\t\t\t// };\n\t\n\t\t\treturn function panUp(distance, objectMatrix) {\n\t\t\t\tvar te = objectMatrix.elements;\n\t\t\t\tvar adjDist = distance / Math.cos(phi);\n\t\n\t\t\t\tv.set(te[4], 0, te[6]);\n\t\t\t\tv.multiplyScalar(adjDist);\n\t\n\t\t\t\tpanOffset.add(v);\n\t\t\t};\n\t\t})();\n\t\n\t\t// deltaX and deltaY are in pixels; right and down are positive\n\t\tvar pan = (function () {\n\t\n\t\t\tvar offset = new _three2['default'].Vector3();\n\t\n\t\t\treturn function (deltaX, deltaY) {\n\t\n\t\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\t\n\t\t\t\tif (scope.object instanceof _three2['default'].PerspectiveCamera) {\n\t\n\t\t\t\t\t// perspective\n\t\t\t\t\tvar position = scope.object.position;\n\t\t\t\t\toffset.copy(position).sub(scope.target);\n\t\t\t\t\tvar targetDistance = offset.length();\n\t\n\t\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\t\ttargetDistance *= Math.tan(scope.object.fov / 2 * Math.PI / 180.0);\n\t\n\t\t\t\t\t// we actually don't use screenWidth, since perspective camera is fixed to screen height\n\t\t\t\t\tpanLeft(2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix);\n\t\t\t\t\tpanUp(2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix);\n\t\t\t\t} else if (scope.object instanceof _three2['default'].OrthographicCamera) {\n\t\n\t\t\t\t\t// orthographic\n\t\t\t\t\tpanLeft(deltaX * (scope.object.right - scope.object.left) / element.clientWidth, scope.object.matrix);\n\t\t\t\t\tpanUp(deltaY * (scope.object.top - scope.object.bottom) / element.clientHeight, scope.object.matrix);\n\t\t\t\t} else {\n\t\n\t\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\t\tconsole.warn('WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.');\n\t\t\t\t\tscope.enablePan = false;\n\t\t\t\t}\n\t\t\t};\n\t\t})();\n\t\n\t\tfunction dollyIn(dollyScale) {\n\t\n\t\t\tif (scope.object instanceof _three2['default'].PerspectiveCamera) {\n\t\n\t\t\t\tscale /= dollyScale;\n\t\t\t} else if (scope.object instanceof _three2['default'].OrthographicCamera) {\n\t\n\t\t\t\tscope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom * dollyScale));\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\t\t\t} else {\n\t\n\t\t\t\tconsole.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.');\n\t\t\t\tscope.enableZoom = false;\n\t\t\t}\n\t\t}\n\t\n\t\tfunction dollyOut(dollyScale) {\n\t\n\t\t\tif (scope.object instanceof _three2['default'].PerspectiveCamera) {\n\t\n\t\t\t\tscale *= dollyScale;\n\t\t\t} else if (scope.object instanceof _three2['default'].OrthographicCamera) {\n\t\n\t\t\t\tscope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom / dollyScale));\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\t\t\t} else {\n\t\n\t\t\t\tconsole.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.');\n\t\t\t\tscope.enableZoom = false;\n\t\t\t}\n\t\t}\n\t\n\t\t//\n\t\t// event callbacks - update the object state\n\t\t//\n\t\n\t\tfunction handleMouseDownRotate(event) {\n\t\n\t\t\t//console.log( 'handleMouseDownRotate' );\n\t\n\t\t\trotateStart.set(event.clientX, event.clientY);\n\t\t}\n\t\n\t\tfunction handleMouseDownDolly(event) {\n\t\n\t\t\t//console.log( 'handleMouseDownDolly' );\n\t\n\t\t\tdollyStart.set(event.clientX, event.clientY);\n\t\t}\n\t\n\t\tfunction handleMouseDownPan(event) {\n\t\n\t\t\t//console.log( 'handleMouseDownPan' );\n\t\n\t\t\tpanStart.set(event.clientX, event.clientY);\n\t\t}\n\t\n\t\tfunction handleMouseMoveRotate(event) {\n\t\n\t\t\t//console.log( 'handleMouseMoveRotate' );\n\t\n\t\t\trotateEnd.set(event.clientX, event.clientY);\n\t\t\trotateDelta.subVectors(rotateEnd, rotateStart);\n\t\n\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\t\n\t\t\t// rotating across whole screen goes 360 degrees around\n\t\t\trotateLeft(2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed);\n\t\n\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\t\trotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed);\n\t\n\t\t\trotateStart.copy(rotateEnd);\n\t\n\t\t\tscope.update();\n\t\t}\n\t\n\t\tfunction handleMouseMoveDolly(event) {\n\t\n\t\t\t//console.log( 'handleMouseMoveDolly' );\n\t\n\t\t\tdollyEnd.set(event.clientX, event.clientY);\n\t\n\t\t\tdollyDelta.subVectors(dollyEnd, dollyStart);\n\t\n\t\t\tif (dollyDelta.y > 0) {\n\t\n\t\t\t\tdollyIn(getZoomScale());\n\t\t\t} else if (dollyDelta.y < 0) {\n\t\n\t\t\t\tdollyOut(getZoomScale());\n\t\t\t}\n\t\n\t\t\tdollyStart.copy(dollyEnd);\n\t\n\t\t\tscope.update();\n\t\t}\n\t\n\t\tfunction handleMouseMovePan(event) {\n\t\n\t\t\t//console.log( 'handleMouseMovePan' );\n\t\n\t\t\tpanEnd.set(event.clientX, event.clientY);\n\t\n\t\t\tpanDelta.subVectors(panEnd, panStart);\n\t\n\t\t\tpan(panDelta.x, panDelta.y);\n\t\n\t\t\tpanStart.copy(panEnd);\n\t\n\t\t\tscope.update();\n\t\t}\n\t\n\t\tfunction handleMouseUp(event) {\n\t\n\t\t\t//console.log( 'handleMouseUp' );\n\t\n\t\t}\n\t\n\t\tfunction handleMouseWheel(event) {\n\t\n\t\t\t//console.log( 'handleMouseWheel' );\n\t\n\t\t\tvar delta = 0;\n\t\n\t\t\tif (event.wheelDelta !== undefined) {\n\t\n\t\t\t\t// WebKit / Opera / Explorer 9\n\t\n\t\t\t\tdelta = event.wheelDelta;\n\t\t\t} else if (event.detail !== undefined) {\n\t\n\t\t\t\t// Firefox\n\t\n\t\t\t\tdelta = -event.detail;\n\t\t\t}\n\t\n\t\t\tif (delta > 0) {\n\t\n\t\t\t\tdollyOut(getZoomScale());\n\t\t\t} else if (delta < 0) {\n\t\n\t\t\t\tdollyIn(getZoomScale());\n\t\t\t}\n\t\n\t\t\tscope.update();\n\t\t}\n\t\n\t\tfunction handleKeyDown(event) {\n\t\n\t\t\t//console.log( 'handleKeyDown' );\n\t\n\t\t\tswitch (event.keyCode) {\n\t\n\t\t\t\tcase scope.keys.UP:\n\t\t\t\t\tpan(0, scope.keyPanSpeed);\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\t\tpan(0, -scope.keyPanSpeed);\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase scope.keys.LEFT:\n\t\t\t\t\tpan(scope.keyPanSpeed, 0);\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase scope.keys.RIGHT:\n\t\t\t\t\tpan(-scope.keyPanSpeed, 0);\n\t\t\t\t\tscope.update();\n\t\t\t\t\tbreak;\n\t\n\t\t\t}\n\t\t}\n\t\n\t\tfunction handleTouchStartRotate(event) {\n\t\n\t\t\t//console.log( 'handleTouchStartRotate' );\n\t\n\t\t\trotateStart.set(event.pointers[0].pageX, event.pointers[0].pageY);\n\t\t}\n\t\n\t\tfunction handleTouchStartDolly(event) {\n\t\n\t\t\t//console.log( 'handleTouchStartDolly' );\n\t\n\t\t\tvar dx = event.pointers[0].pageX - event.pointers[1].pageX;\n\t\t\tvar dy = event.pointers[0].pageY - event.pointers[1].pageY;\n\t\n\t\t\tvar distance = Math.sqrt(dx * dx + dy * dy);\n\t\n\t\t\tdollyStart.set(0, distance);\n\t\t}\n\t\n\t\tfunction handleTouchStartPan(event) {\n\t\n\t\t\t//console.log( 'handleTouchStartPan' );\n\t\n\t\t\tpanStart.set(event.deltaX, event.deltaY);\n\t\t}\n\t\n\t\tfunction handleTouchMoveRotate(event) {\n\t\n\t\t\t//console.log( 'handleTouchMoveRotate' );\n\t\n\t\t\trotateEnd.set(event.pointers[0].pageX, event.pointers[0].pageY);\n\t\t\trotateDelta.subVectors(rotateEnd, rotateStart);\n\t\n\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\t\n\t\t\t// rotating across whole screen goes 360 degrees around\n\t\t\trotateLeft(2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed);\n\t\n\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\t\trotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed);\n\t\n\t\t\trotateStart.copy(rotateEnd);\n\t\n\t\t\tscope.update();\n\t\t}\n\t\n\t\tfunction handleTouchMoveDolly(event) {\n\t\n\t\t\t//console.log( 'handleTouchMoveDolly' );\n\t\n\t\t\tvar dx = event.pointers[0].pageX - event.pointers[1].pageX;\n\t\t\tvar dy = event.pointers[0].pageY - event.pointers[1].pageY;\n\t\n\t\t\tvar distance = Math.sqrt(dx * dx + dy * dy);\n\t\n\t\t\tdollyEnd.set(0, distance);\n\t\n\t\t\tdollyDelta.subVectors(dollyEnd, dollyStart);\n\t\n\t\t\tif (dollyDelta.y > 0) {\n\t\n\t\t\t\tdollyOut(getZoomScale());\n\t\t\t} else if (dollyDelta.y < 0) {\n\t\n\t\t\t\tdollyIn(getZoomScale());\n\t\t\t}\n\t\n\t\t\tdollyStart.copy(dollyEnd);\n\t\n\t\t\tscope.update();\n\t\t}\n\t\n\t\tfunction handleTouchMovePan(event) {\n\t\n\t\t\t//console.log( 'handleTouchMovePan' );\n\t\n\t\t\tpanEnd.set(event.deltaX, event.deltaY);\n\t\n\t\t\tpanDelta.subVectors(panEnd, panStart);\n\t\n\t\t\tpan(panDelta.x, panDelta.y);\n\t\n\t\t\tpanStart.copy(panEnd);\n\t\n\t\t\tscope.update();\n\t\t}\n\t\n\t\tfunction handleTouchEnd(event) {}\n\t\n\t\t//console.log( 'handleTouchEnd' );\n\t\n\t\t//\n\t\t// event handlers - FSM: listen for events and reset state\n\t\t//\n\t\n\t\tfunction onMouseDown(event) {\n\t\n\t\t\tif (scope.enabled === false) return;\n\t\n\t\t\tevent.preventDefault();\n\t\n\t\t\tif (event.button === scope.mouseButtons.ORBIT) {\n\t\n\t\t\t\tif (scope.enableRotate === false) return;\n\t\n\t\t\t\thandleMouseDownRotate(event);\n\t\n\t\t\t\tstate = STATE.ROTATE;\n\t\t\t} else if (event.button === scope.mouseButtons.ZOOM) {\n\t\n\t\t\t\tif (scope.enableZoom === false) return;\n\t\n\t\t\t\thandleMouseDownDolly(event);\n\t\n\t\t\t\tstate = STATE.DOLLY;\n\t\t\t} else if (event.button === scope.mouseButtons.PAN) {\n\t\n\t\t\t\tif (scope.enablePan === false) return;\n\t\n\t\t\t\thandleMouseDownPan(event);\n\t\n\t\t\t\tstate = STATE.PAN;\n\t\t\t}\n\t\n\t\t\tif (state !== STATE.NONE) {\n\t\n\t\t\t\tdocument.addEventListener('mousemove', onMouseMove, false);\n\t\t\t\tdocument.addEventListener('mouseup', onMouseUp, false);\n\t\t\t\tdocument.addEventListener('mouseout', onMouseUp, false);\n\t\n\t\t\t\tscope.dispatchEvent(startEvent);\n\t\t\t}\n\t\t}\n\t\n\t\tfunction onMouseMove(event) {\n\t\n\t\t\tif (scope.enabled === false) return;\n\t\n\t\t\tevent.preventDefault();\n\t\n\t\t\tif (state === STATE.ROTATE) {\n\t\n\t\t\t\tif (scope.enableRotate === false) return;\n\t\n\t\t\t\thandleMouseMoveRotate(event);\n\t\t\t} else if (state === STATE.DOLLY) {\n\t\n\t\t\t\tif (scope.enableZoom === false) return;\n\t\n\t\t\t\thandleMouseMoveDolly(event);\n\t\t\t} else if (state === STATE.PAN) {\n\t\n\t\t\t\tif (scope.enablePan === false) return;\n\t\n\t\t\t\thandleMouseMovePan(event);\n\t\t\t}\n\t\t}\n\t\n\t\tfunction onMouseUp(event) {\n\t\n\t\t\tif (scope.enabled === false) return;\n\t\n\t\t\thandleMouseUp(event);\n\t\n\t\t\tdocument.removeEventListener('mousemove', onMouseMove, false);\n\t\t\tdocument.removeEventListener('mouseup', onMouseUp, false);\n\t\t\tdocument.removeEventListener('mouseout', onMouseUp, false);\n\t\n\t\t\tscope.dispatchEvent(endEvent);\n\t\n\t\t\tstate = STATE.NONE;\n\t\t}\n\t\n\t\tfunction onMouseWheel(event) {\n\t\n\t\t\tif (scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE) return;\n\t\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\n\t\t\thandleMouseWheel(event);\n\t\n\t\t\tscope.dispatchEvent(startEvent); // not sure why these are here...\n\t\t\tscope.dispatchEvent(endEvent);\n\t\t}\n\t\n\t\tfunction onKeyDown(event) {\n\t\n\t\t\tif (scope.enabled === false || scope.enableKeys === false || scope.enablePan === false) return;\n\t\n\t\t\thandleKeyDown(event);\n\t\t}\n\t\n\t\tfunction onTouchStart(event) {\n\t\n\t\t\tif (scope.enabled === false) return;\n\t\n\t\t\tswitch (event.touches.length) {\n\t\n\t\t\t\tcase 1:\n\t\t\t\t\t// one-fingered touch: rotate\n\t\n\t\t\t\t\tif (scope.enableRotate === false) return;\n\t\n\t\t\t\t\thandleTouchStartRotate(event);\n\t\n\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\t\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase 2:\n\t\t\t\t\t// two-fingered touch: dolly\n\t\n\t\t\t\t\tif (scope.enableZoom === false) return;\n\t\n\t\t\t\t\thandleTouchStartDolly(event);\n\t\n\t\t\t\t\tstate = STATE.TOUCH_DOLLY;\n\t\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase 3:\n\t\t\t\t\t// three-fingered touch: pan\n\t\n\t\t\t\t\tif (scope.enablePan === false) return;\n\t\n\t\t\t\t\thandleTouchStartPan(event);\n\t\n\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\t\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tdefault:\n\t\n\t\t\t\t\tstate = STATE.NONE;\n\t\n\t\t\t}\n\t\n\t\t\tif (state !== STATE.NONE) {\n\t\n\t\t\t\tscope.dispatchEvent(startEvent);\n\t\t\t}\n\t\t}\n\t\n\t\tfunction onTouchMove(event) {\n\t\n\t\t\tif (scope.enabled === false) return;\n\t\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\n\t\t\tswitch (event.touches.length) {\n\t\n\t\t\t\tcase 1:\n\t\t\t\t\t// one-fingered touch: rotate\n\t\n\t\t\t\t\tif (scope.enableRotate === false) return;\n\t\t\t\t\tif (state !== STATE.TOUCH_ROTATE) return; // is this needed?...\n\t\n\t\t\t\t\thandleTouchMoveRotate(event);\n\t\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase 2:\n\t\t\t\t\t// two-fingered touch: dolly\n\t\n\t\t\t\t\tif (scope.enableZoom === false) return;\n\t\t\t\t\tif (state !== STATE.TOUCH_DOLLY) return; // is this needed?...\n\t\n\t\t\t\t\thandleTouchMoveDolly(event);\n\t\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase 3:\n\t\t\t\t\t// three-fingered touch: pan\n\t\n\t\t\t\t\tif (scope.enablePan === false) return;\n\t\t\t\t\tif (state !== STATE.TOUCH_PAN) return; // is this needed?...\n\t\n\t\t\t\t\thandleTouchMovePan(event);\n\t\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tdefault:\n\t\n\t\t\t\t\tstate = STATE.NONE;\n\t\n\t\t\t}\n\t\t}\n\t\n\t\tfunction onTouchEnd(event) {\n\t\n\t\t\tif (scope.enabled === false) return;\n\t\n\t\t\thandleTouchEnd(event);\n\t\n\t\t\tscope.dispatchEvent(endEvent);\n\t\n\t\t\tstate = STATE.NONE;\n\t\t}\n\t\n\t\tfunction onContextMenu(event) {\n\t\n\t\t\tevent.preventDefault();\n\t\t}\n\t\n\t\t//\n\t\n\t\tscope.domElement.addEventListener('contextmenu', onContextMenu, false);\n\t\n\t\tscope.domElement.addEventListener('mousedown', onMouseDown, false);\n\t\tscope.domElement.addEventListener('mousewheel', onMouseWheel, false);\n\t\tscope.domElement.addEventListener('MozMousePixelScroll', onMouseWheel, false); // firefox\n\t\n\t\t// scope.domElement.addEventListener( 'touchstart', onTouchStart, false );\n\t\t// scope.domElement.addEventListener( 'touchend', onTouchEnd, false );\n\t\t// scope.domElement.addEventListener( 'touchmove', onTouchMove, false );\n\t\n\t\tscope.hammer = new _hammerjs2['default'](scope.domElement);\n\t\n\t\tscope.hammer.get('pan').set({\n\t\t\tpointers: 0,\n\t\t\tdirection: _hammerjs2['default'].DIRECTION_ALL\n\t\t});\n\t\n\t\tscope.hammer.get('pinch').set({\n\t\t\tenable: true,\n\t\t\tthreshold: 0.1\n\t\t});\n\t\n\t\tscope.hammer.on('panstart', function (event) {\n\t\t\tif (scope.enabled === false) {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tif (event.pointerType === 'mouse') {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tif (event.pointers.length === 1) {\n\t\t\t\tif (scope.enablePan === false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\thandleTouchStartPan(event);\n\t\t\t\t// panStart.set(event.deltaX, event.deltaY);\n\t\n\t\t\t\tstate = STATE.TOUCH_PAN;\n\t\t\t} else if (event.pointers.length === 2) {\n\t\t\t\tif (scope.enableRotate === false) return;\n\t\n\t\t\t\thandleTouchStartRotate(event);\n\t\n\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\t\t\t}\n\t\n\t\t\tif (state !== STATE.NONE) {\n\t\t\t\tscope.dispatchEvent(startEvent);\n\t\t\t}\n\t\t});\n\t\n\t\tscope.hammer.on('panend', function (event) {\n\t\t\tif (event.pointerType === 'mouse') {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tonTouchEnd(event);\n\t\t});\n\t\n\t\tscope.hammer.on('panmove', function (event) {\n\t\t\tif (scope.enabled === false) return;\n\t\n\t\t\tif (event.pointerType === 'mouse') {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\t// event.preventDefault();\n\t\t\t// event.stopPropagation();\n\t\n\t\t\tif (event.pointers.length === 1) {\n\t\t\t\tif (scope.enablePan === false) return;\n\t\t\t\tif (state !== STATE.TOUCH_PAN) return; // is this needed?...\n\t\n\t\t\t\thandleTouchMovePan(event);\n\t\n\t\t\t\t// panEnd.set( event.deltaX, event.deltaY );\n\t\t\t\t//\n\t\t\t\t// panDelta.subVectors( panEnd, panStart );\n\t\t\t\t//\n\t\t\t\t// pan( panDelta.x, panDelta.y );\n\t\t\t\t//\n\t\t\t\t// panStart.copy( panEnd );\n\t\t\t\t//\n\t\t\t\t// scope.update();\n\t\t\t} else if (event.pointers.length === 2) {\n\t\t\t\t\tif (scope.enableRotate === false) return;\n\t\t\t\t\tif (state !== STATE.TOUCH_ROTATE) return; // is this needed?...\n\t\n\t\t\t\t\thandleTouchMoveRotate(event);\n\t\t\t\t}\n\t\t});\n\t\n\t\tscope.hammer.on('pinchstart', function (event) {\n\t\t\tif (scope.enabled === false) return;\n\t\n\t\t\tif (event.pointerType === 'mouse') {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tif (scope.enableZoom === false) return;\n\t\n\t\t\thandleTouchStartDolly(event);\n\t\n\t\t\t// var dx = event.pointers[ 0 ].pageX - event.pointers[ 1 ].pageX;\n\t\t\t// var dy = event.pointers[ 0 ].pageY - event.pointers[ 1 ].pageY;\n\t\t\t//\n\t\t\t// var distance = Math.sqrt( dx * dx + dy * dy );\n\t\t\t//\n\t\t\t// dollyStart.set( 0, distance );\n\t\t\t//\n\t\t\tstate = STATE.TOUCH_DOLLY;\n\t\n\t\t\tif (state !== STATE.NONE) {\n\t\t\t\tscope.dispatchEvent(startEvent);\n\t\t\t}\n\t\t});\n\t\n\t\tscope.hammer.on('pinchend', function (event) {\n\t\t\tif (event.pointerType === 'mouse') {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tonTouchEnd(event);\n\t\t});\n\t\n\t\tscope.hammer.on('pinchmove', function (event) {\n\t\t\tif (scope.enabled === false) return;\n\t\n\t\t\tif (event.pointerType === 'mouse') {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\t// event.preventDefault();\n\t\t\t// event.stopPropagation();\n\t\n\t\t\tif (scope.enableZoom === false) return;\n\t\t\tif (state !== STATE.TOUCH_DOLLY) return; // is this needed?...\n\t\n\t\t\thandleTouchMoveDolly(event);\n\t\n\t\t\t// var dx = event.pointers[ 0 ].pageX - event.pointers[ 1 ].pageX;\n\t\t\t// var dy = event.pointers[ 0 ].pageY - event.pointers[ 1 ].pageY;\n\t\t\t//\n\t\t\t// var distance = Math.sqrt( dx * dx + dy * dy );\n\t\t\t//\n\t\t\t// dollyEnd.set( 0, distance );\n\t\t\t//\n\t\t\t// dollyDelta.subVectors( dollyEnd, dollyStart );\n\t\t\t//\n\t\t\t// if ( dollyDelta.y > 0 ) {\n\t\t\t//\n\t\t\t// \tdollyOut( getZoomScale() );\n\t\t\t//\n\t\t\t// } else if ( dollyDelta.y < 0 ) {\n\t\t\t//\n\t\t\t// \tdollyIn( getZoomScale() );\n\t\t\t//\n\t\t\t// }\n\t\t\t//\n\t\t\t// dollyStart.copy( dollyEnd );\n\t\t\t//\n\t\t\t// scope.update();\n\t\t});\n\t\n\t\twindow.addEventListener('keydown', onKeyDown, false);\n\t\n\t\t// Expose controls methods for programmatic control\n\t\tthis.panLeft = panLeft;\n\t\tthis.panUp = panUp;\n\t\tthis.pan = pan;\n\t\tthis.dollyIn = dollyIn;\n\t\tthis.dollyOut = dollyOut;\n\t\tthis.getZoomScale = getZoomScale;\n\t\tthis.rotateLeft = rotateLeft;\n\t\tthis.rotateUp = rotateUp;\n\t\n\t\t// force an update at start\n\t\n\t\tthis.update();\n\t};\n\t\n\tOrbitControls.prototype = Object.create(_three2['default'].EventDispatcher.prototype);\n\tOrbitControls.prototype.constructor = _three2['default'].OrbitControls;\n\t\n\tObject.defineProperties(OrbitControls.prototype, {\n\t\n\t\tcenter: {\n\t\n\t\t\tget: function get() {\n\t\n\t\t\t\tconsole.warn('THREE.OrbitControls: .center has been renamed to .target');\n\t\t\t\treturn this.target;\n\t\t\t}\n\t\n\t\t},\n\t\n\t\t// backward compatibility\n\t\n\t\tnoZoom: {\n\t\n\t\t\tget: function get() {\n\t\n\t\t\t\tconsole.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.');\n\t\t\t\treturn !this.enableZoom;\n\t\t\t},\n\t\n\t\t\tset: function set(value) {\n\t\n\t\t\t\tconsole.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.');\n\t\t\t\tthis.enableZoom = !value;\n\t\t\t}\n\t\n\t\t},\n\t\n\t\tnoRotate: {\n\t\n\t\t\tget: function get() {\n\t\n\t\t\t\tconsole.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.');\n\t\t\t\treturn !this.enableRotate;\n\t\t\t},\n\t\n\t\t\tset: function set(value) {\n\t\n\t\t\t\tconsole.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.');\n\t\t\t\tthis.enableRotate = !value;\n\t\t\t}\n\t\n\t\t},\n\t\n\t\tnoPan: {\n\t\n\t\t\tget: function get() {\n\t\n\t\t\t\tconsole.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.');\n\t\t\t\treturn !this.enablePan;\n\t\t\t},\n\t\n\t\t\tset: function set(value) {\n\t\n\t\t\t\tconsole.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.');\n\t\t\t\tthis.enablePan = !value;\n\t\t\t}\n\t\n\t\t},\n\t\n\t\tnoKeys: {\n\t\n\t\t\tget: function get() {\n\t\n\t\t\t\tconsole.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.');\n\t\t\t\treturn !this.enableKeys;\n\t\t\t},\n\t\n\t\t\tset: function set(value) {\n\t\n\t\t\t\tconsole.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.');\n\t\t\t\tthis.enableKeys = !value;\n\t\t\t}\n\t\n\t\t},\n\t\n\t\tstaticMoving: {\n\t\n\t\t\tget: function get() {\n\t\n\t\t\t\tconsole.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.');\n\t\t\t\treturn !this.constraint.enableDamping;\n\t\t\t},\n\t\n\t\t\tset: function set(value) {\n\t\n\t\t\t\tconsole.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.');\n\t\t\t\tthis.constraint.enableDamping = !value;\n\t\t\t}\n\t\n\t\t},\n\t\n\t\tdynamicDampingFactor: {\n\t\n\t\t\tget: function get() {\n\t\n\t\t\t\tconsole.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.');\n\t\t\t\treturn this.constraint.dampingFactor;\n\t\t\t},\n\t\n\t\t\tset: function set(value) {\n\t\n\t\t\t\tconsole.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.');\n\t\t\t\tthis.constraint.dampingFactor = value;\n\t\t\t}\n\t\n\t\t}\n\t\n\t});\n\t\n\texports['default'] = OrbitControls;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 37 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_RESULT__;/*! Hammer.JS - v2.0.7 - 2016-04-22\n\t * http://hammerjs.github.io/\n\t *\n\t * Copyright (c) 2016 Jorik Tangelder;\n\t * Licensed under the MIT license */\n\t(function(window, document, exportName, undefined) {\n\t  'use strict';\n\t\n\tvar VENDOR_PREFIXES = ['', 'webkit', 'Moz', 'MS', 'ms', 'o'];\n\tvar TEST_ELEMENT = document.createElement('div');\n\t\n\tvar TYPE_FUNCTION = 'function';\n\t\n\tvar round = Math.round;\n\tvar abs = Math.abs;\n\tvar now = Date.now;\n\t\n\t/**\n\t * set a timeout with a given scope\n\t * @param {Function} fn\n\t * @param {Number} timeout\n\t * @param {Object} context\n\t * @returns {number}\n\t */\n\tfunction setTimeoutContext(fn, timeout, context) {\n\t    return setTimeout(bindFn(fn, context), timeout);\n\t}\n\t\n\t/**\n\t * if the argument is an array, we want to execute the fn on each entry\n\t * if it aint an array we don't want to do a thing.\n\t * this is used by all the methods that accept a single and array argument.\n\t * @param {*|Array} arg\n\t * @param {String} fn\n\t * @param {Object} [context]\n\t * @returns {Boolean}\n\t */\n\tfunction invokeArrayArg(arg, fn, context) {\n\t    if (Array.isArray(arg)) {\n\t        each(arg, context[fn], context);\n\t        return true;\n\t    }\n\t    return false;\n\t}\n\t\n\t/**\n\t * walk objects and arrays\n\t * @param {Object} obj\n\t * @param {Function} iterator\n\t * @param {Object} context\n\t */\n\tfunction each(obj, iterator, context) {\n\t    var i;\n\t\n\t    if (!obj) {\n\t        return;\n\t    }\n\t\n\t    if (obj.forEach) {\n\t        obj.forEach(iterator, context);\n\t    } else if (obj.length !== undefined) {\n\t        i = 0;\n\t        while (i < obj.length) {\n\t            iterator.call(context, obj[i], i, obj);\n\t            i++;\n\t        }\n\t    } else {\n\t        for (i in obj) {\n\t            obj.hasOwnProperty(i) && iterator.call(context, obj[i], i, obj);\n\t        }\n\t    }\n\t}\n\t\n\t/**\n\t * wrap a method with a deprecation warning and stack trace\n\t * @param {Function} method\n\t * @param {String} name\n\t * @param {String} message\n\t * @returns {Function} A new function wrapping the supplied method.\n\t */\n\tfunction deprecate(method, name, message) {\n\t    var deprecationMessage = 'DEPRECATED METHOD: ' + name + '\\n' + message + ' AT \\n';\n\t    return function() {\n\t        var e = new Error('get-stack-trace');\n\t        var stack = e && e.stack ? e.stack.replace(/^[^\\(]+?[\\n$]/gm, '')\n\t            .replace(/^\\s+at\\s+/gm, '')\n\t            .replace(/^Object.<anonymous>\\s*\\(/gm, '{anonymous}()@') : 'Unknown Stack Trace';\n\t\n\t        var log = window.console && (window.console.warn || window.console.log);\n\t        if (log) {\n\t            log.call(window.console, deprecationMessage, stack);\n\t        }\n\t        return method.apply(this, arguments);\n\t    };\n\t}\n\t\n\t/**\n\t * extend object.\n\t * means that properties in dest will be overwritten by the ones in src.\n\t * @param {Object} target\n\t * @param {...Object} objects_to_assign\n\t * @returns {Object} target\n\t */\n\tvar assign;\n\tif (typeof Object.assign !== 'function') {\n\t    assign = function assign(target) {\n\t        if (target === undefined || target === null) {\n\t            throw new TypeError('Cannot convert undefined or null to object');\n\t        }\n\t\n\t        var output = Object(target);\n\t        for (var index = 1; index < arguments.length; index++) {\n\t            var source = arguments[index];\n\t            if (source !== undefined && source !== null) {\n\t                for (var nextKey in source) {\n\t                    if (source.hasOwnProperty(nextKey)) {\n\t                        output[nextKey] = source[nextKey];\n\t                    }\n\t                }\n\t            }\n\t        }\n\t        return output;\n\t    };\n\t} else {\n\t    assign = Object.assign;\n\t}\n\t\n\t/**\n\t * extend object.\n\t * means that properties in dest will be overwritten by the ones in src.\n\t * @param {Object} dest\n\t * @param {Object} src\n\t * @param {Boolean} [merge=false]\n\t * @returns {Object} dest\n\t */\n\tvar extend = deprecate(function extend(dest, src, merge) {\n\t    var keys = Object.keys(src);\n\t    var i = 0;\n\t    while (i < keys.length) {\n\t        if (!merge || (merge && dest[keys[i]] === undefined)) {\n\t            dest[keys[i]] = src[keys[i]];\n\t        }\n\t        i++;\n\t    }\n\t    return dest;\n\t}, 'extend', 'Use `assign`.');\n\t\n\t/**\n\t * merge the values from src in the dest.\n\t * means that properties that exist in dest will not be overwritten by src\n\t * @param {Object} dest\n\t * @param {Object} src\n\t * @returns {Object} dest\n\t */\n\tvar merge = deprecate(function merge(dest, src) {\n\t    return extend(dest, src, true);\n\t}, 'merge', 'Use `assign`.');\n\t\n\t/**\n\t * simple class inheritance\n\t * @param {Function} child\n\t * @param {Function} base\n\t * @param {Object} [properties]\n\t */\n\tfunction inherit(child, base, properties) {\n\t    var baseP = base.prototype,\n\t        childP;\n\t\n\t    childP = child.prototype = Object.create(baseP);\n\t    childP.constructor = child;\n\t    childP._super = baseP;\n\t\n\t    if (properties) {\n\t        assign(childP, properties);\n\t    }\n\t}\n\t\n\t/**\n\t * simple function bind\n\t * @param {Function} fn\n\t * @param {Object} context\n\t * @returns {Function}\n\t */\n\tfunction bindFn(fn, context) {\n\t    return function boundFn() {\n\t        return fn.apply(context, arguments);\n\t    };\n\t}\n\t\n\t/**\n\t * let a boolean value also be a function that must return a boolean\n\t * this first item in args will be used as the context\n\t * @param {Boolean|Function} val\n\t * @param {Array} [args]\n\t * @returns {Boolean}\n\t */\n\tfunction boolOrFn(val, args) {\n\t    if (typeof val == TYPE_FUNCTION) {\n\t        return val.apply(args ? args[0] || undefined : undefined, args);\n\t    }\n\t    return val;\n\t}\n\t\n\t/**\n\t * use the val2 when val1 is undefined\n\t * @param {*} val1\n\t * @param {*} val2\n\t * @returns {*}\n\t */\n\tfunction ifUndefined(val1, val2) {\n\t    return (val1 === undefined) ? val2 : val1;\n\t}\n\t\n\t/**\n\t * addEventListener with multiple events at once\n\t * @param {EventTarget} target\n\t * @param {String} types\n\t * @param {Function} handler\n\t */\n\tfunction addEventListeners(target, types, handler) {\n\t    each(splitStr(types), function(type) {\n\t        target.addEventListener(type, handler, false);\n\t    });\n\t}\n\t\n\t/**\n\t * removeEventListener with multiple events at once\n\t * @param {EventTarget} target\n\t * @param {String} types\n\t * @param {Function} handler\n\t */\n\tfunction removeEventListeners(target, types, handler) {\n\t    each(splitStr(types), function(type) {\n\t        target.removeEventListener(type, handler, false);\n\t    });\n\t}\n\t\n\t/**\n\t * find if a node is in the given parent\n\t * @method hasParent\n\t * @param {HTMLElement} node\n\t * @param {HTMLElement} parent\n\t * @return {Boolean} found\n\t */\n\tfunction hasParent(node, parent) {\n\t    while (node) {\n\t        if (node == parent) {\n\t            return true;\n\t        }\n\t        node = node.parentNode;\n\t    }\n\t    return false;\n\t}\n\t\n\t/**\n\t * small indexOf wrapper\n\t * @param {String} str\n\t * @param {String} find\n\t * @returns {Boolean} found\n\t */\n\tfunction inStr(str, find) {\n\t    return str.indexOf(find) > -1;\n\t}\n\t\n\t/**\n\t * split string on whitespace\n\t * @param {String} str\n\t * @returns {Array} words\n\t */\n\tfunction splitStr(str) {\n\t    return str.trim().split(/\\s+/g);\n\t}\n\t\n\t/**\n\t * find if a array contains the object using indexOf or a simple polyFill\n\t * @param {Array} src\n\t * @param {String} find\n\t * @param {String} [findByKey]\n\t * @return {Boolean|Number} false when not found, or the index\n\t */\n\tfunction inArray(src, find, findByKey) {\n\t    if (src.indexOf && !findByKey) {\n\t        return src.indexOf(find);\n\t    } else {\n\t        var i = 0;\n\t        while (i < src.length) {\n\t            if ((findByKey && src[i][findByKey] == find) || (!findByKey && src[i] === find)) {\n\t                return i;\n\t            }\n\t            i++;\n\t        }\n\t        return -1;\n\t    }\n\t}\n\t\n\t/**\n\t * convert array-like objects to real arrays\n\t * @param {Object} obj\n\t * @returns {Array}\n\t */\n\tfunction toArray(obj) {\n\t    return Array.prototype.slice.call(obj, 0);\n\t}\n\t\n\t/**\n\t * unique array with objects based on a key (like 'id') or just by the array's value\n\t * @param {Array} src [{id:1},{id:2},{id:1}]\n\t * @param {String} [key]\n\t * @param {Boolean} [sort=False]\n\t * @returns {Array} [{id:1},{id:2}]\n\t */\n\tfunction uniqueArray(src, key, sort) {\n\t    var results = [];\n\t    var values = [];\n\t    var i = 0;\n\t\n\t    while (i < src.length) {\n\t        var val = key ? src[i][key] : src[i];\n\t        if (inArray(values, val) < 0) {\n\t            results.push(src[i]);\n\t        }\n\t        values[i] = val;\n\t        i++;\n\t    }\n\t\n\t    if (sort) {\n\t        if (!key) {\n\t            results = results.sort();\n\t        } else {\n\t            results = results.sort(function sortUniqueArray(a, b) {\n\t                return a[key] > b[key];\n\t            });\n\t        }\n\t    }\n\t\n\t    return results;\n\t}\n\t\n\t/**\n\t * get the prefixed property\n\t * @param {Object} obj\n\t * @param {String} property\n\t * @returns {String|Undefined} prefixed\n\t */\n\tfunction prefixed(obj, property) {\n\t    var prefix, prop;\n\t    var camelProp = property[0].toUpperCase() + property.slice(1);\n\t\n\t    var i = 0;\n\t    while (i < VENDOR_PREFIXES.length) {\n\t        prefix = VENDOR_PREFIXES[i];\n\t        prop = (prefix) ? prefix + camelProp : property;\n\t\n\t        if (prop in obj) {\n\t            return prop;\n\t        }\n\t        i++;\n\t    }\n\t    return undefined;\n\t}\n\t\n\t/**\n\t * get a unique id\n\t * @returns {number} uniqueId\n\t */\n\tvar _uniqueId = 1;\n\tfunction uniqueId() {\n\t    return _uniqueId++;\n\t}\n\t\n\t/**\n\t * get the window object of an element\n\t * @param {HTMLElement} element\n\t * @returns {DocumentView|Window}\n\t */\n\tfunction getWindowForElement(element) {\n\t    var doc = element.ownerDocument || element;\n\t    return (doc.defaultView || doc.parentWindow || window);\n\t}\n\t\n\tvar MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\n\t\n\tvar SUPPORT_TOUCH = ('ontouchstart' in window);\n\tvar SUPPORT_POINTER_EVENTS = prefixed(window, 'PointerEvent') !== undefined;\n\tvar SUPPORT_ONLY_TOUCH = SUPPORT_TOUCH && MOBILE_REGEX.test(navigator.userAgent);\n\t\n\tvar INPUT_TYPE_TOUCH = 'touch';\n\tvar INPUT_TYPE_PEN = 'pen';\n\tvar INPUT_TYPE_MOUSE = 'mouse';\n\tvar INPUT_TYPE_KINECT = 'kinect';\n\t\n\tvar COMPUTE_INTERVAL = 25;\n\t\n\tvar INPUT_START = 1;\n\tvar INPUT_MOVE = 2;\n\tvar INPUT_END = 4;\n\tvar INPUT_CANCEL = 8;\n\t\n\tvar DIRECTION_NONE = 1;\n\tvar DIRECTION_LEFT = 2;\n\tvar DIRECTION_RIGHT = 4;\n\tvar DIRECTION_UP = 8;\n\tvar DIRECTION_DOWN = 16;\n\t\n\tvar DIRECTION_HORIZONTAL = DIRECTION_LEFT | DIRECTION_RIGHT;\n\tvar DIRECTION_VERTICAL = DIRECTION_UP | DIRECTION_DOWN;\n\tvar DIRECTION_ALL = DIRECTION_HORIZONTAL | DIRECTION_VERTICAL;\n\t\n\tvar PROPS_XY = ['x', 'y'];\n\tvar PROPS_CLIENT_XY = ['clientX', 'clientY'];\n\t\n\t/**\n\t * create new input type manager\n\t * @param {Manager} manager\n\t * @param {Function} callback\n\t * @returns {Input}\n\t * @constructor\n\t */\n\tfunction Input(manager, callback) {\n\t    var self = this;\n\t    this.manager = manager;\n\t    this.callback = callback;\n\t    this.element = manager.element;\n\t    this.target = manager.options.inputTarget;\n\t\n\t    // smaller wrapper around the handler, for the scope and the enabled state of the manager,\n\t    // so when disabled the input events are completely bypassed.\n\t    this.domHandler = function(ev) {\n\t        if (boolOrFn(manager.options.enable, [manager])) {\n\t            self.handler(ev);\n\t        }\n\t    };\n\t\n\t    this.init();\n\t\n\t}\n\t\n\tInput.prototype = {\n\t    /**\n\t     * should handle the inputEvent data and trigger the callback\n\t     * @virtual\n\t     */\n\t    handler: function() { },\n\t\n\t    /**\n\t     * bind the events\n\t     */\n\t    init: function() {\n\t        this.evEl && addEventListeners(this.element, this.evEl, this.domHandler);\n\t        this.evTarget && addEventListeners(this.target, this.evTarget, this.domHandler);\n\t        this.evWin && addEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n\t    },\n\t\n\t    /**\n\t     * unbind the events\n\t     */\n\t    destroy: function() {\n\t        this.evEl && removeEventListeners(this.element, this.evEl, this.domHandler);\n\t        this.evTarget && removeEventListeners(this.target, this.evTarget, this.domHandler);\n\t        this.evWin && removeEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n\t    }\n\t};\n\t\n\t/**\n\t * create new input type manager\n\t * called by the Manager constructor\n\t * @param {Hammer} manager\n\t * @returns {Input}\n\t */\n\tfunction createInputInstance(manager) {\n\t    var Type;\n\t    var inputClass = manager.options.inputClass;\n\t\n\t    if (inputClass) {\n\t        Type = inputClass;\n\t    } else if (SUPPORT_POINTER_EVENTS) {\n\t        Type = PointerEventInput;\n\t    } else if (SUPPORT_ONLY_TOUCH) {\n\t        Type = TouchInput;\n\t    } else if (!SUPPORT_TOUCH) {\n\t        Type = MouseInput;\n\t    } else {\n\t        Type = TouchMouseInput;\n\t    }\n\t    return new (Type)(manager, inputHandler);\n\t}\n\t\n\t/**\n\t * handle input events\n\t * @param {Manager} manager\n\t * @param {String} eventType\n\t * @param {Object} input\n\t */\n\tfunction inputHandler(manager, eventType, input) {\n\t    var pointersLen = input.pointers.length;\n\t    var changedPointersLen = input.changedPointers.length;\n\t    var isFirst = (eventType & INPUT_START && (pointersLen - changedPointersLen === 0));\n\t    var isFinal = (eventType & (INPUT_END | INPUT_CANCEL) && (pointersLen - changedPointersLen === 0));\n\t\n\t    input.isFirst = !!isFirst;\n\t    input.isFinal = !!isFinal;\n\t\n\t    if (isFirst) {\n\t        manager.session = {};\n\t    }\n\t\n\t    // source event is the normalized value of the domEvents\n\t    // like 'touchstart, mouseup, pointerdown'\n\t    input.eventType = eventType;\n\t\n\t    // compute scale, rotation etc\n\t    computeInputData(manager, input);\n\t\n\t    // emit secret event\n\t    manager.emit('hammer.input', input);\n\t\n\t    manager.recognize(input);\n\t    manager.session.prevInput = input;\n\t}\n\t\n\t/**\n\t * extend the data with some usable properties like scale, rotate, velocity etc\n\t * @param {Object} manager\n\t * @param {Object} input\n\t */\n\tfunction computeInputData(manager, input) {\n\t    var session = manager.session;\n\t    var pointers = input.pointers;\n\t    var pointersLength = pointers.length;\n\t\n\t    // store the first input to calculate the distance and direction\n\t    if (!session.firstInput) {\n\t        session.firstInput = simpleCloneInputData(input);\n\t    }\n\t\n\t    // to compute scale and rotation we need to store the multiple touches\n\t    if (pointersLength > 1 && !session.firstMultiple) {\n\t        session.firstMultiple = simpleCloneInputData(input);\n\t    } else if (pointersLength === 1) {\n\t        session.firstMultiple = false;\n\t    }\n\t\n\t    var firstInput = session.firstInput;\n\t    var firstMultiple = session.firstMultiple;\n\t    var offsetCenter = firstMultiple ? firstMultiple.center : firstInput.center;\n\t\n\t    var center = input.center = getCenter(pointers);\n\t    input.timeStamp = now();\n\t    input.deltaTime = input.timeStamp - firstInput.timeStamp;\n\t\n\t    input.angle = getAngle(offsetCenter, center);\n\t    input.distance = getDistance(offsetCenter, center);\n\t\n\t    computeDeltaXY(session, input);\n\t    input.offsetDirection = getDirection(input.deltaX, input.deltaY);\n\t\n\t    var overallVelocity = getVelocity(input.deltaTime, input.deltaX, input.deltaY);\n\t    input.overallVelocityX = overallVelocity.x;\n\t    input.overallVelocityY = overallVelocity.y;\n\t    input.overallVelocity = (abs(overallVelocity.x) > abs(overallVelocity.y)) ? overallVelocity.x : overallVelocity.y;\n\t\n\t    input.scale = firstMultiple ? getScale(firstMultiple.pointers, pointers) : 1;\n\t    input.rotation = firstMultiple ? getRotation(firstMultiple.pointers, pointers) : 0;\n\t\n\t    input.maxPointers = !session.prevInput ? input.pointers.length : ((input.pointers.length >\n\t        session.prevInput.maxPointers) ? input.pointers.length : session.prevInput.maxPointers);\n\t\n\t    computeIntervalInputData(session, input);\n\t\n\t    // find the correct target\n\t    var target = manager.element;\n\t    if (hasParent(input.srcEvent.target, target)) {\n\t        target = input.srcEvent.target;\n\t    }\n\t    input.target = target;\n\t}\n\t\n\tfunction computeDeltaXY(session, input) {\n\t    var center = input.center;\n\t    var offset = session.offsetDelta || {};\n\t    var prevDelta = session.prevDelta || {};\n\t    var prevInput = session.prevInput || {};\n\t\n\t    if (input.eventType === INPUT_START || prevInput.eventType === INPUT_END) {\n\t        prevDelta = session.prevDelta = {\n\t            x: prevInput.deltaX || 0,\n\t            y: prevInput.deltaY || 0\n\t        };\n\t\n\t        offset = session.offsetDelta = {\n\t            x: center.x,\n\t            y: center.y\n\t        };\n\t    }\n\t\n\t    input.deltaX = prevDelta.x + (center.x - offset.x);\n\t    input.deltaY = prevDelta.y + (center.y - offset.y);\n\t}\n\t\n\t/**\n\t * velocity is calculated every x ms\n\t * @param {Object} session\n\t * @param {Object} input\n\t */\n\tfunction computeIntervalInputData(session, input) {\n\t    var last = session.lastInterval || input,\n\t        deltaTime = input.timeStamp - last.timeStamp,\n\t        velocity, velocityX, velocityY, direction;\n\t\n\t    if (input.eventType != INPUT_CANCEL && (deltaTime > COMPUTE_INTERVAL || last.velocity === undefined)) {\n\t        var deltaX = input.deltaX - last.deltaX;\n\t        var deltaY = input.deltaY - last.deltaY;\n\t\n\t        var v = getVelocity(deltaTime, deltaX, deltaY);\n\t        velocityX = v.x;\n\t        velocityY = v.y;\n\t        velocity = (abs(v.x) > abs(v.y)) ? v.x : v.y;\n\t        direction = getDirection(deltaX, deltaY);\n\t\n\t        session.lastInterval = input;\n\t    } else {\n\t        // use latest velocity info if it doesn't overtake a minimum period\n\t        velocity = last.velocity;\n\t        velocityX = last.velocityX;\n\t        velocityY = last.velocityY;\n\t        direction = last.direction;\n\t    }\n\t\n\t    input.velocity = velocity;\n\t    input.velocityX = velocityX;\n\t    input.velocityY = velocityY;\n\t    input.direction = direction;\n\t}\n\t\n\t/**\n\t * create a simple clone from the input used for storage of firstInput and firstMultiple\n\t * @param {Object} input\n\t * @returns {Object} clonedInputData\n\t */\n\tfunction simpleCloneInputData(input) {\n\t    // make a simple copy of the pointers because we will get a reference if we don't\n\t    // we only need clientXY for the calculations\n\t    var pointers = [];\n\t    var i = 0;\n\t    while (i < input.pointers.length) {\n\t        pointers[i] = {\n\t            clientX: round(input.pointers[i].clientX),\n\t            clientY: round(input.pointers[i].clientY)\n\t        };\n\t        i++;\n\t    }\n\t\n\t    return {\n\t        timeStamp: now(),\n\t        pointers: pointers,\n\t        center: getCenter(pointers),\n\t        deltaX: input.deltaX,\n\t        deltaY: input.deltaY\n\t    };\n\t}\n\t\n\t/**\n\t * get the center of all the pointers\n\t * @param {Array} pointers\n\t * @return {Object} center contains `x` and `y` properties\n\t */\n\tfunction getCenter(pointers) {\n\t    var pointersLength = pointers.length;\n\t\n\t    // no need to loop when only one touch\n\t    if (pointersLength === 1) {\n\t        return {\n\t            x: round(pointers[0].clientX),\n\t            y: round(pointers[0].clientY)\n\t        };\n\t    }\n\t\n\t    var x = 0, y = 0, i = 0;\n\t    while (i < pointersLength) {\n\t        x += pointers[i].clientX;\n\t        y += pointers[i].clientY;\n\t        i++;\n\t    }\n\t\n\t    return {\n\t        x: round(x / pointersLength),\n\t        y: round(y / pointersLength)\n\t    };\n\t}\n\t\n\t/**\n\t * calculate the velocity between two points. unit is in px per ms.\n\t * @param {Number} deltaTime\n\t * @param {Number} x\n\t * @param {Number} y\n\t * @return {Object} velocity `x` and `y`\n\t */\n\tfunction getVelocity(deltaTime, x, y) {\n\t    return {\n\t        x: x / deltaTime || 0,\n\t        y: y / deltaTime || 0\n\t    };\n\t}\n\t\n\t/**\n\t * get the direction between two points\n\t * @param {Number} x\n\t * @param {Number} y\n\t * @return {Number} direction\n\t */\n\tfunction getDirection(x, y) {\n\t    if (x === y) {\n\t        return DIRECTION_NONE;\n\t    }\n\t\n\t    if (abs(x) >= abs(y)) {\n\t        return x < 0 ? DIRECTION_LEFT : DIRECTION_RIGHT;\n\t    }\n\t    return y < 0 ? DIRECTION_UP : DIRECTION_DOWN;\n\t}\n\t\n\t/**\n\t * calculate the absolute distance between two points\n\t * @param {Object} p1 {x, y}\n\t * @param {Object} p2 {x, y}\n\t * @param {Array} [props] containing x and y keys\n\t * @return {Number} distance\n\t */\n\tfunction getDistance(p1, p2, props) {\n\t    if (!props) {\n\t        props = PROPS_XY;\n\t    }\n\t    var x = p2[props[0]] - p1[props[0]],\n\t        y = p2[props[1]] - p1[props[1]];\n\t\n\t    return Math.sqrt((x * x) + (y * y));\n\t}\n\t\n\t/**\n\t * calculate the angle between two coordinates\n\t * @param {Object} p1\n\t * @param {Object} p2\n\t * @param {Array} [props] containing x and y keys\n\t * @return {Number} angle\n\t */\n\tfunction getAngle(p1, p2, props) {\n\t    if (!props) {\n\t        props = PROPS_XY;\n\t    }\n\t    var x = p2[props[0]] - p1[props[0]],\n\t        y = p2[props[1]] - p1[props[1]];\n\t    return Math.atan2(y, x) * 180 / Math.PI;\n\t}\n\t\n\t/**\n\t * calculate the rotation degrees between two pointersets\n\t * @param {Array} start array of pointers\n\t * @param {Array} end array of pointers\n\t * @return {Number} rotation\n\t */\n\tfunction getRotation(start, end) {\n\t    return getAngle(end[1], end[0], PROPS_CLIENT_XY) + getAngle(start[1], start[0], PROPS_CLIENT_XY);\n\t}\n\t\n\t/**\n\t * calculate the scale factor between two pointersets\n\t * no scale is 1, and goes down to 0 when pinched together, and bigger when pinched out\n\t * @param {Array} start array of pointers\n\t * @param {Array} end array of pointers\n\t * @return {Number} scale\n\t */\n\tfunction getScale(start, end) {\n\t    return getDistance(end[0], end[1], PROPS_CLIENT_XY) / getDistance(start[0], start[1], PROPS_CLIENT_XY);\n\t}\n\t\n\tvar MOUSE_INPUT_MAP = {\n\t    mousedown: INPUT_START,\n\t    mousemove: INPUT_MOVE,\n\t    mouseup: INPUT_END\n\t};\n\t\n\tvar MOUSE_ELEMENT_EVENTS = 'mousedown';\n\tvar MOUSE_WINDOW_EVENTS = 'mousemove mouseup';\n\t\n\t/**\n\t * Mouse events input\n\t * @constructor\n\t * @extends Input\n\t */\n\tfunction MouseInput() {\n\t    this.evEl = MOUSE_ELEMENT_EVENTS;\n\t    this.evWin = MOUSE_WINDOW_EVENTS;\n\t\n\t    this.pressed = false; // mousedown state\n\t\n\t    Input.apply(this, arguments);\n\t}\n\t\n\tinherit(MouseInput, Input, {\n\t    /**\n\t     * handle mouse events\n\t     * @param {Object} ev\n\t     */\n\t    handler: function MEhandler(ev) {\n\t        var eventType = MOUSE_INPUT_MAP[ev.type];\n\t\n\t        // on start we want to have the left mouse button down\n\t        if (eventType & INPUT_START && ev.button === 0) {\n\t            this.pressed = true;\n\t        }\n\t\n\t        if (eventType & INPUT_MOVE && ev.which !== 1) {\n\t            eventType = INPUT_END;\n\t        }\n\t\n\t        // mouse must be down\n\t        if (!this.pressed) {\n\t            return;\n\t        }\n\t\n\t        if (eventType & INPUT_END) {\n\t            this.pressed = false;\n\t        }\n\t\n\t        this.callback(this.manager, eventType, {\n\t            pointers: [ev],\n\t            changedPointers: [ev],\n\t            pointerType: INPUT_TYPE_MOUSE,\n\t            srcEvent: ev\n\t        });\n\t    }\n\t});\n\t\n\tvar POINTER_INPUT_MAP = {\n\t    pointerdown: INPUT_START,\n\t    pointermove: INPUT_MOVE,\n\t    pointerup: INPUT_END,\n\t    pointercancel: INPUT_CANCEL,\n\t    pointerout: INPUT_CANCEL\n\t};\n\t\n\t// in IE10 the pointer types is defined as an enum\n\tvar IE10_POINTER_TYPE_ENUM = {\n\t    2: INPUT_TYPE_TOUCH,\n\t    3: INPUT_TYPE_PEN,\n\t    4: INPUT_TYPE_MOUSE,\n\t    5: INPUT_TYPE_KINECT // see https://twitter.com/jacobrossi/status/480596438489890816\n\t};\n\t\n\tvar POINTER_ELEMENT_EVENTS = 'pointerdown';\n\tvar POINTER_WINDOW_EVENTS = 'pointermove pointerup pointercancel';\n\t\n\t// IE10 has prefixed support, and case-sensitive\n\tif (window.MSPointerEvent && !window.PointerEvent) {\n\t    POINTER_ELEMENT_EVENTS = 'MSPointerDown';\n\t    POINTER_WINDOW_EVENTS = 'MSPointerMove MSPointerUp MSPointerCancel';\n\t}\n\t\n\t/**\n\t * Pointer events input\n\t * @constructor\n\t * @extends Input\n\t */\n\tfunction PointerEventInput() {\n\t    this.evEl = POINTER_ELEMENT_EVENTS;\n\t    this.evWin = POINTER_WINDOW_EVENTS;\n\t\n\t    Input.apply(this, arguments);\n\t\n\t    this.store = (this.manager.session.pointerEvents = []);\n\t}\n\t\n\tinherit(PointerEventInput, Input, {\n\t    /**\n\t     * handle mouse events\n\t     * @param {Object} ev\n\t     */\n\t    handler: function PEhandler(ev) {\n\t        var store = this.store;\n\t        var removePointer = false;\n\t\n\t        var eventTypeNormalized = ev.type.toLowerCase().replace('ms', '');\n\t        var eventType = POINTER_INPUT_MAP[eventTypeNormalized];\n\t        var pointerType = IE10_POINTER_TYPE_ENUM[ev.pointerType] || ev.pointerType;\n\t\n\t        var isTouch = (pointerType == INPUT_TYPE_TOUCH);\n\t\n\t        // get index of the event in the store\n\t        var storeIndex = inArray(store, ev.pointerId, 'pointerId');\n\t\n\t        // start and mouse must be down\n\t        if (eventType & INPUT_START && (ev.button === 0 || isTouch)) {\n\t            if (storeIndex < 0) {\n\t                store.push(ev);\n\t                storeIndex = store.length - 1;\n\t            }\n\t        } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n\t            removePointer = true;\n\t        }\n\t\n\t        // it not found, so the pointer hasn't been down (so it's probably a hover)\n\t        if (storeIndex < 0) {\n\t            return;\n\t        }\n\t\n\t        // update the event in the store\n\t        store[storeIndex] = ev;\n\t\n\t        this.callback(this.manager, eventType, {\n\t            pointers: store,\n\t            changedPointers: [ev],\n\t            pointerType: pointerType,\n\t            srcEvent: ev\n\t        });\n\t\n\t        if (removePointer) {\n\t            // remove from the store\n\t            store.splice(storeIndex, 1);\n\t        }\n\t    }\n\t});\n\t\n\tvar SINGLE_TOUCH_INPUT_MAP = {\n\t    touchstart: INPUT_START,\n\t    touchmove: INPUT_MOVE,\n\t    touchend: INPUT_END,\n\t    touchcancel: INPUT_CANCEL\n\t};\n\t\n\tvar SINGLE_TOUCH_TARGET_EVENTS = 'touchstart';\n\tvar SINGLE_TOUCH_WINDOW_EVENTS = 'touchstart touchmove touchend touchcancel';\n\t\n\t/**\n\t * Touch events input\n\t * @constructor\n\t * @extends Input\n\t */\n\tfunction SingleTouchInput() {\n\t    this.evTarget = SINGLE_TOUCH_TARGET_EVENTS;\n\t    this.evWin = SINGLE_TOUCH_WINDOW_EVENTS;\n\t    this.started = false;\n\t\n\t    Input.apply(this, arguments);\n\t}\n\t\n\tinherit(SingleTouchInput, Input, {\n\t    handler: function TEhandler(ev) {\n\t        var type = SINGLE_TOUCH_INPUT_MAP[ev.type];\n\t\n\t        // should we handle the touch events?\n\t        if (type === INPUT_START) {\n\t            this.started = true;\n\t        }\n\t\n\t        if (!this.started) {\n\t            return;\n\t        }\n\t\n\t        var touches = normalizeSingleTouches.call(this, ev, type);\n\t\n\t        // when done, reset the started state\n\t        if (type & (INPUT_END | INPUT_CANCEL) && touches[0].length - touches[1].length === 0) {\n\t            this.started = false;\n\t        }\n\t\n\t        this.callback(this.manager, type, {\n\t            pointers: touches[0],\n\t            changedPointers: touches[1],\n\t            pointerType: INPUT_TYPE_TOUCH,\n\t            srcEvent: ev\n\t        });\n\t    }\n\t});\n\t\n\t/**\n\t * @this {TouchInput}\n\t * @param {Object} ev\n\t * @param {Number} type flag\n\t * @returns {undefined|Array} [all, changed]\n\t */\n\tfunction normalizeSingleTouches(ev, type) {\n\t    var all = toArray(ev.touches);\n\t    var changed = toArray(ev.changedTouches);\n\t\n\t    if (type & (INPUT_END | INPUT_CANCEL)) {\n\t        all = uniqueArray(all.concat(changed), 'identifier', true);\n\t    }\n\t\n\t    return [all, changed];\n\t}\n\t\n\tvar TOUCH_INPUT_MAP = {\n\t    touchstart: INPUT_START,\n\t    touchmove: INPUT_MOVE,\n\t    touchend: INPUT_END,\n\t    touchcancel: INPUT_CANCEL\n\t};\n\t\n\tvar TOUCH_TARGET_EVENTS = 'touchstart touchmove touchend touchcancel';\n\t\n\t/**\n\t * Multi-user touch events input\n\t * @constructor\n\t * @extends Input\n\t */\n\tfunction TouchInput() {\n\t    this.evTarget = TOUCH_TARGET_EVENTS;\n\t    this.targetIds = {};\n\t\n\t    Input.apply(this, arguments);\n\t}\n\t\n\tinherit(TouchInput, Input, {\n\t    handler: function MTEhandler(ev) {\n\t        var type = TOUCH_INPUT_MAP[ev.type];\n\t        var touches = getTouches.call(this, ev, type);\n\t        if (!touches) {\n\t            return;\n\t        }\n\t\n\t        this.callback(this.manager, type, {\n\t            pointers: touches[0],\n\t            changedPointers: touches[1],\n\t            pointerType: INPUT_TYPE_TOUCH,\n\t            srcEvent: ev\n\t        });\n\t    }\n\t});\n\t\n\t/**\n\t * @this {TouchInput}\n\t * @param {Object} ev\n\t * @param {Number} type flag\n\t * @returns {undefined|Array} [all, changed]\n\t */\n\tfunction getTouches(ev, type) {\n\t    var allTouches = toArray(ev.touches);\n\t    var targetIds = this.targetIds;\n\t\n\t    // when there is only one touch, the process can be simplified\n\t    if (type & (INPUT_START | INPUT_MOVE) && allTouches.length === 1) {\n\t        targetIds[allTouches[0].identifier] = true;\n\t        return [allTouches, allTouches];\n\t    }\n\t\n\t    var i,\n\t        targetTouches,\n\t        changedTouches = toArray(ev.changedTouches),\n\t        changedTargetTouches = [],\n\t        target = this.target;\n\t\n\t    // get target touches from touches\n\t    targetTouches = allTouches.filter(function(touch) {\n\t        return hasParent(touch.target, target);\n\t    });\n\t\n\t    // collect touches\n\t    if (type === INPUT_START) {\n\t        i = 0;\n\t        while (i < targetTouches.length) {\n\t            targetIds[targetTouches[i].identifier] = true;\n\t            i++;\n\t        }\n\t    }\n\t\n\t    // filter changed touches to only contain touches that exist in the collected target ids\n\t    i = 0;\n\t    while (i < changedTouches.length) {\n\t        if (targetIds[changedTouches[i].identifier]) {\n\t            changedTargetTouches.push(changedTouches[i]);\n\t        }\n\t\n\t        // cleanup removed touches\n\t        if (type & (INPUT_END | INPUT_CANCEL)) {\n\t            delete targetIds[changedTouches[i].identifier];\n\t        }\n\t        i++;\n\t    }\n\t\n\t    if (!changedTargetTouches.length) {\n\t        return;\n\t    }\n\t\n\t    return [\n\t        // merge targetTouches with changedTargetTouches so it contains ALL touches, including 'end' and 'cancel'\n\t        uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true),\n\t        changedTargetTouches\n\t    ];\n\t}\n\t\n\t/**\n\t * Combined touch and mouse input\n\t *\n\t * Touch has a higher priority then mouse, and while touching no mouse events are allowed.\n\t * This because touch devices also emit mouse events while doing a touch.\n\t *\n\t * @constructor\n\t * @extends Input\n\t */\n\t\n\tvar DEDUP_TIMEOUT = 2500;\n\tvar DEDUP_DISTANCE = 25;\n\t\n\tfunction TouchMouseInput() {\n\t    Input.apply(this, arguments);\n\t\n\t    var handler = bindFn(this.handler, this);\n\t    this.touch = new TouchInput(this.manager, handler);\n\t    this.mouse = new MouseInput(this.manager, handler);\n\t\n\t    this.primaryTouch = null;\n\t    this.lastTouches = [];\n\t}\n\t\n\tinherit(TouchMouseInput, Input, {\n\t    /**\n\t     * handle mouse and touch events\n\t     * @param {Hammer} manager\n\t     * @param {String} inputEvent\n\t     * @param {Object} inputData\n\t     */\n\t    handler: function TMEhandler(manager, inputEvent, inputData) {\n\t        var isTouch = (inputData.pointerType == INPUT_TYPE_TOUCH),\n\t            isMouse = (inputData.pointerType == INPUT_TYPE_MOUSE);\n\t\n\t        if (isMouse && inputData.sourceCapabilities && inputData.sourceCapabilities.firesTouchEvents) {\n\t            return;\n\t        }\n\t\n\t        // when we're in a touch event, record touches to  de-dupe synthetic mouse event\n\t        if (isTouch) {\n\t            recordTouches.call(this, inputEvent, inputData);\n\t        } else if (isMouse && isSyntheticEvent.call(this, inputData)) {\n\t            return;\n\t        }\n\t\n\t        this.callback(manager, inputEvent, inputData);\n\t    },\n\t\n\t    /**\n\t     * remove the event listeners\n\t     */\n\t    destroy: function destroy() {\n\t        this.touch.destroy();\n\t        this.mouse.destroy();\n\t    }\n\t});\n\t\n\tfunction recordTouches(eventType, eventData) {\n\t    if (eventType & INPUT_START) {\n\t        this.primaryTouch = eventData.changedPointers[0].identifier;\n\t        setLastTouch.call(this, eventData);\n\t    } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n\t        setLastTouch.call(this, eventData);\n\t    }\n\t}\n\t\n\tfunction setLastTouch(eventData) {\n\t    var touch = eventData.changedPointers[0];\n\t\n\t    if (touch.identifier === this.primaryTouch) {\n\t        var lastTouch = {x: touch.clientX, y: touch.clientY};\n\t        this.lastTouches.push(lastTouch);\n\t        var lts = this.lastTouches;\n\t        var removeLastTouch = function() {\n\t            var i = lts.indexOf(lastTouch);\n\t            if (i > -1) {\n\t                lts.splice(i, 1);\n\t            }\n\t        };\n\t        setTimeout(removeLastTouch, DEDUP_TIMEOUT);\n\t    }\n\t}\n\t\n\tfunction isSyntheticEvent(eventData) {\n\t    var x = eventData.srcEvent.clientX, y = eventData.srcEvent.clientY;\n\t    for (var i = 0; i < this.lastTouches.length; i++) {\n\t        var t = this.lastTouches[i];\n\t        var dx = Math.abs(x - t.x), dy = Math.abs(y - t.y);\n\t        if (dx <= DEDUP_DISTANCE && dy <= DEDUP_DISTANCE) {\n\t            return true;\n\t        }\n\t    }\n\t    return false;\n\t}\n\t\n\tvar PREFIXED_TOUCH_ACTION = prefixed(TEST_ELEMENT.style, 'touchAction');\n\tvar NATIVE_TOUCH_ACTION = PREFIXED_TOUCH_ACTION !== undefined;\n\t\n\t// magical touchAction value\n\tvar TOUCH_ACTION_COMPUTE = 'compute';\n\tvar TOUCH_ACTION_AUTO = 'auto';\n\tvar TOUCH_ACTION_MANIPULATION = 'manipulation'; // not implemented\n\tvar TOUCH_ACTION_NONE = 'none';\n\tvar TOUCH_ACTION_PAN_X = 'pan-x';\n\tvar TOUCH_ACTION_PAN_Y = 'pan-y';\n\tvar TOUCH_ACTION_MAP = getTouchActionProps();\n\t\n\t/**\n\t * Touch Action\n\t * sets the touchAction property or uses the js alternative\n\t * @param {Manager} manager\n\t * @param {String} value\n\t * @constructor\n\t */\n\tfunction TouchAction(manager, value) {\n\t    this.manager = manager;\n\t    this.set(value);\n\t}\n\t\n\tTouchAction.prototype = {\n\t    /**\n\t     * set the touchAction value on the element or enable the polyfill\n\t     * @param {String} value\n\t     */\n\t    set: function(value) {\n\t        // find out the touch-action by the event handlers\n\t        if (value == TOUCH_ACTION_COMPUTE) {\n\t            value = this.compute();\n\t        }\n\t\n\t        if (NATIVE_TOUCH_ACTION && this.manager.element.style && TOUCH_ACTION_MAP[value]) {\n\t            this.manager.element.style[PREFIXED_TOUCH_ACTION] = value;\n\t        }\n\t        this.actions = value.toLowerCase().trim();\n\t    },\n\t\n\t    /**\n\t     * just re-set the touchAction value\n\t     */\n\t    update: function() {\n\t        this.set(this.manager.options.touchAction);\n\t    },\n\t\n\t    /**\n\t     * compute the value for the touchAction property based on the recognizer's settings\n\t     * @returns {String} value\n\t     */\n\t    compute: function() {\n\t        var actions = [];\n\t        each(this.manager.recognizers, function(recognizer) {\n\t            if (boolOrFn(recognizer.options.enable, [recognizer])) {\n\t                actions = actions.concat(recognizer.getTouchAction());\n\t            }\n\t        });\n\t        return cleanTouchActions(actions.join(' '));\n\t    },\n\t\n\t    /**\n\t     * this method is called on each input cycle and provides the preventing of the browser behavior\n\t     * @param {Object} input\n\t     */\n\t    preventDefaults: function(input) {\n\t        var srcEvent = input.srcEvent;\n\t        var direction = input.offsetDirection;\n\t\n\t        // if the touch action did prevented once this session\n\t        if (this.manager.session.prevented) {\n\t            srcEvent.preventDefault();\n\t            return;\n\t        }\n\t\n\t        var actions = this.actions;\n\t        var hasNone = inStr(actions, TOUCH_ACTION_NONE) && !TOUCH_ACTION_MAP[TOUCH_ACTION_NONE];\n\t        var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y];\n\t        var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];\n\t\n\t        if (hasNone) {\n\t            //do not prevent defaults if this is a tap gesture\n\t\n\t            var isTapPointer = input.pointers.length === 1;\n\t            var isTapMovement = input.distance < 2;\n\t            var isTapTouchTime = input.deltaTime < 250;\n\t\n\t            if (isTapPointer && isTapMovement && isTapTouchTime) {\n\t                return;\n\t            }\n\t        }\n\t\n\t        if (hasPanX && hasPanY) {\n\t            // `pan-x pan-y` means browser handles all scrolling/panning, do not prevent\n\t            return;\n\t        }\n\t\n\t        if (hasNone ||\n\t            (hasPanY && direction & DIRECTION_HORIZONTAL) ||\n\t            (hasPanX && direction & DIRECTION_VERTICAL)) {\n\t            return this.preventSrc(srcEvent);\n\t        }\n\t    },\n\t\n\t    /**\n\t     * call preventDefault to prevent the browser's default behavior (scrolling in most cases)\n\t     * @param {Object} srcEvent\n\t     */\n\t    preventSrc: function(srcEvent) {\n\t        this.manager.session.prevented = true;\n\t        srcEvent.preventDefault();\n\t    }\n\t};\n\t\n\t/**\n\t * when the touchActions are collected they are not a valid value, so we need to clean things up. *\n\t * @param {String} actions\n\t * @returns {*}\n\t */\n\tfunction cleanTouchActions(actions) {\n\t    // none\n\t    if (inStr(actions, TOUCH_ACTION_NONE)) {\n\t        return TOUCH_ACTION_NONE;\n\t    }\n\t\n\t    var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X);\n\t    var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y);\n\t\n\t    // if both pan-x and pan-y are set (different recognizers\n\t    // for different directions, e.g. horizontal pan but vertical swipe?)\n\t    // we need none (as otherwise with pan-x pan-y combined none of these\n\t    // recognizers will work, since the browser would handle all panning\n\t    if (hasPanX && hasPanY) {\n\t        return TOUCH_ACTION_NONE;\n\t    }\n\t\n\t    // pan-x OR pan-y\n\t    if (hasPanX || hasPanY) {\n\t        return hasPanX ? TOUCH_ACTION_PAN_X : TOUCH_ACTION_PAN_Y;\n\t    }\n\t\n\t    // manipulation\n\t    if (inStr(actions, TOUCH_ACTION_MANIPULATION)) {\n\t        return TOUCH_ACTION_MANIPULATION;\n\t    }\n\t\n\t    return TOUCH_ACTION_AUTO;\n\t}\n\t\n\tfunction getTouchActionProps() {\n\t    if (!NATIVE_TOUCH_ACTION) {\n\t        return false;\n\t    }\n\t    var touchMap = {};\n\t    var cssSupports = window.CSS && window.CSS.supports;\n\t    ['auto', 'manipulation', 'pan-y', 'pan-x', 'pan-x pan-y', 'none'].forEach(function(val) {\n\t\n\t        // If css.supports is not supported but there is native touch-action assume it supports\n\t        // all values. This is the case for IE 10 and 11.\n\t        touchMap[val] = cssSupports ? window.CSS.supports('touch-action', val) : true;\n\t    });\n\t    return touchMap;\n\t}\n\t\n\t/**\n\t * Recognizer flow explained; *\n\t * All recognizers have the initial state of POSSIBLE when a input session starts.\n\t * The definition of a input session is from the first input until the last input, with all it's movement in it. *\n\t * Example session for mouse-input: mousedown -> mousemove -> mouseup\n\t *\n\t * On each recognizing cycle (see Manager.recognize) the .recognize() method is executed\n\t * which determines with state it should be.\n\t *\n\t * If the recognizer has the state FAILED, CANCELLED or RECOGNIZED (equals ENDED), it is reset to\n\t * POSSIBLE to give it another change on the next cycle.\n\t *\n\t *               Possible\n\t *                  |\n\t *            +-----+---------------+\n\t *            |                     |\n\t *      +-----+-----+               |\n\t *      |           |               |\n\t *   Failed      Cancelled          |\n\t *                          +-------+------+\n\t *                          |              |\n\t *                      Recognized       Began\n\t *                                         |\n\t *                                      Changed\n\t *                                         |\n\t *                                  Ended/Recognized\n\t */\n\tvar STATE_POSSIBLE = 1;\n\tvar STATE_BEGAN = 2;\n\tvar STATE_CHANGED = 4;\n\tvar STATE_ENDED = 8;\n\tvar STATE_RECOGNIZED = STATE_ENDED;\n\tvar STATE_CANCELLED = 16;\n\tvar STATE_FAILED = 32;\n\t\n\t/**\n\t * Recognizer\n\t * Every recognizer needs to extend from this class.\n\t * @constructor\n\t * @param {Object} options\n\t */\n\tfunction Recognizer(options) {\n\t    this.options = assign({}, this.defaults, options || {});\n\t\n\t    this.id = uniqueId();\n\t\n\t    this.manager = null;\n\t\n\t    // default is enable true\n\t    this.options.enable = ifUndefined(this.options.enable, true);\n\t\n\t    this.state = STATE_POSSIBLE;\n\t\n\t    this.simultaneous = {};\n\t    this.requireFail = [];\n\t}\n\t\n\tRecognizer.prototype = {\n\t    /**\n\t     * @virtual\n\t     * @type {Object}\n\t     */\n\t    defaults: {},\n\t\n\t    /**\n\t     * set options\n\t     * @param {Object} options\n\t     * @return {Recognizer}\n\t     */\n\t    set: function(options) {\n\t        assign(this.options, options);\n\t\n\t        // also update the touchAction, in case something changed about the directions/enabled state\n\t        this.manager && this.manager.touchAction.update();\n\t        return this;\n\t    },\n\t\n\t    /**\n\t     * recognize simultaneous with an other recognizer.\n\t     * @param {Recognizer} otherRecognizer\n\t     * @returns {Recognizer} this\n\t     */\n\t    recognizeWith: function(otherRecognizer) {\n\t        if (invokeArrayArg(otherRecognizer, 'recognizeWith', this)) {\n\t            return this;\n\t        }\n\t\n\t        var simultaneous = this.simultaneous;\n\t        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n\t        if (!simultaneous[otherRecognizer.id]) {\n\t            simultaneous[otherRecognizer.id] = otherRecognizer;\n\t            otherRecognizer.recognizeWith(this);\n\t        }\n\t        return this;\n\t    },\n\t\n\t    /**\n\t     * drop the simultaneous link. it doesnt remove the link on the other recognizer.\n\t     * @param {Recognizer} otherRecognizer\n\t     * @returns {Recognizer} this\n\t     */\n\t    dropRecognizeWith: function(otherRecognizer) {\n\t        if (invokeArrayArg(otherRecognizer, 'dropRecognizeWith', this)) {\n\t            return this;\n\t        }\n\t\n\t        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n\t        delete this.simultaneous[otherRecognizer.id];\n\t        return this;\n\t    },\n\t\n\t    /**\n\t     * recognizer can only run when an other is failing\n\t     * @param {Recognizer} otherRecognizer\n\t     * @returns {Recognizer} this\n\t     */\n\t    requireFailure: function(otherRecognizer) {\n\t        if (invokeArrayArg(otherRecognizer, 'requireFailure', this)) {\n\t            return this;\n\t        }\n\t\n\t        var requireFail = this.requireFail;\n\t        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n\t        if (inArray(requireFail, otherRecognizer) === -1) {\n\t            requireFail.push(otherRecognizer);\n\t            otherRecognizer.requireFailure(this);\n\t        }\n\t        return this;\n\t    },\n\t\n\t    /**\n\t     * drop the requireFailure link. it does not remove the link on the other recognizer.\n\t     * @param {Recognizer} otherRecognizer\n\t     * @returns {Recognizer} this\n\t     */\n\t    dropRequireFailure: function(otherRecognizer) {\n\t        if (invokeArrayArg(otherRecognizer, 'dropRequireFailure', this)) {\n\t            return this;\n\t        }\n\t\n\t        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n\t        var index = inArray(this.requireFail, otherRecognizer);\n\t        if (index > -1) {\n\t            this.requireFail.splice(index, 1);\n\t        }\n\t        return this;\n\t    },\n\t\n\t    /**\n\t     * has require failures boolean\n\t     * @returns {boolean}\n\t     */\n\t    hasRequireFailures: function() {\n\t        return this.requireFail.length > 0;\n\t    },\n\t\n\t    /**\n\t     * if the recognizer can recognize simultaneous with an other recognizer\n\t     * @param {Recognizer} otherRecognizer\n\t     * @returns {Boolean}\n\t     */\n\t    canRecognizeWith: function(otherRecognizer) {\n\t        return !!this.simultaneous[otherRecognizer.id];\n\t    },\n\t\n\t    /**\n\t     * You should use `tryEmit` instead of `emit` directly to check\n\t     * that all the needed recognizers has failed before emitting.\n\t     * @param {Object} input\n\t     */\n\t    emit: function(input) {\n\t        var self = this;\n\t        var state = this.state;\n\t\n\t        function emit(event) {\n\t            self.manager.emit(event, input);\n\t        }\n\t\n\t        // 'panstart' and 'panmove'\n\t        if (state < STATE_ENDED) {\n\t            emit(self.options.event + stateStr(state));\n\t        }\n\t\n\t        emit(self.options.event); // simple 'eventName' events\n\t\n\t        if (input.additionalEvent) { // additional event(panleft, panright, pinchin, pinchout...)\n\t            emit(input.additionalEvent);\n\t        }\n\t\n\t        // panend and pancancel\n\t        if (state >= STATE_ENDED) {\n\t            emit(self.options.event + stateStr(state));\n\t        }\n\t    },\n\t\n\t    /**\n\t     * Check that all the require failure recognizers has failed,\n\t     * if true, it emits a gesture event,\n\t     * otherwise, setup the state to FAILED.\n\t     * @param {Object} input\n\t     */\n\t    tryEmit: function(input) {\n\t        if (this.canEmit()) {\n\t            return this.emit(input);\n\t        }\n\t        // it's failing anyway\n\t        this.state = STATE_FAILED;\n\t    },\n\t\n\t    /**\n\t     * can we emit?\n\t     * @returns {boolean}\n\t     */\n\t    canEmit: function() {\n\t        var i = 0;\n\t        while (i < this.requireFail.length) {\n\t            if (!(this.requireFail[i].state & (STATE_FAILED | STATE_POSSIBLE))) {\n\t                return false;\n\t            }\n\t            i++;\n\t        }\n\t        return true;\n\t    },\n\t\n\t    /**\n\t     * update the recognizer\n\t     * @param {Object} inputData\n\t     */\n\t    recognize: function(inputData) {\n\t        // make a new copy of the inputData\n\t        // so we can change the inputData without messing up the other recognizers\n\t        var inputDataClone = assign({}, inputData);\n\t\n\t        // is is enabled and allow recognizing?\n\t        if (!boolOrFn(this.options.enable, [this, inputDataClone])) {\n\t            this.reset();\n\t            this.state = STATE_FAILED;\n\t            return;\n\t        }\n\t\n\t        // reset when we've reached the end\n\t        if (this.state & (STATE_RECOGNIZED | STATE_CANCELLED | STATE_FAILED)) {\n\t            this.state = STATE_POSSIBLE;\n\t        }\n\t\n\t        this.state = this.process(inputDataClone);\n\t\n\t        // the recognizer has recognized a gesture\n\t        // so trigger an event\n\t        if (this.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED | STATE_CANCELLED)) {\n\t            this.tryEmit(inputDataClone);\n\t        }\n\t    },\n\t\n\t    /**\n\t     * return the state of the recognizer\n\t     * the actual recognizing happens in this method\n\t     * @virtual\n\t     * @param {Object} inputData\n\t     * @returns {Const} STATE\n\t     */\n\t    process: function(inputData) { }, // jshint ignore:line\n\t\n\t    /**\n\t     * return the preferred touch-action\n\t     * @virtual\n\t     * @returns {Array}\n\t     */\n\t    getTouchAction: function() { },\n\t\n\t    /**\n\t     * called when the gesture isn't allowed to recognize\n\t     * like when another is being recognized or it is disabled\n\t     * @virtual\n\t     */\n\t    reset: function() { }\n\t};\n\t\n\t/**\n\t * get a usable string, used as event postfix\n\t * @param {Const} state\n\t * @returns {String} state\n\t */\n\tfunction stateStr(state) {\n\t    if (state & STATE_CANCELLED) {\n\t        return 'cancel';\n\t    } else if (state & STATE_ENDED) {\n\t        return 'end';\n\t    } else if (state & STATE_CHANGED) {\n\t        return 'move';\n\t    } else if (state & STATE_BEGAN) {\n\t        return 'start';\n\t    }\n\t    return '';\n\t}\n\t\n\t/**\n\t * direction cons to string\n\t * @param {Const} direction\n\t * @returns {String}\n\t */\n\tfunction directionStr(direction) {\n\t    if (direction == DIRECTION_DOWN) {\n\t        return 'down';\n\t    } else if (direction == DIRECTION_UP) {\n\t        return 'up';\n\t    } else if (direction == DIRECTION_LEFT) {\n\t        return 'left';\n\t    } else if (direction == DIRECTION_RIGHT) {\n\t        return 'right';\n\t    }\n\t    return '';\n\t}\n\t\n\t/**\n\t * get a recognizer by name if it is bound to a manager\n\t * @param {Recognizer|String} otherRecognizer\n\t * @param {Recognizer} recognizer\n\t * @returns {Recognizer}\n\t */\n\tfunction getRecognizerByNameIfManager(otherRecognizer, recognizer) {\n\t    var manager = recognizer.manager;\n\t    if (manager) {\n\t        return manager.get(otherRecognizer);\n\t    }\n\t    return otherRecognizer;\n\t}\n\t\n\t/**\n\t * This recognizer is just used as a base for the simple attribute recognizers.\n\t * @constructor\n\t * @extends Recognizer\n\t */\n\tfunction AttrRecognizer() {\n\t    Recognizer.apply(this, arguments);\n\t}\n\t\n\tinherit(AttrRecognizer, Recognizer, {\n\t    /**\n\t     * @namespace\n\t     * @memberof AttrRecognizer\n\t     */\n\t    defaults: {\n\t        /**\n\t         * @type {Number}\n\t         * @default 1\n\t         */\n\t        pointers: 1\n\t    },\n\t\n\t    /**\n\t     * Used to check if it the recognizer receives valid input, like input.distance > 10.\n\t     * @memberof AttrRecognizer\n\t     * @param {Object} input\n\t     * @returns {Boolean} recognized\n\t     */\n\t    attrTest: function(input) {\n\t        var optionPointers = this.options.pointers;\n\t        return optionPointers === 0 || input.pointers.length === optionPointers;\n\t    },\n\t\n\t    /**\n\t     * Process the input and return the state for the recognizer\n\t     * @memberof AttrRecognizer\n\t     * @param {Object} input\n\t     * @returns {*} State\n\t     */\n\t    process: function(input) {\n\t        var state = this.state;\n\t        var eventType = input.eventType;\n\t\n\t        var isRecognized = state & (STATE_BEGAN | STATE_CHANGED);\n\t        var isValid = this.attrTest(input);\n\t\n\t        // on cancel input and we've recognized before, return STATE_CANCELLED\n\t        if (isRecognized && (eventType & INPUT_CANCEL || !isValid)) {\n\t            return state | STATE_CANCELLED;\n\t        } else if (isRecognized || isValid) {\n\t            if (eventType & INPUT_END) {\n\t                return state | STATE_ENDED;\n\t            } else if (!(state & STATE_BEGAN)) {\n\t                return STATE_BEGAN;\n\t            }\n\t            return state | STATE_CHANGED;\n\t        }\n\t        return STATE_FAILED;\n\t    }\n\t});\n\t\n\t/**\n\t * Pan\n\t * Recognized when the pointer is down and moved in the allowed direction.\n\t * @constructor\n\t * @extends AttrRecognizer\n\t */\n\tfunction PanRecognizer() {\n\t    AttrRecognizer.apply(this, arguments);\n\t\n\t    this.pX = null;\n\t    this.pY = null;\n\t}\n\t\n\tinherit(PanRecognizer, AttrRecognizer, {\n\t    /**\n\t     * @namespace\n\t     * @memberof PanRecognizer\n\t     */\n\t    defaults: {\n\t        event: 'pan',\n\t        threshold: 10,\n\t        pointers: 1,\n\t        direction: DIRECTION_ALL\n\t    },\n\t\n\t    getTouchAction: function() {\n\t        var direction = this.options.direction;\n\t        var actions = [];\n\t        if (direction & DIRECTION_HORIZONTAL) {\n\t            actions.push(TOUCH_ACTION_PAN_Y);\n\t        }\n\t        if (direction & DIRECTION_VERTICAL) {\n\t            actions.push(TOUCH_ACTION_PAN_X);\n\t        }\n\t        return actions;\n\t    },\n\t\n\t    directionTest: function(input) {\n\t        var options = this.options;\n\t        var hasMoved = true;\n\t        var distance = input.distance;\n\t        var direction = input.direction;\n\t        var x = input.deltaX;\n\t        var y = input.deltaY;\n\t\n\t        // lock to axis?\n\t        if (!(direction & options.direction)) {\n\t            if (options.direction & DIRECTION_HORIZONTAL) {\n\t                direction = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;\n\t                hasMoved = x != this.pX;\n\t                distance = Math.abs(input.deltaX);\n\t            } else {\n\t                direction = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;\n\t                hasMoved = y != this.pY;\n\t                distance = Math.abs(input.deltaY);\n\t            }\n\t        }\n\t        input.direction = direction;\n\t        return hasMoved && distance > options.threshold && direction & options.direction;\n\t    },\n\t\n\t    attrTest: function(input) {\n\t        return AttrRecognizer.prototype.attrTest.call(this, input) &&\n\t            (this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));\n\t    },\n\t\n\t    emit: function(input) {\n\t\n\t        this.pX = input.deltaX;\n\t        this.pY = input.deltaY;\n\t\n\t        var direction = directionStr(input.direction);\n\t\n\t        if (direction) {\n\t            input.additionalEvent = this.options.event + direction;\n\t        }\n\t        this._super.emit.call(this, input);\n\t    }\n\t});\n\t\n\t/**\n\t * Pinch\n\t * Recognized when two or more pointers are moving toward (zoom-in) or away from each other (zoom-out).\n\t * @constructor\n\t * @extends AttrRecognizer\n\t */\n\tfunction PinchRecognizer() {\n\t    AttrRecognizer.apply(this, arguments);\n\t}\n\t\n\tinherit(PinchRecognizer, AttrRecognizer, {\n\t    /**\n\t     * @namespace\n\t     * @memberof PinchRecognizer\n\t     */\n\t    defaults: {\n\t        event: 'pinch',\n\t        threshold: 0,\n\t        pointers: 2\n\t    },\n\t\n\t    getTouchAction: function() {\n\t        return [TOUCH_ACTION_NONE];\n\t    },\n\t\n\t    attrTest: function(input) {\n\t        return this._super.attrTest.call(this, input) &&\n\t            (Math.abs(input.scale - 1) > this.options.threshold || this.state & STATE_BEGAN);\n\t    },\n\t\n\t    emit: function(input) {\n\t        if (input.scale !== 1) {\n\t            var inOut = input.scale < 1 ? 'in' : 'out';\n\t            input.additionalEvent = this.options.event + inOut;\n\t        }\n\t        this._super.emit.call(this, input);\n\t    }\n\t});\n\t\n\t/**\n\t * Press\n\t * Recognized when the pointer is down for x ms without any movement.\n\t * @constructor\n\t * @extends Recognizer\n\t */\n\tfunction PressRecognizer() {\n\t    Recognizer.apply(this, arguments);\n\t\n\t    this._timer = null;\n\t    this._input = null;\n\t}\n\t\n\tinherit(PressRecognizer, Recognizer, {\n\t    /**\n\t     * @namespace\n\t     * @memberof PressRecognizer\n\t     */\n\t    defaults: {\n\t        event: 'press',\n\t        pointers: 1,\n\t        time: 251, // minimal time of the pointer to be pressed\n\t        threshold: 9 // a minimal movement is ok, but keep it low\n\t    },\n\t\n\t    getTouchAction: function() {\n\t        return [TOUCH_ACTION_AUTO];\n\t    },\n\t\n\t    process: function(input) {\n\t        var options = this.options;\n\t        var validPointers = input.pointers.length === options.pointers;\n\t        var validMovement = input.distance < options.threshold;\n\t        var validTime = input.deltaTime > options.time;\n\t\n\t        this._input = input;\n\t\n\t        // we only allow little movement\n\t        // and we've reached an end event, so a tap is possible\n\t        if (!validMovement || !validPointers || (input.eventType & (INPUT_END | INPUT_CANCEL) && !validTime)) {\n\t            this.reset();\n\t        } else if (input.eventType & INPUT_START) {\n\t            this.reset();\n\t            this._timer = setTimeoutContext(function() {\n\t                this.state = STATE_RECOGNIZED;\n\t                this.tryEmit();\n\t            }, options.time, this);\n\t        } else if (input.eventType & INPUT_END) {\n\t            return STATE_RECOGNIZED;\n\t        }\n\t        return STATE_FAILED;\n\t    },\n\t\n\t    reset: function() {\n\t        clearTimeout(this._timer);\n\t    },\n\t\n\t    emit: function(input) {\n\t        if (this.state !== STATE_RECOGNIZED) {\n\t            return;\n\t        }\n\t\n\t        if (input && (input.eventType & INPUT_END)) {\n\t            this.manager.emit(this.options.event + 'up', input);\n\t        } else {\n\t            this._input.timeStamp = now();\n\t            this.manager.emit(this.options.event, this._input);\n\t        }\n\t    }\n\t});\n\t\n\t/**\n\t * Rotate\n\t * Recognized when two or more pointer are moving in a circular motion.\n\t * @constructor\n\t * @extends AttrRecognizer\n\t */\n\tfunction RotateRecognizer() {\n\t    AttrRecognizer.apply(this, arguments);\n\t}\n\t\n\tinherit(RotateRecognizer, AttrRecognizer, {\n\t    /**\n\t     * @namespace\n\t     * @memberof RotateRecognizer\n\t     */\n\t    defaults: {\n\t        event: 'rotate',\n\t        threshold: 0,\n\t        pointers: 2\n\t    },\n\t\n\t    getTouchAction: function() {\n\t        return [TOUCH_ACTION_NONE];\n\t    },\n\t\n\t    attrTest: function(input) {\n\t        return this._super.attrTest.call(this, input) &&\n\t            (Math.abs(input.rotation) > this.options.threshold || this.state & STATE_BEGAN);\n\t    }\n\t});\n\t\n\t/**\n\t * Swipe\n\t * Recognized when the pointer is moving fast (velocity), with enough distance in the allowed direction.\n\t * @constructor\n\t * @extends AttrRecognizer\n\t */\n\tfunction SwipeRecognizer() {\n\t    AttrRecognizer.apply(this, arguments);\n\t}\n\t\n\tinherit(SwipeRecognizer, AttrRecognizer, {\n\t    /**\n\t     * @namespace\n\t     * @memberof SwipeRecognizer\n\t     */\n\t    defaults: {\n\t        event: 'swipe',\n\t        threshold: 10,\n\t        velocity: 0.3,\n\t        direction: DIRECTION_HORIZONTAL | DIRECTION_VERTICAL,\n\t        pointers: 1\n\t    },\n\t\n\t    getTouchAction: function() {\n\t        return PanRecognizer.prototype.getTouchAction.call(this);\n\t    },\n\t\n\t    attrTest: function(input) {\n\t        var direction = this.options.direction;\n\t        var velocity;\n\t\n\t        if (direction & (DIRECTION_HORIZONTAL | DIRECTION_VERTICAL)) {\n\t            velocity = input.overallVelocity;\n\t        } else if (direction & DIRECTION_HORIZONTAL) {\n\t            velocity = input.overallVelocityX;\n\t        } else if (direction & DIRECTION_VERTICAL) {\n\t            velocity = input.overallVelocityY;\n\t        }\n\t\n\t        return this._super.attrTest.call(this, input) &&\n\t            direction & input.offsetDirection &&\n\t            input.distance > this.options.threshold &&\n\t            input.maxPointers == this.options.pointers &&\n\t            abs(velocity) > this.options.velocity && input.eventType & INPUT_END;\n\t    },\n\t\n\t    emit: function(input) {\n\t        var direction = directionStr(input.offsetDirection);\n\t        if (direction) {\n\t            this.manager.emit(this.options.event + direction, input);\n\t        }\n\t\n\t        this.manager.emit(this.options.event, input);\n\t    }\n\t});\n\t\n\t/**\n\t * A tap is ecognized when the pointer is doing a small tap/click. Multiple taps are recognized if they occur\n\t * between the given interval and position. The delay option can be used to recognize multi-taps without firing\n\t * a single tap.\n\t *\n\t * The eventData from the emitted event contains the property `tapCount`, which contains the amount of\n\t * multi-taps being recognized.\n\t * @constructor\n\t * @extends Recognizer\n\t */\n\tfunction TapRecognizer() {\n\t    Recognizer.apply(this, arguments);\n\t\n\t    // previous time and center,\n\t    // used for tap counting\n\t    this.pTime = false;\n\t    this.pCenter = false;\n\t\n\t    this._timer = null;\n\t    this._input = null;\n\t    this.count = 0;\n\t}\n\t\n\tinherit(TapRecognizer, Recognizer, {\n\t    /**\n\t     * @namespace\n\t     * @memberof PinchRecognizer\n\t     */\n\t    defaults: {\n\t        event: 'tap',\n\t        pointers: 1,\n\t        taps: 1,\n\t        interval: 300, // max time between the multi-tap taps\n\t        time: 250, // max time of the pointer to be down (like finger on the screen)\n\t        threshold: 9, // a minimal movement is ok, but keep it low\n\t        posThreshold: 10 // a multi-tap can be a bit off the initial position\n\t    },\n\t\n\t    getTouchAction: function() {\n\t        return [TOUCH_ACTION_MANIPULATION];\n\t    },\n\t\n\t    process: function(input) {\n\t        var options = this.options;\n\t\n\t        var validPointers = input.pointers.length === options.pointers;\n\t        var validMovement = input.distance < options.threshold;\n\t        var validTouchTime = input.deltaTime < options.time;\n\t\n\t        this.reset();\n\t\n\t        if ((input.eventType & INPUT_START) && (this.count === 0)) {\n\t            return this.failTimeout();\n\t        }\n\t\n\t        // we only allow little movement\n\t        // and we've reached an end event, so a tap is possible\n\t        if (validMovement && validTouchTime && validPointers) {\n\t            if (input.eventType != INPUT_END) {\n\t                return this.failTimeout();\n\t            }\n\t\n\t            var validInterval = this.pTime ? (input.timeStamp - this.pTime < options.interval) : true;\n\t            var validMultiTap = !this.pCenter || getDistance(this.pCenter, input.center) < options.posThreshold;\n\t\n\t            this.pTime = input.timeStamp;\n\t            this.pCenter = input.center;\n\t\n\t            if (!validMultiTap || !validInterval) {\n\t                this.count = 1;\n\t            } else {\n\t                this.count += 1;\n\t            }\n\t\n\t            this._input = input;\n\t\n\t            // if tap count matches we have recognized it,\n\t            // else it has began recognizing...\n\t            var tapCount = this.count % options.taps;\n\t            if (tapCount === 0) {\n\t                // no failing requirements, immediately trigger the tap event\n\t                // or wait as long as the multitap interval to trigger\n\t                if (!this.hasRequireFailures()) {\n\t                    return STATE_RECOGNIZED;\n\t                } else {\n\t                    this._timer = setTimeoutContext(function() {\n\t                        this.state = STATE_RECOGNIZED;\n\t                        this.tryEmit();\n\t                    }, options.interval, this);\n\t                    return STATE_BEGAN;\n\t                }\n\t            }\n\t        }\n\t        return STATE_FAILED;\n\t    },\n\t\n\t    failTimeout: function() {\n\t        this._timer = setTimeoutContext(function() {\n\t            this.state = STATE_FAILED;\n\t        }, this.options.interval, this);\n\t        return STATE_FAILED;\n\t    },\n\t\n\t    reset: function() {\n\t        clearTimeout(this._timer);\n\t    },\n\t\n\t    emit: function() {\n\t        if (this.state == STATE_RECOGNIZED) {\n\t            this._input.tapCount = this.count;\n\t            this.manager.emit(this.options.event, this._input);\n\t        }\n\t    }\n\t});\n\t\n\t/**\n\t * Simple way to create a manager with a default set of recognizers.\n\t * @param {HTMLElement} element\n\t * @param {Object} [options]\n\t * @constructor\n\t */\n\tfunction Hammer(element, options) {\n\t    options = options || {};\n\t    options.recognizers = ifUndefined(options.recognizers, Hammer.defaults.preset);\n\t    return new Manager(element, options);\n\t}\n\t\n\t/**\n\t * @const {string}\n\t */\n\tHammer.VERSION = '2.0.7';\n\t\n\t/**\n\t * default settings\n\t * @namespace\n\t */\n\tHammer.defaults = {\n\t    /**\n\t     * set if DOM events are being triggered.\n\t     * But this is slower and unused by simple implementations, so disabled by default.\n\t     * @type {Boolean}\n\t     * @default false\n\t     */\n\t    domEvents: false,\n\t\n\t    /**\n\t     * The value for the touchAction property/fallback.\n\t     * When set to `compute` it will magically set the correct value based on the added recognizers.\n\t     * @type {String}\n\t     * @default compute\n\t     */\n\t    touchAction: TOUCH_ACTION_COMPUTE,\n\t\n\t    /**\n\t     * @type {Boolean}\n\t     * @default true\n\t     */\n\t    enable: true,\n\t\n\t    /**\n\t     * EXPERIMENTAL FEATURE -- can be removed/changed\n\t     * Change the parent input target element.\n\t     * If Null, then it is being set the to main element.\n\t     * @type {Null|EventTarget}\n\t     * @default null\n\t     */\n\t    inputTarget: null,\n\t\n\t    /**\n\t     * force an input class\n\t     * @type {Null|Function}\n\t     * @default null\n\t     */\n\t    inputClass: null,\n\t\n\t    /**\n\t     * Default recognizer setup when calling `Hammer()`\n\t     * When creating a new Manager these will be skipped.\n\t     * @type {Array}\n\t     */\n\t    preset: [\n\t        // RecognizerClass, options, [recognizeWith, ...], [requireFailure, ...]\n\t        [RotateRecognizer, {enable: false}],\n\t        [PinchRecognizer, {enable: false}, ['rotate']],\n\t        [SwipeRecognizer, {direction: DIRECTION_HORIZONTAL}],\n\t        [PanRecognizer, {direction: DIRECTION_HORIZONTAL}, ['swipe']],\n\t        [TapRecognizer],\n\t        [TapRecognizer, {event: 'doubletap', taps: 2}, ['tap']],\n\t        [PressRecognizer]\n\t    ],\n\t\n\t    /**\n\t     * Some CSS properties can be used to improve the working of Hammer.\n\t     * Add them to this method and they will be set when creating a new Manager.\n\t     * @namespace\n\t     */\n\t    cssProps: {\n\t        /**\n\t         * Disables text selection to improve the dragging gesture. Mainly for desktop browsers.\n\t         * @type {String}\n\t         * @default 'none'\n\t         */\n\t        userSelect: 'none',\n\t\n\t        /**\n\t         * Disable the Windows Phone grippers when pressing an element.\n\t         * @type {String}\n\t         * @default 'none'\n\t         */\n\t        touchSelect: 'none',\n\t\n\t        /**\n\t         * Disables the default callout shown when you touch and hold a touch target.\n\t         * On iOS, when you touch and hold a touch target such as a link, Safari displays\n\t         * a callout containing information about the link. This property allows you to disable that callout.\n\t         * @type {String}\n\t         * @default 'none'\n\t         */\n\t        touchCallout: 'none',\n\t\n\t        /**\n\t         * Specifies whether zooming is enabled. Used by IE10>\n\t         * @type {String}\n\t         * @default 'none'\n\t         */\n\t        contentZooming: 'none',\n\t\n\t        /**\n\t         * Specifies that an entire element should be draggable instead of its contents. Mainly for desktop browsers.\n\t         * @type {String}\n\t         * @default 'none'\n\t         */\n\t        userDrag: 'none',\n\t\n\t        /**\n\t         * Overrides the highlight color shown when the user taps a link or a JavaScript\n\t         * clickable element in iOS. This property obeys the alpha value, if specified.\n\t         * @type {String}\n\t         * @default 'rgba(0,0,0,0)'\n\t         */\n\t        tapHighlightColor: 'rgba(0,0,0,0)'\n\t    }\n\t};\n\t\n\tvar STOP = 1;\n\tvar FORCED_STOP = 2;\n\t\n\t/**\n\t * Manager\n\t * @param {HTMLElement} element\n\t * @param {Object} [options]\n\t * @constructor\n\t */\n\tfunction Manager(element, options) {\n\t    this.options = assign({}, Hammer.defaults, options || {});\n\t\n\t    this.options.inputTarget = this.options.inputTarget || element;\n\t\n\t    this.handlers = {};\n\t    this.session = {};\n\t    this.recognizers = [];\n\t    this.oldCssProps = {};\n\t\n\t    this.element = element;\n\t    this.input = createInputInstance(this);\n\t    this.touchAction = new TouchAction(this, this.options.touchAction);\n\t\n\t    toggleCssProps(this, true);\n\t\n\t    each(this.options.recognizers, function(item) {\n\t        var recognizer = this.add(new (item[0])(item[1]));\n\t        item[2] && recognizer.recognizeWith(item[2]);\n\t        item[3] && recognizer.requireFailure(item[3]);\n\t    }, this);\n\t}\n\t\n\tManager.prototype = {\n\t    /**\n\t     * set options\n\t     * @param {Object} options\n\t     * @returns {Manager}\n\t     */\n\t    set: function(options) {\n\t        assign(this.options, options);\n\t\n\t        // Options that need a little more setup\n\t        if (options.touchAction) {\n\t            this.touchAction.update();\n\t        }\n\t        if (options.inputTarget) {\n\t            // Clean up existing event listeners and reinitialize\n\t            this.input.destroy();\n\t            this.input.target = options.inputTarget;\n\t            this.input.init();\n\t        }\n\t        return this;\n\t    },\n\t\n\t    /**\n\t     * stop recognizing for this session.\n\t     * This session will be discarded, when a new [input]start event is fired.\n\t     * When forced, the recognizer cycle is stopped immediately.\n\t     * @param {Boolean} [force]\n\t     */\n\t    stop: function(force) {\n\t        this.session.stopped = force ? FORCED_STOP : STOP;\n\t    },\n\t\n\t    /**\n\t     * run the recognizers!\n\t     * called by the inputHandler function on every movement of the pointers (touches)\n\t     * it walks through all the recognizers and tries to detect the gesture that is being made\n\t     * @param {Object} inputData\n\t     */\n\t    recognize: function(inputData) {\n\t        var session = this.session;\n\t        if (session.stopped) {\n\t            return;\n\t        }\n\t\n\t        // run the touch-action polyfill\n\t        this.touchAction.preventDefaults(inputData);\n\t\n\t        var recognizer;\n\t        var recognizers = this.recognizers;\n\t\n\t        // this holds the recognizer that is being recognized.\n\t        // so the recognizer's state needs to be BEGAN, CHANGED, ENDED or RECOGNIZED\n\t        // if no recognizer is detecting a thing, it is set to `null`\n\t        var curRecognizer = session.curRecognizer;\n\t\n\t        // reset when the last recognizer is recognized\n\t        // or when we're in a new session\n\t        if (!curRecognizer || (curRecognizer && curRecognizer.state & STATE_RECOGNIZED)) {\n\t            curRecognizer = session.curRecognizer = null;\n\t        }\n\t\n\t        var i = 0;\n\t        while (i < recognizers.length) {\n\t            recognizer = recognizers[i];\n\t\n\t            // find out if we are allowed try to recognize the input for this one.\n\t            // 1.   allow if the session is NOT forced stopped (see the .stop() method)\n\t            // 2.   allow if we still haven't recognized a gesture in this session, or the this recognizer is the one\n\t            //      that is being recognized.\n\t            // 3.   allow if the recognizer is allowed to run simultaneous with the current recognized recognizer.\n\t            //      this can be setup with the `recognizeWith()` method on the recognizer.\n\t            if (session.stopped !== FORCED_STOP && ( // 1\n\t                    !curRecognizer || recognizer == curRecognizer || // 2\n\t                    recognizer.canRecognizeWith(curRecognizer))) { // 3\n\t                recognizer.recognize(inputData);\n\t            } else {\n\t                recognizer.reset();\n\t            }\n\t\n\t            // if the recognizer has been recognizing the input as a valid gesture, we want to store this one as the\n\t            // current active recognizer. but only if we don't already have an active recognizer\n\t            if (!curRecognizer && recognizer.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED)) {\n\t                curRecognizer = session.curRecognizer = recognizer;\n\t            }\n\t            i++;\n\t        }\n\t    },\n\t\n\t    /**\n\t     * get a recognizer by its event name.\n\t     * @param {Recognizer|String} recognizer\n\t     * @returns {Recognizer|Null}\n\t     */\n\t    get: function(recognizer) {\n\t        if (recognizer instanceof Recognizer) {\n\t            return recognizer;\n\t        }\n\t\n\t        var recognizers = this.recognizers;\n\t        for (var i = 0; i < recognizers.length; i++) {\n\t            if (recognizers[i].options.event == recognizer) {\n\t                return recognizers[i];\n\t            }\n\t        }\n\t        return null;\n\t    },\n\t\n\t    /**\n\t     * add a recognizer to the manager\n\t     * existing recognizers with the same event name will be removed\n\t     * @param {Recognizer} recognizer\n\t     * @returns {Recognizer|Manager}\n\t     */\n\t    add: function(recognizer) {\n\t        if (invokeArrayArg(recognizer, 'add', this)) {\n\t            return this;\n\t        }\n\t\n\t        // remove existing\n\t        var existing = this.get(recognizer.options.event);\n\t        if (existing) {\n\t            this.remove(existing);\n\t        }\n\t\n\t        this.recognizers.push(recognizer);\n\t        recognizer.manager = this;\n\t\n\t        this.touchAction.update();\n\t        return recognizer;\n\t    },\n\t\n\t    /**\n\t     * remove a recognizer by name or instance\n\t     * @param {Recognizer|String} recognizer\n\t     * @returns {Manager}\n\t     */\n\t    remove: function(recognizer) {\n\t        if (invokeArrayArg(recognizer, 'remove', this)) {\n\t            return this;\n\t        }\n\t\n\t        recognizer = this.get(recognizer);\n\t\n\t        // let's make sure this recognizer exists\n\t        if (recognizer) {\n\t            var recognizers = this.recognizers;\n\t            var index = inArray(recognizers, recognizer);\n\t\n\t            if (index !== -1) {\n\t                recognizers.splice(index, 1);\n\t                this.touchAction.update();\n\t            }\n\t        }\n\t\n\t        return this;\n\t    },\n\t\n\t    /**\n\t     * bind event\n\t     * @param {String} events\n\t     * @param {Function} handler\n\t     * @returns {EventEmitter} this\n\t     */\n\t    on: function(events, handler) {\n\t        if (events === undefined) {\n\t            return;\n\t        }\n\t        if (handler === undefined) {\n\t            return;\n\t        }\n\t\n\t        var handlers = this.handlers;\n\t        each(splitStr(events), function(event) {\n\t            handlers[event] = handlers[event] || [];\n\t            handlers[event].push(handler);\n\t        });\n\t        return this;\n\t    },\n\t\n\t    /**\n\t     * unbind event, leave emit blank to remove all handlers\n\t     * @param {String} events\n\t     * @param {Function} [handler]\n\t     * @returns {EventEmitter} this\n\t     */\n\t    off: function(events, handler) {\n\t        if (events === undefined) {\n\t            return;\n\t        }\n\t\n\t        var handlers = this.handlers;\n\t        each(splitStr(events), function(event) {\n\t            if (!handler) {\n\t                delete handlers[event];\n\t            } else {\n\t                handlers[event] && handlers[event].splice(inArray(handlers[event], handler), 1);\n\t            }\n\t        });\n\t        return this;\n\t    },\n\t\n\t    /**\n\t     * emit event to the listeners\n\t     * @param {String} event\n\t     * @param {Object} data\n\t     */\n\t    emit: function(event, data) {\n\t        // we also want to trigger dom events\n\t        if (this.options.domEvents) {\n\t            triggerDomEvent(event, data);\n\t        }\n\t\n\t        // no handlers, so skip it all\n\t        var handlers = this.handlers[event] && this.handlers[event].slice();\n\t        if (!handlers || !handlers.length) {\n\t            return;\n\t        }\n\t\n\t        data.type = event;\n\t        data.preventDefault = function() {\n\t            data.srcEvent.preventDefault();\n\t        };\n\t\n\t        var i = 0;\n\t        while (i < handlers.length) {\n\t            handlers[i](data);\n\t            i++;\n\t        }\n\t    },\n\t\n\t    /**\n\t     * destroy the manager and unbinds all events\n\t     * it doesn't unbind dom events, that is the user own responsibility\n\t     */\n\t    destroy: function() {\n\t        this.element && toggleCssProps(this, false);\n\t\n\t        this.handlers = {};\n\t        this.session = {};\n\t        this.input.destroy();\n\t        this.element = null;\n\t    }\n\t};\n\t\n\t/**\n\t * add/remove the css properties as defined in manager.options.cssProps\n\t * @param {Manager} manager\n\t * @param {Boolean} add\n\t */\n\tfunction toggleCssProps(manager, add) {\n\t    var element = manager.element;\n\t    if (!element.style) {\n\t        return;\n\t    }\n\t    var prop;\n\t    each(manager.options.cssProps, function(value, name) {\n\t        prop = prefixed(element.style, name);\n\t        if (add) {\n\t            manager.oldCssProps[prop] = element.style[prop];\n\t            element.style[prop] = value;\n\t        } else {\n\t            element.style[prop] = manager.oldCssProps[prop] || '';\n\t        }\n\t    });\n\t    if (!add) {\n\t        manager.oldCssProps = {};\n\t    }\n\t}\n\t\n\t/**\n\t * trigger dom event\n\t * @param {String} event\n\t * @param {Object} data\n\t */\n\tfunction triggerDomEvent(event, data) {\n\t    var gestureEvent = document.createEvent('Event');\n\t    gestureEvent.initEvent(event, true, true);\n\t    gestureEvent.gesture = data;\n\t    data.target.dispatchEvent(gestureEvent);\n\t}\n\t\n\tassign(Hammer, {\n\t    INPUT_START: INPUT_START,\n\t    INPUT_MOVE: INPUT_MOVE,\n\t    INPUT_END: INPUT_END,\n\t    INPUT_CANCEL: INPUT_CANCEL,\n\t\n\t    STATE_POSSIBLE: STATE_POSSIBLE,\n\t    STATE_BEGAN: STATE_BEGAN,\n\t    STATE_CHANGED: STATE_CHANGED,\n\t    STATE_ENDED: STATE_ENDED,\n\t    STATE_RECOGNIZED: STATE_RECOGNIZED,\n\t    STATE_CANCELLED: STATE_CANCELLED,\n\t    STATE_FAILED: STATE_FAILED,\n\t\n\t    DIRECTION_NONE: DIRECTION_NONE,\n\t    DIRECTION_LEFT: DIRECTION_LEFT,\n\t    DIRECTION_RIGHT: DIRECTION_RIGHT,\n\t    DIRECTION_UP: DIRECTION_UP,\n\t    DIRECTION_DOWN: DIRECTION_DOWN,\n\t    DIRECTION_HORIZONTAL: DIRECTION_HORIZONTAL,\n\t    DIRECTION_VERTICAL: DIRECTION_VERTICAL,\n\t    DIRECTION_ALL: DIRECTION_ALL,\n\t\n\t    Manager: Manager,\n\t    Input: Input,\n\t    TouchAction: TouchAction,\n\t\n\t    TouchInput: TouchInput,\n\t    MouseInput: MouseInput,\n\t    PointerEventInput: PointerEventInput,\n\t    TouchMouseInput: TouchMouseInput,\n\t    SingleTouchInput: SingleTouchInput,\n\t\n\t    Recognizer: Recognizer,\n\t    AttrRecognizer: AttrRecognizer,\n\t    Tap: TapRecognizer,\n\t    Pan: PanRecognizer,\n\t    Swipe: SwipeRecognizer,\n\t    Pinch: PinchRecognizer,\n\t    Rotate: RotateRecognizer,\n\t    Press: PressRecognizer,\n\t\n\t    on: addEventListeners,\n\t    off: removeEventListeners,\n\t    each: each,\n\t    merge: merge,\n\t    extend: extend,\n\t    assign: assign,\n\t    inherit: inherit,\n\t    bindFn: bindFn,\n\t    prefixed: prefixed\n\t});\n\t\n\t// this prevents errors when Hammer is loaded in the presence of an AMD\n\t//  style loader but by script tag, not by the loader.\n\tvar freeGlobal = (typeof window !== 'undefined' ? window : (typeof self !== 'undefined' ? self : {})); // jshint ignore:line\n\tfreeGlobal.Hammer = Hammer;\n\t\n\tif (true) {\n\t    !(__WEBPACK_AMD_DEFINE_RESULT__ = function() {\n\t        return Hammer;\n\t    }.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t} else if (typeof module != 'undefined' && module.exports) {\n\t    module.exports = Hammer;\n\t} else {\n\t    window[exportName] = Hammer;\n\t}\n\t\n\t})(window, document, 'Hammer');\n\n\n/***/ },\n/* 38 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_38__;\n\n/***/ },\n/* 39 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _TileLayer2 = __webpack_require__(40);\n\t\n\tvar _TileLayer3 = _interopRequireDefault(_TileLayer2);\n\t\n\tvar _ImageTile = __webpack_require__(50);\n\t\n\tvar _ImageTile2 = _interopRequireDefault(_ImageTile);\n\t\n\tvar _ImageTileLayerBaseMaterial = __webpack_require__(53);\n\t\n\tvar _ImageTileLayerBaseMaterial2 = _interopRequireDefault(_ImageTileLayerBaseMaterial);\n\t\n\tvar _lodashThrottle = __webpack_require__(33);\n\t\n\tvar _lodashThrottle2 = _interopRequireDefault(_lodashThrottle);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\t// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\t\n\t// DONE: Find a way to avoid the flashing caused by the gap between old tiles\n\t// being removed and the new tiles being ready for display\n\t//\n\t// DONE: Simplest first step for MVP would be to give each tile mesh the colour\n\t// of the basemap ground so it blends in a little more, or have a huge ground\n\t// plane underneath all the tiles that shows through between tile updates.\n\t//\n\t// Could keep the old tiles around until the new ones are ready, though they'd\n\t// probably need to be layered in a way so the old tiles don't overlap new ones,\n\t// which is similar to how Leaflet approaches this (it has 2 layers)\n\t//\n\t// Could keep the tile from the previous quadtree level visible until all 4\n\t// tiles at the new / current level have finished loading and are displayed.\n\t// Perhaps by keeping a map of tiles by quadcode and a boolean for each of the\n\t// child quadcodes showing whether they are loaded and in view. If all true then\n\t// remove the parent tile, otherwise keep it on a lower layer.\n\t\n\t// TODO: Load and display a base layer separate to the LOD grid that is at a low\n\t// resolution – used as a backup / background to fill in empty areas / distance\n\t\n\t// DONE: Fix the issue where some tiles just don't load, or at least the texture\n\t// never shows up – tends to happen if you quickly zoom in / out past it while\n\t// it's still loading, leaving a blank space\n\t\n\t// TODO: Optimise the request of many image tiles – look at how Leaflet and\n\t// OpenWebGlobe approach this (eg. batching, queues, etc)\n\t\n\t// TODO: Cancel pending tile requests if they get removed from view before they\n\t// reach a ready state (eg. cancel image requests, etc). Need to ensure that the\n\t// images are re-requested when the tile is next in scene (even if from cache)\n\t\n\t// TODO: Consider not performing an LOD calculation on every frame, instead only\n\t// on move end so panning, orbiting and zooming stays smooth. Otherwise it's\n\t// possible for performance to tank if you pan, orbit or zoom rapidly while all\n\t// the LOD calculations are being made and new tiles requested.\n\t//\n\t// Pending tiles should continue to be requested and output to the scene on each\n\t// frame, but no new LOD calculations should be made.\n\t\n\t// This tile layer both updates the quadtree and outputs tiles on every frame\n\t// (throttled to some amount)\n\t//\n\t// This is because the computational complexity of image tiles is generally low\n\t// and so there isn't much jank when running these calculations and outputs in\n\t// realtime\n\t//\n\t// The benefit to doing this is that the underlying map layer continues to\n\t// refresh and update during movement, which is an arguably better experience\n\t\n\tvar ImageTileLayer = (function (_TileLayer) {\n\t  _inherits(ImageTileLayer, _TileLayer);\n\t\n\t  function ImageTileLayer(path, options) {\n\t    _classCallCheck(this, ImageTileLayer);\n\t\n\t    var defaults = {\n\t      distance: 300000\n\t    };\n\t\n\t    options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    _get(Object.getPrototypeOf(ImageTileLayer.prototype), 'constructor', this).call(this, options);\n\t\n\t    this._path = path;\n\t  }\n\t\n\t  _createClass(ImageTileLayer, [{\n\t    key: '_onAdd',\n\t    value: function _onAdd(world) {\n\t      var _this = this;\n\t\n\t      _get(Object.getPrototypeOf(ImageTileLayer.prototype), '_onAdd', this).call(this, world);\n\t\n\t      // Add base layer\n\t      var geom = new _three2['default'].PlaneBufferGeometry(2000000, 2000000, 1);\n\t\n\t      var baseMaterial;\n\t      if (this._world._environment._skybox) {\n\t        baseMaterial = (0, _ImageTileLayerBaseMaterial2['default'])('#f5f5f3', this._world._environment._skybox.getRenderTarget());\n\t      } else {\n\t        baseMaterial = (0, _ImageTileLayerBaseMaterial2['default'])('#f5f5f3');\n\t      }\n\t\n\t      var mesh = new _three2['default'].Mesh(geom, baseMaterial);\n\t      mesh.renderOrder = 0;\n\t      mesh.rotation.x = -90 * Math.PI / 180;\n\t\n\t      // TODO: It might be overkill to receive a shadow on the base layer as it's\n\t      // rarely seen (good to have if performance difference is negligible)\n\t      mesh.receiveShadow = true;\n\t\n\t      this._baseLayer = mesh;\n\t      this.add(mesh);\n\t\n\t      // Trigger initial quadtree calculation on the next frame\n\t      //\n\t      // TODO: This is a hack to ensure the camera is all set up - a better\n\t      // solution should be found\n\t      setTimeout(function () {\n\t        _this._calculateLOD();\n\t        _this._initEvents();\n\t      }, 0);\n\t    }\n\t  }, {\n\t    key: '_initEvents',\n\t    value: function _initEvents() {\n\t      // Run LOD calculations based on render calls\n\t      //\n\t      // Throttled to 1 LOD calculation per 100ms\n\t      this._throttledWorldUpdate = (0, _lodashThrottle2['default'])(this._onWorldUpdate, 100);\n\t\n\t      this._world.on('preUpdate', this._throttledWorldUpdate, this);\n\t      this._world.on('move', this._onWorldMove, this);\n\t    }\n\t  }, {\n\t    key: '_onWorldUpdate',\n\t    value: function _onWorldUpdate() {\n\t      this._calculateLOD();\n\t      this._outputTiles();\n\t    }\n\t  }, {\n\t    key: '_onWorldMove',\n\t    value: function _onWorldMove(latlon, point) {\n\t      this._moveBaseLayer(point);\n\t    }\n\t  }, {\n\t    key: '_moveBaseLayer',\n\t    value: function _moveBaseLayer(point) {\n\t      this._baseLayer.position.x = point.x;\n\t      this._baseLayer.position.z = point.y;\n\t    }\n\t  }, {\n\t    key: '_createTile',\n\t    value: function _createTile(quadcode, layer) {\n\t      return new _ImageTile2['default'](quadcode, this._path, layer);\n\t    }\n\t\n\t    // Destroys the layer and removes it from the scene and memory\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      this._world.off('preUpdate', this._throttledWorldUpdate);\n\t      this._world.off('move', this._onWorldMove);\n\t\n\t      this._throttledWorldUpdate = null;\n\t\n\t      // Dispose of mesh and materials\n\t      this._baseLayer.geometry.dispose();\n\t      this._baseLayer.geometry = null;\n\t\n\t      if (this._baseLayer.material.map) {\n\t        this._baseLayer.material.map.dispose();\n\t        this._baseLayer.material.map = null;\n\t      }\n\t\n\t      this._baseLayer.material.dispose();\n\t      this._baseLayer.material = null;\n\t\n\t      this._baseLayer = null;\n\t\n\t      // Run common destruction logic from parent\n\t      _get(Object.getPrototypeOf(ImageTileLayer.prototype), 'destroy', this).call(this);\n\t    }\n\t  }]);\n\t\n\t  return ImageTileLayer;\n\t})(_TileLayer3['default']);\n\t\n\texports['default'] = ImageTileLayer;\n\t\n\tvar noNew = function noNew(path, options) {\n\t  return new ImageTileLayer(path, options);\n\t};\n\t\n\t// Initialise without requiring new keyword\n\texports.imageTileLayer = noNew;\n\n/***/ },\n/* 40 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _Layer2 = __webpack_require__(30);\n\t\n\tvar _Layer3 = _interopRequireDefault(_Layer2);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar _TileCache = __webpack_require__(41);\n\t\n\tvar _TileCache2 = _interopRequireDefault(_TileCache);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t// TODO: Consider removing picking from TileLayer instances as there aren't\n\t// (m)any situations where it would be practical\n\t//\n\t// For example, how would you even know what picking IDs to listen to and what\n\t// to do with them?\n\t\n\t// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\t\n\t// TODO: Consider keeping a single TileLayer / LOD instance running by default\n\t// that keeps a standard LOD grid for other layers to utilise, rather than\n\t// having to create their own, unique LOD grid and duplicate calculations when\n\t// they're going to use the same grid setup anyway\n\t//\n\t// It still makes sense to be able to have a custom LOD grid for some layers as\n\t// they may want to customise things, maybe not even using a quadtree at all!\n\t//\n\t// Perhaps it makes sense to split out the quadtree stuff into a singleton and\n\t// pass in the necessary parameters each time for the calculation step.\n\t//\n\t// Either way, it seems silly to force layers to have to create a new LOD grid\n\t// each time and create extra, duplicated processing every frame.\n\t\n\t// TODO: Allow passing in of options to define min/max LOD and a distance to use\n\t// for culling tiles beyond that distance.\n\t\n\t// DONE: Prevent tiles from being loaded if they are further than a certain\n\t// distance from the camera and are unlikely to be seen anyway\n\t\n\t// TODO: Avoid performing LOD calculation when it isn't required. For example,\n\t// when nothing has changed since the last frame and there are no tiles to be\n\t// loaded or in need of rendering\n\t\n\t// TODO: Only remove tiles from the layer that aren't to be rendered in the\n\t// current frame – it seems excessive to remove all tiles and re-add them on\n\t// every single frame, even if it's just array manipulation\n\t\n\t// TODO: Fix LOD calculation so min and max LOD can be changed without causing\n\t// problems (eg. making min above 5 causes all sorts of issues)\n\t\n\t// TODO: Reuse THREE objects where possible instead of creating new instances\n\t// on every LOD calculation\n\t\n\t// TODO: Consider not using THREE or LatLon / Point objects in LOD calculations\n\t// to avoid creating unnecessary memory for garbage collection\n\t\n\t// TODO: Prioritise loading of tiles at highest level in the quadtree (those\n\t// closest to the camera) so visual inconsistancies during loading are minimised\n\t\n\tvar TileLayer = (function (_Layer) {\n\t  _inherits(TileLayer, _Layer);\n\t\n\t  function TileLayer(options) {\n\t    var _this = this;\n\t\n\t    _classCallCheck(this, TileLayer);\n\t\n\t    var defaults = {\n\t      picking: false,\n\t      maxCache: 1000,\n\t      maxLOD: 18\n\t    };\n\t\n\t    var _options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    _get(Object.getPrototypeOf(TileLayer.prototype), 'constructor', this).call(this, _options);\n\t\n\t    this._tileCache = new _TileCache2['default'](this._options.maxCache, function (tile) {\n\t      _this._destroyTile(tile);\n\t    });\n\t\n\t    // List of tiles from the previous LOD calculation\n\t    this._tileList = [];\n\t\n\t    // TODO: Work out why changing the minLOD causes loads of issues\n\t    this._minLOD = 3;\n\t    this._maxLOD = this._options.maxLOD;\n\t\n\t    this._frustum = new _three2['default'].Frustum();\n\t    this._tiles = new _three2['default'].Object3D();\n\t    this._tilesPicking = new _three2['default'].Object3D();\n\t  }\n\t\n\t  _createClass(TileLayer, [{\n\t    key: '_onAdd',\n\t    value: function _onAdd(world) {\n\t      this.addToPicking(this._tilesPicking);\n\t      this.add(this._tiles);\n\t    }\n\t  }, {\n\t    key: '_updateFrustum',\n\t    value: function _updateFrustum() {\n\t      var camera = this._world.getCamera();\n\t      var projScreenMatrix = new _three2['default'].Matrix4();\n\t      projScreenMatrix.multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse);\n\t\n\t      this._frustum.setFromMatrix(camera.projectionMatrix);\n\t      this._frustum.setFromMatrix(new _three2['default'].Matrix4().multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse));\n\t    }\n\t  }, {\n\t    key: '_tileInFrustum',\n\t    value: function _tileInFrustum(tile) {\n\t      var bounds = tile.getBounds();\n\t      return this._frustum.intersectsBox(new _three2['default'].Box3(new _three2['default'].Vector3(bounds[0], 0, bounds[3]), new _three2['default'].Vector3(bounds[2], 0, bounds[1])));\n\t    }\n\t\n\t    // Update and output tiles from the previous LOD checklist\n\t  }, {\n\t    key: '_outputTiles',\n\t    value: function _outputTiles() {\n\t      var _this2 = this;\n\t\n\t      if (!this._tiles) {\n\t        return;\n\t      }\n\t\n\t      // Remove all tiles from layer\n\t      this._removeTiles();\n\t\n\t      // Add / re-add tiles\n\t      this._tileList.forEach(function (tile) {\n\t        // Are the mesh and texture ready?\n\t        //\n\t        // If yes, continue\n\t        // If no, skip\n\t        if (!tile.isReady()) {\n\t          return;\n\t        }\n\t\n\t        // Add tile to layer (and to scene) if not already there\n\t        _this2._tiles.add(tile.getMesh());\n\t\n\t        if (tile.getPickingMesh()) {\n\t          _this2._tilesPicking.add(tile.getPickingMesh());\n\t        }\n\t      });\n\t    }\n\t\n\t    // Works out tiles in the view frustum and stores them in an array\n\t    //\n\t    // Does not output the tiles, deferring this to _outputTiles()\n\t  }, {\n\t    key: '_calculateLOD',\n\t    value: function _calculateLOD() {\n\t      var _this3 = this;\n\t\n\t      if (this._stop || !this._world) {\n\t        return;\n\t      }\n\t\n\t      // var start = performance.now();\n\t\n\t      var camera = this._world.getCamera();\n\t\n\t      // 1. Update and retrieve camera frustum\n\t      this._updateFrustum(this._frustum, camera);\n\t\n\t      // 2. Add the four root items of the quadtree to a check list\n\t      var checkList = this._checklist;\n\t      checkList = [];\n\t      checkList.push(this._requestTile('0', this));\n\t      checkList.push(this._requestTile('1', this));\n\t      checkList.push(this._requestTile('2', this));\n\t      checkList.push(this._requestTile('3', this));\n\t\n\t      // 3. Call Divide, passing in the check list\n\t      this._divide(checkList);\n\t\n\t      // // 4. Remove all tiles from layer\n\t      //\n\t      // Moved to _outputTiles() for now\n\t      // this._removeTiles();\n\t\n\t      // Order tile-list by zoom so nearest tiles are requested first\n\t      checkList.sort(function (a, b) {\n\t        return a._quadcode.length < b._quadcode.length;\n\t      });\n\t\n\t      // 5. Filter the tiles remaining in the check list\n\t      this._tileList = checkList.filter(function (tile, index) {\n\t        // Skip tile if it's not in the current view frustum\n\t        if (!_this3._tileInFrustum(tile)) {\n\t          return false;\n\t        }\n\t\n\t        if (_this3._options.distance && _this3._options.distance > 0) {\n\t          // TODO: Can probably speed this up\n\t          var center = tile.getCenter();\n\t          var dist = new _three2['default'].Vector3(center[0], 0, center[1]).sub(camera.position).length();\n\t\n\t          // Manual distance limit to cut down on tiles so far away\n\t          if (dist > _this3._options.distance) {\n\t            return false;\n\t          }\n\t        }\n\t\n\t        // Does the tile have a mesh?\n\t        //\n\t        // If yes, continue\n\t        // If no, generate tile mesh, request texture and skip\n\t        if (!tile.getMesh()) {\n\t          tile.requestTileAsync();\n\t        }\n\t\n\t        return true;\n\t\n\t        // Are the mesh and texture ready?\n\t        //\n\t        // If yes, continue\n\t        // If no, skip\n\t        // if (!tile.isReady()) {\n\t        //   return;\n\t        // }\n\t        //\n\t        // // Add tile to layer (and to scene)\n\t        // this._tiles.add(tile.getMesh());\n\t      });\n\t\n\t      // console.log(performance.now() - start);\n\t    }\n\t  }, {\n\t    key: '_divide',\n\t    value: function _divide(checkList) {\n\t      var count = 0;\n\t      var currentItem;\n\t      var quadcode;\n\t\n\t      // 1. Loop until count equals check list length\n\t      while (count != checkList.length) {\n\t        currentItem = checkList[count];\n\t        quadcode = currentItem.getQuadcode();\n\t\n\t        // 2. Increase count and continue loop if quadcode equals max LOD / zoom\n\t        if (currentItem.length === this._maxLOD) {\n\t          count++;\n\t          continue;\n\t        }\n\t\n\t        // 3. Else, calculate screen-space error metric for quadcode\n\t        if (this._screenSpaceError(currentItem)) {\n\t          // 4. If error is sufficient...\n\t\n\t          // 4a. Remove parent item from the check list\n\t          checkList.splice(count, 1);\n\t\n\t          // 4b. Add 4 child items to the check list\n\t          checkList.push(this._requestTile(quadcode + '0', this));\n\t          checkList.push(this._requestTile(quadcode + '1', this));\n\t          checkList.push(this._requestTile(quadcode + '2', this));\n\t          checkList.push(this._requestTile(quadcode + '3', this));\n\t\n\t          // 4d. Continue the loop without increasing count\n\t          continue;\n\t        } else {\n\t          // 5. Else, increase count and continue loop\n\t          count++;\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: '_screenSpaceError',\n\t    value: function _screenSpaceError(tile) {\n\t      var minDepth = this._minLOD;\n\t      var maxDepth = this._maxLOD;\n\t\n\t      var quadcode = tile.getQuadcode();\n\t\n\t      var camera = this._world.getCamera();\n\t\n\t      // Tweak this value to refine specific point that each quad is subdivided\n\t      //\n\t      // It's used to multiple the dimensions of the tile sides before\n\t      // comparing against the tile distance from camera\n\t      var quality = 3.0;\n\t\n\t      // 1. Return false if quadcode length equals maxDepth (stop dividing)\n\t      if (quadcode.length === maxDepth) {\n\t        return false;\n\t      }\n\t\n\t      // 2. Return true if quadcode length is less than minDepth\n\t      if (quadcode.length < minDepth) {\n\t        return true;\n\t      }\n\t\n\t      // 3. Return false if quadcode bounds are not in view frustum\n\t      if (!this._tileInFrustum(tile)) {\n\t        return false;\n\t      }\n\t\n\t      var center = tile.getCenter();\n\t\n\t      // 4. Calculate screen-space error metric\n\t      // TODO: Use closest distance to one of the 4 tile corners\n\t      var dist = new _three2['default'].Vector3(center[0], 0, center[1]).sub(camera.position).length();\n\t\n\t      var error = quality * tile.getSide() / dist;\n\t\n\t      // 5. Return true if error is greater than 1.0, else return false\n\t      return error > 1.0;\n\t    }\n\t  }, {\n\t    key: '_removeTiles',\n\t    value: function _removeTiles() {\n\t      if (!this._tiles || !this._tiles.children) {\n\t        return;\n\t      }\n\t\n\t      for (var i = this._tiles.children.length - 1; i >= 0; i--) {\n\t        this._tiles.remove(this._tiles.children[i]);\n\t      }\n\t\n\t      if (!this._tilesPicking || !this._tilesPicking.children) {\n\t        return;\n\t      }\n\t\n\t      for (var i = this._tilesPicking.children.length - 1; i >= 0; i--) {\n\t        this._tilesPicking.remove(this._tilesPicking.children[i]);\n\t      }\n\t    }\n\t\n\t    // Return a new tile instance\n\t  }, {\n\t    key: '_createTile',\n\t    value: function _createTile(quadcode, layer) {}\n\t\n\t    // Get a cached tile or request a new one if not in cache\n\t  }, {\n\t    key: '_requestTile',\n\t    value: function _requestTile(quadcode, layer) {\n\t      var tile = this._tileCache.getTile(quadcode);\n\t\n\t      if (!tile) {\n\t        // Set up a brand new tile\n\t        tile = this._createTile(quadcode, layer);\n\t\n\t        // Add tile to cache, though it won't be ready yet as the data is being\n\t        // requested from various places asynchronously\n\t        this._tileCache.setTile(quadcode, tile);\n\t      }\n\t\n\t      return tile;\n\t    }\n\t  }, {\n\t    key: '_destroyTile',\n\t    value: function _destroyTile(tile) {\n\t      // Remove tile from scene\n\t      this._tiles.remove(tile.getMesh());\n\t\n\t      // Delete any references to the tile within this component\n\t\n\t      // Call destory on tile instance\n\t      tile.destroy();\n\t    }\n\t\n\t    // Destroys the layer and removes it from the scene and memory\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      if (this._tiles.children) {\n\t        // Remove all tiles\n\t        for (var i = this._tiles.children.length - 1; i >= 0; i--) {\n\t          this._tiles.remove(this._tiles.children[i]);\n\t        }\n\t      }\n\t\n\t      // Remove tile from picking scene\n\t      this.removeFromPicking(this._tilesPicking);\n\t\n\t      if (this._tilesPicking.children) {\n\t        // Remove all tiles\n\t        for (var i = this._tilesPicking.children.length - 1; i >= 0; i--) {\n\t          this._tilesPicking.remove(this._tilesPicking.children[i]);\n\t        }\n\t      }\n\t\n\t      this._tileCache.destroy();\n\t      this._tileCache = null;\n\t\n\t      this._tiles = null;\n\t      this._tilesPicking = null;\n\t      this._frustum = null;\n\t\n\t      _get(Object.getPrototypeOf(TileLayer.prototype), 'destroy', this).call(this);\n\t    }\n\t  }]);\n\t\n\t  return TileLayer;\n\t})(_Layer3['default']);\n\t\n\texports['default'] = TileLayer;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 41 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tvar _lruCache = __webpack_require__(42);\n\t\n\tvar _lruCache2 = _interopRequireDefault(_lruCache);\n\t\n\t// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\t\n\t// This process is based on a similar approach taken by OpenWebGlobe\n\t// See: https://github.com/OpenWebGlobe/WebViewer/blob/master/source/core/globecache.js\n\t\n\tvar TileCache = (function () {\n\t  function TileCache(cacheLimit, onDestroyTile) {\n\t    _classCallCheck(this, TileCache);\n\t\n\t    this._cache = (0, _lruCache2['default'])({\n\t      max: cacheLimit,\n\t      dispose: function dispose(key, tile) {\n\t        onDestroyTile(tile);\n\t      }\n\t    });\n\t  }\n\t\n\t  // Returns true if all specified tile providers are ready to be used\n\t  // Otherwise, returns false\n\t\n\t  _createClass(TileCache, [{\n\t    key: 'isReady',\n\t    value: function isReady() {\n\t      return false;\n\t    }\n\t\n\t    // Get a cached tile without requesting a new one\n\t  }, {\n\t    key: 'getTile',\n\t    value: function getTile(quadcode) {\n\t      return this._cache.get(quadcode);\n\t    }\n\t\n\t    // Add tile to cache\n\t  }, {\n\t    key: 'setTile',\n\t    value: function setTile(quadcode, tile) {\n\t      this._cache.set(quadcode, tile);\n\t    }\n\t\n\t    // Destroy the cache and remove it from memory\n\t    //\n\t    // TODO: Call destroy method on items in cache\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      this._cache.reset();\n\t      this._cache = null;\n\t    }\n\t  }]);\n\t\n\t  return TileCache;\n\t})();\n\t\n\texports['default'] = TileCache;\n\t\n\tvar noNew = function noNew(cacheLimit, onDestroyTile) {\n\t  return new TileCache(cacheLimit, onDestroyTile);\n\t};\n\t\n\t// Initialise without requiring new keyword\n\texports.tileCache = noNew;\n\n/***/ },\n/* 42 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = LRUCache\n\t\n\t// This will be a proper iterable 'Map' in engines that support it,\n\t// or a fakey-fake PseudoMap in older versions.\n\tvar Map = __webpack_require__(43)\n\tvar util = __webpack_require__(46)\n\t\n\t// A linked list to keep track of recently-used-ness\n\tvar Yallist = __webpack_require__(49)\n\t\n\t// use symbols if possible, otherwise just _props\n\tvar symbols = {}\n\tvar hasSymbol = typeof Symbol === 'function'\n\tvar makeSymbol\n\t/* istanbul ignore if */\n\tif (hasSymbol) {\n\t  makeSymbol = function (key) {\n\t    return Symbol.for(key)\n\t  }\n\t} else {\n\t  makeSymbol = function (key) {\n\t    return '_' + key\n\t  }\n\t}\n\t\n\tfunction priv (obj, key, val) {\n\t  var sym\n\t  if (symbols[key]) {\n\t    sym = symbols[key]\n\t  } else {\n\t    sym = makeSymbol(key)\n\t    symbols[key] = sym\n\t  }\n\t  if (arguments.length === 2) {\n\t    return obj[sym]\n\t  } else {\n\t    obj[sym] = val\n\t    return val\n\t  }\n\t}\n\t\n\tfunction naiveLength () { return 1 }\n\t\n\t// lruList is a yallist where the head is the youngest\n\t// item, and the tail is the oldest.  the list contains the Hit\n\t// objects as the entries.\n\t// Each Hit object has a reference to its Yallist.Node.  This\n\t// never changes.\n\t//\n\t// cache is a Map (or PseudoMap) that matches the keys to\n\t// the Yallist.Node object.\n\tfunction LRUCache (options) {\n\t  if (!(this instanceof LRUCache)) {\n\t    return new LRUCache(options)\n\t  }\n\t\n\t  if (typeof options === 'number') {\n\t    options = { max: options }\n\t  }\n\t\n\t  if (!options) {\n\t    options = {}\n\t  }\n\t\n\t  var max = priv(this, 'max', options.max)\n\t  // Kind of weird to have a default max of Infinity, but oh well.\n\t  if (!max ||\n\t      !(typeof max === 'number') ||\n\t      max <= 0) {\n\t    priv(this, 'max', Infinity)\n\t  }\n\t\n\t  var lc = options.length || naiveLength\n\t  if (typeof lc !== 'function') {\n\t    lc = naiveLength\n\t  }\n\t  priv(this, 'lengthCalculator', lc)\n\t\n\t  priv(this, 'allowStale', options.stale || false)\n\t  priv(this, 'maxAge', options.maxAge || 0)\n\t  priv(this, 'dispose', options.dispose)\n\t  this.reset()\n\t}\n\t\n\t// resize the cache when the max changes.\n\tObject.defineProperty(LRUCache.prototype, 'max', {\n\t  set: function (mL) {\n\t    if (!mL || !(typeof mL === 'number') || mL <= 0) {\n\t      mL = Infinity\n\t    }\n\t    priv(this, 'max', mL)\n\t    trim(this)\n\t  },\n\t  get: function () {\n\t    return priv(this, 'max')\n\t  },\n\t  enumerable: true\n\t})\n\t\n\tObject.defineProperty(LRUCache.prototype, 'allowStale', {\n\t  set: function (allowStale) {\n\t    priv(this, 'allowStale', !!allowStale)\n\t  },\n\t  get: function () {\n\t    return priv(this, 'allowStale')\n\t  },\n\t  enumerable: true\n\t})\n\t\n\tObject.defineProperty(LRUCache.prototype, 'maxAge', {\n\t  set: function (mA) {\n\t    if (!mA || !(typeof mA === 'number') || mA < 0) {\n\t      mA = 0\n\t    }\n\t    priv(this, 'maxAge', mA)\n\t    trim(this)\n\t  },\n\t  get: function () {\n\t    return priv(this, 'maxAge')\n\t  },\n\t  enumerable: true\n\t})\n\t\n\t// resize the cache when the lengthCalculator changes.\n\tObject.defineProperty(LRUCache.prototype, 'lengthCalculator', {\n\t  set: function (lC) {\n\t    if (typeof lC !== 'function') {\n\t      lC = naiveLength\n\t    }\n\t    if (lC !== priv(this, 'lengthCalculator')) {\n\t      priv(this, 'lengthCalculator', lC)\n\t      priv(this, 'length', 0)\n\t      priv(this, 'lruList').forEach(function (hit) {\n\t        hit.length = priv(this, 'lengthCalculator').call(this, hit.value, hit.key)\n\t        priv(this, 'length', priv(this, 'length') + hit.length)\n\t      }, this)\n\t    }\n\t    trim(this)\n\t  },\n\t  get: function () { return priv(this, 'lengthCalculator') },\n\t  enumerable: true\n\t})\n\t\n\tObject.defineProperty(LRUCache.prototype, 'length', {\n\t  get: function () { return priv(this, 'length') },\n\t  enumerable: true\n\t})\n\t\n\tObject.defineProperty(LRUCache.prototype, 'itemCount', {\n\t  get: function () { return priv(this, 'lruList').length },\n\t  enumerable: true\n\t})\n\t\n\tLRUCache.prototype.rforEach = function (fn, thisp) {\n\t  thisp = thisp || this\n\t  for (var walker = priv(this, 'lruList').tail; walker !== null;) {\n\t    var prev = walker.prev\n\t    forEachStep(this, fn, walker, thisp)\n\t    walker = prev\n\t  }\n\t}\n\t\n\tfunction forEachStep (self, fn, node, thisp) {\n\t  var hit = node.value\n\t  if (isStale(self, hit)) {\n\t    del(self, node)\n\t    if (!priv(self, 'allowStale')) {\n\t      hit = undefined\n\t    }\n\t  }\n\t  if (hit) {\n\t    fn.call(thisp, hit.value, hit.key, self)\n\t  }\n\t}\n\t\n\tLRUCache.prototype.forEach = function (fn, thisp) {\n\t  thisp = thisp || this\n\t  for (var walker = priv(this, 'lruList').head; walker !== null;) {\n\t    var next = walker.next\n\t    forEachStep(this, fn, walker, thisp)\n\t    walker = next\n\t  }\n\t}\n\t\n\tLRUCache.prototype.keys = function () {\n\t  return priv(this, 'lruList').toArray().map(function (k) {\n\t    return k.key\n\t  }, this)\n\t}\n\t\n\tLRUCache.prototype.values = function () {\n\t  return priv(this, 'lruList').toArray().map(function (k) {\n\t    return k.value\n\t  }, this)\n\t}\n\t\n\tLRUCache.prototype.reset = function () {\n\t  if (priv(this, 'dispose') &&\n\t      priv(this, 'lruList') &&\n\t      priv(this, 'lruList').length) {\n\t    priv(this, 'lruList').forEach(function (hit) {\n\t      priv(this, 'dispose').call(this, hit.key, hit.value)\n\t    }, this)\n\t  }\n\t\n\t  priv(this, 'cache', new Map()) // hash of items by key\n\t  priv(this, 'lruList', new Yallist()) // list of items in order of use recency\n\t  priv(this, 'length', 0) // length of items in the list\n\t}\n\t\n\tLRUCache.prototype.dump = function () {\n\t  return priv(this, 'lruList').map(function (hit) {\n\t    if (!isStale(this, hit)) {\n\t      return {\n\t        k: hit.key,\n\t        v: hit.value,\n\t        e: hit.now + (hit.maxAge || 0)\n\t      }\n\t    }\n\t  }, this).toArray().filter(function (h) {\n\t    return h\n\t  })\n\t}\n\t\n\tLRUCache.prototype.dumpLru = function () {\n\t  return priv(this, 'lruList')\n\t}\n\t\n\tLRUCache.prototype.inspect = function (n, opts) {\n\t  var str = 'LRUCache {'\n\t  var extras = false\n\t\n\t  var as = priv(this, 'allowStale')\n\t  if (as) {\n\t    str += '\\n  allowStale: true'\n\t    extras = true\n\t  }\n\t\n\t  var max = priv(this, 'max')\n\t  if (max && max !== Infinity) {\n\t    if (extras) {\n\t      str += ','\n\t    }\n\t    str += '\\n  max: ' + util.inspect(max, opts)\n\t    extras = true\n\t  }\n\t\n\t  var maxAge = priv(this, 'maxAge')\n\t  if (maxAge) {\n\t    if (extras) {\n\t      str += ','\n\t    }\n\t    str += '\\n  maxAge: ' + util.inspect(maxAge, opts)\n\t    extras = true\n\t  }\n\t\n\t  var lc = priv(this, 'lengthCalculator')\n\t  if (lc && lc !== naiveLength) {\n\t    if (extras) {\n\t      str += ','\n\t    }\n\t    str += '\\n  length: ' + util.inspect(priv(this, 'length'), opts)\n\t    extras = true\n\t  }\n\t\n\t  var didFirst = false\n\t  priv(this, 'lruList').forEach(function (item) {\n\t    if (didFirst) {\n\t      str += ',\\n  '\n\t    } else {\n\t      if (extras) {\n\t        str += ',\\n'\n\t      }\n\t      didFirst = true\n\t      str += '\\n  '\n\t    }\n\t    var key = util.inspect(item.key).split('\\n').join('\\n  ')\n\t    var val = { value: item.value }\n\t    if (item.maxAge !== maxAge) {\n\t      val.maxAge = item.maxAge\n\t    }\n\t    if (lc !== naiveLength) {\n\t      val.length = item.length\n\t    }\n\t    if (isStale(this, item)) {\n\t      val.stale = true\n\t    }\n\t\n\t    val = util.inspect(val, opts).split('\\n').join('\\n  ')\n\t    str += key + ' => ' + val\n\t  })\n\t\n\t  if (didFirst || extras) {\n\t    str += '\\n'\n\t  }\n\t  str += '}'\n\t\n\t  return str\n\t}\n\t\n\tLRUCache.prototype.set = function (key, value, maxAge) {\n\t  maxAge = maxAge || priv(this, 'maxAge')\n\t\n\t  var now = maxAge ? Date.now() : 0\n\t  var len = priv(this, 'lengthCalculator').call(this, value, key)\n\t\n\t  if (priv(this, 'cache').has(key)) {\n\t    if (len > priv(this, 'max')) {\n\t      del(this, priv(this, 'cache').get(key))\n\t      return false\n\t    }\n\t\n\t    var node = priv(this, 'cache').get(key)\n\t    var item = node.value\n\t\n\t    // dispose of the old one before overwriting\n\t    if (priv(this, 'dispose')) {\n\t      priv(this, 'dispose').call(this, key, item.value)\n\t    }\n\t\n\t    item.now = now\n\t    item.maxAge = maxAge\n\t    item.value = value\n\t    priv(this, 'length', priv(this, 'length') + (len - item.length))\n\t    item.length = len\n\t    this.get(key)\n\t    trim(this)\n\t    return true\n\t  }\n\t\n\t  var hit = new Entry(key, value, len, now, maxAge)\n\t\n\t  // oversized objects fall out of cache automatically.\n\t  if (hit.length > priv(this, 'max')) {\n\t    if (priv(this, 'dispose')) {\n\t      priv(this, 'dispose').call(this, key, value)\n\t    }\n\t    return false\n\t  }\n\t\n\t  priv(this, 'length', priv(this, 'length') + hit.length)\n\t  priv(this, 'lruList').unshift(hit)\n\t  priv(this, 'cache').set(key, priv(this, 'lruList').head)\n\t  trim(this)\n\t  return true\n\t}\n\t\n\tLRUCache.prototype.has = function (key) {\n\t  if (!priv(this, 'cache').has(key)) return false\n\t  var hit = priv(this, 'cache').get(key).value\n\t  if (isStale(this, hit)) {\n\t    return false\n\t  }\n\t  return true\n\t}\n\t\n\tLRUCache.prototype.get = function (key) {\n\t  return get(this, key, true)\n\t}\n\t\n\tLRUCache.prototype.peek = function (key) {\n\t  return get(this, key, false)\n\t}\n\t\n\tLRUCache.prototype.pop = function () {\n\t  var node = priv(this, 'lruList').tail\n\t  if (!node) return null\n\t  del(this, node)\n\t  return node.value\n\t}\n\t\n\tLRUCache.prototype.del = function (key) {\n\t  del(this, priv(this, 'cache').get(key))\n\t}\n\t\n\tLRUCache.prototype.load = function (arr) {\n\t  // reset the cache\n\t  this.reset()\n\t\n\t  var now = Date.now()\n\t  // A previous serialized cache has the most recent items first\n\t  for (var l = arr.length - 1; l >= 0; l--) {\n\t    var hit = arr[l]\n\t    var expiresAt = hit.e || 0\n\t    if (expiresAt === 0) {\n\t      // the item was created without expiration in a non aged cache\n\t      this.set(hit.k, hit.v)\n\t    } else {\n\t      var maxAge = expiresAt - now\n\t      // dont add already expired items\n\t      if (maxAge > 0) {\n\t        this.set(hit.k, hit.v, maxAge)\n\t      }\n\t    }\n\t  }\n\t}\n\t\n\tLRUCache.prototype.prune = function () {\n\t  var self = this\n\t  priv(this, 'cache').forEach(function (value, key) {\n\t    get(self, key, false)\n\t  })\n\t}\n\t\n\tfunction get (self, key, doUse) {\n\t  var node = priv(self, 'cache').get(key)\n\t  if (node) {\n\t    var hit = node.value\n\t    if (isStale(self, hit)) {\n\t      del(self, node)\n\t      if (!priv(self, 'allowStale')) hit = undefined\n\t    } else {\n\t      if (doUse) {\n\t        priv(self, 'lruList').unshiftNode(node)\n\t      }\n\t    }\n\t    if (hit) hit = hit.value\n\t  }\n\t  return hit\n\t}\n\t\n\tfunction isStale (self, hit) {\n\t  if (!hit || (!hit.maxAge && !priv(self, 'maxAge'))) {\n\t    return false\n\t  }\n\t  var stale = false\n\t  var diff = Date.now() - hit.now\n\t  if (hit.maxAge) {\n\t    stale = diff > hit.maxAge\n\t  } else {\n\t    stale = priv(self, 'maxAge') && (diff > priv(self, 'maxAge'))\n\t  }\n\t  return stale\n\t}\n\t\n\tfunction trim (self) {\n\t  if (priv(self, 'length') > priv(self, 'max')) {\n\t    for (var walker = priv(self, 'lruList').tail;\n\t         priv(self, 'length') > priv(self, 'max') && walker !== null;) {\n\t      // We know that we're about to delete this one, and also\n\t      // what the next least recently used key will be, so just\n\t      // go ahead and set it now.\n\t      var prev = walker.prev\n\t      del(self, walker)\n\t      walker = prev\n\t    }\n\t  }\n\t}\n\t\n\tfunction del (self, node) {\n\t  if (node) {\n\t    var hit = node.value\n\t    if (priv(self, 'dispose')) {\n\t      priv(self, 'dispose').call(this, hit.key, hit.value)\n\t    }\n\t    priv(self, 'length', priv(self, 'length') - hit.length)\n\t    priv(self, 'cache').delete(hit.key)\n\t    priv(self, 'lruList').removeNode(node)\n\t  }\n\t}\n\t\n\t// classy, since V8 prefers predictable objects.\n\tfunction Entry (key, value, length, now, maxAge) {\n\t  this.key = key\n\t  this.value = value\n\t  this.length = length\n\t  this.now = now\n\t  this.maxAge = maxAge || 0\n\t}\n\n\n/***/ },\n/* 43 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(process) {if (process.env.npm_package_name === 'pseudomap' &&\n\t    process.env.npm_lifecycle_script === 'test')\n\t  process.env.TEST_PSEUDOMAP = 'true'\n\t\n\tif (typeof Map === 'function' && !process.env.TEST_PSEUDOMAP) {\n\t  module.exports = Map\n\t} else {\n\t  module.exports = __webpack_require__(45)\n\t}\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(44)))\n\n/***/ },\n/* 44 */\n/***/ function(module, exports) {\n\n\t// shim for using process in browser\n\tvar process = module.exports = {};\n\t\n\t// cached from whatever global is present so that test runners that stub it\n\t// don't break things.  But we need to wrap it in a try catch in case it is\n\t// wrapped in strict mode code which doesn't define any globals.  It's inside a\n\t// function because try/catches deoptimize in certain engines.\n\t\n\tvar cachedSetTimeout;\n\tvar cachedClearTimeout;\n\t\n\tfunction defaultSetTimout() {\n\t    throw new Error('setTimeout has not been defined');\n\t}\n\tfunction defaultClearTimeout () {\n\t    throw new Error('clearTimeout has not been defined');\n\t}\n\t(function () {\n\t    try {\n\t        if (typeof setTimeout === 'function') {\n\t            cachedSetTimeout = setTimeout;\n\t        } else {\n\t            cachedSetTimeout = defaultSetTimout;\n\t        }\n\t    } catch (e) {\n\t        cachedSetTimeout = defaultSetTimout;\n\t    }\n\t    try {\n\t        if (typeof clearTimeout === 'function') {\n\t            cachedClearTimeout = clearTimeout;\n\t        } else {\n\t            cachedClearTimeout = defaultClearTimeout;\n\t        }\n\t    } catch (e) {\n\t        cachedClearTimeout = defaultClearTimeout;\n\t    }\n\t} ())\n\tfunction runTimeout(fun) {\n\t    if (cachedSetTimeout === setTimeout) {\n\t        //normal enviroments in sane situations\n\t        return setTimeout(fun, 0);\n\t    }\n\t    // if setTimeout wasn't available but was latter defined\n\t    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n\t        cachedSetTimeout = setTimeout;\n\t        return setTimeout(fun, 0);\n\t    }\n\t    try {\n\t        // when when somebody has screwed with setTimeout but no I.E. maddness\n\t        return cachedSetTimeout(fun, 0);\n\t    } catch(e){\n\t        try {\n\t            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n\t            return cachedSetTimeout.call(null, fun, 0);\n\t        } catch(e){\n\t            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n\t            return cachedSetTimeout.call(this, fun, 0);\n\t        }\n\t    }\n\t\n\t\n\t}\n\tfunction runClearTimeout(marker) {\n\t    if (cachedClearTimeout === clearTimeout) {\n\t        //normal enviroments in sane situations\n\t        return clearTimeout(marker);\n\t    }\n\t    // if clearTimeout wasn't available but was latter defined\n\t    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n\t        cachedClearTimeout = clearTimeout;\n\t        return clearTimeout(marker);\n\t    }\n\t    try {\n\t        // when when somebody has screwed with setTimeout but no I.E. maddness\n\t        return cachedClearTimeout(marker);\n\t    } catch (e){\n\t        try {\n\t            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n\t            return cachedClearTimeout.call(null, marker);\n\t        } catch (e){\n\t            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n\t            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n\t            return cachedClearTimeout.call(this, marker);\n\t        }\n\t    }\n\t\n\t\n\t\n\t}\n\tvar queue = [];\n\tvar draining = false;\n\tvar currentQueue;\n\tvar queueIndex = -1;\n\t\n\tfunction cleanUpNextTick() {\n\t    if (!draining || !currentQueue) {\n\t        return;\n\t    }\n\t    draining = false;\n\t    if (currentQueue.length) {\n\t        queue = currentQueue.concat(queue);\n\t    } else {\n\t        queueIndex = -1;\n\t    }\n\t    if (queue.length) {\n\t        drainQueue();\n\t    }\n\t}\n\t\n\tfunction drainQueue() {\n\t    if (draining) {\n\t        return;\n\t    }\n\t    var timeout = runTimeout(cleanUpNextTick);\n\t    draining = true;\n\t\n\t    var len = queue.length;\n\t    while(len) {\n\t        currentQueue = queue;\n\t        queue = [];\n\t        while (++queueIndex < len) {\n\t            if (currentQueue) {\n\t                currentQueue[queueIndex].run();\n\t            }\n\t        }\n\t        queueIndex = -1;\n\t        len = queue.length;\n\t    }\n\t    currentQueue = null;\n\t    draining = false;\n\t    runClearTimeout(timeout);\n\t}\n\t\n\tprocess.nextTick = function (fun) {\n\t    var args = new Array(arguments.length - 1);\n\t    if (arguments.length > 1) {\n\t        for (var i = 1; i < arguments.length; i++) {\n\t            args[i - 1] = arguments[i];\n\t        }\n\t    }\n\t    queue.push(new Item(fun, args));\n\t    if (queue.length === 1 && !draining) {\n\t        runTimeout(drainQueue);\n\t    }\n\t};\n\t\n\t// v8 likes predictible objects\n\tfunction Item(fun, array) {\n\t    this.fun = fun;\n\t    this.array = array;\n\t}\n\tItem.prototype.run = function () {\n\t    this.fun.apply(null, this.array);\n\t};\n\tprocess.title = 'browser';\n\tprocess.browser = true;\n\tprocess.env = {};\n\tprocess.argv = [];\n\tprocess.version = ''; // empty string to avoid regexp issues\n\tprocess.versions = {};\n\t\n\tfunction noop() {}\n\t\n\tprocess.on = noop;\n\tprocess.addListener = noop;\n\tprocess.once = noop;\n\tprocess.off = noop;\n\tprocess.removeListener = noop;\n\tprocess.removeAllListeners = noop;\n\tprocess.emit = noop;\n\t\n\tprocess.binding = function (name) {\n\t    throw new Error('process.binding is not supported');\n\t};\n\t\n\tprocess.cwd = function () { return '/' };\n\tprocess.chdir = function (dir) {\n\t    throw new Error('process.chdir is not supported');\n\t};\n\tprocess.umask = function() { return 0; };\n\n\n/***/ },\n/* 45 */\n/***/ function(module, exports) {\n\n\tvar hasOwnProperty = Object.prototype.hasOwnProperty\n\t\n\tmodule.exports = PseudoMap\n\t\n\tfunction PseudoMap (set) {\n\t  if (!(this instanceof PseudoMap)) // whyyyyyyy\n\t    throw new TypeError(\"Constructor PseudoMap requires 'new'\")\n\t\n\t  this.clear()\n\t\n\t  if (set) {\n\t    if ((set instanceof PseudoMap) ||\n\t        (typeof Map === 'function' && set instanceof Map))\n\t      set.forEach(function (value, key) {\n\t        this.set(key, value)\n\t      }, this)\n\t    else if (Array.isArray(set))\n\t      set.forEach(function (kv) {\n\t        this.set(kv[0], kv[1])\n\t      }, this)\n\t    else\n\t      throw new TypeError('invalid argument')\n\t  }\n\t}\n\t\n\tPseudoMap.prototype.forEach = function (fn, thisp) {\n\t  thisp = thisp || this\n\t  Object.keys(this._data).forEach(function (k) {\n\t    if (k !== 'size')\n\t      fn.call(thisp, this._data[k].value, this._data[k].key)\n\t  }, this)\n\t}\n\t\n\tPseudoMap.prototype.has = function (k) {\n\t  return !!find(this._data, k)\n\t}\n\t\n\tPseudoMap.prototype.get = function (k) {\n\t  var res = find(this._data, k)\n\t  return res && res.value\n\t}\n\t\n\tPseudoMap.prototype.set = function (k, v) {\n\t  set(this._data, k, v)\n\t}\n\t\n\tPseudoMap.prototype.delete = function (k) {\n\t  var res = find(this._data, k)\n\t  if (res) {\n\t    delete this._data[res._index]\n\t    this._data.size--\n\t  }\n\t}\n\t\n\tPseudoMap.prototype.clear = function () {\n\t  var data = Object.create(null)\n\t  data.size = 0\n\t\n\t  Object.defineProperty(this, '_data', {\n\t    value: data,\n\t    enumerable: false,\n\t    configurable: true,\n\t    writable: false\n\t  })\n\t}\n\t\n\tObject.defineProperty(PseudoMap.prototype, 'size', {\n\t  get: function () {\n\t    return this._data.size\n\t  },\n\t  set: function (n) {},\n\t  enumerable: true,\n\t  configurable: true\n\t})\n\t\n\tPseudoMap.prototype.values =\n\tPseudoMap.prototype.keys =\n\tPseudoMap.prototype.entries = function () {\n\t  throw new Error('iterators are not implemented in this version')\n\t}\n\t\n\t// Either identical, or both NaN\n\tfunction same (a, b) {\n\t  return a === b || a !== a && b !== b\n\t}\n\t\n\tfunction Entry (k, v, i) {\n\t  this.key = k\n\t  this.value = v\n\t  this._index = i\n\t}\n\t\n\tfunction find (data, k) {\n\t  for (var i = 0, s = '_' + k, key = s;\n\t       hasOwnProperty.call(data, key);\n\t       key = s + i++) {\n\t    if (same(data[key].key, k))\n\t      return data[key]\n\t  }\n\t}\n\t\n\tfunction set (data, k, v) {\n\t  for (var i = 0, s = '_' + k, key = s;\n\t       hasOwnProperty.call(data, key);\n\t       key = s + i++) {\n\t    if (same(data[key].key, k)) {\n\t      data[key].value = v\n\t      return\n\t    }\n\t  }\n\t  data.size++\n\t  data[key] = new Entry(k, v, key)\n\t}\n\n\n/***/ },\n/* 46 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(global, process) {// Copyright Joyent, Inc. and other Node contributors.\n\t//\n\t// Permission is hereby granted, free of charge, to any person obtaining a\n\t// copy of this software and associated documentation files (the\n\t// \"Software\"), to deal in the Software without restriction, including\n\t// without limitation the rights to use, copy, modify, merge, publish,\n\t// distribute, sublicense, and/or sell copies of the Software, and to permit\n\t// persons to whom the Software is furnished to do so, subject to the\n\t// following conditions:\n\t//\n\t// The above copyright notice and this permission notice shall be included\n\t// in all copies or substantial portions of the Software.\n\t//\n\t// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n\t// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n\t// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n\t// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n\t// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n\t// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n\t// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\t\n\tvar formatRegExp = /%[sdj%]/g;\n\texports.format = function(f) {\n\t  if (!isString(f)) {\n\t    var objects = [];\n\t    for (var i = 0; i < arguments.length; i++) {\n\t      objects.push(inspect(arguments[i]));\n\t    }\n\t    return objects.join(' ');\n\t  }\n\t\n\t  var i = 1;\n\t  var args = arguments;\n\t  var len = args.length;\n\t  var str = String(f).replace(formatRegExp, function(x) {\n\t    if (x === '%%') return '%';\n\t    if (i >= len) return x;\n\t    switch (x) {\n\t      case '%s': return String(args[i++]);\n\t      case '%d': return Number(args[i++]);\n\t      case '%j':\n\t        try {\n\t          return JSON.stringify(args[i++]);\n\t        } catch (_) {\n\t          return '[Circular]';\n\t        }\n\t      default:\n\t        return x;\n\t    }\n\t  });\n\t  for (var x = args[i]; i < len; x = args[++i]) {\n\t    if (isNull(x) || !isObject(x)) {\n\t      str += ' ' + x;\n\t    } else {\n\t      str += ' ' + inspect(x);\n\t    }\n\t  }\n\t  return str;\n\t};\n\t\n\t\n\t// Mark that a method should not be used.\n\t// Returns a modified function which warns once by default.\n\t// If --no-deprecation is set, then it is a no-op.\n\texports.deprecate = function(fn, msg) {\n\t  // Allow for deprecating things in the process of starting up.\n\t  if (isUndefined(global.process)) {\n\t    return function() {\n\t      return exports.deprecate(fn, msg).apply(this, arguments);\n\t    };\n\t  }\n\t\n\t  if (process.noDeprecation === true) {\n\t    return fn;\n\t  }\n\t\n\t  var warned = false;\n\t  function deprecated() {\n\t    if (!warned) {\n\t      if (process.throwDeprecation) {\n\t        throw new Error(msg);\n\t      } else if (process.traceDeprecation) {\n\t        console.trace(msg);\n\t      } else {\n\t        console.error(msg);\n\t      }\n\t      warned = true;\n\t    }\n\t    return fn.apply(this, arguments);\n\t  }\n\t\n\t  return deprecated;\n\t};\n\t\n\t\n\tvar debugs = {};\n\tvar debugEnviron;\n\texports.debuglog = function(set) {\n\t  if (isUndefined(debugEnviron))\n\t    debugEnviron = process.env.NODE_DEBUG || '';\n\t  set = set.toUpperCase();\n\t  if (!debugs[set]) {\n\t    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n\t      var pid = process.pid;\n\t      debugs[set] = function() {\n\t        var msg = exports.format.apply(exports, arguments);\n\t        console.error('%s %d: %s', set, pid, msg);\n\t      };\n\t    } else {\n\t      debugs[set] = function() {};\n\t    }\n\t  }\n\t  return debugs[set];\n\t};\n\t\n\t\n\t/**\n\t * Echos the value of a value. Trys to print the value out\n\t * in the best way possible given the different types.\n\t *\n\t * @param {Object} obj The object to print out.\n\t * @param {Object} opts Optional options object that alters the output.\n\t */\n\t/* legacy: obj, showHidden, depth, colors*/\n\tfunction inspect(obj, opts) {\n\t  // default options\n\t  var ctx = {\n\t    seen: [],\n\t    stylize: stylizeNoColor\n\t  };\n\t  // legacy...\n\t  if (arguments.length >= 3) ctx.depth = arguments[2];\n\t  if (arguments.length >= 4) ctx.colors = arguments[3];\n\t  if (isBoolean(opts)) {\n\t    // legacy...\n\t    ctx.showHidden = opts;\n\t  } else if (opts) {\n\t    // got an \"options\" object\n\t    exports._extend(ctx, opts);\n\t  }\n\t  // set default options\n\t  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n\t  if (isUndefined(ctx.depth)) ctx.depth = 2;\n\t  if (isUndefined(ctx.colors)) ctx.colors = false;\n\t  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n\t  if (ctx.colors) ctx.stylize = stylizeWithColor;\n\t  return formatValue(ctx, obj, ctx.depth);\n\t}\n\texports.inspect = inspect;\n\t\n\t\n\t// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\n\tinspect.colors = {\n\t  'bold' : [1, 22],\n\t  'italic' : [3, 23],\n\t  'underline' : [4, 24],\n\t  'inverse' : [7, 27],\n\t  'white' : [37, 39],\n\t  'grey' : [90, 39],\n\t  'black' : [30, 39],\n\t  'blue' : [34, 39],\n\t  'cyan' : [36, 39],\n\t  'green' : [32, 39],\n\t  'magenta' : [35, 39],\n\t  'red' : [31, 39],\n\t  'yellow' : [33, 39]\n\t};\n\t\n\t// Don't use 'blue' not visible on cmd.exe\n\tinspect.styles = {\n\t  'special': 'cyan',\n\t  'number': 'yellow',\n\t  'boolean': 'yellow',\n\t  'undefined': 'grey',\n\t  'null': 'bold',\n\t  'string': 'green',\n\t  'date': 'magenta',\n\t  // \"name\": intentionally not styling\n\t  'regexp': 'red'\n\t};\n\t\n\t\n\tfunction stylizeWithColor(str, styleType) {\n\t  var style = inspect.styles[styleType];\n\t\n\t  if (style) {\n\t    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n\t           '\\u001b[' + inspect.colors[style][1] + 'm';\n\t  } else {\n\t    return str;\n\t  }\n\t}\n\t\n\t\n\tfunction stylizeNoColor(str, styleType) {\n\t  return str;\n\t}\n\t\n\t\n\tfunction arrayToHash(array) {\n\t  var hash = {};\n\t\n\t  array.forEach(function(val, idx) {\n\t    hash[val] = true;\n\t  });\n\t\n\t  return hash;\n\t}\n\t\n\t\n\tfunction formatValue(ctx, value, recurseTimes) {\n\t  // Provide a hook for user-specified inspect functions.\n\t  // Check that value is an object with an inspect function on it\n\t  if (ctx.customInspect &&\n\t      value &&\n\t      isFunction(value.inspect) &&\n\t      // Filter out the util module, it's inspect function is special\n\t      value.inspect !== exports.inspect &&\n\t      // Also filter out any prototype objects using the circular check.\n\t      !(value.constructor && value.constructor.prototype === value)) {\n\t    var ret = value.inspect(recurseTimes, ctx);\n\t    if (!isString(ret)) {\n\t      ret = formatValue(ctx, ret, recurseTimes);\n\t    }\n\t    return ret;\n\t  }\n\t\n\t  // Primitive types cannot have properties\n\t  var primitive = formatPrimitive(ctx, value);\n\t  if (primitive) {\n\t    return primitive;\n\t  }\n\t\n\t  // Look up the keys of the object.\n\t  var keys = Object.keys(value);\n\t  var visibleKeys = arrayToHash(keys);\n\t\n\t  if (ctx.showHidden) {\n\t    keys = Object.getOwnPropertyNames(value);\n\t  }\n\t\n\t  // IE doesn't make error fields non-enumerable\n\t  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n\t  if (isError(value)\n\t      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n\t    return formatError(value);\n\t  }\n\t\n\t  // Some type of object without properties can be shortcutted.\n\t  if (keys.length === 0) {\n\t    if (isFunction(value)) {\n\t      var name = value.name ? ': ' + value.name : '';\n\t      return ctx.stylize('[Function' + name + ']', 'special');\n\t    }\n\t    if (isRegExp(value)) {\n\t      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n\t    }\n\t    if (isDate(value)) {\n\t      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n\t    }\n\t    if (isError(value)) {\n\t      return formatError(value);\n\t    }\n\t  }\n\t\n\t  var base = '', array = false, braces = ['{', '}'];\n\t\n\t  // Make Array say that they are Array\n\t  if (isArray(value)) {\n\t    array = true;\n\t    braces = ['[', ']'];\n\t  }\n\t\n\t  // Make functions say that they are functions\n\t  if (isFunction(value)) {\n\t    var n = value.name ? ': ' + value.name : '';\n\t    base = ' [Function' + n + ']';\n\t  }\n\t\n\t  // Make RegExps say that they are RegExps\n\t  if (isRegExp(value)) {\n\t    base = ' ' + RegExp.prototype.toString.call(value);\n\t  }\n\t\n\t  // Make dates with properties first say the date\n\t  if (isDate(value)) {\n\t    base = ' ' + Date.prototype.toUTCString.call(value);\n\t  }\n\t\n\t  // Make error with message first say the error\n\t  if (isError(value)) {\n\t    base = ' ' + formatError(value);\n\t  }\n\t\n\t  if (keys.length === 0 && (!array || value.length == 0)) {\n\t    return braces[0] + base + braces[1];\n\t  }\n\t\n\t  if (recurseTimes < 0) {\n\t    if (isRegExp(value)) {\n\t      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n\t    } else {\n\t      return ctx.stylize('[Object]', 'special');\n\t    }\n\t  }\n\t\n\t  ctx.seen.push(value);\n\t\n\t  var output;\n\t  if (array) {\n\t    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n\t  } else {\n\t    output = keys.map(function(key) {\n\t      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n\t    });\n\t  }\n\t\n\t  ctx.seen.pop();\n\t\n\t  return reduceToSingleString(output, base, braces);\n\t}\n\t\n\t\n\tfunction formatPrimitive(ctx, value) {\n\t  if (isUndefined(value))\n\t    return ctx.stylize('undefined', 'undefined');\n\t  if (isString(value)) {\n\t    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n\t                                             .replace(/'/g, \"\\\\'\")\n\t                                             .replace(/\\\\\"/g, '\"') + '\\'';\n\t    return ctx.stylize(simple, 'string');\n\t  }\n\t  if (isNumber(value))\n\t    return ctx.stylize('' + value, 'number');\n\t  if (isBoolean(value))\n\t    return ctx.stylize('' + value, 'boolean');\n\t  // For some reason typeof null is \"object\", so special case here.\n\t  if (isNull(value))\n\t    return ctx.stylize('null', 'null');\n\t}\n\t\n\t\n\tfunction formatError(value) {\n\t  return '[' + Error.prototype.toString.call(value) + ']';\n\t}\n\t\n\t\n\tfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n\t  var output = [];\n\t  for (var i = 0, l = value.length; i < l; ++i) {\n\t    if (hasOwnProperty(value, String(i))) {\n\t      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n\t          String(i), true));\n\t    } else {\n\t      output.push('');\n\t    }\n\t  }\n\t  keys.forEach(function(key) {\n\t    if (!key.match(/^\\d+$/)) {\n\t      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n\t          key, true));\n\t    }\n\t  });\n\t  return output;\n\t}\n\t\n\t\n\tfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n\t  var name, str, desc;\n\t  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n\t  if (desc.get) {\n\t    if (desc.set) {\n\t      str = ctx.stylize('[Getter/Setter]', 'special');\n\t    } else {\n\t      str = ctx.stylize('[Getter]', 'special');\n\t    }\n\t  } else {\n\t    if (desc.set) {\n\t      str = ctx.stylize('[Setter]', 'special');\n\t    }\n\t  }\n\t  if (!hasOwnProperty(visibleKeys, key)) {\n\t    name = '[' + key + ']';\n\t  }\n\t  if (!str) {\n\t    if (ctx.seen.indexOf(desc.value) < 0) {\n\t      if (isNull(recurseTimes)) {\n\t        str = formatValue(ctx, desc.value, null);\n\t      } else {\n\t        str = formatValue(ctx, desc.value, recurseTimes - 1);\n\t      }\n\t      if (str.indexOf('\\n') > -1) {\n\t        if (array) {\n\t          str = str.split('\\n').map(function(line) {\n\t            return '  ' + line;\n\t          }).join('\\n').substr(2);\n\t        } else {\n\t          str = '\\n' + str.split('\\n').map(function(line) {\n\t            return '   ' + line;\n\t          }).join('\\n');\n\t        }\n\t      }\n\t    } else {\n\t      str = ctx.stylize('[Circular]', 'special');\n\t    }\n\t  }\n\t  if (isUndefined(name)) {\n\t    if (array && key.match(/^\\d+$/)) {\n\t      return str;\n\t    }\n\t    name = JSON.stringify('' + key);\n\t    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n\t      name = name.substr(1, name.length - 2);\n\t      name = ctx.stylize(name, 'name');\n\t    } else {\n\t      name = name.replace(/'/g, \"\\\\'\")\n\t                 .replace(/\\\\\"/g, '\"')\n\t                 .replace(/(^\"|\"$)/g, \"'\");\n\t      name = ctx.stylize(name, 'string');\n\t    }\n\t  }\n\t\n\t  return name + ': ' + str;\n\t}\n\t\n\t\n\tfunction reduceToSingleString(output, base, braces) {\n\t  var numLinesEst = 0;\n\t  var length = output.reduce(function(prev, cur) {\n\t    numLinesEst++;\n\t    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n\t    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n\t  }, 0);\n\t\n\t  if (length > 60) {\n\t    return braces[0] +\n\t           (base === '' ? '' : base + '\\n ') +\n\t           ' ' +\n\t           output.join(',\\n  ') +\n\t           ' ' +\n\t           braces[1];\n\t  }\n\t\n\t  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n\t}\n\t\n\t\n\t// NOTE: These type checking functions intentionally don't use `instanceof`\n\t// because it is fragile and can be easily faked with `Object.create()`.\n\tfunction isArray(ar) {\n\t  return Array.isArray(ar);\n\t}\n\texports.isArray = isArray;\n\t\n\tfunction isBoolean(arg) {\n\t  return typeof arg === 'boolean';\n\t}\n\texports.isBoolean = isBoolean;\n\t\n\tfunction isNull(arg) {\n\t  return arg === null;\n\t}\n\texports.isNull = isNull;\n\t\n\tfunction isNullOrUndefined(arg) {\n\t  return arg == null;\n\t}\n\texports.isNullOrUndefined = isNullOrUndefined;\n\t\n\tfunction isNumber(arg) {\n\t  return typeof arg === 'number';\n\t}\n\texports.isNumber = isNumber;\n\t\n\tfunction isString(arg) {\n\t  return typeof arg === 'string';\n\t}\n\texports.isString = isString;\n\t\n\tfunction isSymbol(arg) {\n\t  return typeof arg === 'symbol';\n\t}\n\texports.isSymbol = isSymbol;\n\t\n\tfunction isUndefined(arg) {\n\t  return arg === void 0;\n\t}\n\texports.isUndefined = isUndefined;\n\t\n\tfunction isRegExp(re) {\n\t  return isObject(re) && objectToString(re) === '[object RegExp]';\n\t}\n\texports.isRegExp = isRegExp;\n\t\n\tfunction isObject(arg) {\n\t  return typeof arg === 'object' && arg !== null;\n\t}\n\texports.isObject = isObject;\n\t\n\tfunction isDate(d) {\n\t  return isObject(d) && objectToString(d) === '[object Date]';\n\t}\n\texports.isDate = isDate;\n\t\n\tfunction isError(e) {\n\t  return isObject(e) &&\n\t      (objectToString(e) === '[object Error]' || e instanceof Error);\n\t}\n\texports.isError = isError;\n\t\n\tfunction isFunction(arg) {\n\t  return typeof arg === 'function';\n\t}\n\texports.isFunction = isFunction;\n\t\n\tfunction isPrimitive(arg) {\n\t  return arg === null ||\n\t         typeof arg === 'boolean' ||\n\t         typeof arg === 'number' ||\n\t         typeof arg === 'string' ||\n\t         typeof arg === 'symbol' ||  // ES6 symbol\n\t         typeof arg === 'undefined';\n\t}\n\texports.isPrimitive = isPrimitive;\n\t\n\texports.isBuffer = __webpack_require__(47);\n\t\n\tfunction objectToString(o) {\n\t  return Object.prototype.toString.call(o);\n\t}\n\t\n\t\n\tfunction pad(n) {\n\t  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n\t}\n\t\n\t\n\tvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n\t              'Oct', 'Nov', 'Dec'];\n\t\n\t// 26 Feb 16:19:34\n\tfunction timestamp() {\n\t  var d = new Date();\n\t  var time = [pad(d.getHours()),\n\t              pad(d.getMinutes()),\n\t              pad(d.getSeconds())].join(':');\n\t  return [d.getDate(), months[d.getMonth()], time].join(' ');\n\t}\n\t\n\t\n\t// log is just a thin wrapper to console.log that prepends a timestamp\n\texports.log = function() {\n\t  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n\t};\n\t\n\t\n\t/**\n\t * Inherit the prototype methods from one constructor into another.\n\t *\n\t * The Function.prototype.inherits from lang.js rewritten as a standalone\n\t * function (not on Function.prototype). NOTE: If this file is to be loaded\n\t * during bootstrapping this function needs to be rewritten using some native\n\t * functions as prototype setup using normal JavaScript does not work as\n\t * expected during bootstrapping (see mirror.js in r114903).\n\t *\n\t * @param {function} ctor Constructor function which needs to inherit the\n\t *     prototype.\n\t * @param {function} superCtor Constructor function to inherit prototype from.\n\t */\n\texports.inherits = __webpack_require__(48);\n\t\n\texports._extend = function(origin, add) {\n\t  // Don't do anything if add isn't an object\n\t  if (!add || !isObject(add)) return origin;\n\t\n\t  var keys = Object.keys(add);\n\t  var i = keys.length;\n\t  while (i--) {\n\t    origin[keys[i]] = add[keys[i]];\n\t  }\n\t  return origin;\n\t};\n\t\n\tfunction hasOwnProperty(obj, prop) {\n\t  return Object.prototype.hasOwnProperty.call(obj, prop);\n\t}\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }()), __webpack_require__(44)))\n\n/***/ },\n/* 47 */\n/***/ function(module, exports) {\n\n\tmodule.exports = function isBuffer(arg) {\n\t  return arg && typeof arg === 'object'\n\t    && typeof arg.copy === 'function'\n\t    && typeof arg.fill === 'function'\n\t    && typeof arg.readUInt8 === 'function';\n\t}\n\n/***/ },\n/* 48 */\n/***/ function(module, exports) {\n\n\tif (typeof Object.create === 'function') {\n\t  // implementation from standard node.js 'util' module\n\t  module.exports = function inherits(ctor, superCtor) {\n\t    ctor.super_ = superCtor\n\t    ctor.prototype = Object.create(superCtor.prototype, {\n\t      constructor: {\n\t        value: ctor,\n\t        enumerable: false,\n\t        writable: true,\n\t        configurable: true\n\t      }\n\t    });\n\t  };\n\t} else {\n\t  // old school shim for old browsers\n\t  module.exports = function inherits(ctor, superCtor) {\n\t    ctor.super_ = superCtor\n\t    var TempCtor = function () {}\n\t    TempCtor.prototype = superCtor.prototype\n\t    ctor.prototype = new TempCtor()\n\t    ctor.prototype.constructor = ctor\n\t  }\n\t}\n\n\n/***/ },\n/* 49 */\n/***/ function(module, exports) {\n\n\tmodule.exports = Yallist\n\t\n\tYallist.Node = Node\n\tYallist.create = Yallist\n\t\n\tfunction Yallist (list) {\n\t  var self = this\n\t  if (!(self instanceof Yallist)) {\n\t    self = new Yallist()\n\t  }\n\t\n\t  self.tail = null\n\t  self.head = null\n\t  self.length = 0\n\t\n\t  if (list && typeof list.forEach === 'function') {\n\t    list.forEach(function (item) {\n\t      self.push(item)\n\t    })\n\t  } else if (arguments.length > 0) {\n\t    for (var i = 0, l = arguments.length; i < l; i++) {\n\t      self.push(arguments[i])\n\t    }\n\t  }\n\t\n\t  return self\n\t}\n\t\n\tYallist.prototype.removeNode = function (node) {\n\t  if (node.list !== this) {\n\t    throw new Error('removing node which does not belong to this list')\n\t  }\n\t\n\t  var next = node.next\n\t  var prev = node.prev\n\t\n\t  if (next) {\n\t    next.prev = prev\n\t  }\n\t\n\t  if (prev) {\n\t    prev.next = next\n\t  }\n\t\n\t  if (node === this.head) {\n\t    this.head = next\n\t  }\n\t  if (node === this.tail) {\n\t    this.tail = prev\n\t  }\n\t\n\t  node.list.length --\n\t  node.next = null\n\t  node.prev = null\n\t  node.list = null\n\t}\n\t\n\tYallist.prototype.unshiftNode = function (node) {\n\t  if (node === this.head) {\n\t    return\n\t  }\n\t\n\t  if (node.list) {\n\t    node.list.removeNode(node)\n\t  }\n\t\n\t  var head = this.head\n\t  node.list = this\n\t  node.next = head\n\t  if (head) {\n\t    head.prev = node\n\t  }\n\t\n\t  this.head = node\n\t  if (!this.tail) {\n\t    this.tail = node\n\t  }\n\t  this.length ++\n\t}\n\t\n\tYallist.prototype.pushNode = function (node) {\n\t  if (node === this.tail) {\n\t    return\n\t  }\n\t\n\t  if (node.list) {\n\t    node.list.removeNode(node)\n\t  }\n\t\n\t  var tail = this.tail\n\t  node.list = this\n\t  node.prev = tail\n\t  if (tail) {\n\t    tail.next = node\n\t  }\n\t\n\t  this.tail = node\n\t  if (!this.head) {\n\t    this.head = node\n\t  }\n\t  this.length ++\n\t}\n\t\n\tYallist.prototype.push = function () {\n\t  for (var i = 0, l = arguments.length; i < l; i++) {\n\t    push(this, arguments[i])\n\t  }\n\t  return this.length\n\t}\n\t\n\tYallist.prototype.unshift = function () {\n\t  for (var i = 0, l = arguments.length; i < l; i++) {\n\t    unshift(this, arguments[i])\n\t  }\n\t  return this.length\n\t}\n\t\n\tYallist.prototype.pop = function () {\n\t  if (!this.tail)\n\t    return undefined\n\t\n\t  var res = this.tail.value\n\t  this.tail = this.tail.prev\n\t  this.tail.next = null\n\t  this.length --\n\t  return res\n\t}\n\t\n\tYallist.prototype.shift = function () {\n\t  if (!this.head)\n\t    return undefined\n\t\n\t  var res = this.head.value\n\t  this.head = this.head.next\n\t  this.head.prev = null\n\t  this.length --\n\t  return res\n\t}\n\t\n\tYallist.prototype.forEach = function (fn, thisp) {\n\t  thisp = thisp || this\n\t  for (var walker = this.head, i = 0; walker !== null; i++) {\n\t    fn.call(thisp, walker.value, i, this)\n\t    walker = walker.next\n\t  }\n\t}\n\t\n\tYallist.prototype.forEachReverse = function (fn, thisp) {\n\t  thisp = thisp || this\n\t  for (var walker = this.tail, i = this.length - 1; walker !== null; i--) {\n\t    fn.call(thisp, walker.value, i, this)\n\t    walker = walker.prev\n\t  }\n\t}\n\t\n\tYallist.prototype.get = function (n) {\n\t  for (var i = 0, walker = this.head; walker !== null && i < n; i++) {\n\t    // abort out of the list early if we hit a cycle\n\t    walker = walker.next\n\t  }\n\t  if (i === n && walker !== null) {\n\t    return walker.value\n\t  }\n\t}\n\t\n\tYallist.prototype.getReverse = function (n) {\n\t  for (var i = 0, walker = this.tail; walker !== null && i < n; i++) {\n\t    // abort out of the list early if we hit a cycle\n\t    walker = walker.prev\n\t  }\n\t  if (i === n && walker !== null) {\n\t    return walker.value\n\t  }\n\t}\n\t\n\tYallist.prototype.map = function (fn, thisp) {\n\t  thisp = thisp || this\n\t  var res = new Yallist()\n\t  for (var walker = this.head; walker !== null; ) {\n\t    res.push(fn.call(thisp, walker.value, this))\n\t    walker = walker.next\n\t  }\n\t  return res\n\t}\n\t\n\tYallist.prototype.mapReverse = function (fn, thisp) {\n\t  thisp = thisp || this\n\t  var res = new Yallist()\n\t  for (var walker = this.tail; walker !== null;) {\n\t    res.push(fn.call(thisp, walker.value, this))\n\t    walker = walker.prev\n\t  }\n\t  return res\n\t}\n\t\n\tYallist.prototype.reduce = function (fn, initial) {\n\t  var acc\n\t  var walker = this.head\n\t  if (arguments.length > 1) {\n\t    acc = initial\n\t  } else if (this.head) {\n\t    walker = this.head.next\n\t    acc = this.head.value\n\t  } else {\n\t    throw new TypeError('Reduce of empty list with no initial value')\n\t  }\n\t\n\t  for (var i = 0; walker !== null; i++) {\n\t    acc = fn(acc, walker.value, i)\n\t    walker = walker.next\n\t  }\n\t\n\t  return acc\n\t}\n\t\n\tYallist.prototype.reduceReverse = function (fn, initial) {\n\t  var acc\n\t  var walker = this.tail\n\t  if (arguments.length > 1) {\n\t    acc = initial\n\t  } else if (this.tail) {\n\t    walker = this.tail.prev\n\t    acc = this.tail.value\n\t  } else {\n\t    throw new TypeError('Reduce of empty list with no initial value')\n\t  }\n\t\n\t  for (var i = this.length - 1; walker !== null; i--) {\n\t    acc = fn(acc, walker.value, i)\n\t    walker = walker.prev\n\t  }\n\t\n\t  return acc\n\t}\n\t\n\tYallist.prototype.toArray = function () {\n\t  var arr = new Array(this.length)\n\t  for (var i = 0, walker = this.head; walker !== null; i++) {\n\t    arr[i] = walker.value\n\t    walker = walker.next\n\t  }\n\t  return arr\n\t}\n\t\n\tYallist.prototype.toArrayReverse = function () {\n\t  var arr = new Array(this.length)\n\t  for (var i = 0, walker = this.tail; walker !== null; i++) {\n\t    arr[i] = walker.value\n\t    walker = walker.prev\n\t  }\n\t  return arr\n\t}\n\t\n\tYallist.prototype.slice = function (from, to) {\n\t  to = to || this.length\n\t  if (to < 0) {\n\t    to += this.length\n\t  }\n\t  from = from || 0\n\t  if (from < 0) {\n\t    from += this.length\n\t  }\n\t  var ret = new Yallist()\n\t  if (to < from || to < 0) {\n\t    return ret\n\t  }\n\t  if (from < 0) {\n\t    from = 0\n\t  }\n\t  if (to > this.length) {\n\t    to = this.length\n\t  }\n\t  for (var i = 0, walker = this.head; walker !== null && i < from; i++) {\n\t    walker = walker.next\n\t  }\n\t  for (; walker !== null && i < to; i++, walker = walker.next) {\n\t    ret.push(walker.value)\n\t  }\n\t  return ret\n\t}\n\t\n\tYallist.prototype.sliceReverse = function (from, to) {\n\t  to = to || this.length\n\t  if (to < 0) {\n\t    to += this.length\n\t  }\n\t  from = from || 0\n\t  if (from < 0) {\n\t    from += this.length\n\t  }\n\t  var ret = new Yallist()\n\t  if (to < from || to < 0) {\n\t    return ret\n\t  }\n\t  if (from < 0) {\n\t    from = 0\n\t  }\n\t  if (to > this.length) {\n\t    to = this.length\n\t  }\n\t  for (var i = this.length, walker = this.tail; walker !== null && i > to; i--) {\n\t    walker = walker.prev\n\t  }\n\t  for (; walker !== null && i > from; i--, walker = walker.prev) {\n\t    ret.push(walker.value)\n\t  }\n\t  return ret\n\t}\n\t\n\tYallist.prototype.reverse = function () {\n\t  var head = this.head\n\t  var tail = this.tail\n\t  for (var walker = head; walker !== null; walker = walker.prev) {\n\t    var p = walker.prev\n\t    walker.prev = walker.next\n\t    walker.next = p\n\t  }\n\t  this.head = tail\n\t  this.tail = head\n\t  return this\n\t}\n\t\n\tfunction push (self, item) {\n\t  self.tail = new Node(item, self.tail, null, self)\n\t  if (!self.head) {\n\t    self.head = self.tail\n\t  }\n\t  self.length ++\n\t}\n\t\n\tfunction unshift (self, item) {\n\t  self.head = new Node(item, null, self.head, self)\n\t  if (!self.tail) {\n\t    self.tail = self.head\n\t  }\n\t  self.length ++\n\t}\n\t\n\tfunction Node (value, prev, next, list) {\n\t  if (!(this instanceof Node)) {\n\t    return new Node(value, prev, next, list)\n\t  }\n\t\n\t  this.list = list\n\t  this.value = value\n\t\n\t  if (prev) {\n\t    prev.next = this\n\t    this.prev = prev\n\t  } else {\n\t    this.prev = null\n\t  }\n\t\n\t  if (next) {\n\t    next.prev = this\n\t    this.next = next\n\t  } else {\n\t    this.next = null\n\t  }\n\t}\n\n\n/***/ },\n/* 50 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _Tile2 = __webpack_require__(51);\n\t\n\tvar _Tile3 = _interopRequireDefault(_Tile2);\n\t\n\tvar _vendorBoxHelper = __webpack_require__(52);\n\t\n\tvar _vendorBoxHelper2 = _interopRequireDefault(_vendorBoxHelper);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\t\n\tvar ImageTile = (function (_Tile) {\n\t  _inherits(ImageTile, _Tile);\n\t\n\t  function ImageTile(quadcode, path, layer) {\n\t    _classCallCheck(this, ImageTile);\n\t\n\t    _get(Object.getPrototypeOf(ImageTile.prototype), 'constructor', this).call(this, quadcode, path, layer);\n\t  }\n\t\n\t  // Request data for the tile\n\t\n\t  _createClass(ImageTile, [{\n\t    key: 'requestTileAsync',\n\t    value: function requestTileAsync() {\n\t      var _this = this;\n\t\n\t      // Making this asynchronous really speeds up the LOD framerate\n\t      setTimeout(function () {\n\t        if (!_this._mesh) {\n\t          _this._mesh = _this._createMesh();\n\t          _this._requestTile();\n\t        }\n\t      }, 0);\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      // Cancel any pending requests\n\t      this._abortRequest();\n\t\n\t      // Clear image reference\n\t      this._image = null;\n\t\n\t      _get(Object.getPrototypeOf(ImageTile.prototype), 'destroy', this).call(this);\n\t    }\n\t  }, {\n\t    key: '_createMesh',\n\t    value: function _createMesh() {\n\t      // Something went wrong and the tile\n\t      //\n\t      // Possibly removed by the cache before loaded\n\t      if (!this._center) {\n\t        return;\n\t      }\n\t\n\t      var mesh = new _three2['default'].Object3D();\n\t      var geom = new _three2['default'].PlaneBufferGeometry(this._side, this._side, 1);\n\t\n\t      var material;\n\t      if (!this._world._environment._skybox) {\n\t        material = new _three2['default'].MeshBasicMaterial({\n\t          depthWrite: false\n\t        });\n\t\n\t        // var material = new THREE.MeshPhongMaterial({\n\t        //   depthWrite: false\n\t        // });\n\t      } else {\n\t          // Other MeshStandardMaterial settings\n\t          //\n\t          // material.envMapIntensity will change the amount of colour reflected(?)\n\t          // from the environment map – can be greater than 1 for more intensity\n\t\n\t          material = new _three2['default'].MeshStandardMaterial({\n\t            depthWrite: false\n\t          });\n\t          material.roughness = 1;\n\t          material.metalness = 0.1;\n\t          material.envMap = this._world._environment._skybox.getRenderTarget();\n\t        }\n\t\n\t      var localMesh = new _three2['default'].Mesh(geom, material);\n\t      localMesh.rotation.x = -90 * Math.PI / 180;\n\t\n\t      localMesh.receiveShadow = true;\n\t\n\t      mesh.add(localMesh);\n\t      mesh.renderOrder = 0.1;\n\t\n\t      mesh.position.x = this._center[0];\n\t      mesh.position.z = this._center[1];\n\t\n\t      // var box = new BoxHelper(localMesh);\n\t      // mesh.add(box);\n\t      //\n\t      // mesh.add(this._createDebugMesh());\n\t\n\t      return mesh;\n\t    }\n\t  }, {\n\t    key: '_createDebugMesh',\n\t    value: function _createDebugMesh() {\n\t      var canvas = document.createElement('canvas');\n\t      canvas.width = 256;\n\t      canvas.height = 256;\n\t\n\t      var context = canvas.getContext('2d');\n\t      context.font = 'Bold 20px Helvetica Neue, Verdana, Arial';\n\t      context.fillStyle = '#ff0000';\n\t      context.fillText(this._quadcode, 20, canvas.width / 2 - 5);\n\t      context.fillText(this._tile.toString(), 20, canvas.width / 2 + 25);\n\t\n\t      var texture = new _three2['default'].Texture(canvas);\n\t\n\t      // Silky smooth images when tilted\n\t      texture.magFilter = _three2['default'].LinearFilter;\n\t      texture.minFilter = _three2['default'].LinearMipMapLinearFilter;\n\t\n\t      // TODO: Set this to renderer.getMaxAnisotropy() / 4\n\t      texture.anisotropy = 4;\n\t\n\t      texture.needsUpdate = true;\n\t\n\t      var material = new _three2['default'].MeshBasicMaterial({\n\t        map: texture,\n\t        transparent: true,\n\t        depthWrite: false\n\t      });\n\t\n\t      var geom = new _three2['default'].PlaneBufferGeometry(this._side, this._side, 1);\n\t      var mesh = new _three2['default'].Mesh(geom, material);\n\t\n\t      mesh.rotation.x = -90 * Math.PI / 180;\n\t      mesh.position.y = 0.1;\n\t\n\t      return mesh;\n\t    }\n\t  }, {\n\t    key: '_requestTile',\n\t    value: function _requestTile() {\n\t      var _this2 = this;\n\t\n\t      var urlParams = {\n\t        x: this._tile[0],\n\t        y: this._tile[1],\n\t        z: this._tile[2]\n\t      };\n\t\n\t      var url = this._getTileURL(urlParams);\n\t\n\t      var image = document.createElement('img');\n\t\n\t      image.addEventListener('load', function (event) {\n\t        var texture = new _three2['default'].Texture();\n\t\n\t        texture.image = image;\n\t        texture.needsUpdate = true;\n\t\n\t        // Silky smooth images when tilted\n\t        texture.magFilter = _three2['default'].LinearFilter;\n\t        texture.minFilter = _three2['default'].LinearMipMapLinearFilter;\n\t\n\t        // TODO: Set this to renderer.getMaxAnisotropy() / 4\n\t        texture.anisotropy = 4;\n\t\n\t        texture.needsUpdate = true;\n\t\n\t        // Something went wrong and the tile or its material is missing\n\t        //\n\t        // Possibly removed by the cache before the image loaded\n\t        if (!_this2._mesh || !_this2._mesh.children[0] || !_this2._mesh.children[0].material) {\n\t          return;\n\t        }\n\t\n\t        _this2._mesh.children[0].material.map = texture;\n\t        _this2._mesh.children[0].material.needsUpdate = true;\n\t\n\t        _this2._texture = texture;\n\t        _this2._ready = true;\n\t      }, false);\n\t\n\t      // image.addEventListener('progress', event => {}, false);\n\t      // image.addEventListener('error', event => {}, false);\n\t\n\t      image.crossOrigin = '';\n\t\n\t      // Load image\n\t      image.src = url;\n\t\n\t      this._image = image;\n\t    }\n\t  }, {\n\t    key: '_abortRequest',\n\t    value: function _abortRequest() {\n\t      if (!this._image) {\n\t        return;\n\t      }\n\t\n\t      this._image.src = '';\n\t    }\n\t  }]);\n\t\n\t  return ImageTile;\n\t})(_Tile3['default']);\n\t\n\texports['default'] = ImageTile;\n\t\n\tvar noNew = function noNew(quadcode, path, layer) {\n\t  return new ImageTile(quadcode, path, layer);\n\t};\n\t\n\t// Initialise without requiring new keyword\n\texports.imageTile = noNew;\n\n/***/ },\n/* 51 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tvar _geoPoint = __webpack_require__(6);\n\t\n\tvar _geoLatLon = __webpack_require__(5);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\t\n\t// Manages a single tile and its layers\n\t\n\tvar r2d = 180 / Math.PI;\n\t\n\tvar tileURLRegex = /\\{([szxy])\\}/g;\n\t\n\tvar Tile = (function () {\n\t  function Tile(quadcode, path, layer) {\n\t    _classCallCheck(this, Tile);\n\t\n\t    this._layer = layer;\n\t    this._world = layer._world;\n\t    this._quadcode = quadcode;\n\t    this._path = path;\n\t\n\t    this._ready = false;\n\t\n\t    this._tile = this._quadcodeToTile(quadcode);\n\t\n\t    // Bottom-left and top-right bounds in WGS84 coordinates\n\t    this._boundsLatLon = this._tileBoundsWGS84(this._tile);\n\t\n\t    // Bottom-left and top-right bounds in world coordinates\n\t    this._boundsWorld = this._tileBoundsFromWGS84(this._boundsLatLon);\n\t\n\t    // Tile center in world coordinates\n\t    this._center = this._boundsToCenter(this._boundsWorld);\n\t\n\t    // Tile center in projected coordinates\n\t    this._centerLatlon = this._world.pointToLatLon((0, _geoPoint.point)(this._center[0], this._center[1]));\n\t\n\t    // Length of a tile side in world coorindates\n\t    this._side = this._getSide(this._boundsWorld);\n\t\n\t    // Point scale for tile (for unit conversion)\n\t    this._pointScale = this._world.pointScale(this._centerLatlon);\n\t  }\n\t\n\t  // Returns true if the tile mesh and texture are ready to be used\n\t  // Otherwise, returns false\n\t\n\t  _createClass(Tile, [{\n\t    key: 'isReady',\n\t    value: function isReady() {\n\t      return this._ready;\n\t    }\n\t\n\t    // Request data for the tile\n\t  }, {\n\t    key: 'requestTileAsync',\n\t    value: function requestTileAsync() {}\n\t  }, {\n\t    key: 'getQuadcode',\n\t    value: function getQuadcode() {\n\t      return this._quadcode;\n\t    }\n\t  }, {\n\t    key: 'getBounds',\n\t    value: function getBounds() {\n\t      return this._boundsWorld;\n\t    }\n\t  }, {\n\t    key: 'getCenter',\n\t    value: function getCenter() {\n\t      return this._center;\n\t    }\n\t  }, {\n\t    key: 'getSide',\n\t    value: function getSide() {\n\t      return this._side;\n\t    }\n\t  }, {\n\t    key: 'getMesh',\n\t    value: function getMesh() {\n\t      return this._mesh;\n\t    }\n\t  }, {\n\t    key: 'getPickingMesh',\n\t    value: function getPickingMesh() {\n\t      return this._pickingMesh;\n\t    }\n\t\n\t    // Destroys the tile and removes it from the layer and memory\n\t    //\n\t    // Ensure that this leaves no trace of the tile – no textures, no meshes,\n\t    // nothing in memory or the GPU\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      // Delete reference to layer and world\n\t      this._layer = null;\n\t      this._world = null;\n\t\n\t      // Delete location references\n\t      this._boundsLatLon = null;\n\t      this._boundsWorld = null;\n\t      this._center = null;\n\t\n\t      // Done if no mesh\n\t      if (!this._mesh) {\n\t        return;\n\t      }\n\t\n\t      if (this._mesh.children) {\n\t        // Dispose of mesh and materials\n\t        this._mesh.children.forEach(function (child) {\n\t          child.geometry.dispose();\n\t          child.geometry = null;\n\t\n\t          if (child.material.map) {\n\t            child.material.map.dispose();\n\t            child.material.map = null;\n\t          }\n\t\n\t          child.material.dispose();\n\t          child.material = null;\n\t        });\n\t      } else {\n\t        this._mesh.geometry.dispose();\n\t        this._mesh.geometry = null;\n\t\n\t        if (this._mesh.material.map) {\n\t          this._mesh.material.map.dispose();\n\t          this._mesh.material.map = null;\n\t        }\n\t\n\t        this._mesh.material.dispose();\n\t        this._mesh.material = null;\n\t      }\n\t    }\n\t  }, {\n\t    key: '_createMesh',\n\t    value: function _createMesh() {}\n\t  }, {\n\t    key: '_createDebugMesh',\n\t    value: function _createDebugMesh() {}\n\t  }, {\n\t    key: '_getTileURL',\n\t    value: function _getTileURL(urlParams) {\n\t      if (!urlParams.s) {\n\t        // Default to a random choice of a, b or c\n\t        urlParams.s = String.fromCharCode(97 + Math.floor(Math.random() * 3));\n\t      }\n\t\n\t      tileURLRegex.lastIndex = 0;\n\t      return this._path.replace(tileURLRegex, function (value, key) {\n\t        // Replace with paramter, otherwise keep existing value\n\t        return urlParams[key];\n\t      });\n\t    }\n\t\n\t    // Convert from quadcode to TMS tile coordinates\n\t  }, {\n\t    key: '_quadcodeToTile',\n\t    value: function _quadcodeToTile(quadcode) {\n\t      var x = 0;\n\t      var y = 0;\n\t      var z = quadcode.length;\n\t\n\t      for (var i = z; i > 0; i--) {\n\t        var mask = 1 << i - 1;\n\t        var q = +quadcode[z - i];\n\t        if (q === 1) {\n\t          x |= mask;\n\t        }\n\t        if (q === 2) {\n\t          y |= mask;\n\t        }\n\t        if (q === 3) {\n\t          x |= mask;\n\t          y |= mask;\n\t        }\n\t      }\n\t\n\t      return [x, y, z];\n\t    }\n\t\n\t    // Convert WGS84 tile bounds to world coordinates\n\t  }, {\n\t    key: '_tileBoundsFromWGS84',\n\t    value: function _tileBoundsFromWGS84(boundsWGS84) {\n\t      var sw = this._layer._world.latLonToPoint((0, _geoLatLon.latLon)(boundsWGS84[1], boundsWGS84[0]));\n\t      var ne = this._layer._world.latLonToPoint((0, _geoLatLon.latLon)(boundsWGS84[3], boundsWGS84[2]));\n\t\n\t      return [sw.x, sw.y, ne.x, ne.y];\n\t    }\n\t\n\t    // Get tile bounds in WGS84 coordinates\n\t  }, {\n\t    key: '_tileBoundsWGS84',\n\t    value: function _tileBoundsWGS84(tile) {\n\t      var e = this._tile2lon(tile[0] + 1, tile[2]);\n\t      var w = this._tile2lon(tile[0], tile[2]);\n\t      var s = this._tile2lat(tile[1] + 1, tile[2]);\n\t      var n = this._tile2lat(tile[1], tile[2]);\n\t      return [w, s, e, n];\n\t    }\n\t  }, {\n\t    key: '_tile2lon',\n\t    value: function _tile2lon(x, z) {\n\t      return x / Math.pow(2, z) * 360 - 180;\n\t    }\n\t  }, {\n\t    key: '_tile2lat',\n\t    value: function _tile2lat(y, z) {\n\t      var n = Math.PI - 2 * Math.PI * y / Math.pow(2, z);\n\t      return r2d * Math.atan(0.5 * (Math.exp(n) - Math.exp(-n)));\n\t    }\n\t  }, {\n\t    key: '_boundsToCenter',\n\t    value: function _boundsToCenter(bounds) {\n\t      var x = bounds[0] + (bounds[2] - bounds[0]) / 2;\n\t      var y = bounds[1] + (bounds[3] - bounds[1]) / 2;\n\t\n\t      return [x, y];\n\t    }\n\t  }, {\n\t    key: '_getSide',\n\t    value: function _getSide(bounds) {\n\t      return new _three2['default'].Vector3(bounds[0], 0, bounds[3]).sub(new _three2['default'].Vector3(bounds[0], 0, bounds[1])).length();\n\t    }\n\t  }]);\n\t\n\t  return Tile;\n\t})();\n\t\n\texports['default'] = Tile;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 52 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */\n\t\n\tBoxHelper = function (object) {\n\t\n\t\tvar indices = new Uint16Array([0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7]);\n\t\tvar positions = new Float32Array(8 * 3);\n\t\n\t\tvar geometry = new _three2['default'].BufferGeometry();\n\t\tgeometry.setIndex(new _three2['default'].BufferAttribute(indices, 1));\n\t\tgeometry.addAttribute('position', new _three2['default'].BufferAttribute(positions, 3));\n\t\n\t\t_three2['default'].LineSegments.call(this, geometry, new _three2['default'].LineBasicMaterial({ linewidth: 2, color: 0xff0000 }));\n\t\n\t\tif (object !== undefined) {\n\t\n\t\t\tthis.update(object);\n\t\t}\n\t};\n\t\n\tBoxHelper.prototype = Object.create(_three2['default'].LineSegments.prototype);\n\tBoxHelper.prototype.constructor = BoxHelper;\n\t\n\tBoxHelper.prototype.update = (function () {\n\t\n\t\tvar box = new _three2['default'].Box3();\n\t\n\t\treturn function (object) {\n\t\n\t\t\tbox.setFromObject(object);\n\t\n\t\t\tif (box.isEmpty()) return;\n\t\n\t\t\tvar min = box.min;\n\t\t\tvar max = box.max;\n\t\n\t\t\t/*\n\t    5____4\n\t  1/___0/|\n\t  | 6__|_7\n\t  2/___3/\n\t  \t0: max.x, max.y, max.z\n\t  1: min.x, max.y, max.z\n\t  2: min.x, min.y, max.z\n\t  3: max.x, min.y, max.z\n\t  4: max.x, max.y, min.z\n\t  5: min.x, max.y, min.z\n\t  6: min.x, min.y, min.z\n\t  7: max.x, min.y, min.z\n\t  */\n\t\n\t\t\tvar position = this.geometry.attributes.position;\n\t\t\tvar array = position.array;\n\t\n\t\t\tarray[0] = max.x;array[1] = max.y;array[2] = max.z;\n\t\t\tarray[3] = min.x;array[4] = max.y;array[5] = max.z;\n\t\t\tarray[6] = min.x;array[7] = min.y;array[8] = max.z;\n\t\t\tarray[9] = max.x;array[10] = min.y;array[11] = max.z;\n\t\t\tarray[12] = max.x;array[13] = max.y;array[14] = min.z;\n\t\t\tarray[15] = min.x;array[16] = max.y;array[17] = min.z;\n\t\t\tarray[18] = min.x;array[19] = min.y;array[20] = min.z;\n\t\t\tarray[21] = max.x;array[22] = min.y;array[23] = min.z;\n\t\n\t\t\tposition.needsUpdate = true;\n\t\n\t\t\tthis.geometry.computeBoundingSphere();\n\t\t};\n\t})();\n\t\n\texports['default'] = BoxHelper;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 53 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\texports['default'] = function (colour, skyboxTarget) {\n\t  var canvas = document.createElement('canvas');\n\t  canvas.width = 1;\n\t  canvas.height = 1;\n\t\n\t  var context = canvas.getContext('2d');\n\t  context.fillStyle = colour;\n\t  context.fillRect(0, 0, canvas.width, canvas.height);\n\t  // context.strokeStyle = '#D0D0CF';\n\t  // context.strokeRect(0, 0, canvas.width, canvas.height);\n\t\n\t  var texture = new _three2['default'].Texture(canvas);\n\t\n\t  // // Silky smooth images when tilted\n\t  // texture.magFilter = THREE.LinearFilter;\n\t  // texture.minFilter = THREE.LinearMipMapLinearFilter;\n\t  // //\n\t  // // // TODO: Set this to renderer.getMaxAnisotropy() / 4\n\t  // texture.anisotropy = 4;\n\t\n\t  // texture.wrapS = THREE.RepeatWrapping;\n\t  // texture.wrapT = THREE.RepeatWrapping;\n\t  // texture.repeat.set(segments, segments);\n\t\n\t  texture.needsUpdate = true;\n\t\n\t  var material;\n\t\n\t  if (!skyboxTarget) {\n\t    material = new _three2['default'].MeshBasicMaterial({\n\t      map: texture,\n\t      depthWrite: false\n\t    });\n\t  } else {\n\t    material = new _three2['default'].MeshStandardMaterial({\n\t      map: texture,\n\t      depthWrite: false\n\t    });\n\t    material.roughness = 1;\n\t    material.metalness = 0.1;\n\t    material.envMap = skyboxTarget;\n\t  }\n\t\n\t  return material;\n\t};\n\t\n\t;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 54 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _TileLayer2 = __webpack_require__(40);\n\t\n\tvar _TileLayer3 = _interopRequireDefault(_TileLayer2);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar _GeoJSONTile = __webpack_require__(55);\n\t\n\tvar _GeoJSONTile2 = _interopRequireDefault(_GeoJSONTile);\n\t\n\tvar _lodashThrottle = __webpack_require__(33);\n\t\n\tvar _lodashThrottle2 = _interopRequireDefault(_lodashThrottle);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t// TODO: Offer on-the-fly slicing of static, non-tile-based GeoJSON files into a\n\t// tile grid using geojson-vt\n\t//\n\t// See: https://github.com/mapbox/geojson-vt\n\t\n\t// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\t\n\t// TODO: Consider pausing per-frame output during movement so there's little to\n\t// no jank caused by previous tiles still processing\n\t\n\t// This tile layer only updates the quadtree after world movement has occurred\n\t//\n\t// Tiles from previous quadtree updates are updated and outputted every frame\n\t// (or at least every frame, throttled to some amount)\n\t//\n\t// This is because the complexity of TopoJSON tiles requires a lot of processing\n\t// and so makes movement janky if updates occur every frame – only updating\n\t// after movement means frame drops are less obvious due to heavy processing\n\t// occurring while the view is generally stationary\n\t//\n\t// The downside is that until new tiles are requested and outputted you will\n\t// see blank spaces as you orbit and move around\n\t//\n\t// An added benefit is that it dramatically reduces the number of tiles being\n\t// requested over a period of time and the time it takes to go from request to\n\t// screen output\n\t//\n\t// It may be possible to perform these updates per-frame once Web Worker\n\t// processing is added\n\t\n\tvar GeoJSONTileLayer = (function (_TileLayer) {\n\t  _inherits(GeoJSONTileLayer, _TileLayer);\n\t\n\t  function GeoJSONTileLayer(path, options) {\n\t    _classCallCheck(this, GeoJSONTileLayer);\n\t\n\t    var defaults = {\n\t      maxLOD: 14,\n\t      distance: 30000\n\t    };\n\t\n\t    options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    _get(Object.getPrototypeOf(GeoJSONTileLayer.prototype), 'constructor', this).call(this, options);\n\t\n\t    this._path = path;\n\t  }\n\t\n\t  _createClass(GeoJSONTileLayer, [{\n\t    key: '_onAdd',\n\t    value: function _onAdd(world) {\n\t      var _this = this;\n\t\n\t      _get(Object.getPrototypeOf(GeoJSONTileLayer.prototype), '_onAdd', this).call(this, world);\n\t\n\t      // Trigger initial quadtree calculation on the next frame\n\t      //\n\t      // TODO: This is a hack to ensure the camera is all set up - a better\n\t      // solution should be found\n\t      setTimeout(function () {\n\t        _this._calculateLOD();\n\t        _this._initEvents();\n\t      }, 0);\n\t    }\n\t  }, {\n\t    key: '_initEvents',\n\t    value: function _initEvents() {\n\t      // Run LOD calculations based on render calls\n\t      //\n\t      // Throttled to 1 LOD calculation per 100ms\n\t      this._throttledWorldUpdate = (0, _lodashThrottle2['default'])(this._onWorldUpdate, 100);\n\t\n\t      this._world.on('preUpdate', this._throttledWorldUpdate, this);\n\t      this._world.on('move', this._onWorldMove, this);\n\t      this._world.on('controlsMove', this._onControlsMove, this);\n\t    }\n\t\n\t    // Update and output tiles each frame (throttled)\n\t  }, {\n\t    key: '_onWorldUpdate',\n\t    value: function _onWorldUpdate() {\n\t      if (this._pauseOutput) {\n\t        return;\n\t      }\n\t\n\t      this._outputTiles();\n\t    }\n\t\n\t    // Update tiles grid after world move, but don't output them\n\t  }, {\n\t    key: '_onWorldMove',\n\t    value: function _onWorldMove(latlon, point) {\n\t      this._pauseOutput = false;\n\t      this._calculateLOD();\n\t    }\n\t\n\t    // Pause updates during control movement for less visual jank\n\t  }, {\n\t    key: '_onControlsMove',\n\t    value: function _onControlsMove() {\n\t      this._pauseOutput = true;\n\t    }\n\t  }, {\n\t    key: '_createTile',\n\t    value: function _createTile(quadcode, layer) {\n\t      var options = {};\n\t\n\t      // if (this._options.filter) {\n\t      //   options.filter = this._options.filter;\n\t      // }\n\t      //\n\t      // if (this._options.style) {\n\t      //   options.style = this._options.style;\n\t      // }\n\t      //\n\t      // if (this._options.topojson) {\n\t      //   options.topojson = true;\n\t      // }\n\t      //\n\t      // if (this._options.interactive) {\n\t      //   options.interactive = true;\n\t      // }\n\t      //\n\t      // if (this._options.onClick) {\n\t      //   options.onClick = this._options.onClick;\n\t      // }\n\t\n\t      return new _GeoJSONTile2['default'](quadcode, this._path, layer, this._options);\n\t    }\n\t\n\t    // Destroys the layer and removes it from the scene and memory\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      this._world.off('preUpdate', this._throttledWorldUpdate);\n\t      this._world.off('move', this._onWorldMove);\n\t\n\t      this._throttledWorldUpdate = null;\n\t\n\t      // Run common destruction logic from parent\n\t      _get(Object.getPrototypeOf(GeoJSONTileLayer.prototype), 'destroy', this).call(this);\n\t    }\n\t  }]);\n\t\n\t  return GeoJSONTileLayer;\n\t})(_TileLayer3['default']);\n\t\n\texports['default'] = GeoJSONTileLayer;\n\t\n\tvar noNew = function noNew(path, options) {\n\t  return new GeoJSONTileLayer(path, options);\n\t};\n\t\n\t// Initialise without requiring new keyword\n\texports.geoJSONTileLayer = noNew;\n\n/***/ },\n/* 55 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _Tile2 = __webpack_require__(51);\n\t\n\tvar _Tile3 = _interopRequireDefault(_Tile2);\n\t\n\tvar _GeoJSONLayer = __webpack_require__(56);\n\t\n\tvar _vendorBoxHelper = __webpack_require__(52);\n\t\n\tvar _vendorBoxHelper2 = _interopRequireDefault(_vendorBoxHelper);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _reqwest = __webpack_require__(58);\n\t\n\tvar _reqwest2 = _interopRequireDefault(_reqwest);\n\t\n\tvar _geoPoint = __webpack_require__(6);\n\t\n\tvar _geoLatLon = __webpack_require__(5);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\t// import Offset from 'polygon-offset';\n\t\n\tvar _utilGeoJSON = __webpack_require__(60);\n\t\n\tvar _utilGeoJSON2 = _interopRequireDefault(_utilGeoJSON);\n\t\n\tvar _utilBuffer = __webpack_require__(66);\n\t\n\tvar _utilBuffer2 = _interopRequireDefault(_utilBuffer);\n\t\n\tvar _enginePickingMaterial = __webpack_require__(67);\n\t\n\tvar _enginePickingMaterial2 = _interopRequireDefault(_enginePickingMaterial);\n\t\n\t// TODO: Map picking IDs to some reference within the tile data / geometry so\n\t// that something useful can be done when an object is picked / clicked on\n\t\n\t// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\t\n\t// TODO: Perform tile request and processing in a Web Worker\n\t//\n\t// Use Operative (https://github.com/padolsey/operative)\n\t//\n\t// Would it make sense to have the worker functionality defined in a static\n\t// method so it only gets initialised once and not on every tile instance?\n\t//\n\t// Otherwise, worker processing logic would have to go in the tile layer so not\n\t// to waste loads of time setting up a brand new worker with three.js for each\n\t// tile every single time.\n\t//\n\t// Unsure of the best way to get three.js and VIZI into the worker\n\t//\n\t// Would need to set up a CRS / projection identical to the world instance\n\t//\n\t// Is it possible to bypass requirements on external script by having multiple\n\t// simple worker methods that each take enough inputs to perform a single task\n\t// without requiring VIZI or three.js? So long as the heaviest logic is done in\n\t// the worker and transferrable objects are used then it should be better than\n\t// nothing. Would probably still need things like earcut...\n\t//\n\t// After all, the three.js logic and object creation will still need to be\n\t// done on the main thread regardless so the worker should try to do as much as\n\t// possible with as few dependencies as possible.\n\t//\n\t// Have a look at how this is done in Tangram before implementing anything as\n\t// the approach there is pretty similar and robust.\n\t\n\tvar GeoJSONTile = (function (_Tile) {\n\t  _inherits(GeoJSONTile, _Tile);\n\t\n\t  function GeoJSONTile(quadcode, path, layer, options) {\n\t    _classCallCheck(this, GeoJSONTile);\n\t\n\t    _get(Object.getPrototypeOf(GeoJSONTile.prototype), 'constructor', this).call(this, quadcode, path, layer);\n\t\n\t    this._defaultStyle = _utilGeoJSON2['default'].defaultStyle;\n\t\n\t    var defaults = {\n\t      output: true,\n\t      outputToScene: false,\n\t      interactive: false,\n\t      topojson: false,\n\t      filter: null,\n\t      onEachFeature: null,\n\t      polygonMaterial: null,\n\t      onPolygonMesh: null,\n\t      onPolygonBufferAttributes: null,\n\t      polylineMaterial: null,\n\t      onPolylineMesh: null,\n\t      onPolylineBufferAttributes: null,\n\t      pointGeometry: null,\n\t      pointMaterial: null,\n\t      onPointMesh: null,\n\t      style: _utilGeoJSON2['default'].defaultStyle,\n\t      keepFeatures: false\n\t    };\n\t\n\t    var _options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    if (typeof options.style === 'function') {\n\t      _options.style = options.style;\n\t    } else {\n\t      _options.style = (0, _lodashAssign2['default'])({}, defaults.style, options.style);\n\t    }\n\t\n\t    this._options = _options;\n\t  }\n\t\n\t  // Request data for the tile\n\t\n\t  _createClass(GeoJSONTile, [{\n\t    key: 'requestTileAsync',\n\t    value: function requestTileAsync() {\n\t      var _this = this;\n\t\n\t      // Making this asynchronous really speeds up the LOD framerate\n\t      setTimeout(function () {\n\t        if (!_this._mesh) {\n\t          _this._mesh = _this._createMesh();\n\t\n\t          // this._shadowCanvas = this._createShadowCanvas();\n\t\n\t          _this._requestTile();\n\t        }\n\t      }, 0);\n\t    }\n\t\n\t    // TODO: Destroy GeoJSONLayer\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      // Cancel any pending requests\n\t      this._abortRequest();\n\t\n\t      // Clear request reference\n\t      this._request = null;\n\t\n\t      if (this._geojsonLayer) {\n\t        this._geojsonLayer.destroy();\n\t        this._geojsonLayer = null;\n\t      }\n\t\n\t      this._mesh = null;\n\t\n\t      // TODO: Properly dispose of picking mesh\n\t      this._pickingMesh = null;\n\t\n\t      _get(Object.getPrototypeOf(GeoJSONTile.prototype), 'destroy', this).call(this);\n\t    }\n\t  }, {\n\t    key: '_createMesh',\n\t    value: function _createMesh() {\n\t      // Something went wrong and the tile\n\t      //\n\t      // Possibly removed by the cache before loaded\n\t      if (!this._center) {\n\t        return;\n\t      }\n\t\n\t      var mesh = new _three2['default'].Object3D();\n\t      // mesh.add(this._createDebugMesh());\n\t\n\t      return mesh;\n\t    }\n\t  }, {\n\t    key: '_createDebugMesh',\n\t    value: function _createDebugMesh() {\n\t      var canvas = document.createElement('canvas');\n\t      canvas.width = 256;\n\t      canvas.height = 256;\n\t\n\t      var context = canvas.getContext('2d');\n\t      context.font = 'Bold 20px Helvetica Neue, Verdana, Arial';\n\t      context.fillStyle = '#ff0000';\n\t      context.fillText(this._quadcode, 20, canvas.width / 2 - 5);\n\t      context.fillText(this._tile.toString(), 20, canvas.width / 2 + 25);\n\t\n\t      var texture = new _three2['default'].Texture(canvas);\n\t\n\t      // Silky smooth images when tilted\n\t      texture.magFilter = _three2['default'].LinearFilter;\n\t      texture.minFilter = _three2['default'].LinearMipMapLinearFilter;\n\t\n\t      // TODO: Set this to renderer.getMaxAnisotropy() / 4\n\t      texture.anisotropy = 4;\n\t\n\t      texture.needsUpdate = true;\n\t\n\t      var material = new _three2['default'].MeshBasicMaterial({\n\t        map: texture,\n\t        transparent: true,\n\t        depthWrite: false\n\t      });\n\t\n\t      var geom = new _three2['default'].PlaneBufferGeometry(this._side, this._side, 1);\n\t      var mesh = new _three2['default'].Mesh(geom, material);\n\t\n\t      mesh.rotation.x = -90 * Math.PI / 180;\n\t      mesh.position.y = 0.1;\n\t\n\t      return mesh;\n\t    }\n\t\n\t    // _createShadowCanvas() {\n\t    //   var canvas = document.createElement('canvas');\n\t    //\n\t    //   // Rendered at a low resolution and later scaled up for a low-quality blur\n\t    //   canvas.width = 512;\n\t    //   canvas.height = 512;\n\t    //\n\t    //   return canvas;\n\t    // }\n\t\n\t    // _addShadow(coordinates) {\n\t    //   var ctx = this._shadowCanvas.getContext('2d');\n\t    //   var width = this._shadowCanvas.width;\n\t    //   var height = this._shadowCanvas.height;\n\t    //\n\t    //   var _coords;\n\t    //   var _offset;\n\t    //   var offset = new Offset();\n\t    //\n\t    //   // Transform coordinates to shadowCanvas space and draw on canvas\n\t    //   coordinates.forEach((ring, index) => {\n\t    //     ctx.beginPath();\n\t    //\n\t    //     _coords = ring.map(coord => {\n\t    //       var xFrac = (coord[0] - this._boundsWorld[0]) / this._side;\n\t    //       var yFrac = (coord[1] - this._boundsWorld[3]) / this._side;\n\t    //       return [xFrac * width, yFrac * height];\n\t    //     });\n\t    //\n\t    //     if (index > 0) {\n\t    //       _offset = _coords;\n\t    //     } else {\n\t    //       _offset = offset.data(_coords).padding(1.3);\n\t    //     }\n\t    //\n\t    //     // TODO: This is super flaky and crashes the browser if run on anything\n\t    //     // put the outer ring (potentially due to winding)\n\t    //     _offset.forEach((coord, index) => {\n\t    //       // var xFrac = (coord[0] - this._boundsWorld[0]) / this._side;\n\t    //       // var yFrac = (coord[1] - this._boundsWorld[3]) / this._side;\n\t    //\n\t    //       if (index === 0) {\n\t    //         ctx.moveTo(coord[0], coord[1]);\n\t    //       } else {\n\t    //         ctx.lineTo(coord[0], coord[1]);\n\t    //       }\n\t    //     });\n\t    //\n\t    //     ctx.closePath();\n\t    //   });\n\t    //\n\t    //   ctx.fillStyle = 'rgba(80, 80, 80, 0.7)';\n\t    //   ctx.fill();\n\t    // }\n\t\n\t  }, {\n\t    key: '_requestTile',\n\t    value: function _requestTile() {\n\t      var _this2 = this;\n\t\n\t      var urlParams = {\n\t        x: this._tile[0],\n\t        y: this._tile[1],\n\t        z: this._tile[2]\n\t      };\n\t\n\t      var url = this._getTileURL(urlParams);\n\t\n\t      this._request = (0, _reqwest2['default'])({\n\t        url: url,\n\t        type: 'json',\n\t        crossOrigin: true\n\t      }).then(function (res) {\n\t        // Clear request reference\n\t        _this2._request = null;\n\t        _this2._processTileData(res);\n\t      })['catch'](function (err) {\n\t        console.error(err);\n\t\n\t        // Clear request reference\n\t        _this2._request = null;\n\t      });\n\t    }\n\t  }, {\n\t    key: '_processTileData',\n\t    value: function _processTileData(data) {\n\t      console.time(this._tile);\n\t\n\t      // Using this creates a huge amount of memory due to the quantity of tiles\n\t      this._geojsonLayer = (0, _GeoJSONLayer.geoJSONLayer)(data, this._options).addTo(this._world);\n\t\n\t      this._mesh = this._geojsonLayer._object3D;\n\t      this._pickingMesh = this._geojsonLayer._pickingMesh;\n\t\n\t      // Free the GeoJSON memory as we don't need it\n\t      //\n\t      // TODO: This should probably be a method within GeoJSONLayer\n\t      this._geojsonLayer._geojson = null;\n\t\n\t      // TODO: Fix or store shadow canvas stuff and get rid of this code\n\t      // Draw footprint on shadow canvas\n\t      //\n\t      // TODO: Disabled for the time-being until it can be sped up / moved to\n\t      // a worker\n\t      // this._addShadow(coordinates);\n\t\n\t      // Output shadow canvas\n\t\n\t      // TODO: Disabled for the time-being until it can be sped up / moved to\n\t      // a worker\n\t\n\t      // var texture = new THREE.Texture(this._shadowCanvas);\n\t      //\n\t      // // Silky smooth images when tilted\n\t      // texture.magFilter = THREE.LinearFilter;\n\t      // texture.minFilter = THREE.LinearMipMapLinearFilter;\n\t      //\n\t      // // TODO: Set this to renderer.getMaxAnisotropy() / 4\n\t      // texture.anisotropy = 4;\n\t      //\n\t      // texture.needsUpdate = true;\n\t      //\n\t      // var material;\n\t      // if (!this._world._environment._skybox) {\n\t      //   material = new THREE.MeshBasicMaterial({\n\t      //     map: texture,\n\t      //     transparent: true,\n\t      //     depthWrite: false\n\t      //   });\n\t      // } else {\n\t      //   material = new THREE.MeshStandardMaterial({\n\t      //     map: texture,\n\t      //     transparent: true,\n\t      //     depthWrite: false\n\t      //   });\n\t      //   material.roughness = 1;\n\t      //   material.metalness = 0.1;\n\t      //   material.envMap = this._world._environment._skybox.getRenderTarget();\n\t      // }\n\t      //\n\t      // var geom = new THREE.PlaneBufferGeometry(this._side, this._side, 1);\n\t      // var mesh = new THREE.Mesh(geom, material);\n\t      //\n\t      // mesh.castShadow = false;\n\t      // mesh.receiveShadow = false;\n\t      // mesh.renderOrder = 1;\n\t      //\n\t      // mesh.rotation.x = -90 * Math.PI / 180;\n\t      //\n\t      // this._mesh.add(mesh);\n\t\n\t      this._ready = true;\n\t      console.timeEnd(this._tile);\n\t    }\n\t  }, {\n\t    key: '_abortRequest',\n\t    value: function _abortRequest() {\n\t      if (!this._request) {\n\t        return;\n\t      }\n\t\n\t      this._request.abort();\n\t    }\n\t  }]);\n\t\n\t  return GeoJSONTile;\n\t})(_Tile3['default']);\n\t\n\texports['default'] = GeoJSONTile;\n\t\n\tvar noNew = function noNew(quadcode, path, layer, options) {\n\t  return new GeoJSONTile(quadcode, path, layer, options);\n\t};\n\t\n\t// Initialise without requiring new keyword\n\texports.geoJSONTile = noNew;\n\n/***/ },\n/* 56 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// TODO: Consider adopting GeoJSON CSS\n\t// http://wiki.openstreetmap.org/wiki/Geojson_CSS\n\t\n\t// TODO: Allow interaction to be defined per-layer to save on resources\n\t//\n\t// For example, only allow polygons to be interactive via a polygonInteractive\n\t// option\n\t\n\tvar _LayerGroup2 = __webpack_require__(57);\n\t\n\tvar _LayerGroup3 = _interopRequireDefault(_LayerGroup2);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar _reqwest = __webpack_require__(58);\n\t\n\tvar _reqwest2 = _interopRequireDefault(_reqwest);\n\t\n\tvar _utilGeoJSON = __webpack_require__(60);\n\t\n\tvar _utilGeoJSON2 = _interopRequireDefault(_utilGeoJSON);\n\t\n\tvar _utilBuffer = __webpack_require__(66);\n\t\n\tvar _utilBuffer2 = _interopRequireDefault(_utilBuffer);\n\t\n\tvar _enginePickingMaterial = __webpack_require__(67);\n\t\n\tvar _enginePickingMaterial2 = _interopRequireDefault(_enginePickingMaterial);\n\t\n\tvar _geometryPolygonLayer = __webpack_require__(69);\n\t\n\tvar _geometryPolygonLayer2 = _interopRequireDefault(_geometryPolygonLayer);\n\t\n\tvar _geometryPolylineLayer = __webpack_require__(70);\n\t\n\tvar _geometryPolylineLayer2 = _interopRequireDefault(_geometryPolylineLayer);\n\t\n\tvar _geometryPointLayer = __webpack_require__(71);\n\t\n\tvar _geometryPointLayer2 = _interopRequireDefault(_geometryPointLayer);\n\t\n\tvar GeoJSONLayer = (function (_LayerGroup) {\n\t  _inherits(GeoJSONLayer, _LayerGroup);\n\t\n\t  function GeoJSONLayer(geojson, options) {\n\t    _classCallCheck(this, GeoJSONLayer);\n\t\n\t    var defaults = {\n\t      output: false,\n\t      interactive: false,\n\t      topojson: false,\n\t      filter: null,\n\t      onEachFeature: null,\n\t      polygonMaterial: null,\n\t      onPolygonMesh: null,\n\t      onPolygonBufferAttributes: null,\n\t      polylineMaterial: null,\n\t      onPolylineMesh: null,\n\t      onPolylineBufferAttributes: null,\n\t      pointGeometry: null,\n\t      pointMaterial: null,\n\t      onPointMesh: null,\n\t      style: _utilGeoJSON2['default'].defaultStyle,\n\t      keepFeatures: true\n\t    };\n\t\n\t    var _options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    if (typeof options.style === 'function') {\n\t      _options.style = options.style;\n\t    } else {\n\t      _options.style = (0, _lodashAssign2['default'])({}, defaults.style, options.style);\n\t    }\n\t\n\t    _get(Object.getPrototypeOf(GeoJSONLayer.prototype), 'constructor', this).call(this, _options);\n\t\n\t    this._geojson = geojson;\n\t  }\n\t\n\t  _createClass(GeoJSONLayer, [{\n\t    key: '_onAdd',\n\t    value: function _onAdd(world) {\n\t      // Only add to picking mesh if this layer is controlling output\n\t      //\n\t      // Otherwise, assume another component will eventually add a mesh to\n\t      // the picking scene\n\t      if (this.isOutput()) {\n\t        this._pickingMesh = new THREE.Object3D();\n\t        this.addToPicking(this._pickingMesh);\n\t      }\n\t\n\t      // Request data from URL if needed\n\t      if (typeof this._geojson === 'string') {\n\t        this._requestData(this._geojson);\n\t      } else {\n\t        // Process and add GeoJSON to layer\n\t        this._processData(this._geojson);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_requestData',\n\t    value: function _requestData(url) {\n\t      var _this = this;\n\t\n\t      this._request = (0, _reqwest2['default'])({\n\t        url: url,\n\t        type: 'json',\n\t        crossOrigin: true\n\t      }).then(function (res) {\n\t        // Clear request reference\n\t        _this._request = null;\n\t        _this._processData(res);\n\t      })['catch'](function (err) {\n\t        console.error(err);\n\t\n\t        // Clear request reference\n\t        _this._request = null;\n\t      });\n\t    }\n\t\n\t    // TODO: Wrap into a helper method so this isn't duplicated in the tiled\n\t    // GeoJSON output layer\n\t    //\n\t    // Need to be careful as to not make it impossible to fork this off into a\n\t    // worker script at a later stage\n\t  }, {\n\t    key: '_processData',\n\t    value: function _processData(data) {\n\t      var _this2 = this;\n\t\n\t      // Collects features into a single FeatureCollection\n\t      //\n\t      // Also converts TopoJSON to GeoJSON if instructed\n\t      this._geojson = _utilGeoJSON2['default'].collectFeatures(data, this._options.topojson);\n\t\n\t      // TODO: Check that GeoJSON is valid / usable\n\t\n\t      var features = this._geojson.features;\n\t\n\t      // Run filter, if provided\n\t      if (this._options.filter) {\n\t        features = this._geojson.features.filter(this._options.filter);\n\t      }\n\t\n\t      var defaults = {};\n\t\n\t      // Assume that a style won't be set per feature\n\t      var style = this._options.style;\n\t\n\t      var options;\n\t      features.forEach(function (feature) {\n\t        // Get per-feature style object, if provided\n\t        if (typeof _this2._options.style === 'function') {\n\t          style = (0, _lodashAssign2['default'])({}, _utilGeoJSON2['default'].defaultStyle, _this2._options.style(feature));\n\t        }\n\t\n\t        options = (0, _lodashAssign2['default'])({}, defaults, {\n\t          // If merging feature layers, stop them outputting themselves\n\t          // If not, let feature layers output themselves to the world\n\t          output: !_this2.isOutput(),\n\t          interactive: _this2._options.interactive,\n\t          style: style\n\t        });\n\t\n\t        var layer = _this2._featureToLayer(feature, options);\n\t\n\t        if (!layer) {\n\t          return;\n\t        }\n\t\n\t        // Sometimes you don't want to store a reference to the feature\n\t        //\n\t        // For example, to save memory when being used by tile layers\n\t        if (_this2._options.keepFeatures) {\n\t          layer.feature = feature;\n\t        }\n\t\n\t        // If defined, call a function for each feature\n\t        //\n\t        // This is commonly used for adding event listeners from the user script\n\t        if (_this2._options.onEachFeature) {\n\t          _this2._options.onEachFeature(feature, layer);\n\t        }\n\t\n\t        _this2.addLayer(layer);\n\t      });\n\t\n\t      // If merging layers do that now, otherwise skip as the geometry layers\n\t      // should have already outputted themselves\n\t      if (!this.isOutput()) {\n\t        return;\n\t      }\n\t\n\t      // From here on we can assume that we want to merge the layers\n\t\n\t      var polygonAttributes = [];\n\t      var polygonFlat = true;\n\t\n\t      var polylineAttributes = [];\n\t      var pointAttributes = [];\n\t\n\t      this._layers.forEach(function (layer) {\n\t        if (layer instanceof _geometryPolygonLayer2['default']) {\n\t          polygonAttributes.push(layer.getBufferAttributes());\n\t\n\t          if (polygonFlat && !layer.isFlat()) {\n\t            polygonFlat = false;\n\t          }\n\t        } else if (layer instanceof _geometryPolylineLayer2['default']) {\n\t          polylineAttributes.push(layer.getBufferAttributes());\n\t        } else if (layer instanceof _geometryPointLayer2['default']) {\n\t          pointAttributes.push(layer.getBufferAttributes());\n\t        }\n\t      });\n\t\n\t      if (polygonAttributes.length > 0) {\n\t        var mergedPolygonAttributes = _utilBuffer2['default'].mergeAttributes(polygonAttributes);\n\t        this._setPolygonMesh(mergedPolygonAttributes, polygonFlat);\n\t        this.add(this._polygonMesh);\n\t      }\n\t\n\t      if (polylineAttributes.length > 0) {\n\t        var mergedPolylineAttributes = _utilBuffer2['default'].mergeAttributes(polylineAttributes);\n\t        this._setPolylineMesh(mergedPolylineAttributes);\n\t        this.add(this._polylineMesh);\n\t      }\n\t\n\t      if (pointAttributes.length > 0) {\n\t        var mergedPointAttributes = _utilBuffer2['default'].mergeAttributes(pointAttributes);\n\t        this._setPointMesh(mergedPointAttributes);\n\t        this.add(this._pointMesh);\n\t      }\n\t\n\t      // Clean up layers\n\t      //\n\t      // TODO: Are there ever situations where the unmerged buffer attributes\n\t      // and coordinates would still be required?\n\t      this._layers.forEach(function (layer) {\n\t        layer.clearBufferAttributes();\n\t        layer.clearCoordinates();\n\t      });\n\t    }\n\t\n\t    // Create and store mesh from buffer attributes\n\t    //\n\t    // TODO: De-dupe this from the individual mesh creation logic within each\n\t    // geometry layer (materials, settings, etc)\n\t    //\n\t    // Could make this an abstract method for each geometry layer\n\t  }, {\n\t    key: '_setPolygonMesh',\n\t    value: function _setPolygonMesh(attributes, flat) {\n\t      var geometry = new THREE.BufferGeometry();\n\t\n\t      // itemSize = 3 because there are 3 values (components) per vertex\n\t      geometry.addAttribute('position', new THREE.BufferAttribute(attributes.vertices, 3));\n\t      geometry.addAttribute('normal', new THREE.BufferAttribute(attributes.normals, 3));\n\t      geometry.addAttribute('color', new THREE.BufferAttribute(attributes.colours, 3));\n\t\n\t      if (attributes.pickingIds) {\n\t        geometry.addAttribute('pickingId', new THREE.BufferAttribute(attributes.pickingIds, 1));\n\t      }\n\t\n\t      geometry.computeBoundingBox();\n\t\n\t      // TODO: Make this work when style is a function per feature\n\t      var style = typeof this._options.style === 'function' ? this._options.style(this._geojson.features[0]) : this._options.style;\n\t      style = (0, _lodashAssign2['default'])({}, _utilGeoJSON2['default'].defaultStyle, style);\n\t\n\t      var material;\n\t      if (this._options.polygonMaterial && this._options.polygonMaterial instanceof THREE.Material) {\n\t        material = this._options.polygonMaterial;\n\t      } else if (!this._world._environment._skybox) {\n\t        material = new THREE.MeshPhongMaterial({\n\t          vertexColors: THREE.VertexColors,\n\t          side: THREE.BackSide,\n\t          transparent: style.transparent,\n\t          opacity: style.opacity,\n\t          blending: style.blending\n\t        });\n\t      } else {\n\t        material = new THREE.MeshStandardMaterial({\n\t          vertexColors: THREE.VertexColors,\n\t          side: THREE.BackSide,\n\t          transparent: style.transparent,\n\t          opacity: style.opacity,\n\t          blending: style.blending\n\t        });\n\t        material.roughness = 1;\n\t        material.metalness = 0.1;\n\t        material.envMapIntensity = 3;\n\t        material.envMap = this._world._environment._skybox.getRenderTarget();\n\t      }\n\t\n\t      var mesh;\n\t\n\t      // Pass mesh through callback, if defined\n\t      if (typeof this._options.onPolygonMesh === 'function') {\n\t        mesh = this._options.onPolygonMesh(geometry, material);\n\t      } else {\n\t        mesh = new THREE.Mesh(geometry, material);\n\t\n\t        mesh.castShadow = true;\n\t        mesh.receiveShadow = true;\n\t      }\n\t\n\t      if (flat) {\n\t        material.depthWrite = false;\n\t        mesh.renderOrder = 1;\n\t      }\n\t\n\t      if (this._options.interactive && this._pickingMesh) {\n\t        material = new _enginePickingMaterial2['default']();\n\t        material.side = THREE.BackSide;\n\t\n\t        var pickingMesh = new THREE.Mesh(geometry, material);\n\t        this._pickingMesh.add(pickingMesh);\n\t      }\n\t\n\t      this._polygonMesh = mesh;\n\t    }\n\t  }, {\n\t    key: '_setPolylineMesh',\n\t    value: function _setPolylineMesh(attributes) {\n\t      var geometry = new THREE.BufferGeometry();\n\t\n\t      // itemSize = 3 because there are 3 values (components) per vertex\n\t      geometry.addAttribute('position', new THREE.BufferAttribute(attributes.vertices, 3));\n\t\n\t      if (attributes.normals) {\n\t        geometry.addAttribute('normal', new THREE.BufferAttribute(attributes.normals, 3));\n\t      }\n\t\n\t      geometry.addAttribute('color', new THREE.BufferAttribute(attributes.colours, 3));\n\t\n\t      if (attributes.pickingIds) {\n\t        geometry.addAttribute('pickingId', new THREE.BufferAttribute(attributes.pickingIds, 1));\n\t      }\n\t\n\t      geometry.computeBoundingBox();\n\t\n\t      // TODO: Make this work when style is a function per feature\n\t      var style = typeof this._options.style === 'function' ? this._options.style(this._geojson.features[0]) : this._options.style;\n\t      style = (0, _lodashAssign2['default'])({}, _utilGeoJSON2['default'].defaultStyle, style);\n\t\n\t      var material;\n\t      if (this._options.polylineMaterial && this._options.polylineMaterial instanceof THREE.Material) {\n\t        material = this._options.polylineMaterial;\n\t      } else {\n\t        material = new THREE.LineBasicMaterial({\n\t          vertexColors: THREE.VertexColors,\n\t          linewidth: style.lineWidth,\n\t          transparent: style.lineTransparent,\n\t          opacity: style.lineOpacity,\n\t          blending: style.lineBlending\n\t        });\n\t      }\n\t\n\t      var mesh;\n\t\n\t      // Pass mesh through callback, if defined\n\t      if (typeof this._options.onPolylineMesh === 'function') {\n\t        mesh = this._options.onPolylineMesh(geometry, material);\n\t      } else {\n\t        mesh = new THREE.LineSegments(geometry, material);\n\t\n\t        if (style.lineRenderOrder !== undefined) {\n\t          material.depthWrite = false;\n\t          mesh.renderOrder = style.lineRenderOrder;\n\t        }\n\t\n\t        mesh.castShadow = true;\n\t        // mesh.receiveShadow = true;\n\t      }\n\t\n\t      // TODO: Allow this to be overridden, or copy mesh instead of creating a new\n\t      // one just for picking\n\t      if (this._options.interactive && this._pickingMesh) {\n\t        material = new _enginePickingMaterial2['default']();\n\t        // material.side = THREE.BackSide;\n\t\n\t        // Make the line wider / easier to pick\n\t        material.linewidth = style.lineWidth + material.linePadding;\n\t\n\t        var pickingMesh = new THREE.LineSegments(geometry, material);\n\t        this._pickingMesh.add(pickingMesh);\n\t      }\n\t\n\t      this._polylineMesh = mesh;\n\t    }\n\t  }, {\n\t    key: '_setPointMesh',\n\t    value: function _setPointMesh(attributes) {\n\t      var geometry = new THREE.BufferGeometry();\n\t\n\t      // itemSize = 3 because there are 3 values (components) per vertex\n\t      geometry.addAttribute('position', new THREE.BufferAttribute(attributes.vertices, 3));\n\t      geometry.addAttribute('normal', new THREE.BufferAttribute(attributes.normals, 3));\n\t      geometry.addAttribute('color', new THREE.BufferAttribute(attributes.colours, 3));\n\t\n\t      if (attributes.pickingIds) {\n\t        geometry.addAttribute('pickingId', new THREE.BufferAttribute(attributes.pickingIds, 1));\n\t      }\n\t\n\t      geometry.computeBoundingBox();\n\t\n\t      var material;\n\t      if (this._options.pointMaterial && this._options.pointMaterial instanceof THREE.Material) {\n\t        material = this._options.pointMaterial;\n\t      } else if (!this._world._environment._skybox) {\n\t        material = new THREE.MeshPhongMaterial({\n\t          vertexColors: THREE.VertexColors\n\t          // side: THREE.BackSide\n\t        });\n\t      } else {\n\t          material = new THREE.MeshStandardMaterial({\n\t            vertexColors: THREE.VertexColors\n\t            // side: THREE.BackSide\n\t          });\n\t          material.roughness = 1;\n\t          material.metalness = 0.1;\n\t          material.envMapIntensity = 3;\n\t          material.envMap = this._world._environment._skybox.getRenderTarget();\n\t        }\n\t\n\t      var mesh;\n\t\n\t      // Pass mesh callback, if defined\n\t      if (typeof this._options.onPointMesh === 'function') {\n\t        mesh = this._options.onPointMesh(geometry, material);\n\t      } else {\n\t        mesh = new THREE.Mesh(geometry, material);\n\t\n\t        mesh.castShadow = true;\n\t        // mesh.receiveShadow = true;\n\t      }\n\t\n\t      if (this._options.interactive && this._pickingMesh) {\n\t        material = new _enginePickingMaterial2['default']();\n\t        // material.side = THREE.BackSide;\n\t\n\t        var pickingMesh = new THREE.Mesh(geometry, material);\n\t        this._pickingMesh.add(pickingMesh);\n\t      }\n\t\n\t      this._pointMesh = mesh;\n\t    }\n\t\n\t    // TODO: Support all GeoJSON geometry types\n\t  }, {\n\t    key: '_featureToLayer',\n\t    value: function _featureToLayer(feature, options) {\n\t      var geometry = feature.geometry;\n\t      var coordinates = geometry.coordinates ? geometry.coordinates : null;\n\t\n\t      if (!coordinates || !geometry) {\n\t        return;\n\t      }\n\t\n\t      if (geometry.type === 'Polygon' || geometry.type === 'MultiPolygon') {\n\t        // Get material instance to use for polygon, if provided\n\t        if (typeof this._options.polygonMaterial === 'function') {\n\t          options.geometry = this._options.polygonMaterial(feature);\n\t        }\n\t\n\t        if (typeof this._options.onPolygonMesh === 'function') {\n\t          options.onMesh = this._options.onPolygonMesh;\n\t        }\n\t\n\t        // Pass onBufferAttributes callback, if defined\n\t        if (typeof this._options.onPolygonBufferAttributes === 'function') {\n\t          options.onBufferAttributes = this._options.onPolygonBufferAttributes;\n\t        }\n\t\n\t        return new _geometryPolygonLayer2['default'](coordinates, options);\n\t      }\n\t\n\t      if (geometry.type === 'LineString' || geometry.type === 'MultiLineString') {\n\t        // Get material instance to use for line, if provided\n\t        if (typeof this._options.lineMaterial === 'function') {\n\t          options.geometry = this._options.lineMaterial(feature);\n\t        }\n\t\n\t        if (typeof this._options.onPolylineMesh === 'function') {\n\t          options.onMesh = this._options.onPolylineMesh;\n\t        }\n\t\n\t        // Pass onBufferAttributes callback, if defined\n\t        if (typeof this._options.onPolylineBufferAttributes === 'function') {\n\t          options.onBufferAttributes = this._options.onPolylineBufferAttributes;\n\t        }\n\t\n\t        return new _geometryPolylineLayer2['default'](coordinates, options);\n\t      }\n\t\n\t      if (geometry.type === 'Point' || geometry.type === 'MultiPoint') {\n\t        // Get geometry object to use for point, if provided\n\t        if (typeof this._options.pointGeometry === 'function') {\n\t          options.geometry = this._options.pointGeometry(feature);\n\t        }\n\t\n\t        // Get material instance to use for point, if provided\n\t        if (typeof this._options.pointMaterial === 'function') {\n\t          options.geometry = this._options.pointMaterial(feature);\n\t        }\n\t\n\t        if (typeof this._options.onPointMesh === 'function') {\n\t          options.onMesh = this._options.onPointMesh;\n\t        }\n\t\n\t        return new _geometryPointLayer2['default'](coordinates, options);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_abortRequest',\n\t    value: function _abortRequest() {\n\t      if (!this._request) {\n\t        return;\n\t      }\n\t\n\t      this._request.abort();\n\t    }\n\t\n\t    // Destroy the layers and remove them from the scene and memory\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      // Cancel any pending requests\n\t      this._abortRequest();\n\t\n\t      // Clear request reference\n\t      this._request = null;\n\t\n\t      this._geojson = null;\n\t\n\t      if (this._pickingMesh) {\n\t        // TODO: Properly dispose of picking mesh\n\t        this._pickingMesh = null;\n\t      }\n\t\n\t      if (this._polygonMesh) {\n\t        this._polygonMesh = null;\n\t      }\n\t\n\t      if (this._polylineMesh) {\n\t        this._polylineMesh = null;\n\t      }\n\t\n\t      if (this._pointMesh) {\n\t        this._pointMesh = null;\n\t      }\n\t\n\t      // Run common destruction logic from parent\n\t      _get(Object.getPrototypeOf(GeoJSONLayer.prototype), 'destroy', this).call(this);\n\t    }\n\t  }]);\n\t\n\t  return GeoJSONLayer;\n\t})(_LayerGroup3['default']);\n\t\n\texports['default'] = GeoJSONLayer;\n\t\n\tvar noNew = function noNew(geojson, options) {\n\t  return new GeoJSONLayer(geojson, options);\n\t};\n\t\n\texports.geoJSONLayer = noNew;\n\n/***/ },\n/* 57 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _Layer2 = __webpack_require__(30);\n\t\n\tvar _Layer3 = _interopRequireDefault(_Layer2);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar LayerGroup = (function (_Layer) {\n\t  _inherits(LayerGroup, _Layer);\n\t\n\t  function LayerGroup(options) {\n\t    _classCallCheck(this, LayerGroup);\n\t\n\t    var defaults = {\n\t      output: false\n\t    };\n\t\n\t    var _options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    _get(Object.getPrototypeOf(LayerGroup.prototype), 'constructor', this).call(this, _options);\n\t\n\t    this._layers = [];\n\t  }\n\t\n\t  _createClass(LayerGroup, [{\n\t    key: 'addLayer',\n\t    value: function addLayer(layer) {\n\t      this._layers.push(layer);\n\t      this._world.addLayer(layer);\n\t    }\n\t  }, {\n\t    key: 'removeLayer',\n\t    value: function removeLayer(layer) {\n\t      var layerIndex = this._layers.indexOf(layer);\n\t\n\t      if (layerIndex > -1) {\n\t        // Remove from this._layers\n\t        this._layers.splice(layerIndex, 1);\n\t      };\n\t\n\t      this._world.removeLayer(layer);\n\t    }\n\t  }, {\n\t    key: '_onAdd',\n\t    value: function _onAdd(world) {}\n\t\n\t    // Destroy the layers and remove them from the scene and memory\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      // TODO: Sometimes this is already null, find out why\n\t      if (this._layers) {\n\t        for (var i = 0; i < this._layers.length; i++) {\n\t          this._layers[i].destroy();\n\t        }\n\t\n\t        this._layers = null;\n\t      }\n\t\n\t      _get(Object.getPrototypeOf(LayerGroup.prototype), 'destroy', this).call(this);\n\t    }\n\t  }]);\n\t\n\t  return LayerGroup;\n\t})(_Layer3['default']);\n\t\n\texports['default'] = LayerGroup;\n\t\n\tvar noNew = function noNew(options) {\n\t  return new LayerGroup(options);\n\t};\n\t\n\texports.layerGroup = noNew;\n\n/***/ },\n/* 58 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n\t  * Reqwest! A general purpose XHR connection manager\n\t  * license MIT (c) Dustin Diaz 2015\n\t  * https://github.com/ded/reqwest\n\t  */\n\t\n\t!function (name, context, definition) {\n\t  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n\t  else if (true) !(__WEBPACK_AMD_DEFINE_FACTORY__ = (definition), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))\n\t  else context[name] = definition()\n\t}('reqwest', this, function () {\n\t\n\t  var context = this\n\t\n\t  if ('window' in context) {\n\t    var doc = document\n\t      , byTag = 'getElementsByTagName'\n\t      , head = doc[byTag]('head')[0]\n\t  } else {\n\t    var XHR2\n\t    try {\n\t      XHR2 = __webpack_require__(59)\n\t    } catch (ex) {\n\t      throw new Error('Peer dependency `xhr2` required! Please npm install xhr2')\n\t    }\n\t  }\n\t\n\t\n\t  var httpsRe = /^http/\n\t    , protocolRe = /(^\\w+):\\/\\//\n\t    , twoHundo = /^(20\\d|1223)$/ //http://stackoverflow.com/questions/10046972/msie-returns-status-code-of-1223-for-ajax-request\n\t    , readyState = 'readyState'\n\t    , contentType = 'Content-Type'\n\t    , requestedWith = 'X-Requested-With'\n\t    , uniqid = 0\n\t    , callbackPrefix = 'reqwest_' + (+new Date())\n\t    , lastValue // data stored by the most recent JSONP callback\n\t    , xmlHttpRequest = 'XMLHttpRequest'\n\t    , xDomainRequest = 'XDomainRequest'\n\t    , noop = function () {}\n\t\n\t    , isArray = typeof Array.isArray == 'function'\n\t        ? Array.isArray\n\t        : function (a) {\n\t            return a instanceof Array\n\t          }\n\t\n\t    , defaultHeaders = {\n\t          'contentType': 'application/x-www-form-urlencoded'\n\t        , 'requestedWith': xmlHttpRequest\n\t        , 'accept': {\n\t              '*':  'text/javascript, text/html, application/xml, text/xml, */*'\n\t            , 'xml':  'application/xml, text/xml'\n\t            , 'html': 'text/html'\n\t            , 'text': 'text/plain'\n\t            , 'json': 'application/json, text/javascript'\n\t            , 'js':   'application/javascript, text/javascript'\n\t          }\n\t      }\n\t\n\t    , xhr = function(o) {\n\t        // is it x-domain\n\t        if (o['crossOrigin'] === true) {\n\t          var xhr = context[xmlHttpRequest] ? new XMLHttpRequest() : null\n\t          if (xhr && 'withCredentials' in xhr) {\n\t            return xhr\n\t          } else if (context[xDomainRequest]) {\n\t            return new XDomainRequest()\n\t          } else {\n\t            throw new Error('Browser does not support cross-origin requests')\n\t          }\n\t        } else if (context[xmlHttpRequest]) {\n\t          return new XMLHttpRequest()\n\t        } else if (XHR2) {\n\t          return new XHR2()\n\t        } else {\n\t          return new ActiveXObject('Microsoft.XMLHTTP')\n\t        }\n\t      }\n\t    , globalSetupOptions = {\n\t        dataFilter: function (data) {\n\t          return data\n\t        }\n\t      }\n\t\n\t  function succeed(r) {\n\t    var protocol = protocolRe.exec(r.url)\n\t    protocol = (protocol && protocol[1]) || context.location.protocol\n\t    return httpsRe.test(protocol) ? twoHundo.test(r.request.status) : !!r.request.response\n\t  }\n\t\n\t  function handleReadyState(r, success, error) {\n\t    return function () {\n\t      // use _aborted to mitigate against IE err c00c023f\n\t      // (can't read props on aborted request objects)\n\t      if (r._aborted) return error(r.request)\n\t      if (r._timedOut) return error(r.request, 'Request is aborted: timeout')\n\t      if (r.request && r.request[readyState] == 4) {\n\t        r.request.onreadystatechange = noop\n\t        if (succeed(r)) success(r.request)\n\t        else\n\t          error(r.request)\n\t      }\n\t    }\n\t  }\n\t\n\t  function setHeaders(http, o) {\n\t    var headers = o['headers'] || {}\n\t      , h\n\t\n\t    headers['Accept'] = headers['Accept']\n\t      || defaultHeaders['accept'][o['type']]\n\t      || defaultHeaders['accept']['*']\n\t\n\t    var isAFormData = typeof FormData !== 'undefined' && (o['data'] instanceof FormData);\n\t    // breaks cross-origin requests with legacy browsers\n\t    if (!o['crossOrigin'] && !headers[requestedWith]) headers[requestedWith] = defaultHeaders['requestedWith']\n\t    if (!headers[contentType] && !isAFormData) headers[contentType] = o['contentType'] || defaultHeaders['contentType']\n\t    for (h in headers)\n\t      headers.hasOwnProperty(h) && 'setRequestHeader' in http && http.setRequestHeader(h, headers[h])\n\t  }\n\t\n\t  function setCredentials(http, o) {\n\t    if (typeof o['withCredentials'] !== 'undefined' && typeof http.withCredentials !== 'undefined') {\n\t      http.withCredentials = !!o['withCredentials']\n\t    }\n\t  }\n\t\n\t  function generalCallback(data) {\n\t    lastValue = data\n\t  }\n\t\n\t  function urlappend (url, s) {\n\t    return url + (/\\?/.test(url) ? '&' : '?') + s\n\t  }\n\t\n\t  function handleJsonp(o, fn, err, url) {\n\t    var reqId = uniqid++\n\t      , cbkey = o['jsonpCallback'] || 'callback' // the 'callback' key\n\t      , cbval = o['jsonpCallbackName'] || reqwest.getcallbackPrefix(reqId)\n\t      , cbreg = new RegExp('((^|\\\\?|&)' + cbkey + ')=([^&]+)')\n\t      , match = url.match(cbreg)\n\t      , script = doc.createElement('script')\n\t      , loaded = 0\n\t      , isIE10 = navigator.userAgent.indexOf('MSIE 10.0') !== -1\n\t\n\t    if (match) {\n\t      if (match[3] === '?') {\n\t        url = url.replace(cbreg, '$1=' + cbval) // wildcard callback func name\n\t      } else {\n\t        cbval = match[3] // provided callback func name\n\t      }\n\t    } else {\n\t      url = urlappend(url, cbkey + '=' + cbval) // no callback details, add 'em\n\t    }\n\t\n\t    context[cbval] = generalCallback\n\t\n\t    script.type = 'text/javascript'\n\t    script.src = url\n\t    script.async = true\n\t    if (typeof script.onreadystatechange !== 'undefined' && !isIE10) {\n\t      // need this for IE due to out-of-order onreadystatechange(), binding script\n\t      // execution to an event listener gives us control over when the script\n\t      // is executed. See http://jaubourg.net/2010/07/loading-script-as-onclick-handler-of.html\n\t      script.htmlFor = script.id = '_reqwest_' + reqId\n\t    }\n\t\n\t    script.onload = script.onreadystatechange = function () {\n\t      if ((script[readyState] && script[readyState] !== 'complete' && script[readyState] !== 'loaded') || loaded) {\n\t        return false\n\t      }\n\t      script.onload = script.onreadystatechange = null\n\t      script.onclick && script.onclick()\n\t      // Call the user callback with the last value stored and clean up values and scripts.\n\t      fn(lastValue)\n\t      lastValue = undefined\n\t      head.removeChild(script)\n\t      loaded = 1\n\t    }\n\t\n\t    // Add the script to the DOM head\n\t    head.appendChild(script)\n\t\n\t    // Enable JSONP timeout\n\t    return {\n\t      abort: function () {\n\t        script.onload = script.onreadystatechange = null\n\t        err({}, 'Request is aborted: timeout', {})\n\t        lastValue = undefined\n\t        head.removeChild(script)\n\t        loaded = 1\n\t      }\n\t    }\n\t  }\n\t\n\t  function getRequest(fn, err) {\n\t    var o = this.o\n\t      , method = (o['method'] || 'GET').toUpperCase()\n\t      , url = typeof o === 'string' ? o : o['url']\n\t      // convert non-string objects to query-string form unless o['processData'] is false\n\t      , data = (o['processData'] !== false && o['data'] && typeof o['data'] !== 'string')\n\t        ? reqwest.toQueryString(o['data'])\n\t        : (o['data'] || null)\n\t      , http\n\t      , sendWait = false\n\t\n\t    // if we're working on a GET request and we have data then we should append\n\t    // query string to end of URL and not post data\n\t    if ((o['type'] == 'jsonp' || method == 'GET') && data) {\n\t      url = urlappend(url, data)\n\t      data = null\n\t    }\n\t\n\t    if (o['type'] == 'jsonp') return handleJsonp(o, fn, err, url)\n\t\n\t    // get the xhr from the factory if passed\n\t    // if the factory returns null, fall-back to ours\n\t    http = (o.xhr && o.xhr(o)) || xhr(o)\n\t\n\t    http.open(method, url, o['async'] === false ? false : true)\n\t    setHeaders(http, o)\n\t    setCredentials(http, o)\n\t    if (context[xDomainRequest] && http instanceof context[xDomainRequest]) {\n\t        http.onload = fn\n\t        http.onerror = err\n\t        // NOTE: see\n\t        // http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/30ef3add-767c-4436-b8a9-f1ca19b4812e\n\t        http.onprogress = function() {}\n\t        sendWait = true\n\t    } else {\n\t      http.onreadystatechange = handleReadyState(this, fn, err)\n\t    }\n\t    o['before'] && o['before'](http)\n\t    if (sendWait) {\n\t      setTimeout(function () {\n\t        http.send(data)\n\t      }, 200)\n\t    } else {\n\t      http.send(data)\n\t    }\n\t    return http\n\t  }\n\t\n\t  function Reqwest(o, fn) {\n\t    this.o = o\n\t    this.fn = fn\n\t\n\t    init.apply(this, arguments)\n\t  }\n\t\n\t  function setType(header) {\n\t    // json, javascript, text/plain, text/html, xml\n\t    if (header === null) return undefined; //In case of no content-type.\n\t    if (header.match('json')) return 'json'\n\t    if (header.match('javascript')) return 'js'\n\t    if (header.match('text')) return 'html'\n\t    if (header.match('xml')) return 'xml'\n\t  }\n\t\n\t  function init(o, fn) {\n\t\n\t    this.url = typeof o == 'string' ? o : o['url']\n\t    this.timeout = null\n\t\n\t    // whether request has been fulfilled for purpose\n\t    // of tracking the Promises\n\t    this._fulfilled = false\n\t    // success handlers\n\t    this._successHandler = function(){}\n\t    this._fulfillmentHandlers = []\n\t    // error handlers\n\t    this._errorHandlers = []\n\t    // complete (both success and fail) handlers\n\t    this._completeHandlers = []\n\t    this._erred = false\n\t    this._responseArgs = {}\n\t\n\t    var self = this\n\t\n\t    fn = fn || function () {}\n\t\n\t    if (o['timeout']) {\n\t      this.timeout = setTimeout(function () {\n\t        timedOut()\n\t      }, o['timeout'])\n\t    }\n\t\n\t    if (o['success']) {\n\t      this._successHandler = function () {\n\t        o['success'].apply(o, arguments)\n\t      }\n\t    }\n\t\n\t    if (o['error']) {\n\t      this._errorHandlers.push(function () {\n\t        o['error'].apply(o, arguments)\n\t      })\n\t    }\n\t\n\t    if (o['complete']) {\n\t      this._completeHandlers.push(function () {\n\t        o['complete'].apply(o, arguments)\n\t      })\n\t    }\n\t\n\t    function complete (resp) {\n\t      o['timeout'] && clearTimeout(self.timeout)\n\t      self.timeout = null\n\t      while (self._completeHandlers.length > 0) {\n\t        self._completeHandlers.shift()(resp)\n\t      }\n\t    }\n\t\n\t    function success (resp) {\n\t      var type = o['type'] || resp && setType(resp.getResponseHeader('Content-Type')) // resp can be undefined in IE\n\t      resp = (type !== 'jsonp') ? self.request : resp\n\t      // use global data filter on response text\n\t      var filteredResponse = globalSetupOptions.dataFilter(resp.responseText, type)\n\t        , r = filteredResponse\n\t      try {\n\t        resp.responseText = r\n\t      } catch (e) {\n\t        // can't assign this in IE<=8, just ignore\n\t      }\n\t      if (r) {\n\t        switch (type) {\n\t        case 'json':\n\t          try {\n\t            resp = context.JSON ? context.JSON.parse(r) : eval('(' + r + ')')\n\t          } catch (err) {\n\t            return error(resp, 'Could not parse JSON in response', err)\n\t          }\n\t          break\n\t        case 'js':\n\t          resp = eval(r)\n\t          break\n\t        case 'html':\n\t          resp = r\n\t          break\n\t        case 'xml':\n\t          resp = resp.responseXML\n\t              && resp.responseXML.parseError // IE trololo\n\t              && resp.responseXML.parseError.errorCode\n\t              && resp.responseXML.parseError.reason\n\t            ? null\n\t            : resp.responseXML\n\t          break\n\t        }\n\t      }\n\t\n\t      self._responseArgs.resp = resp\n\t      self._fulfilled = true\n\t      fn(resp)\n\t      self._successHandler(resp)\n\t      while (self._fulfillmentHandlers.length > 0) {\n\t        resp = self._fulfillmentHandlers.shift()(resp)\n\t      }\n\t\n\t      complete(resp)\n\t    }\n\t\n\t    function timedOut() {\n\t      self._timedOut = true\n\t      self.request.abort()\n\t    }\n\t\n\t    function error(resp, msg, t) {\n\t      resp = self.request\n\t      self._responseArgs.resp = resp\n\t      self._responseArgs.msg = msg\n\t      self._responseArgs.t = t\n\t      self._erred = true\n\t      while (self._errorHandlers.length > 0) {\n\t        self._errorHandlers.shift()(resp, msg, t)\n\t      }\n\t      complete(resp)\n\t    }\n\t\n\t    this.request = getRequest.call(this, success, error)\n\t  }\n\t\n\t  Reqwest.prototype = {\n\t    abort: function () {\n\t      this._aborted = true\n\t      this.request.abort()\n\t    }\n\t\n\t  , retry: function () {\n\t      init.call(this, this.o, this.fn)\n\t    }\n\t\n\t    /**\n\t     * Small deviation from the Promises A CommonJs specification\n\t     * http://wiki.commonjs.org/wiki/Promises/A\n\t     */\n\t\n\t    /**\n\t     * `then` will execute upon successful requests\n\t     */\n\t  , then: function (success, fail) {\n\t      success = success || function () {}\n\t      fail = fail || function () {}\n\t      if (this._fulfilled) {\n\t        this._responseArgs.resp = success(this._responseArgs.resp)\n\t      } else if (this._erred) {\n\t        fail(this._responseArgs.resp, this._responseArgs.msg, this._responseArgs.t)\n\t      } else {\n\t        this._fulfillmentHandlers.push(success)\n\t        this._errorHandlers.push(fail)\n\t      }\n\t      return this\n\t    }\n\t\n\t    /**\n\t     * `always` will execute whether the request succeeds or fails\n\t     */\n\t  , always: function (fn) {\n\t      if (this._fulfilled || this._erred) {\n\t        fn(this._responseArgs.resp)\n\t      } else {\n\t        this._completeHandlers.push(fn)\n\t      }\n\t      return this\n\t    }\n\t\n\t    /**\n\t     * `fail` will execute when the request fails\n\t     */\n\t  , fail: function (fn) {\n\t      if (this._erred) {\n\t        fn(this._responseArgs.resp, this._responseArgs.msg, this._responseArgs.t)\n\t      } else {\n\t        this._errorHandlers.push(fn)\n\t      }\n\t      return this\n\t    }\n\t  , 'catch': function (fn) {\n\t      return this.fail(fn)\n\t    }\n\t  }\n\t\n\t  function reqwest(o, fn) {\n\t    return new Reqwest(o, fn)\n\t  }\n\t\n\t  // normalize newline variants according to spec -> CRLF\n\t  function normalize(s) {\n\t    return s ? s.replace(/\\r?\\n/g, '\\r\\n') : ''\n\t  }\n\t\n\t  function serial(el, cb) {\n\t    var n = el.name\n\t      , t = el.tagName.toLowerCase()\n\t      , optCb = function (o) {\n\t          // IE gives value=\"\" even where there is no value attribute\n\t          // 'specified' ref: http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-862529273\n\t          if (o && !o['disabled'])\n\t            cb(n, normalize(o['attributes']['value'] && o['attributes']['value']['specified'] ? o['value'] : o['text']))\n\t        }\n\t      , ch, ra, val, i\n\t\n\t    // don't serialize elements that are disabled or without a name\n\t    if (el.disabled || !n) return\n\t\n\t    switch (t) {\n\t    case 'input':\n\t      if (!/reset|button|image|file/i.test(el.type)) {\n\t        ch = /checkbox/i.test(el.type)\n\t        ra = /radio/i.test(el.type)\n\t        val = el.value\n\t        // WebKit gives us \"\" instead of \"on\" if a checkbox has no value, so correct it here\n\t        ;(!(ch || ra) || el.checked) && cb(n, normalize(ch && val === '' ? 'on' : val))\n\t      }\n\t      break\n\t    case 'textarea':\n\t      cb(n, normalize(el.value))\n\t      break\n\t    case 'select':\n\t      if (el.type.toLowerCase() === 'select-one') {\n\t        optCb(el.selectedIndex >= 0 ? el.options[el.selectedIndex] : null)\n\t      } else {\n\t        for (i = 0; el.length && i < el.length; i++) {\n\t          el.options[i].selected && optCb(el.options[i])\n\t        }\n\t      }\n\t      break\n\t    }\n\t  }\n\t\n\t  // collect up all form elements found from the passed argument elements all\n\t  // the way down to child elements; pass a '<form>' or form fields.\n\t  // called with 'this'=callback to use for serial() on each element\n\t  function eachFormElement() {\n\t    var cb = this\n\t      , e, i\n\t      , serializeSubtags = function (e, tags) {\n\t          var i, j, fa\n\t          for (i = 0; i < tags.length; i++) {\n\t            fa = e[byTag](tags[i])\n\t            for (j = 0; j < fa.length; j++) serial(fa[j], cb)\n\t          }\n\t        }\n\t\n\t    for (i = 0; i < arguments.length; i++) {\n\t      e = arguments[i]\n\t      if (/input|select|textarea/i.test(e.tagName)) serial(e, cb)\n\t      serializeSubtags(e, [ 'input', 'select', 'textarea' ])\n\t    }\n\t  }\n\t\n\t  // standard query string style serialization\n\t  function serializeQueryString() {\n\t    return reqwest.toQueryString(reqwest.serializeArray.apply(null, arguments))\n\t  }\n\t\n\t  // { 'name': 'value', ... } style serialization\n\t  function serializeHash() {\n\t    var hash = {}\n\t    eachFormElement.apply(function (name, value) {\n\t      if (name in hash) {\n\t        hash[name] && !isArray(hash[name]) && (hash[name] = [hash[name]])\n\t        hash[name].push(value)\n\t      } else hash[name] = value\n\t    }, arguments)\n\t    return hash\n\t  }\n\t\n\t  // [ { name: 'name', value: 'value' }, ... ] style serialization\n\t  reqwest.serializeArray = function () {\n\t    var arr = []\n\t    eachFormElement.apply(function (name, value) {\n\t      arr.push({name: name, value: value})\n\t    }, arguments)\n\t    return arr\n\t  }\n\t\n\t  reqwest.serialize = function () {\n\t    if (arguments.length === 0) return ''\n\t    var opt, fn\n\t      , args = Array.prototype.slice.call(arguments, 0)\n\t\n\t    opt = args.pop()\n\t    opt && opt.nodeType && args.push(opt) && (opt = null)\n\t    opt && (opt = opt.type)\n\t\n\t    if (opt == 'map') fn = serializeHash\n\t    else if (opt == 'array') fn = reqwest.serializeArray\n\t    else fn = serializeQueryString\n\t\n\t    return fn.apply(null, args)\n\t  }\n\t\n\t  reqwest.toQueryString = function (o, trad) {\n\t    var prefix, i\n\t      , traditional = trad || false\n\t      , s = []\n\t      , enc = encodeURIComponent\n\t      , add = function (key, value) {\n\t          // If value is a function, invoke it and return its value\n\t          value = ('function' === typeof value) ? value() : (value == null ? '' : value)\n\t          s[s.length] = enc(key) + '=' + enc(value)\n\t        }\n\t    // If an array was passed in, assume that it is an array of form elements.\n\t    if (isArray(o)) {\n\t      for (i = 0; o && i < o.length; i++) add(o[i]['name'], o[i]['value'])\n\t    } else {\n\t      // If traditional, encode the \"old\" way (the way 1.3.2 or older\n\t      // did it), otherwise encode params recursively.\n\t      for (prefix in o) {\n\t        if (o.hasOwnProperty(prefix)) buildParams(prefix, o[prefix], traditional, add)\n\t      }\n\t    }\n\t\n\t    // spaces should be + according to spec\n\t    return s.join('&').replace(/%20/g, '+')\n\t  }\n\t\n\t  function buildParams(prefix, obj, traditional, add) {\n\t    var name, i, v\n\t      , rbracket = /\\[\\]$/\n\t\n\t    if (isArray(obj)) {\n\t      // Serialize array item.\n\t      for (i = 0; obj && i < obj.length; i++) {\n\t        v = obj[i]\n\t        if (traditional || rbracket.test(prefix)) {\n\t          // Treat each array item as a scalar.\n\t          add(prefix, v)\n\t        } else {\n\t          buildParams(prefix + '[' + (typeof v === 'object' ? i : '') + ']', v, traditional, add)\n\t        }\n\t      }\n\t    } else if (obj && obj.toString() === '[object Object]') {\n\t      // Serialize object item.\n\t      for (name in obj) {\n\t        buildParams(prefix + '[' + name + ']', obj[name], traditional, add)\n\t      }\n\t\n\t    } else {\n\t      // Serialize scalar item.\n\t      add(prefix, obj)\n\t    }\n\t  }\n\t\n\t  reqwest.getcallbackPrefix = function () {\n\t    return callbackPrefix\n\t  }\n\t\n\t  // jQuery and Zepto compatibility, differences can be remapped here so you can call\n\t  // .ajax.compat(options, callback)\n\t  reqwest.compat = function (o, fn) {\n\t    if (o) {\n\t      o['type'] && (o['method'] = o['type']) && delete o['type']\n\t      o['dataType'] && (o['type'] = o['dataType'])\n\t      o['jsonpCallback'] && (o['jsonpCallbackName'] = o['jsonpCallback']) && delete o['jsonpCallback']\n\t      o['jsonp'] && (o['jsonpCallback'] = o['jsonp'])\n\t    }\n\t    return new Reqwest(o, fn)\n\t  }\n\t\n\t  reqwest.ajaxSetup = function (options) {\n\t    options = options || {}\n\t    for (var k in options) {\n\t      globalSetupOptions[k] = options[k]\n\t    }\n\t  }\n\t\n\t  return reqwest\n\t});\n\n\n/***/ },\n/* 59 */\n/***/ function(module, exports) {\n\n\t/* (ignored) */\n\n/***/ },\n/* 60 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t/*\n\t * GeoJSON helpers for handling data and generating objects\n\t */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _topojson2 = __webpack_require__(61);\n\t\n\tvar _topojson3 = _interopRequireDefault(_topojson2);\n\t\n\tvar _geojsonMerge = __webpack_require__(62);\n\t\n\tvar _geojsonMerge2 = _interopRequireDefault(_geojsonMerge);\n\t\n\tvar _earcut = __webpack_require__(64);\n\t\n\tvar _earcut2 = _interopRequireDefault(_earcut);\n\t\n\tvar _extrudePolygon = __webpack_require__(65);\n\t\n\tvar _extrudePolygon2 = _interopRequireDefault(_extrudePolygon);\n\t\n\t// TODO: Make it so height can be per-coordinate / point but connected together\n\t// as a linestring (eg. GPS points with an elevation at each point)\n\t//\n\t// This isn't really valid GeoJSON so perhaps something best left to an external\n\t// component for now, until a better approach can be considered\n\t//\n\t// See: http://lists.geojson.org/pipermail/geojson-geojson.org/2009-June/000489.html\n\t\n\t// Light and dark colours used for poor-mans AO gradient on object sides\n\tvar light = new _three2['default'].Color(0xffffff);\n\tvar shadow = new _three2['default'].Color(0x666666);\n\t\n\tvar GeoJSON = (function () {\n\t  var defaultStyle = {\n\t    color: '#ffffff',\n\t    transparent: false,\n\t    opacity: 1,\n\t    blending: _three2['default'].NormalBlending,\n\t    height: 0,\n\t    lineOpacity: 1,\n\t    lineTransparent: false,\n\t    lineColor: '#ffffff',\n\t    lineWidth: 1,\n\t    lineBlending: _three2['default'].NormalBlending\n\t  };\n\t\n\t  // Attempts to merge together multiple GeoJSON Features or FeatureCollections\n\t  // into a single FeatureCollection\n\t  var collectFeatures = function collectFeatures(data, _topojson) {\n\t    var collections = [];\n\t\n\t    if (_topojson) {\n\t      // TODO: Allow TopoJSON objects to be overridden as an option\n\t\n\t      // If not overridden, merge all features from all objects\n\t      for (var tk in data.objects) {\n\t        collections.push(_topojson3['default'].feature(data, data.objects[tk]));\n\t      }\n\t\n\t      return (0, _geojsonMerge2['default'])(collections);\n\t    } else {\n\t      // If root doesn't have a type then let's see if there are features in the\n\t      // next step down\n\t      if (!data.type) {\n\t        // TODO: Allow GeoJSON objects to be overridden as an option\n\t\n\t        // If not overridden, merge all features from all objects\n\t        for (var gk in data) {\n\t          if (!data[gk].type) {\n\t            continue;\n\t          }\n\t\n\t          collections.push(data[gk]);\n\t        }\n\t\n\t        return (0, _geojsonMerge2['default'])(collections);\n\t      } else if (Array.isArray(data)) {\n\t        return (0, _geojsonMerge2['default'])(data);\n\t      } else {\n\t        return data;\n\t      }\n\t    }\n\t  };\n\t\n\t  // TODO: This is only used by GeoJSONTile so either roll it into that or\n\t  // update GeoJSONTile to use the new GeoJSONLayer or geometry layers\n\t  var lineStringAttributes = function lineStringAttributes(coordinates, colour, height) {\n\t    var _coords = [];\n\t    var _colours = [];\n\t\n\t    var nextCoord;\n\t\n\t    // Connect coordinate with the next to make a pair\n\t    //\n\t    // LineSegments requires pairs of vertices so repeat the last point if\n\t    // there's an odd number of vertices\n\t    coordinates.forEach(function (coordinate, index) {\n\t      _colours.push([colour.r, colour.g, colour.b]);\n\t      _coords.push([coordinate[0], height, coordinate[1]]);\n\t\n\t      nextCoord = coordinates[index + 1] ? coordinates[index + 1] : coordinate;\n\t\n\t      _colours.push([colour.r, colour.g, colour.b]);\n\t      _coords.push([nextCoord[0], height, nextCoord[1]]);\n\t    });\n\t\n\t    return {\n\t      vertices: _coords,\n\t      colours: _colours\n\t    };\n\t  };\n\t\n\t  // TODO: This is only used by GeoJSONTile so either roll it into that or\n\t  // update GeoJSONTile to use the new GeoJSONLayer or geometry layers\n\t  var multiLineStringAttributes = function multiLineStringAttributes(coordinates, colour, height) {\n\t    var _coords = [];\n\t    var _colours = [];\n\t\n\t    var result;\n\t    coordinates.forEach(function (coordinate) {\n\t      result = lineStringAttributes(coordinate, colour, height);\n\t\n\t      result.vertices.forEach(function (coord) {\n\t        _coords.push(coord);\n\t      });\n\t\n\t      result.colours.forEach(function (colour) {\n\t        _colours.push(colour);\n\t      });\n\t    });\n\t\n\t    return {\n\t      vertices: _coords,\n\t      colours: _colours\n\t    };\n\t  };\n\t\n\t  // TODO: This is only used by GeoJSONTile so either roll it into that or\n\t  // update GeoJSONTile to use the new GeoJSONLayer or geometry layers\n\t  var polygonAttributes = function polygonAttributes(coordinates, colour, height) {\n\t    var earcutData = _toEarcut(coordinates);\n\t\n\t    var faces = _triangulate(earcutData.vertices, earcutData.holes, earcutData.dimensions);\n\t\n\t    var groupedVertices = [];\n\t    for (i = 0, il = earcutData.vertices.length; i < il; i += earcutData.dimensions) {\n\t      groupedVertices.push(earcutData.vertices.slice(i, i + earcutData.dimensions));\n\t    }\n\t\n\t    var extruded = (0, _extrudePolygon2['default'])(groupedVertices, faces, {\n\t      bottom: 0,\n\t      top: height\n\t    });\n\t\n\t    var topColor = colour.clone().multiply(light);\n\t    var bottomColor = colour.clone().multiply(shadow);\n\t\n\t    var _vertices = extruded.positions;\n\t    var _faces = [];\n\t    var _colours = [];\n\t\n\t    var _colour;\n\t    extruded.top.forEach(function (face, fi) {\n\t      _colour = [];\n\t\n\t      _colour.push([colour.r, colour.g, colour.b]);\n\t      _colour.push([colour.r, colour.g, colour.b]);\n\t      _colour.push([colour.r, colour.g, colour.b]);\n\t\n\t      _faces.push(face);\n\t      _colours.push(_colour);\n\t    });\n\t\n\t    var allFlat = true;\n\t\n\t    if (extruded.sides) {\n\t      if (allFlat) {\n\t        allFlat = false;\n\t      }\n\t\n\t      // Set up colours for every vertex with poor-mans AO on the sides\n\t      extruded.sides.forEach(function (face, fi) {\n\t        _colour = [];\n\t\n\t        // First face is always bottom-bottom-top\n\t        if (fi % 2 === 0) {\n\t          _colour.push([bottomColor.r, bottomColor.g, bottomColor.b]);\n\t          _colour.push([bottomColor.r, bottomColor.g, bottomColor.b]);\n\t          _colour.push([topColor.r, topColor.g, topColor.b]);\n\t          // Reverse winding for the second face\n\t          // top-top-bottom\n\t        } else {\n\t            _colour.push([topColor.r, topColor.g, topColor.b]);\n\t            _colour.push([topColor.r, topColor.g, topColor.b]);\n\t            _colour.push([bottomColor.r, bottomColor.g, bottomColor.b]);\n\t          }\n\t\n\t        _faces.push(face);\n\t        _colours.push(_colour);\n\t      });\n\t    }\n\t\n\t    // Skip bottom as there's no point rendering it\n\t    // allFaces.push(extruded.faces);\n\t\n\t    return {\n\t      vertices: _vertices,\n\t      faces: _faces,\n\t      colours: _colours,\n\t      flat: allFlat\n\t    };\n\t  };\n\t\n\t  // TODO: This is only used by GeoJSONTile so either roll it into that or\n\t  // update GeoJSONTile to use the new GeoJSONLayer or geometry layers\n\t  var _toEarcut = function _toEarcut(data) {\n\t    var dim = data[0][0].length;\n\t    var result = { vertices: [], holes: [], dimensions: dim };\n\t    var holeIndex = 0;\n\t\n\t    for (var i = 0; i < data.length; i++) {\n\t      for (var j = 0; j < data[i].length; j++) {\n\t        for (var d = 0; d < dim; d++) {\n\t          result.vertices.push(data[i][j][d]);\n\t        }\n\t      }\n\t      if (i > 0) {\n\t        holeIndex += data[i - 1].length;\n\t        result.holes.push(holeIndex);\n\t      }\n\t    }\n\t\n\t    return result;\n\t  };\n\t\n\t  // TODO: This is only used by GeoJSONTile so either roll it into that or\n\t  // update GeoJSONTile to use the new GeoJSONLayer or geometry layers\n\t  var _triangulate = function _triangulate(contour, holes, dim) {\n\t    // console.time('earcut');\n\t\n\t    var faces = (0, _earcut2['default'])(contour, holes, dim);\n\t    var result = [];\n\t\n\t    for (i = 0, il = faces.length; i < il; i += 3) {\n\t      result.push(faces.slice(i, i + 3));\n\t    }\n\t\n\t    // console.timeEnd('earcut');\n\t\n\t    return result;\n\t  };\n\t\n\t  return {\n\t    defaultStyle: defaultStyle,\n\t    collectFeatures: collectFeatures,\n\t    lineStringAttributes: lineStringAttributes,\n\t    multiLineStringAttributes: multiLineStringAttributes,\n\t    polygonAttributes: polygonAttributes\n\t  };\n\t})();\n\t\n\texports['default'] = GeoJSON;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 61 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t(function (global, factory) {\n\t   true ? factory(exports) :\n\t  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t  (factory((global.topojson = global.topojson || {})));\n\t}(this, (function (exports) { 'use strict';\n\t\n\tfunction noop() {}\n\t\n\tfunction transformAbsolute(transform) {\n\t  if (!transform) return noop;\n\t  var x0,\n\t      y0,\n\t      kx = transform.scale[0],\n\t      ky = transform.scale[1],\n\t      dx = transform.translate[0],\n\t      dy = transform.translate[1];\n\t  return function(point, i) {\n\t    if (!i) x0 = y0 = 0;\n\t    point[0] = (x0 += point[0]) * kx + dx;\n\t    point[1] = (y0 += point[1]) * ky + dy;\n\t  };\n\t}\n\t\n\tfunction transformRelative(transform) {\n\t  if (!transform) return noop;\n\t  var x0,\n\t      y0,\n\t      kx = transform.scale[0],\n\t      ky = transform.scale[1],\n\t      dx = transform.translate[0],\n\t      dy = transform.translate[1];\n\t  return function(point, i) {\n\t    if (!i) x0 = y0 = 0;\n\t    var x1 = Math.round((point[0] - dx) / kx),\n\t        y1 = Math.round((point[1] - dy) / ky);\n\t    point[0] = x1 - x0;\n\t    point[1] = y1 - y0;\n\t    x0 = x1;\n\t    y0 = y1;\n\t  };\n\t}\n\t\n\tfunction reverse(array, n) {\n\t  var t, j = array.length, i = j - n;\n\t  while (i < --j) t = array[i], array[i++] = array[j], array[j] = t;\n\t}\n\t\n\tfunction bisect(a, x) {\n\t  var lo = 0, hi = a.length;\n\t  while (lo < hi) {\n\t    var mid = lo + hi >>> 1;\n\t    if (a[mid] < x) lo = mid + 1;\n\t    else hi = mid;\n\t  }\n\t  return lo;\n\t}\n\t\n\tfunction feature(topology, o) {\n\t  return o.type === \"GeometryCollection\" ? {\n\t    type: \"FeatureCollection\",\n\t    features: o.geometries.map(function(o) { return feature$1(topology, o); })\n\t  } : feature$1(topology, o);\n\t}\n\t\n\tfunction feature$1(topology, o) {\n\t  var f = {\n\t    type: \"Feature\",\n\t    id: o.id,\n\t    properties: o.properties || {},\n\t    geometry: object(topology, o)\n\t  };\n\t  if (o.id == null) delete f.id;\n\t  return f;\n\t}\n\t\n\tfunction object(topology, o) {\n\t  var absolute = transformAbsolute(topology.transform),\n\t      arcs = topology.arcs;\n\t\n\t  function arc(i, points) {\n\t    if (points.length) points.pop();\n\t    for (var a = arcs[i < 0 ? ~i : i], k = 0, n = a.length, p; k < n; ++k) {\n\t      points.push(p = a[k].slice());\n\t      absolute(p, k);\n\t    }\n\t    if (i < 0) reverse(points, n);\n\t  }\n\t\n\t  function point(p) {\n\t    p = p.slice();\n\t    absolute(p, 0);\n\t    return p;\n\t  }\n\t\n\t  function line(arcs) {\n\t    var points = [];\n\t    for (var i = 0, n = arcs.length; i < n; ++i) arc(arcs[i], points);\n\t    if (points.length < 2) points.push(points[0].slice());\n\t    return points;\n\t  }\n\t\n\t  function ring(arcs) {\n\t    var points = line(arcs);\n\t    while (points.length < 4) points.push(points[0].slice());\n\t    return points;\n\t  }\n\t\n\t  function polygon(arcs) {\n\t    return arcs.map(ring);\n\t  }\n\t\n\t  function geometry(o) {\n\t    var t = o.type;\n\t    return t === \"GeometryCollection\" ? {type: t, geometries: o.geometries.map(geometry)}\n\t        : t in geometryType ? {type: t, coordinates: geometryType[t](o)}\n\t        : null;\n\t  }\n\t\n\t  var geometryType = {\n\t    Point: function(o) { return point(o.coordinates); },\n\t    MultiPoint: function(o) { return o.coordinates.map(point); },\n\t    LineString: function(o) { return line(o.arcs); },\n\t    MultiLineString: function(o) { return o.arcs.map(line); },\n\t    Polygon: function(o) { return polygon(o.arcs); },\n\t    MultiPolygon: function(o) { return o.arcs.map(polygon); }\n\t  };\n\t\n\t  return geometry(o);\n\t}\n\t\n\tfunction stitchArcs(topology, arcs) {\n\t  var stitchedArcs = {},\n\t      fragmentByStart = {},\n\t      fragmentByEnd = {},\n\t      fragments = [],\n\t      emptyIndex = -1;\n\t\n\t  // Stitch empty arcs first, since they may be subsumed by other arcs.\n\t  arcs.forEach(function(i, j) {\n\t    var arc = topology.arcs[i < 0 ? ~i : i], t;\n\t    if (arc.length < 3 && !arc[1][0] && !arc[1][1]) {\n\t      t = arcs[++emptyIndex], arcs[emptyIndex] = i, arcs[j] = t;\n\t    }\n\t  });\n\t\n\t  arcs.forEach(function(i) {\n\t    var e = ends(i),\n\t        start = e[0],\n\t        end = e[1],\n\t        f, g;\n\t\n\t    if (f = fragmentByEnd[start]) {\n\t      delete fragmentByEnd[f.end];\n\t      f.push(i);\n\t      f.end = end;\n\t      if (g = fragmentByStart[end]) {\n\t        delete fragmentByStart[g.start];\n\t        var fg = g === f ? f : f.concat(g);\n\t        fragmentByStart[fg.start = f.start] = fragmentByEnd[fg.end = g.end] = fg;\n\t      } else {\n\t        fragmentByStart[f.start] = fragmentByEnd[f.end] = f;\n\t      }\n\t    } else if (f = fragmentByStart[end]) {\n\t      delete fragmentByStart[f.start];\n\t      f.unshift(i);\n\t      f.start = start;\n\t      if (g = fragmentByEnd[start]) {\n\t        delete fragmentByEnd[g.end];\n\t        var gf = g === f ? f : g.concat(f);\n\t        fragmentByStart[gf.start = g.start] = fragmentByEnd[gf.end = f.end] = gf;\n\t      } else {\n\t        fragmentByStart[f.start] = fragmentByEnd[f.end] = f;\n\t      }\n\t    } else {\n\t      f = [i];\n\t      fragmentByStart[f.start = start] = fragmentByEnd[f.end = end] = f;\n\t    }\n\t  });\n\t\n\t  function ends(i) {\n\t    var arc = topology.arcs[i < 0 ? ~i : i], p0 = arc[0], p1;\n\t    if (topology.transform) p1 = [0, 0], arc.forEach(function(dp) { p1[0] += dp[0], p1[1] += dp[1]; });\n\t    else p1 = arc[arc.length - 1];\n\t    return i < 0 ? [p1, p0] : [p0, p1];\n\t  }\n\t\n\t  function flush(fragmentByEnd, fragmentByStart) {\n\t    for (var k in fragmentByEnd) {\n\t      var f = fragmentByEnd[k];\n\t      delete fragmentByStart[f.start];\n\t      delete f.start;\n\t      delete f.end;\n\t      f.forEach(function(i) { stitchedArcs[i < 0 ? ~i : i] = 1; });\n\t      fragments.push(f);\n\t    }\n\t  }\n\t\n\t  flush(fragmentByEnd, fragmentByStart);\n\t  flush(fragmentByStart, fragmentByEnd);\n\t  arcs.forEach(function(i) { if (!stitchedArcs[i < 0 ? ~i : i]) fragments.push([i]); });\n\t\n\t  return fragments;\n\t}\n\t\n\tfunction mesh(topology) {\n\t  return object(topology, meshArcs.apply(this, arguments));\n\t}\n\t\n\tfunction meshArcs(topology, o, filter) {\n\t  var arcs = [];\n\t\n\t  function arc(i) {\n\t    var j = i < 0 ? ~i : i;\n\t    (geomsByArc[j] || (geomsByArc[j] = [])).push({i: i, g: geom});\n\t  }\n\t\n\t  function line(arcs) {\n\t    arcs.forEach(arc);\n\t  }\n\t\n\t  function polygon(arcs) {\n\t    arcs.forEach(line);\n\t  }\n\t\n\t  function geometry(o) {\n\t    if (o.type === \"GeometryCollection\") o.geometries.forEach(geometry);\n\t    else if (o.type in geometryType) geom = o, geometryType[o.type](o.arcs);\n\t  }\n\t\n\t  if (arguments.length > 1) {\n\t    var geomsByArc = [],\n\t        geom;\n\t\n\t    var geometryType = {\n\t      LineString: line,\n\t      MultiLineString: polygon,\n\t      Polygon: polygon,\n\t      MultiPolygon: function(arcs) { arcs.forEach(polygon); }\n\t    };\n\t\n\t    geometry(o);\n\t\n\t    geomsByArc.forEach(arguments.length < 3\n\t        ? function(geoms) { arcs.push(geoms[0].i); }\n\t        : function(geoms) { if (filter(geoms[0].g, geoms[geoms.length - 1].g)) arcs.push(geoms[0].i); });\n\t  } else {\n\t    for (var i = 0, n = topology.arcs.length; i < n; ++i) arcs.push(i);\n\t  }\n\t\n\t  return {type: \"MultiLineString\", arcs: stitchArcs(topology, arcs)};\n\t}\n\t\n\tfunction cartesianTriangleArea(triangle) {\n\t  var a = triangle[0], b = triangle[1], c = triangle[2];\n\t  return Math.abs((a[0] - c[0]) * (b[1] - a[1]) - (a[0] - b[0]) * (c[1] - a[1]));\n\t}\n\t\n\tfunction ring(ring) {\n\t  var i = -1,\n\t      n = ring.length,\n\t      a,\n\t      b = ring[n - 1],\n\t      area = 0;\n\t\n\t  while (++i < n) {\n\t    a = b;\n\t    b = ring[i];\n\t    area += a[0] * b[1] - a[1] * b[0];\n\t  }\n\t\n\t  return area / 2;\n\t}\n\t\n\tfunction merge(topology) {\n\t  return object(topology, mergeArcs.apply(this, arguments));\n\t}\n\t\n\tfunction mergeArcs(topology, objects) {\n\t  var polygonsByArc = {},\n\t      polygons = [],\n\t      components = [];\n\t\n\t  objects.forEach(function(o) {\n\t    if (o.type === \"Polygon\") register(o.arcs);\n\t    else if (o.type === \"MultiPolygon\") o.arcs.forEach(register);\n\t  });\n\t\n\t  function register(polygon) {\n\t    polygon.forEach(function(ring$$) {\n\t      ring$$.forEach(function(arc) {\n\t        (polygonsByArc[arc = arc < 0 ? ~arc : arc] || (polygonsByArc[arc] = [])).push(polygon);\n\t      });\n\t    });\n\t    polygons.push(polygon);\n\t  }\n\t\n\t  function area(ring$$) {\n\t    return Math.abs(ring(object(topology, {type: \"Polygon\", arcs: [ring$$]}).coordinates[0]));\n\t  }\n\t\n\t  polygons.forEach(function(polygon) {\n\t    if (!polygon._) {\n\t      var component = [],\n\t          neighbors = [polygon];\n\t      polygon._ = 1;\n\t      components.push(component);\n\t      while (polygon = neighbors.pop()) {\n\t        component.push(polygon);\n\t        polygon.forEach(function(ring$$) {\n\t          ring$$.forEach(function(arc) {\n\t            polygonsByArc[arc < 0 ? ~arc : arc].forEach(function(polygon) {\n\t              if (!polygon._) {\n\t                polygon._ = 1;\n\t                neighbors.push(polygon);\n\t              }\n\t            });\n\t          });\n\t        });\n\t      }\n\t    }\n\t  });\n\t\n\t  polygons.forEach(function(polygon) {\n\t    delete polygon._;\n\t  });\n\t\n\t  return {\n\t    type: \"MultiPolygon\",\n\t    arcs: components.map(function(polygons) {\n\t      var arcs = [], n;\n\t\n\t      // Extract the exterior (unique) arcs.\n\t      polygons.forEach(function(polygon) {\n\t        polygon.forEach(function(ring$$) {\n\t          ring$$.forEach(function(arc) {\n\t            if (polygonsByArc[arc < 0 ? ~arc : arc].length < 2) {\n\t              arcs.push(arc);\n\t            }\n\t          });\n\t        });\n\t      });\n\t\n\t      // Stitch the arcs into one or more rings.\n\t      arcs = stitchArcs(topology, arcs);\n\t\n\t      // If more than one ring is returned,\n\t      // at most one of these rings can be the exterior;\n\t      // choose the one with the greatest absolute area.\n\t      if ((n = arcs.length) > 1) {\n\t        for (var i = 1, k = area(arcs[0]), ki, t; i < n; ++i) {\n\t          if ((ki = area(arcs[i])) > k) {\n\t            t = arcs[0], arcs[0] = arcs[i], arcs[i] = t, k = ki;\n\t          }\n\t        }\n\t      }\n\t\n\t      return arcs;\n\t    })\n\t  };\n\t}\n\t\n\tfunction neighbors(objects) {\n\t  var indexesByArc = {}, // arc index -> array of object indexes\n\t      neighbors = objects.map(function() { return []; });\n\t\n\t  function line(arcs, i) {\n\t    arcs.forEach(function(a) {\n\t      if (a < 0) a = ~a;\n\t      var o = indexesByArc[a];\n\t      if (o) o.push(i);\n\t      else indexesByArc[a] = [i];\n\t    });\n\t  }\n\t\n\t  function polygon(arcs, i) {\n\t    arcs.forEach(function(arc) { line(arc, i); });\n\t  }\n\t\n\t  function geometry(o, i) {\n\t    if (o.type === \"GeometryCollection\") o.geometries.forEach(function(o) { geometry(o, i); });\n\t    else if (o.type in geometryType) geometryType[o.type](o.arcs, i);\n\t  }\n\t\n\t  var geometryType = {\n\t    LineString: line,\n\t    MultiLineString: polygon,\n\t    Polygon: polygon,\n\t    MultiPolygon: function(arcs, i) { arcs.forEach(function(arc) { polygon(arc, i); }); }\n\t  };\n\t\n\t  objects.forEach(geometry);\n\t\n\t  for (var i in indexesByArc) {\n\t    for (var indexes = indexesByArc[i], m = indexes.length, j = 0; j < m; ++j) {\n\t      for (var k = j + 1; k < m; ++k) {\n\t        var ij = indexes[j], ik = indexes[k], n;\n\t        if ((n = neighbors[ij])[i = bisect(n, ik)] !== ik) n.splice(i, 0, ik);\n\t        if ((n = neighbors[ik])[i = bisect(n, ij)] !== ij) n.splice(i, 0, ij);\n\t      }\n\t    }\n\t  }\n\t\n\t  return neighbors;\n\t}\n\t\n\tfunction compareArea(a, b) {\n\t  return a[1][2] - b[1][2];\n\t}\n\t\n\tfunction minAreaHeap() {\n\t  var heap = {},\n\t      array = [],\n\t      size = 0;\n\t\n\t  heap.push = function(object) {\n\t    up(array[object._ = size] = object, size++);\n\t    return size;\n\t  };\n\t\n\t  heap.pop = function() {\n\t    if (size <= 0) return;\n\t    var removed = array[0], object;\n\t    if (--size > 0) object = array[size], down(array[object._ = 0] = object, 0);\n\t    return removed;\n\t  };\n\t\n\t  heap.remove = function(removed) {\n\t    var i = removed._, object;\n\t    if (array[i] !== removed) return; // invalid request\n\t    if (i !== --size) object = array[size], (compareArea(object, removed) < 0 ? up : down)(array[object._ = i] = object, i);\n\t    return i;\n\t  };\n\t\n\t  function up(object, i) {\n\t    while (i > 0) {\n\t      var j = ((i + 1) >> 1) - 1,\n\t          parent = array[j];\n\t      if (compareArea(object, parent) >= 0) break;\n\t      array[parent._ = i] = parent;\n\t      array[object._ = i = j] = object;\n\t    }\n\t  }\n\t\n\t  function down(object, i) {\n\t    while (true) {\n\t      var r = (i + 1) << 1,\n\t          l = r - 1,\n\t          j = i,\n\t          child = array[j];\n\t      if (l < size && compareArea(array[l], child) < 0) child = array[j = l];\n\t      if (r < size && compareArea(array[r], child) < 0) child = array[j = r];\n\t      if (j === i) break;\n\t      array[child._ = i] = child;\n\t      array[object._ = i = j] = object;\n\t    }\n\t  }\n\t\n\t  return heap;\n\t}\n\t\n\tfunction presimplify(topology, triangleArea) {\n\t  var absolute = transformAbsolute(topology.transform),\n\t      relative = transformRelative(topology.transform),\n\t      heap = minAreaHeap();\n\t\n\t  if (!triangleArea) triangleArea = cartesianTriangleArea;\n\t\n\t  topology.arcs.forEach(function(arc) {\n\t    var triangles = [],\n\t        maxArea = 0,\n\t        triangle,\n\t        i,\n\t        n,\n\t        p;\n\t\n\t    // To store each point’s effective area, we create a new array rather than\n\t    // extending the passed-in point to workaround a Chrome/V8 bug (getting\n\t    // stuck in smi mode). For midpoints, the initial effective area of\n\t    // Infinity will be computed in the next step.\n\t    for (i = 0, n = arc.length; i < n; ++i) {\n\t      p = arc[i];\n\t      absolute(arc[i] = [p[0], p[1], Infinity], i);\n\t    }\n\t\n\t    for (i = 1, n = arc.length - 1; i < n; ++i) {\n\t      triangle = arc.slice(i - 1, i + 2);\n\t      triangle[1][2] = triangleArea(triangle);\n\t      triangles.push(triangle);\n\t      heap.push(triangle);\n\t    }\n\t\n\t    for (i = 0, n = triangles.length; i < n; ++i) {\n\t      triangle = triangles[i];\n\t      triangle.previous = triangles[i - 1];\n\t      triangle.next = triangles[i + 1];\n\t    }\n\t\n\t    while (triangle = heap.pop()) {\n\t      var previous = triangle.previous,\n\t          next = triangle.next;\n\t\n\t      // If the area of the current point is less than that of the previous point\n\t      // to be eliminated, use the latter's area instead. This ensures that the\n\t      // current point cannot be eliminated without eliminating previously-\n\t      // eliminated points.\n\t      if (triangle[1][2] < maxArea) triangle[1][2] = maxArea;\n\t      else maxArea = triangle[1][2];\n\t\n\t      if (previous) {\n\t        previous.next = next;\n\t        previous[2] = triangle[2];\n\t        update(previous);\n\t      }\n\t\n\t      if (next) {\n\t        next.previous = previous;\n\t        next[0] = triangle[0];\n\t        update(next);\n\t      }\n\t    }\n\t\n\t    arc.forEach(relative);\n\t  });\n\t\n\t  function update(triangle) {\n\t    heap.remove(triangle);\n\t    triangle[1][2] = triangleArea(triangle);\n\t    heap.push(triangle);\n\t  }\n\t\n\t  return topology;\n\t}\n\t\n\tvar version = \"1.6.27\";\n\t\n\texports.version = version;\n\texports.mesh = mesh;\n\texports.meshArcs = meshArcs;\n\texports.merge = merge;\n\texports.mergeArcs = mergeArcs;\n\texports.feature = feature;\n\texports.neighbors = neighbors;\n\texports.presimplify = presimplify;\n\t\n\tObject.defineProperty(exports, '__esModule', { value: true });\n\t\n\t})));\n\n/***/ },\n/* 62 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar normalize = __webpack_require__(63);\n\t\n\tmodule.exports = function(inputs) {\n\t    return {\n\t        type: 'FeatureCollection',\n\t        features: inputs.reduce(function(memo, input) {\n\t            return memo.concat(normalize(input).features);\n\t        }, [])\n\t    };\n\t};\n\n\n/***/ },\n/* 63 */\n/***/ function(module, exports) {\n\n\tmodule.exports = normalize;\n\t\n\tvar types = {\n\t    Point: 'geometry',\n\t    MultiPoint: 'geometry',\n\t    LineString: 'geometry',\n\t    MultiLineString: 'geometry',\n\t    Polygon: 'geometry',\n\t    MultiPolygon: 'geometry',\n\t    GeometryCollection: 'geometry',\n\t    Feature: 'feature',\n\t    FeatureCollection: 'featurecollection'\n\t};\n\t\n\t/**\n\t * Normalize a GeoJSON feature into a FeatureCollection.\n\t *\n\t * @param {object} gj geojson data\n\t * @returns {object} normalized geojson data\n\t */\n\tfunction normalize(gj) {\n\t    if (!gj || !gj.type) return null;\n\t    var type = types[gj.type];\n\t    if (!type) return null;\n\t\n\t    if (type === 'geometry') {\n\t        return {\n\t            type: 'FeatureCollection',\n\t            features: [{\n\t                type: 'Feature',\n\t                properties: {},\n\t                geometry: gj\n\t            }]\n\t        };\n\t    } else if (type === 'feature') {\n\t        return {\n\t            type: 'FeatureCollection',\n\t            features: [gj]\n\t        };\n\t    } else if (type === 'featurecollection') {\n\t        return gj;\n\t    }\n\t}\n\n\n/***/ },\n/* 64 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tmodule.exports = earcut;\n\t\n\tfunction earcut(data, holeIndices, dim) {\n\t\n\t    dim = dim || 2;\n\t\n\t    var hasHoles = holeIndices && holeIndices.length,\n\t        outerLen = hasHoles ? holeIndices[0] * dim : data.length,\n\t        outerNode = linkedList(data, 0, outerLen, dim, true),\n\t        triangles = [];\n\t\n\t    if (!outerNode) return triangles;\n\t\n\t    var minX, minY, maxX, maxY, x, y, size;\n\t\n\t    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\n\t\n\t    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n\t    if (data.length > 80 * dim) {\n\t        minX = maxX = data[0];\n\t        minY = maxY = data[1];\n\t\n\t        for (var i = dim; i < outerLen; i += dim) {\n\t            x = data[i];\n\t            y = data[i + 1];\n\t            if (x < minX) minX = x;\n\t            if (y < minY) minY = y;\n\t            if (x > maxX) maxX = x;\n\t            if (y > maxY) maxY = y;\n\t        }\n\t\n\t        // minX, minY and size are later used to transform coords into integers for z-order calculation\n\t        size = Math.max(maxX - minX, maxY - minY);\n\t    }\n\t\n\t    earcutLinked(outerNode, triangles, dim, minX, minY, size);\n\t\n\t    return triangles;\n\t}\n\t\n\t// create a circular doubly linked list from polygon points in the specified winding order\n\tfunction linkedList(data, start, end, dim, clockwise) {\n\t    var i, last;\n\t\n\t    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\n\t        for (i = start; i < end; i += dim) last = insertNode(i, data[i], data[i + 1], last);\n\t    } else {\n\t        for (i = end - dim; i >= start; i -= dim) last = insertNode(i, data[i], data[i + 1], last);\n\t    }\n\t\n\t    if (last && equals(last, last.next)) {\n\t        removeNode(last);\n\t        last = last.next;\n\t    }\n\t\n\t    return last;\n\t}\n\t\n\t// eliminate colinear or duplicate points\n\tfunction filterPoints(start, end) {\n\t    if (!start) return start;\n\t    if (!end) end = start;\n\t\n\t    var p = start,\n\t        again;\n\t    do {\n\t        again = false;\n\t\n\t        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\n\t            removeNode(p);\n\t            p = end = p.prev;\n\t            if (p === p.next) return null;\n\t            again = true;\n\t\n\t        } else {\n\t            p = p.next;\n\t        }\n\t    } while (again || p !== end);\n\t\n\t    return end;\n\t}\n\t\n\t// main ear slicing loop which triangulates a polygon (given as a linked list)\n\tfunction earcutLinked(ear, triangles, dim, minX, minY, size, pass) {\n\t    if (!ear) return;\n\t\n\t    // interlink polygon nodes in z-order\n\t    if (!pass && size) indexCurve(ear, minX, minY, size);\n\t\n\t    var stop = ear,\n\t        prev, next;\n\t\n\t    // iterate through ears, slicing them one by one\n\t    while (ear.prev !== ear.next) {\n\t        prev = ear.prev;\n\t        next = ear.next;\n\t\n\t        if (size ? isEarHashed(ear, minX, minY, size) : isEar(ear)) {\n\t            // cut off the triangle\n\t            triangles.push(prev.i / dim);\n\t            triangles.push(ear.i / dim);\n\t            triangles.push(next.i / dim);\n\t\n\t            removeNode(ear);\n\t\n\t            // skipping the next vertice leads to less sliver triangles\n\t            ear = next.next;\n\t            stop = next.next;\n\t\n\t            continue;\n\t        }\n\t\n\t        ear = next;\n\t\n\t        // if we looped through the whole remaining polygon and can't find any more ears\n\t        if (ear === stop) {\n\t            // try filtering points and slicing again\n\t            if (!pass) {\n\t                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, size, 1);\n\t\n\t            // if this didn't work, try curing all small self-intersections locally\n\t            } else if (pass === 1) {\n\t                ear = cureLocalIntersections(ear, triangles, dim);\n\t                earcutLinked(ear, triangles, dim, minX, minY, size, 2);\n\t\n\t            // as a last resort, try splitting the remaining polygon into two\n\t            } else if (pass === 2) {\n\t                splitEarcut(ear, triangles, dim, minX, minY, size);\n\t            }\n\t\n\t            break;\n\t        }\n\t    }\n\t}\n\t\n\t// check whether a polygon node forms a valid ear with adjacent nodes\n\tfunction isEar(ear) {\n\t    var a = ear.prev,\n\t        b = ear,\n\t        c = ear.next;\n\t\n\t    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\t\n\t    // now make sure we don't have other points inside the potential ear\n\t    var p = ear.next.next;\n\t\n\t    while (p !== ear.prev) {\n\t        if (pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n\t            area(p.prev, p, p.next) >= 0) return false;\n\t        p = p.next;\n\t    }\n\t\n\t    return true;\n\t}\n\t\n\tfunction isEarHashed(ear, minX, minY, size) {\n\t    var a = ear.prev,\n\t        b = ear,\n\t        c = ear.next;\n\t\n\t    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\t\n\t    // triangle bbox; min & max are calculated like this for speed\n\t    var minTX = a.x < b.x ? (a.x < c.x ? a.x : c.x) : (b.x < c.x ? b.x : c.x),\n\t        minTY = a.y < b.y ? (a.y < c.y ? a.y : c.y) : (b.y < c.y ? b.y : c.y),\n\t        maxTX = a.x > b.x ? (a.x > c.x ? a.x : c.x) : (b.x > c.x ? b.x : c.x),\n\t        maxTY = a.y > b.y ? (a.y > c.y ? a.y : c.y) : (b.y > c.y ? b.y : c.y);\n\t\n\t    // z-order range for the current triangle bbox;\n\t    var minZ = zOrder(minTX, minTY, minX, minY, size),\n\t        maxZ = zOrder(maxTX, maxTY, minX, minY, size);\n\t\n\t    // first look for points inside the triangle in increasing z-order\n\t    var p = ear.nextZ;\n\t\n\t    while (p && p.z <= maxZ) {\n\t        if (p !== ear.prev && p !== ear.next &&\n\t            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n\t            area(p.prev, p, p.next) >= 0) return false;\n\t        p = p.nextZ;\n\t    }\n\t\n\t    // then look for points in decreasing z-order\n\t    p = ear.prevZ;\n\t\n\t    while (p && p.z >= minZ) {\n\t        if (p !== ear.prev && p !== ear.next &&\n\t            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n\t            area(p.prev, p, p.next) >= 0) return false;\n\t        p = p.prevZ;\n\t    }\n\t\n\t    return true;\n\t}\n\t\n\t// go through all polygon nodes and cure small local self-intersections\n\tfunction cureLocalIntersections(start, triangles, dim) {\n\t    var p = start;\n\t    do {\n\t        var a = p.prev,\n\t            b = p.next.next;\n\t\n\t        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\n\t\n\t            triangles.push(a.i / dim);\n\t            triangles.push(p.i / dim);\n\t            triangles.push(b.i / dim);\n\t\n\t            // remove two nodes involved\n\t            removeNode(p);\n\t            removeNode(p.next);\n\t\n\t            p = start = b;\n\t        }\n\t        p = p.next;\n\t    } while (p !== start);\n\t\n\t    return p;\n\t}\n\t\n\t// try splitting polygon into two and triangulate them independently\n\tfunction splitEarcut(start, triangles, dim, minX, minY, size) {\n\t    // look for a valid diagonal that divides the polygon into two\n\t    var a = start;\n\t    do {\n\t        var b = a.next.next;\n\t        while (b !== a.prev) {\n\t            if (a.i !== b.i && isValidDiagonal(a, b)) {\n\t                // split the polygon in two by the diagonal\n\t                var c = splitPolygon(a, b);\n\t\n\t                // filter colinear points around the cuts\n\t                a = filterPoints(a, a.next);\n\t                c = filterPoints(c, c.next);\n\t\n\t                // run earcut on each half\n\t                earcutLinked(a, triangles, dim, minX, minY, size);\n\t                earcutLinked(c, triangles, dim, minX, minY, size);\n\t                return;\n\t            }\n\t            b = b.next;\n\t        }\n\t        a = a.next;\n\t    } while (a !== start);\n\t}\n\t\n\t// link every hole into the outer loop, producing a single-ring polygon without holes\n\tfunction eliminateHoles(data, holeIndices, outerNode, dim) {\n\t    var queue = [],\n\t        i, len, start, end, list;\n\t\n\t    for (i = 0, len = holeIndices.length; i < len; i++) {\n\t        start = holeIndices[i] * dim;\n\t        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n\t        list = linkedList(data, start, end, dim, false);\n\t        if (list === list.next) list.steiner = true;\n\t        queue.push(getLeftmost(list));\n\t    }\n\t\n\t    queue.sort(compareX);\n\t\n\t    // process holes from left to right\n\t    for (i = 0; i < queue.length; i++) {\n\t        eliminateHole(queue[i], outerNode);\n\t        outerNode = filterPoints(outerNode, outerNode.next);\n\t    }\n\t\n\t    return outerNode;\n\t}\n\t\n\tfunction compareX(a, b) {\n\t    return a.x - b.x;\n\t}\n\t\n\t// find a bridge between vertices that connects hole with an outer ring and and link it\n\tfunction eliminateHole(hole, outerNode) {\n\t    outerNode = findHoleBridge(hole, outerNode);\n\t    if (outerNode) {\n\t        var b = splitPolygon(outerNode, hole);\n\t        filterPoints(b, b.next);\n\t    }\n\t}\n\t\n\t// David Eberly's algorithm for finding a bridge between hole and outer polygon\n\tfunction findHoleBridge(hole, outerNode) {\n\t    var p = outerNode,\n\t        hx = hole.x,\n\t        hy = hole.y,\n\t        qx = -Infinity,\n\t        m;\n\t\n\t    // find a segment intersected by a ray from the hole's leftmost point to the left;\n\t    // segment's endpoint with lesser x will be potential connection point\n\t    do {\n\t        if (hy <= p.y && hy >= p.next.y) {\n\t            var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\n\t            if (x <= hx && x > qx) {\n\t                qx = x;\n\t                if (x === hx) {\n\t                    if (hy === p.y) return p;\n\t                    if (hy === p.next.y) return p.next;\n\t                }\n\t                m = p.x < p.next.x ? p : p.next;\n\t            }\n\t        }\n\t        p = p.next;\n\t    } while (p !== outerNode);\n\t\n\t    if (!m) return null;\n\t\n\t    if (hx === qx) return m.prev; // hole touches outer segment; pick lower endpoint\n\t\n\t    // look for points inside the triangle of hole point, segment intersection and endpoint;\n\t    // if there are no points found, we have a valid connection;\n\t    // otherwise choose the point of the minimum angle with the ray as connection point\n\t\n\t    var stop = m,\n\t        mx = m.x,\n\t        my = m.y,\n\t        tanMin = Infinity,\n\t        tan;\n\t\n\t    p = m.next;\n\t\n\t    while (p !== stop) {\n\t        if (hx >= p.x && p.x >= mx &&\n\t                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\n\t\n\t            tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\n\t\n\t            if ((tan < tanMin || (tan === tanMin && p.x > m.x)) && locallyInside(p, hole)) {\n\t                m = p;\n\t                tanMin = tan;\n\t            }\n\t        }\n\t\n\t        p = p.next;\n\t    }\n\t\n\t    return m;\n\t}\n\t\n\t// interlink polygon nodes in z-order\n\tfunction indexCurve(start, minX, minY, size) {\n\t    var p = start;\n\t    do {\n\t        if (p.z === null) p.z = zOrder(p.x, p.y, minX, minY, size);\n\t        p.prevZ = p.prev;\n\t        p.nextZ = p.next;\n\t        p = p.next;\n\t    } while (p !== start);\n\t\n\t    p.prevZ.nextZ = null;\n\t    p.prevZ = null;\n\t\n\t    sortLinked(p);\n\t}\n\t\n\t// Simon Tatham's linked list merge sort algorithm\n\t// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\n\tfunction sortLinked(list) {\n\t    var i, p, q, e, tail, numMerges, pSize, qSize,\n\t        inSize = 1;\n\t\n\t    do {\n\t        p = list;\n\t        list = null;\n\t        tail = null;\n\t        numMerges = 0;\n\t\n\t        while (p) {\n\t            numMerges++;\n\t            q = p;\n\t            pSize = 0;\n\t            for (i = 0; i < inSize; i++) {\n\t                pSize++;\n\t                q = q.nextZ;\n\t                if (!q) break;\n\t            }\n\t\n\t            qSize = inSize;\n\t\n\t            while (pSize > 0 || (qSize > 0 && q)) {\n\t\n\t                if (pSize === 0) {\n\t                    e = q;\n\t                    q = q.nextZ;\n\t                    qSize--;\n\t                } else if (qSize === 0 || !q) {\n\t                    e = p;\n\t                    p = p.nextZ;\n\t                    pSize--;\n\t                } else if (p.z <= q.z) {\n\t                    e = p;\n\t                    p = p.nextZ;\n\t                    pSize--;\n\t                } else {\n\t                    e = q;\n\t                    q = q.nextZ;\n\t                    qSize--;\n\t                }\n\t\n\t                if (tail) tail.nextZ = e;\n\t                else list = e;\n\t\n\t                e.prevZ = tail;\n\t                tail = e;\n\t            }\n\t\n\t            p = q;\n\t        }\n\t\n\t        tail.nextZ = null;\n\t        inSize *= 2;\n\t\n\t    } while (numMerges > 1);\n\t\n\t    return list;\n\t}\n\t\n\t// z-order of a point given coords and size of the data bounding box\n\tfunction zOrder(x, y, minX, minY, size) {\n\t    // coords are transformed into non-negative 15-bit integer range\n\t    x = 32767 * (x - minX) / size;\n\t    y = 32767 * (y - minY) / size;\n\t\n\t    x = (x | (x << 8)) & 0x00FF00FF;\n\t    x = (x | (x << 4)) & 0x0F0F0F0F;\n\t    x = (x | (x << 2)) & 0x33333333;\n\t    x = (x | (x << 1)) & 0x55555555;\n\t\n\t    y = (y | (y << 8)) & 0x00FF00FF;\n\t    y = (y | (y << 4)) & 0x0F0F0F0F;\n\t    y = (y | (y << 2)) & 0x33333333;\n\t    y = (y | (y << 1)) & 0x55555555;\n\t\n\t    return x | (y << 1);\n\t}\n\t\n\t// find the leftmost node of a polygon ring\n\tfunction getLeftmost(start) {\n\t    var p = start,\n\t        leftmost = start;\n\t    do {\n\t        if (p.x < leftmost.x) leftmost = p;\n\t        p = p.next;\n\t    } while (p !== start);\n\t\n\t    return leftmost;\n\t}\n\t\n\t// check if a point lies within a convex triangle\n\tfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\n\t    return (cx - px) * (ay - py) - (ax - px) * (cy - py) >= 0 &&\n\t           (ax - px) * (by - py) - (bx - px) * (ay - py) >= 0 &&\n\t           (bx - px) * (cy - py) - (cx - px) * (by - py) >= 0;\n\t}\n\t\n\t// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\n\tfunction isValidDiagonal(a, b) {\n\t    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) &&\n\t           locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b);\n\t}\n\t\n\t// signed area of a triangle\n\tfunction area(p, q, r) {\n\t    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\n\t}\n\t\n\t// check if two points are equal\n\tfunction equals(p1, p2) {\n\t    return p1.x === p2.x && p1.y === p2.y;\n\t}\n\t\n\t// check if two segments intersect\n\tfunction intersects(p1, q1, p2, q2) {\n\t    if ((equals(p1, q1) && equals(p2, q2)) ||\n\t        (equals(p1, q2) && equals(p2, q1))) return true;\n\t    return area(p1, q1, p2) > 0 !== area(p1, q1, q2) > 0 &&\n\t           area(p2, q2, p1) > 0 !== area(p2, q2, q1) > 0;\n\t}\n\t\n\t// check if a polygon diagonal intersects any polygon segments\n\tfunction intersectsPolygon(a, b) {\n\t    var p = a;\n\t    do {\n\t        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n\t                intersects(p, p.next, a, b)) return true;\n\t        p = p.next;\n\t    } while (p !== a);\n\t\n\t    return false;\n\t}\n\t\n\t// check if a polygon diagonal is locally inside the polygon\n\tfunction locallyInside(a, b) {\n\t    return area(a.prev, a, a.next) < 0 ?\n\t        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\n\t        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\n\t}\n\t\n\t// check if the middle point of a polygon diagonal is inside the polygon\n\tfunction middleInside(a, b) {\n\t    var p = a,\n\t        inside = false,\n\t        px = (a.x + b.x) / 2,\n\t        py = (a.y + b.y) / 2;\n\t    do {\n\t        if (((p.y > py) !== (p.next.y > py)) && (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\n\t            inside = !inside;\n\t        p = p.next;\n\t    } while (p !== a);\n\t\n\t    return inside;\n\t}\n\t\n\t// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n\t// if one belongs to the outer ring and another to a hole, it merges it into a single ring\n\tfunction splitPolygon(a, b) {\n\t    var a2 = new Node(a.i, a.x, a.y),\n\t        b2 = new Node(b.i, b.x, b.y),\n\t        an = a.next,\n\t        bp = b.prev;\n\t\n\t    a.next = b;\n\t    b.prev = a;\n\t\n\t    a2.next = an;\n\t    an.prev = a2;\n\t\n\t    b2.next = a2;\n\t    a2.prev = b2;\n\t\n\t    bp.next = b2;\n\t    b2.prev = bp;\n\t\n\t    return b2;\n\t}\n\t\n\t// create a node and optionally link it with previous one (in a circular doubly linked list)\n\tfunction insertNode(i, x, y, last) {\n\t    var p = new Node(i, x, y);\n\t\n\t    if (!last) {\n\t        p.prev = p;\n\t        p.next = p;\n\t\n\t    } else {\n\t        p.next = last.next;\n\t        p.prev = last;\n\t        last.next.prev = p;\n\t        last.next = p;\n\t    }\n\t    return p;\n\t}\n\t\n\tfunction removeNode(p) {\n\t    p.next.prev = p.prev;\n\t    p.prev.next = p.next;\n\t\n\t    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\n\t    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\n\t}\n\t\n\tfunction Node(i, x, y) {\n\t    // vertice index in coordinates array\n\t    this.i = i;\n\t\n\t    // vertex coordinates\n\t    this.x = x;\n\t    this.y = y;\n\t\n\t    // previous and next vertice nodes in a polygon ring\n\t    this.prev = null;\n\t    this.next = null;\n\t\n\t    // z-order curve value\n\t    this.z = null;\n\t\n\t    // previous and next nodes in z-order\n\t    this.prevZ = null;\n\t    this.nextZ = null;\n\t\n\t    // indicates whether this is a steiner point\n\t    this.steiner = false;\n\t}\n\t\n\t// return a percentage difference between the polygon area and its triangulation area;\n\t// used to verify correctness of triangulation\n\tearcut.deviation = function (data, holeIndices, dim, triangles) {\n\t    var hasHoles = holeIndices && holeIndices.length;\n\t    var outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n\t\n\t    var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\n\t    if (hasHoles) {\n\t        for (var i = 0, len = holeIndices.length; i < len; i++) {\n\t            var start = holeIndices[i] * dim;\n\t            var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n\t            polygonArea -= Math.abs(signedArea(data, start, end, dim));\n\t        }\n\t    }\n\t\n\t    var trianglesArea = 0;\n\t    for (i = 0; i < triangles.length; i += 3) {\n\t        var a = triangles[i] * dim;\n\t        var b = triangles[i + 1] * dim;\n\t        var c = triangles[i + 2] * dim;\n\t        trianglesArea += Math.abs(\n\t            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\n\t            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\n\t    }\n\t\n\t    return polygonArea === 0 && trianglesArea === 0 ? 0 :\n\t        Math.abs((trianglesArea - polygonArea) / polygonArea);\n\t};\n\t\n\tfunction signedArea(data, start, end, dim) {\n\t    var sum = 0;\n\t    for (var i = start, j = end - dim; i < end; i += dim) {\n\t        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\n\t        j = i;\n\t    }\n\t    return sum;\n\t}\n\t\n\t// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\n\tearcut.flatten = function (data) {\n\t    var dim = data[0][0].length,\n\t        result = {vertices: [], holes: [], dimensions: dim},\n\t        holeIndex = 0;\n\t\n\t    for (var i = 0; i < data.length; i++) {\n\t        for (var j = 0; j < data[i].length; j++) {\n\t            for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);\n\t        }\n\t        if (i > 0) {\n\t            holeIndex += data[i - 1].length;\n\t            result.holes.push(holeIndex);\n\t        }\n\t    }\n\t    return result;\n\t};\n\n\n/***/ },\n/* 65 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t/*\n\t * Extrude a polygon given its vertices and triangulated faces\n\t *\n\t * Based on:\n\t * https://github.com/freeman-lab/extrude\n\t */\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar extrudePolygon = function extrudePolygon(points, faces, _options) {\n\t  var defaults = {\n\t    top: 1,\n\t    bottom: 0,\n\t    closed: true\n\t  };\n\t\n\t  var options = (0, _lodashAssign2['default'])({}, defaults, _options);\n\t\n\t  var n = points.length;\n\t  var positions;\n\t  var cells;\n\t  var topCells;\n\t  var bottomCells;\n\t  var sideCells;\n\t\n\t  // If bottom and top values are identical then return the flat shape\n\t  options.top === options.bottom ? flat() : full();\n\t\n\t  function flat() {\n\t    positions = points.map(function (p) {\n\t      return [p[0], options.top, p[1]];\n\t    });\n\t    cells = faces;\n\t    topCells = faces;\n\t  }\n\t\n\t  function full() {\n\t    positions = [];\n\t    points.forEach(function (p) {\n\t      positions.push([p[0], options.top, p[1]]);\n\t    });\n\t    points.forEach(function (p) {\n\t      positions.push([p[0], options.bottom, p[1]]);\n\t    });\n\t\n\t    cells = [];\n\t    for (var i = 0; i < n; i++) {\n\t      if (i === n - 1) {\n\t        cells.push([i + n, n, i]);\n\t        cells.push([0, i, n]);\n\t      } else {\n\t        cells.push([i + n, i + n + 1, i]);\n\t        cells.push([i + 1, i, i + n + 1]);\n\t      }\n\t    }\n\t\n\t    sideCells = [].concat(cells);\n\t\n\t    if (options.closed) {\n\t      var top = faces;\n\t      var bottom = top.map(function (p) {\n\t        return p.map(function (v) {\n\t          return v + n;\n\t        });\n\t      });\n\t      bottom = bottom.map(function (p) {\n\t        return [p[0], p[2], p[1]];\n\t      });\n\t      cells = cells.concat(top).concat(bottom);\n\t\n\t      topCells = top;\n\t      bottomCells = bottom;\n\t    }\n\t  }\n\t\n\t  return {\n\t    positions: positions,\n\t    faces: cells,\n\t    top: topCells,\n\t    bottom: bottomCells,\n\t    sides: sideCells\n\t  };\n\t};\n\t\n\texports['default'] = extrudePolygon;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 66 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t/*\n\t * BufferGeometry helpers\n\t */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar Buffer = (function () {\n\t  // Merge multiple attribute objects into a single attribute object\n\t  //\n\t  // Attribute objects must all use the same attribute keys\n\t  var mergeAttributes = function mergeAttributes(attributes) {\n\t    var lengths = {};\n\t\n\t    // Find array lengths\n\t    attributes.forEach(function (_attributes) {\n\t      for (var k in _attributes) {\n\t        if (!lengths[k]) {\n\t          lengths[k] = 0;\n\t        }\n\t\n\t        lengths[k] += _attributes[k].length;\n\t      }\n\t    });\n\t\n\t    var mergedAttributes = {};\n\t\n\t    // Set up arrays to merge into\n\t    for (var k in lengths) {\n\t      mergedAttributes[k] = new Float32Array(lengths[k]);\n\t    }\n\t\n\t    var lastLengths = {};\n\t\n\t    attributes.forEach(function (_attributes) {\n\t      for (var k in _attributes) {\n\t        if (!lastLengths[k]) {\n\t          lastLengths[k] = 0;\n\t        }\n\t\n\t        mergedAttributes[k].set(_attributes[k], lastLengths[k]);\n\t\n\t        lastLengths[k] += _attributes[k].length;\n\t      }\n\t    });\n\t\n\t    return mergedAttributes;\n\t  };\n\t\n\t  var createLineGeometry = function createLineGeometry(lines, offset) {\n\t    var geometry = new _three2['default'].BufferGeometry();\n\t\n\t    var vertices = new Float32Array(lines.verticesCount * 3);\n\t    var colours = new Float32Array(lines.verticesCount * 3);\n\t\n\t    var pickingIds;\n\t    if (lines.pickingIds) {\n\t      // One component per vertex (1)\n\t      pickingIds = new Float32Array(lines.verticesCount);\n\t    }\n\t\n\t    var _vertices;\n\t    var _colour;\n\t    var _pickingId;\n\t\n\t    var lastIndex = 0;\n\t\n\t    for (var i = 0; i < lines.vertices.length; i++) {\n\t      _vertices = lines.vertices[i];\n\t      _colour = lines.colours[i];\n\t\n\t      if (pickingIds) {\n\t        _pickingId = lines.pickingIds[i];\n\t      }\n\t\n\t      for (var j = 0; j < _vertices.length; j++) {\n\t        var ax = _vertices[j][0] + offset.x;\n\t        var ay = _vertices[j][1];\n\t        var az = _vertices[j][2] + offset.y;\n\t\n\t        var c1 = _colour[j];\n\t\n\t        vertices[lastIndex * 3 + 0] = ax;\n\t        vertices[lastIndex * 3 + 1] = ay;\n\t        vertices[lastIndex * 3 + 2] = az;\n\t\n\t        colours[lastIndex * 3 + 0] = c1[0];\n\t        colours[lastIndex * 3 + 1] = c1[1];\n\t        colours[lastIndex * 3 + 2] = c1[2];\n\t\n\t        if (pickingIds) {\n\t          pickingIds[lastIndex] = _pickingId;\n\t        }\n\t\n\t        lastIndex++;\n\t      }\n\t    }\n\t\n\t    // itemSize = 3 because there are 3 values (components) per vertex\n\t    geometry.addAttribute('position', new _three2['default'].BufferAttribute(vertices, 3));\n\t    geometry.addAttribute('color', new _three2['default'].BufferAttribute(colours, 3));\n\t\n\t    if (pickingIds) {\n\t      geometry.addAttribute('pickingId', new _three2['default'].BufferAttribute(pickingIds, 1));\n\t    }\n\t\n\t    geometry.computeBoundingBox();\n\t\n\t    return geometry;\n\t  };\n\t\n\t  // TODO: Make picking IDs optional\n\t  var createGeometry = function createGeometry(attributes, offset) {\n\t    var geometry = new _three2['default'].BufferGeometry();\n\t\n\t    // Three components per vertex per face (3 x 3 = 9)\n\t    var vertices = new Float32Array(attributes.facesCount * 9);\n\t    var normals = new Float32Array(attributes.facesCount * 9);\n\t    var colours = new Float32Array(attributes.facesCount * 9);\n\t\n\t    var pickingIds;\n\t    if (attributes.pickingIds) {\n\t      // One component per vertex per face (1 x 3 = 3)\n\t      pickingIds = new Float32Array(attributes.facesCount * 3);\n\t    }\n\t\n\t    var pA = new _three2['default'].Vector3();\n\t    var pB = new _three2['default'].Vector3();\n\t    var pC = new _three2['default'].Vector3();\n\t\n\t    var cb = new _three2['default'].Vector3();\n\t    var ab = new _three2['default'].Vector3();\n\t\n\t    var index;\n\t    var _faces;\n\t    var _vertices;\n\t    var _colour;\n\t    var _pickingId;\n\t    var lastIndex = 0;\n\t    for (var i = 0; i < attributes.faces.length; i++) {\n\t      _faces = attributes.faces[i];\n\t      _vertices = attributes.vertices[i];\n\t      _colour = attributes.colours[i];\n\t\n\t      if (pickingIds) {\n\t        _pickingId = attributes.pickingIds[i];\n\t      }\n\t\n\t      for (var j = 0; j < _faces.length; j++) {\n\t        // Array of vertex indexes for the face\n\t        index = _faces[j][0];\n\t\n\t        var ax = _vertices[index][0] + offset.x;\n\t        var ay = _vertices[index][1];\n\t        var az = _vertices[index][2] + offset.y;\n\t\n\t        var c1 = _colour[j][0];\n\t\n\t        index = _faces[j][1];\n\t\n\t        var bx = _vertices[index][0] + offset.x;\n\t        var by = _vertices[index][1];\n\t        var bz = _vertices[index][2] + offset.y;\n\t\n\t        var c2 = _colour[j][1];\n\t\n\t        index = _faces[j][2];\n\t\n\t        var cx = _vertices[index][0] + offset.x;\n\t        var cy = _vertices[index][1];\n\t        var cz = _vertices[index][2] + offset.y;\n\t\n\t        var c3 = _colour[j][2];\n\t\n\t        // Flat face normals\n\t        // From: http://threejs.org/examples/webgl_buffergeometry.html\n\t        pA.set(ax, ay, az);\n\t        pB.set(bx, by, bz);\n\t        pC.set(cx, cy, cz);\n\t\n\t        cb.subVectors(pC, pB);\n\t        ab.subVectors(pA, pB);\n\t        cb.cross(ab);\n\t\n\t        cb.normalize();\n\t\n\t        var nx = cb.x;\n\t        var ny = cb.y;\n\t        var nz = cb.z;\n\t\n\t        vertices[lastIndex * 9 + 0] = ax;\n\t        vertices[lastIndex * 9 + 1] = ay;\n\t        vertices[lastIndex * 9 + 2] = az;\n\t\n\t        normals[lastIndex * 9 + 0] = nx;\n\t        normals[lastIndex * 9 + 1] = ny;\n\t        normals[lastIndex * 9 + 2] = nz;\n\t\n\t        colours[lastIndex * 9 + 0] = c1[0];\n\t        colours[lastIndex * 9 + 1] = c1[1];\n\t        colours[lastIndex * 9 + 2] = c1[2];\n\t\n\t        vertices[lastIndex * 9 + 3] = bx;\n\t        vertices[lastIndex * 9 + 4] = by;\n\t        vertices[lastIndex * 9 + 5] = bz;\n\t\n\t        normals[lastIndex * 9 + 3] = nx;\n\t        normals[lastIndex * 9 + 4] = ny;\n\t        normals[lastIndex * 9 + 5] = nz;\n\t\n\t        colours[lastIndex * 9 + 3] = c2[0];\n\t        colours[lastIndex * 9 + 4] = c2[1];\n\t        colours[lastIndex * 9 + 5] = c2[2];\n\t\n\t        vertices[lastIndex * 9 + 6] = cx;\n\t        vertices[lastIndex * 9 + 7] = cy;\n\t        vertices[lastIndex * 9 + 8] = cz;\n\t\n\t        normals[lastIndex * 9 + 6] = nx;\n\t        normals[lastIndex * 9 + 7] = ny;\n\t        normals[lastIndex * 9 + 8] = nz;\n\t\n\t        colours[lastIndex * 9 + 6] = c3[0];\n\t        colours[lastIndex * 9 + 7] = c3[1];\n\t        colours[lastIndex * 9 + 8] = c3[2];\n\t\n\t        if (pickingIds) {\n\t          pickingIds[lastIndex * 3 + 0] = _pickingId;\n\t          pickingIds[lastIndex * 3 + 1] = _pickingId;\n\t          pickingIds[lastIndex * 3 + 2] = _pickingId;\n\t        }\n\t\n\t        lastIndex++;\n\t      }\n\t    }\n\t\n\t    // itemSize = 3 because there are 3 values (components) per vertex\n\t    geometry.addAttribute('position', new _three2['default'].BufferAttribute(vertices, 3));\n\t    geometry.addAttribute('normal', new _three2['default'].BufferAttribute(normals, 3));\n\t    geometry.addAttribute('color', new _three2['default'].BufferAttribute(colours, 3));\n\t\n\t    if (pickingIds) {\n\t      geometry.addAttribute('pickingId', new _three2['default'].BufferAttribute(pickingIds, 1));\n\t    }\n\t\n\t    geometry.computeBoundingBox();\n\t\n\t    return geometry;\n\t  };\n\t\n\t  return {\n\t    mergeAttributes: mergeAttributes,\n\t    createLineGeometry: createLineGeometry,\n\t    createGeometry: createGeometry\n\t  };\n\t})();\n\t\n\texports['default'] = Buffer;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 67 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _PickingShader = __webpack_require__(68);\n\t\n\tvar _PickingShader2 = _interopRequireDefault(_PickingShader);\n\t\n\t// FROM: https://github.com/brianxu/GPUPicker/blob/master/GPUPicker.js\n\t\n\tvar PickingMaterial = function PickingMaterial() {\n\t  _three2['default'].ShaderMaterial.call(this, {\n\t    uniforms: {\n\t      size: {\n\t        type: 'f',\n\t        value: 0.01\n\t      },\n\t      scale: {\n\t        type: 'f',\n\t        value: 400\n\t      }\n\t    },\n\t    // attributes: ['position', 'id'],\n\t    vertexShader: _PickingShader2['default'].vertexShader,\n\t    fragmentShader: _PickingShader2['default'].fragmentShader\n\t  });\n\t\n\t  this.linePadding = 2;\n\t};\n\t\n\tPickingMaterial.prototype = Object.create(_three2['default'].ShaderMaterial.prototype);\n\t\n\tPickingMaterial.prototype.constructor = PickingMaterial;\n\t\n\tPickingMaterial.prototype.setPointSize = function (size) {\n\t  this.uniforms.size.value = size;\n\t};\n\t\n\tPickingMaterial.prototype.setPointScale = function (scale) {\n\t  this.uniforms.scale.value = scale;\n\t};\n\t\n\texports['default'] = PickingMaterial;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 68 */\n/***/ function(module, exports) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t// FROM: https://github.com/brianxu/GPUPicker/blob/master/GPUPicker.js\n\t\n\tvar PickingShader = {\n\t\tvertexShader: ['attribute float pickingId;',\n\t\t// '',\n\t\t// 'uniform float size;',\n\t\t// 'uniform float scale;',\n\t\t'', 'varying vec4 worldId;', '', 'void main() {', '  vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',\n\t\t// '  gl_PointSize = size * ( scale / length( mvPosition.xyz ) );',\n\t\t'  vec3 a = fract(vec3(1.0/255.0, 1.0/(255.0*255.0), 1.0/(255.0*255.0*255.0)) * pickingId);', '  a -= a.xxy * vec3(0.0, 1.0/255.0, 1.0/255.0);', '  worldId = vec4(a,1);', '  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );', '}'].join('\\n'),\n\t\n\t\tfragmentShader: ['#ifdef GL_ES\\n', 'precision highp float;\\n', '#endif\\n', '', 'varying vec4 worldId;', '', 'void main() {', '  gl_FragColor = worldId;', '}'].join('\\n')\n\t};\n\t\n\texports['default'] = PickingShader;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 69 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// TODO: Move duplicated logic between geometry layrs into GeometryLayer\n\t\n\t// TODO: Look at ways to drop unneeded references to array buffers, etc to\n\t// reduce memory footprint\n\t\n\t// TODO: Support dynamic updating / hiding / animation of geometry\n\t//\n\t// This could be pretty hard as it's all packed away within BufferGeometry and\n\t// may even be merged by another layer (eg. GeoJSONLayer)\n\t//\n\t// How much control should this layer support? Perhaps a different or custom\n\t// layer would be better suited for animation, for example.\n\t\n\t// TODO: Allow _setBufferAttributes to use a custom function passed in to\n\t// generate a custom mesh\n\t\n\tvar _Layer2 = __webpack_require__(30);\n\t\n\tvar _Layer3 = _interopRequireDefault(_Layer2);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _geoLatLon = __webpack_require__(5);\n\t\n\tvar _geoPoint = __webpack_require__(6);\n\t\n\tvar _earcut2 = __webpack_require__(64);\n\t\n\tvar _earcut3 = _interopRequireDefault(_earcut2);\n\t\n\tvar _utilExtrudePolygon = __webpack_require__(65);\n\t\n\tvar _utilExtrudePolygon2 = _interopRequireDefault(_utilExtrudePolygon);\n\t\n\tvar _enginePickingMaterial = __webpack_require__(67);\n\t\n\tvar _enginePickingMaterial2 = _interopRequireDefault(_enginePickingMaterial);\n\t\n\tvar _utilBuffer = __webpack_require__(66);\n\t\n\tvar _utilBuffer2 = _interopRequireDefault(_utilBuffer);\n\t\n\tvar PolygonLayer = (function (_Layer) {\n\t  _inherits(PolygonLayer, _Layer);\n\t\n\t  function PolygonLayer(coordinates, options) {\n\t    _classCallCheck(this, PolygonLayer);\n\t\n\t    var defaults = {\n\t      output: true,\n\t      interactive: false,\n\t      // Custom material override\n\t      //\n\t      // TODO: Should this be in the style object?\n\t      material: null,\n\t      onMesh: null,\n\t      onBufferAttributes: null,\n\t      // This default style is separate to Util.GeoJSON.defaultStyle\n\t      style: {\n\t        color: '#ffffff',\n\t        transparent: false,\n\t        opacity: 1,\n\t        blending: _three2['default'].NormalBlending,\n\t        height: 0\n\t      }\n\t    };\n\t\n\t    var _options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    _get(Object.getPrototypeOf(PolygonLayer.prototype), 'constructor', this).call(this, _options);\n\t\n\t    // Return coordinates as array of polygons so it's easy to support\n\t    // MultiPolygon features (a single polygon would be a MultiPolygon with a\n\t    // single polygon in the array)\n\t    this._coordinates = PolygonLayer.isSingle(coordinates) ? [coordinates] : coordinates;\n\t  }\n\t\n\t  _createClass(PolygonLayer, [{\n\t    key: '_onAdd',\n\t    value: function _onAdd(world) {\n\t      this._setCoordinates();\n\t\n\t      if (this._options.interactive) {\n\t        // Only add to picking mesh if this layer is controlling output\n\t        //\n\t        // Otherwise, assume another component will eventually add a mesh to\n\t        // the picking scene\n\t        if (this.isOutput()) {\n\t          this._pickingMesh = new _three2['default'].Object3D();\n\t          this.addToPicking(this._pickingMesh);\n\t        }\n\t\n\t        this._setPickingId();\n\t        this._addPickingEvents();\n\t      }\n\t\n\t      // Store geometry representation as instances of THREE.BufferAttribute\n\t      this._setBufferAttributes();\n\t\n\t      if (this.isOutput()) {\n\t        // Set mesh if not merging elsewhere\n\t        this._setMesh(this._bufferAttributes);\n\t\n\t        // Output mesh\n\t        this.add(this._mesh);\n\t      }\n\t    }\n\t\n\t    // Return center of polygon as a LatLon\n\t    //\n\t    // This is used for things like placing popups / UI elements on the layer\n\t    //\n\t    // TODO: Find proper center position instead of returning first coordinate\n\t    // SEE: https://github.com/Leaflet/Leaflet/blob/master/src/layer/vector/Polygon.js#L15\n\t  }, {\n\t    key: 'getCenter',\n\t    value: function getCenter() {\n\t      return this._center;\n\t    }\n\t\n\t    // Return polygon bounds in geographic coordinates\n\t    //\n\t    // TODO: Implement getBounds()\n\t  }, {\n\t    key: 'getBounds',\n\t    value: function getBounds() {}\n\t\n\t    // Get unique ID for picking interaction\n\t  }, {\n\t    key: '_setPickingId',\n\t    value: function _setPickingId() {\n\t      this._pickingId = this.getPickingId();\n\t    }\n\t\n\t    // Set up and re-emit interaction events\n\t  }, {\n\t    key: '_addPickingEvents',\n\t    value: function _addPickingEvents() {\n\t      var _this = this;\n\t\n\t      // TODO: Find a way to properly remove this listener on destroy\n\t      this._world.on('pick-' + this._pickingId, function (point2d, point3d, intersects) {\n\t        // Re-emit click event from the layer\n\t        _this.emit('click', _this, point2d, point3d, intersects);\n\t      });\n\t    }\n\t\n\t    // Create and store reference to THREE.BufferAttribute data for this layer\n\t  }, {\n\t    key: '_setBufferAttributes',\n\t    value: function _setBufferAttributes() {\n\t      var _this2 = this;\n\t\n\t      var attributes;\n\t\n\t      // Only use this if you know what you're doing\n\t      if (typeof this._options.onBufferAttributes === 'function') {\n\t        // TODO: Probably want to pass something less general as arguments,\n\t        // though passing the instance will do for now (it's everything)\n\t        attributes = this._options.onBufferAttributes(this);\n\t      } else {\n\t        var height = 0;\n\t\n\t        // Convert height into world units\n\t        if (this._options.style.height && this._options.style.height !== 0) {\n\t          height = this._world.metresToWorld(this._options.style.height, this._pointScale);\n\t        }\n\t\n\t        var colour = new _three2['default'].Color();\n\t        colour.set(this._options.style.color);\n\t\n\t        // Light and dark colours used for poor-mans AO gradient on object sides\n\t        var light = new _three2['default'].Color(0xffffff);\n\t        var shadow = new _three2['default'].Color(0x666666);\n\t\n\t        // For each polygon\n\t        attributes = this._projectedCoordinates.map(function (_projectedCoordinates) {\n\t          // Convert coordinates to earcut format\n\t          var _earcut = _this2._toEarcut(_projectedCoordinates);\n\t\n\t          // Triangulate faces using earcut\n\t          var faces = _this2._triangulate(_earcut.vertices, _earcut.holes, _earcut.dimensions);\n\t\n\t          var groupedVertices = [];\n\t          for (i = 0, il = _earcut.vertices.length; i < il; i += _earcut.dimensions) {\n\t            groupedVertices.push(_earcut.vertices.slice(i, i + _earcut.dimensions));\n\t          }\n\t\n\t          var extruded = (0, _utilExtrudePolygon2['default'])(groupedVertices, faces, {\n\t            bottom: 0,\n\t            top: height\n\t          });\n\t\n\t          var topColor = colour.clone().multiply(light);\n\t          var bottomColor = colour.clone().multiply(shadow);\n\t\n\t          var _vertices = extruded.positions;\n\t          var _faces = [];\n\t          var _colours = [];\n\t\n\t          var _colour;\n\t          extruded.top.forEach(function (face, fi) {\n\t            _colour = [];\n\t\n\t            _colour.push([colour.r, colour.g, colour.b]);\n\t            _colour.push([colour.r, colour.g, colour.b]);\n\t            _colour.push([colour.r, colour.g, colour.b]);\n\t\n\t            _faces.push(face);\n\t            _colours.push(_colour);\n\t          });\n\t\n\t          _this2._flat = true;\n\t\n\t          if (extruded.sides) {\n\t            _this2._flat = false;\n\t\n\t            // Set up colours for every vertex with poor-mans AO on the sides\n\t            extruded.sides.forEach(function (face, fi) {\n\t              _colour = [];\n\t\n\t              // First face is always bottom-bottom-top\n\t              if (fi % 2 === 0) {\n\t                _colour.push([bottomColor.r, bottomColor.g, bottomColor.b]);\n\t                _colour.push([bottomColor.r, bottomColor.g, bottomColor.b]);\n\t                _colour.push([topColor.r, topColor.g, topColor.b]);\n\t                // Reverse winding for the second face\n\t                // top-top-bottom\n\t              } else {\n\t                  _colour.push([topColor.r, topColor.g, topColor.b]);\n\t                  _colour.push([topColor.r, topColor.g, topColor.b]);\n\t                  _colour.push([bottomColor.r, bottomColor.g, bottomColor.b]);\n\t                }\n\t\n\t              _faces.push(face);\n\t              _colours.push(_colour);\n\t            });\n\t          }\n\t\n\t          // Skip bottom as there's no point rendering it\n\t          // allFaces.push(extruded.faces);\n\t\n\t          var polygon = {\n\t            vertices: _vertices,\n\t            faces: _faces,\n\t            colours: _colours,\n\t            facesCount: _faces.length\n\t          };\n\t\n\t          if (_this2._options.interactive && _this2._pickingId) {\n\t            // Inject picking ID\n\t            polygon.pickingId = _this2._pickingId;\n\t          }\n\t\n\t          // Convert polygon representation to proper attribute arrays\n\t          return _this2._toAttributes(polygon);\n\t        });\n\t      }\n\t\n\t      this._bufferAttributes = _utilBuffer2['default'].mergeAttributes(attributes);\n\t\n\t      // Original attributes are no longer required so free the memory\n\t      attributes = null;\n\t    }\n\t  }, {\n\t    key: 'getBufferAttributes',\n\t    value: function getBufferAttributes() {\n\t      return this._bufferAttributes;\n\t    }\n\t\n\t    // Used by external components to clear some memory when the attributes\n\t    // are no longer required to be stored in this layer\n\t    //\n\t    // For example, you would want to clear the attributes here after merging them\n\t    // using something like the GeoJSONLayer\n\t  }, {\n\t    key: 'clearBufferAttributes',\n\t    value: function clearBufferAttributes() {\n\t      this._bufferAttributes = null;\n\t    }\n\t\n\t    // Used by external components to clear some memory when the coordinates\n\t    // are no longer required to be stored in this layer\n\t    //\n\t    // For example, you would want to clear the coordinates here after this\n\t    // layer is merged in something like the GeoJSONLayer\n\t  }, {\n\t    key: 'clearCoordinates',\n\t    value: function clearCoordinates() {\n\t      this._coordinates = null;\n\t      this._projectedCoordinates = null;\n\t    }\n\t\n\t    // Create and store mesh from buffer attributes\n\t    //\n\t    // This is only called if the layer is controlling its own output\n\t  }, {\n\t    key: '_setMesh',\n\t    value: function _setMesh(attributes) {\n\t      var geometry = new _three2['default'].BufferGeometry();\n\t\n\t      // itemSize = 3 because there are 3 values (components) per vertex\n\t      geometry.addAttribute('position', new _three2['default'].BufferAttribute(attributes.vertices, 3));\n\t      geometry.addAttribute('normal', new _three2['default'].BufferAttribute(attributes.normals, 3));\n\t      geometry.addAttribute('color', new _three2['default'].BufferAttribute(attributes.colours, 3));\n\t\n\t      if (attributes.pickingIds) {\n\t        geometry.addAttribute('pickingId', new _three2['default'].BufferAttribute(attributes.pickingIds, 1));\n\t      }\n\t\n\t      geometry.computeBoundingBox();\n\t\n\t      var material;\n\t      if (this._options.material && this._options.material instanceof _three2['default'].Material) {\n\t        material = this._options.material;\n\t      } else if (!this._world._environment._skybox) {\n\t        material = new _three2['default'].MeshPhongMaterial({\n\t          vertexColors: _three2['default'].VertexColors,\n\t          side: _three2['default'].BackSide,\n\t          transparent: this._options.style.transparent,\n\t          opacity: this._options.style.opacity,\n\t          blending: this._options.style.blending\n\t        });\n\t      } else {\n\t        material = new _three2['default'].MeshStandardMaterial({\n\t          vertexColors: _three2['default'].VertexColors,\n\t          side: _three2['default'].BackSide,\n\t          transparent: this._options.style.transparent,\n\t          opacity: this._options.style.opacity,\n\t          blending: this._options.style.blending\n\t        });\n\t        material.roughness = 1;\n\t        material.metalness = 0.1;\n\t        material.envMapIntensity = 3;\n\t        material.envMap = this._world._environment._skybox.getRenderTarget();\n\t      }\n\t\n\t      var mesh;\n\t\n\t      // Pass mesh through callback, if defined\n\t      if (typeof this._options.onMesh === 'function') {\n\t        mesh = this._options.onMesh(geometry, material);\n\t      } else {\n\t        mesh = new _three2['default'].Mesh(geometry, material);\n\t\n\t        mesh.castShadow = true;\n\t        mesh.receiveShadow = true;\n\t      }\n\t\n\t      if (this.isFlat()) {\n\t        material.depthWrite = false;\n\t        mesh.renderOrder = 1;\n\t      }\n\t\n\t      if (this._options.interactive && this._pickingMesh) {\n\t        material = new _enginePickingMaterial2['default']();\n\t        material.side = _three2['default'].BackSide;\n\t\n\t        var pickingMesh = new _three2['default'].Mesh(geometry, material);\n\t        this._pickingMesh.add(pickingMesh);\n\t      }\n\t\n\t      this._mesh = mesh;\n\t    }\n\t\n\t    // Convert and project coordinates\n\t    //\n\t    // TODO: Calculate bounds\n\t  }, {\n\t    key: '_setCoordinates',\n\t    value: function _setCoordinates() {\n\t      this._bounds = [];\n\t      this._coordinates = this._convertCoordinates(this._coordinates);\n\t\n\t      this._projectedBounds = [];\n\t      this._projectedCoordinates = this._projectCoordinates();\n\t\n\t      this._center = this._coordinates[0][0][0];\n\t    }\n\t\n\t    // Recursively convert input coordinates into LatLon objects\n\t    //\n\t    // Calculate geographic bounds at the same time\n\t    //\n\t    // TODO: Calculate geographic bounds\n\t  }, {\n\t    key: '_convertCoordinates',\n\t    value: function _convertCoordinates(coordinates) {\n\t      return coordinates.map(function (_coordinates) {\n\t        return _coordinates.map(function (ring) {\n\t          return ring.map(function (coordinate) {\n\t            return (0, _geoLatLon.latLon)(coordinate[1], coordinate[0]);\n\t          });\n\t        });\n\t      });\n\t    }\n\t\n\t    // Recursively project coordinates into world positions\n\t    //\n\t    // Calculate world bounds, offset and pointScale at the same time\n\t    //\n\t    // TODO: Calculate world bounds\n\t  }, {\n\t    key: '_projectCoordinates',\n\t    value: function _projectCoordinates() {\n\t      var _this3 = this;\n\t\n\t      var point;\n\t      return this._coordinates.map(function (_coordinates) {\n\t        return _coordinates.map(function (ring) {\n\t          return ring.map(function (latlon) {\n\t            point = _this3._world.latLonToPoint(latlon);\n\t\n\t            // TODO: Is offset ever being used or needed?\n\t            if (!_this3._offset) {\n\t              _this3._offset = (0, _geoPoint.point)(0, 0);\n\t              _this3._offset.x = -1 * point.x;\n\t              _this3._offset.y = -1 * point.y;\n\t\n\t              _this3._pointScale = _this3._world.pointScale(latlon);\n\t            }\n\t\n\t            return point;\n\t          });\n\t        });\n\t      });\n\t    }\n\t\n\t    // Convert coordinates array to something earcut can understand\n\t  }, {\n\t    key: '_toEarcut',\n\t    value: function _toEarcut(coordinates) {\n\t      var dim = 2;\n\t      var result = { vertices: [], holes: [], dimensions: dim };\n\t      var holeIndex = 0;\n\t\n\t      for (var i = 0; i < coordinates.length; i++) {\n\t        for (var j = 0; j < coordinates[i].length; j++) {\n\t          // for (var d = 0; d < dim; d++) {\n\t          result.vertices.push(coordinates[i][j].x);\n\t          result.vertices.push(coordinates[i][j].y);\n\t          // }\n\t        }\n\t        if (i > 0) {\n\t          holeIndex += coordinates[i - 1].length;\n\t          result.holes.push(holeIndex);\n\t        }\n\t      }\n\t\n\t      return result;\n\t    }\n\t\n\t    // Triangulate earcut-based input using earcut\n\t  }, {\n\t    key: '_triangulate',\n\t    value: function _triangulate(contour, holes, dim) {\n\t      // console.time('earcut');\n\t\n\t      var faces = (0, _earcut3['default'])(contour, holes, dim);\n\t      var result = [];\n\t\n\t      for (i = 0, il = faces.length; i < il; i += 3) {\n\t        result.push(faces.slice(i, i + 3));\n\t      }\n\t\n\t      // console.timeEnd('earcut');\n\t\n\t      return result;\n\t    }\n\t\n\t    // Transform polygon representation into attribute arrays that can be used by\n\t    // THREE.BufferGeometry\n\t    //\n\t    // TODO: Can this be simplified? It's messy and huge\n\t  }, {\n\t    key: '_toAttributes',\n\t    value: function _toAttributes(polygon) {\n\t      // Three components per vertex per face (3 x 3 = 9)\n\t      var vertices = new Float32Array(polygon.facesCount * 9);\n\t      var normals = new Float32Array(polygon.facesCount * 9);\n\t      var colours = new Float32Array(polygon.facesCount * 9);\n\t\n\t      var pickingIds;\n\t      if (polygon.pickingId) {\n\t        // One component per vertex per face (1 x 3 = 3)\n\t        pickingIds = new Float32Array(polygon.facesCount * 3);\n\t      }\n\t\n\t      var pA = new _three2['default'].Vector3();\n\t      var pB = new _three2['default'].Vector3();\n\t      var pC = new _three2['default'].Vector3();\n\t\n\t      var cb = new _three2['default'].Vector3();\n\t      var ab = new _three2['default'].Vector3();\n\t\n\t      var index;\n\t\n\t      var _faces = polygon.faces;\n\t      var _vertices = polygon.vertices;\n\t      var _colour = polygon.colours;\n\t\n\t      var _pickingId;\n\t      if (pickingIds) {\n\t        _pickingId = polygon.pickingId;\n\t      }\n\t\n\t      var lastIndex = 0;\n\t\n\t      for (var i = 0; i < _faces.length; i++) {\n\t        // Array of vertex indexes for the face\n\t        index = _faces[i][0];\n\t\n\t        var ax = _vertices[index][0];\n\t        var ay = _vertices[index][1];\n\t        var az = _vertices[index][2];\n\t\n\t        var c1 = _colour[i][0];\n\t\n\t        index = _faces[i][1];\n\t\n\t        var bx = _vertices[index][0];\n\t        var by = _vertices[index][1];\n\t        var bz = _vertices[index][2];\n\t\n\t        var c2 = _colour[i][1];\n\t\n\t        index = _faces[i][2];\n\t\n\t        var cx = _vertices[index][0];\n\t        var cy = _vertices[index][1];\n\t        var cz = _vertices[index][2];\n\t\n\t        var c3 = _colour[i][2];\n\t\n\t        // Flat face normals\n\t        // From: http://threejs.org/examples/webgl_buffergeometry.html\n\t        pA.set(ax, ay, az);\n\t        pB.set(bx, by, bz);\n\t        pC.set(cx, cy, cz);\n\t\n\t        cb.subVectors(pC, pB);\n\t        ab.subVectors(pA, pB);\n\t        cb.cross(ab);\n\t\n\t        cb.normalize();\n\t\n\t        var nx = cb.x;\n\t        var ny = cb.y;\n\t        var nz = cb.z;\n\t\n\t        vertices[lastIndex * 9 + 0] = ax;\n\t        vertices[lastIndex * 9 + 1] = ay;\n\t        vertices[lastIndex * 9 + 2] = az;\n\t\n\t        normals[lastIndex * 9 + 0] = nx;\n\t        normals[lastIndex * 9 + 1] = ny;\n\t        normals[lastIndex * 9 + 2] = nz;\n\t\n\t        colours[lastIndex * 9 + 0] = c1[0];\n\t        colours[lastIndex * 9 + 1] = c1[1];\n\t        colours[lastIndex * 9 + 2] = c1[2];\n\t\n\t        vertices[lastIndex * 9 + 3] = bx;\n\t        vertices[lastIndex * 9 + 4] = by;\n\t        vertices[lastIndex * 9 + 5] = bz;\n\t\n\t        normals[lastIndex * 9 + 3] = nx;\n\t        normals[lastIndex * 9 + 4] = ny;\n\t        normals[lastIndex * 9 + 5] = nz;\n\t\n\t        colours[lastIndex * 9 + 3] = c2[0];\n\t        colours[lastIndex * 9 + 4] = c2[1];\n\t        colours[lastIndex * 9 + 5] = c2[2];\n\t\n\t        vertices[lastIndex * 9 + 6] = cx;\n\t        vertices[lastIndex * 9 + 7] = cy;\n\t        vertices[lastIndex * 9 + 8] = cz;\n\t\n\t        normals[lastIndex * 9 + 6] = nx;\n\t        normals[lastIndex * 9 + 7] = ny;\n\t        normals[lastIndex * 9 + 8] = nz;\n\t\n\t        colours[lastIndex * 9 + 6] = c3[0];\n\t        colours[lastIndex * 9 + 7] = c3[1];\n\t        colours[lastIndex * 9 + 8] = c3[2];\n\t\n\t        if (pickingIds) {\n\t          pickingIds[lastIndex * 3 + 0] = _pickingId;\n\t          pickingIds[lastIndex * 3 + 1] = _pickingId;\n\t          pickingIds[lastIndex * 3 + 2] = _pickingId;\n\t        }\n\t\n\t        lastIndex++;\n\t      }\n\t\n\t      var attributes = {\n\t        vertices: vertices,\n\t        normals: normals,\n\t        colours: colours\n\t      };\n\t\n\t      if (pickingIds) {\n\t        attributes.pickingIds = pickingIds;\n\t      }\n\t\n\t      return attributes;\n\t    }\n\t\n\t    // Returns true if the polygon is flat (has no height)\n\t  }, {\n\t    key: 'isFlat',\n\t    value: function isFlat() {\n\t      return this._flat;\n\t    }\n\t\n\t    // Returns true if coordinates refer to a single geometry\n\t    //\n\t    // For example, not coordinates for a MultiPolygon GeoJSON feature\n\t  }, {\n\t    key: 'destroy',\n\t\n\t    // TODO: Make sure this is cleaning everything\n\t    value: function destroy() {\n\t      if (this._pickingMesh) {\n\t        // TODO: Properly dispose of picking mesh\n\t        this._pickingMesh = null;\n\t      }\n\t\n\t      this.clearCoordinates();\n\t      this.clearBufferAttributes();\n\t\n\t      // Run common destruction logic from parent\n\t      _get(Object.getPrototypeOf(PolygonLayer.prototype), 'destroy', this).call(this);\n\t    }\n\t  }], [{\n\t    key: 'isSingle',\n\t    value: function isSingle(coordinates) {\n\t      return !Array.isArray(coordinates[0][0][0]);\n\t    }\n\t  }]);\n\t\n\t  return PolygonLayer;\n\t})(_Layer3['default']);\n\t\n\texports['default'] = PolygonLayer;\n\t\n\tvar noNew = function noNew(coordinates, options) {\n\t  return new PolygonLayer(coordinates, options);\n\t};\n\t\n\texports.polygonLayer = noNew;\n\n/***/ },\n/* 70 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// TODO: Move duplicated logic between geometry layrs into GeometryLayer\n\t\n\t// TODO: Look at ways to drop unneeded references to array buffers, etc to\n\t// reduce memory footprint\n\t\n\t// TODO: Provide alternative output using tubes and splines / curves\n\t\n\t// TODO: Support dynamic updating / hiding / animation of geometry\n\t//\n\t// This could be pretty hard as it's all packed away within BufferGeometry and\n\t// may even be merged by another layer (eg. GeoJSONLayer)\n\t//\n\t// How much control should this layer support? Perhaps a different or custom\n\t// layer would be better suited for animation, for example.\n\t\n\t// TODO: Allow _setBufferAttributes to use a custom function passed in to\n\t// generate a custom mesh\n\t\n\tvar _Layer2 = __webpack_require__(30);\n\t\n\tvar _Layer3 = _interopRequireDefault(_Layer2);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _geoLatLon = __webpack_require__(5);\n\t\n\tvar _geoPoint = __webpack_require__(6);\n\t\n\tvar _enginePickingMaterial = __webpack_require__(67);\n\t\n\tvar _enginePickingMaterial2 = _interopRequireDefault(_enginePickingMaterial);\n\t\n\tvar _utilBuffer = __webpack_require__(66);\n\t\n\tvar _utilBuffer2 = _interopRequireDefault(_utilBuffer);\n\t\n\tvar PolylineLayer = (function (_Layer) {\n\t  _inherits(PolylineLayer, _Layer);\n\t\n\t  function PolylineLayer(coordinates, options) {\n\t    _classCallCheck(this, PolylineLayer);\n\t\n\t    var defaults = {\n\t      output: true,\n\t      interactive: false,\n\t      // Custom material override\n\t      //\n\t      // TODO: Should this be in the style object?\n\t      material: null,\n\t      onMesh: null,\n\t      onBufferAttributes: null,\n\t      // This default style is separate to Util.GeoJSON.defaultStyle\n\t      style: {\n\t        lineOpacity: 1,\n\t        lineTransparent: false,\n\t        lineColor: '#ffffff',\n\t        lineWidth: 1,\n\t        lineBlending: _three2['default'].NormalBlending\n\t      }\n\t    };\n\t\n\t    var _options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    _get(Object.getPrototypeOf(PolylineLayer.prototype), 'constructor', this).call(this, _options);\n\t\n\t    // Return coordinates as array of lines so it's easy to support\n\t    // MultiLineString features (a single line would be a MultiLineString with a\n\t    // single line in the array)\n\t    this._coordinates = PolylineLayer.isSingle(coordinates) ? [coordinates] : coordinates;\n\t\n\t    // Polyline features are always flat (for now at least)\n\t    this._flat = true;\n\t  }\n\t\n\t  _createClass(PolylineLayer, [{\n\t    key: '_onAdd',\n\t    value: function _onAdd(world) {\n\t      this._setCoordinates();\n\t\n\t      if (this._options.interactive) {\n\t        // Only add to picking mesh if this layer is controlling output\n\t        //\n\t        // Otherwise, assume another component will eventually add a mesh to\n\t        // the picking scene\n\t        if (this.isOutput()) {\n\t          this._pickingMesh = new _three2['default'].Object3D();\n\t          this.addToPicking(this._pickingMesh);\n\t        }\n\t\n\t        this._setPickingId();\n\t        this._addPickingEvents();\n\t      }\n\t\n\t      // Store geometry representation as instances of THREE.BufferAttribute\n\t      this._setBufferAttributes();\n\t\n\t      if (this.isOutput()) {\n\t        // Set mesh if not merging elsewhere\n\t        this._setMesh(this._bufferAttributes);\n\t\n\t        // Output mesh\n\t        this.add(this._mesh);\n\t      }\n\t    }\n\t\n\t    // Return center of polyline as a LatLon\n\t    //\n\t    // This is used for things like placing popups / UI elements on the layer\n\t    //\n\t    // TODO: Find proper center position instead of returning first coordinate\n\t    // SEE: https://github.com/Leaflet/Leaflet/blob/master/src/layer/vector/Polyline.js#L59\n\t  }, {\n\t    key: 'getCenter',\n\t    value: function getCenter() {\n\t      return this._center;\n\t    }\n\t\n\t    // Return line bounds in geographic coordinates\n\t    //\n\t    // TODO: Implement getBounds()\n\t  }, {\n\t    key: 'getBounds',\n\t    value: function getBounds() {}\n\t\n\t    // Get unique ID for picking interaction\n\t  }, {\n\t    key: '_setPickingId',\n\t    value: function _setPickingId() {\n\t      this._pickingId = this.getPickingId();\n\t    }\n\t\n\t    // Set up and re-emit interaction events\n\t  }, {\n\t    key: '_addPickingEvents',\n\t    value: function _addPickingEvents() {\n\t      var _this = this;\n\t\n\t      // TODO: Find a way to properly remove this listener on destroy\n\t      this._world.on('pick-' + this._pickingId, function (point2d, point3d, intersects) {\n\t        // Re-emit click event from the layer\n\t        _this.emit('click', _this, point2d, point3d, intersects);\n\t      });\n\t    }\n\t\n\t    // Create and store reference to THREE.BufferAttribute data for this layer\n\t  }, {\n\t    key: '_setBufferAttributes',\n\t    value: function _setBufferAttributes() {\n\t      var _this2 = this;\n\t\n\t      var attributes;\n\t\n\t      // Only use this if you know what you're doing\n\t      if (typeof this._options.onBufferAttributes === 'function') {\n\t        // TODO: Probably want to pass something less general as arguments,\n\t        // though passing the instance will do for now (it's everything)\n\t        attributes = this._options.onBufferAttributes(this);\n\t      } else {\n\t        var height = 0;\n\t\n\t        // Convert height into world units\n\t        if (this._options.style.lineHeight) {\n\t          height = this._world.metresToWorld(this._options.style.lineHeight, this._pointScale);\n\t        }\n\t\n\t        var colour = new _three2['default'].Color();\n\t        colour.set(this._options.style.lineColor);\n\t\n\t        // For each line\n\t        attributes = this._projectedCoordinates.map(function (_projectedCoordinates) {\n\t          var _vertices = [];\n\t          var _colours = [];\n\t\n\t          // Connect coordinate with the next to make a pair\n\t          //\n\t          // LineSegments requires pairs of vertices so repeat the last point if\n\t          // there's an odd number of vertices\n\t          var nextCoord;\n\t          _projectedCoordinates.forEach(function (coordinate, index) {\n\t            _colours.push([colour.r, colour.g, colour.b]);\n\t            _vertices.push([coordinate.x, height, coordinate.y]);\n\t\n\t            nextCoord = _projectedCoordinates[index + 1] ? _projectedCoordinates[index + 1] : coordinate;\n\t\n\t            _colours.push([colour.r, colour.g, colour.b]);\n\t            _vertices.push([nextCoord.x, height, nextCoord.y]);\n\t          });\n\t\n\t          var line = {\n\t            vertices: _vertices,\n\t            colours: _colours,\n\t            verticesCount: _vertices.length\n\t          };\n\t\n\t          if (_this2._options.interactive && _this2._pickingId) {\n\t            // Inject picking ID\n\t            line.pickingId = _this2._pickingId;\n\t          }\n\t\n\t          // Convert line representation to proper attribute arrays\n\t          return _this2._toAttributes(line);\n\t        });\n\t      }\n\t\n\t      this._bufferAttributes = _utilBuffer2['default'].mergeAttributes(attributes);\n\t\n\t      // Original attributes are no longer required so free the memory\n\t      attributes = null;\n\t    }\n\t  }, {\n\t    key: 'getBufferAttributes',\n\t    value: function getBufferAttributes() {\n\t      return this._bufferAttributes;\n\t    }\n\t\n\t    // Used by external components to clear some memory when the attributes\n\t    // are no longer required to be stored in this layer\n\t    //\n\t    // For example, you would want to clear the attributes here after merging them\n\t    // using something like the GeoJSONLayer\n\t  }, {\n\t    key: 'clearBufferAttributes',\n\t    value: function clearBufferAttributes() {\n\t      this._bufferAttributes = null;\n\t    }\n\t\n\t    // Used by external components to clear some memory when the coordinates\n\t    // are no longer required to be stored in this layer\n\t    //\n\t    // For example, you would want to clear the coordinates here after this\n\t    // layer is merged in something like the GeoJSONLayer\n\t  }, {\n\t    key: 'clearCoordinates',\n\t    value: function clearCoordinates() {\n\t      this._coordinates = null;\n\t      this._projectedCoordinates = null;\n\t    }\n\t\n\t    // Create and store mesh from buffer attributes\n\t    //\n\t    // This is only called if the layer is controlling its own output\n\t  }, {\n\t    key: '_setMesh',\n\t    value: function _setMesh(attributes) {\n\t      var geometry = new _three2['default'].BufferGeometry();\n\t\n\t      // itemSize = 3 because there are 3 values (components) per vertex\n\t      geometry.addAttribute('position', new _three2['default'].BufferAttribute(attributes.vertices, 3));\n\t\n\t      if (attributes.normals) {\n\t        geometry.addAttribute('normal', new _three2['default'].BufferAttribute(attributes.normals, 3));\n\t      }\n\t\n\t      geometry.addAttribute('color', new _three2['default'].BufferAttribute(attributes.colours, 3));\n\t\n\t      if (attributes.pickingIds) {\n\t        geometry.addAttribute('pickingId', new _three2['default'].BufferAttribute(attributes.pickingIds, 1));\n\t      }\n\t\n\t      geometry.computeBoundingBox();\n\t\n\t      var style = this._options.style;\n\t      var material;\n\t\n\t      if (this._options.material && this._options.material instanceof _three2['default'].Material) {\n\t        material = this._options.material;\n\t      } else {\n\t        material = new _three2['default'].LineBasicMaterial({\n\t          vertexColors: _three2['default'].VertexColors,\n\t          linewidth: style.lineWidth,\n\t          transparent: style.lineTransparent,\n\t          opacity: style.lineOpacity,\n\t          blending: style.lineBlending\n\t        });\n\t      }\n\t\n\t      var mesh;\n\t\n\t      // Pass mesh through callback, if defined\n\t      if (typeof this._options.onMesh === 'function') {\n\t        mesh = this._options.onMesh(geometry, material);\n\t      } else {\n\t        mesh = new _three2['default'].LineSegments(geometry, material);\n\t\n\t        if (style.lineRenderOrder !== undefined) {\n\t          material.depthWrite = false;\n\t          mesh.renderOrder = style.lineRenderOrder;\n\t        }\n\t\n\t        mesh.castShadow = true;\n\t        // mesh.receiveShadow = true;\n\t      }\n\t\n\t      // TODO: Allow this to be overridden, or copy mesh instead of creating a new\n\t      // one just for picking\n\t      if (this._options.interactive && this._pickingMesh) {\n\t        material = new _enginePickingMaterial2['default']();\n\t        // material.side = THREE.BackSide;\n\t\n\t        // Make the line wider / easier to pick\n\t        material.linewidth = style.lineWidth + material.linePadding;\n\t\n\t        var pickingMesh = new _three2['default'].LineSegments(geometry, material);\n\t        this._pickingMesh.add(pickingMesh);\n\t      }\n\t\n\t      this._mesh = mesh;\n\t    }\n\t\n\t    // Convert and project coordinates\n\t    //\n\t    // TODO: Calculate bounds\n\t  }, {\n\t    key: '_setCoordinates',\n\t    value: function _setCoordinates() {\n\t      this._bounds = [];\n\t      this._coordinates = this._convertCoordinates(this._coordinates);\n\t\n\t      this._projectedBounds = [];\n\t      this._projectedCoordinates = this._projectCoordinates();\n\t\n\t      this._center = this._coordinates[0][0];\n\t    }\n\t\n\t    // Recursively convert input coordinates into LatLon objects\n\t    //\n\t    // Calculate geographic bounds at the same time\n\t    //\n\t    // TODO: Calculate geographic bounds\n\t  }, {\n\t    key: '_convertCoordinates',\n\t    value: function _convertCoordinates(coordinates) {\n\t      return coordinates.map(function (_coordinates) {\n\t        return _coordinates.map(function (coordinate) {\n\t          return (0, _geoLatLon.latLon)(coordinate[1], coordinate[0]);\n\t        });\n\t      });\n\t    }\n\t\n\t    // Recursively project coordinates into world positions\n\t    //\n\t    // Calculate world bounds, offset and pointScale at the same time\n\t    //\n\t    // TODO: Calculate world bounds\n\t  }, {\n\t    key: '_projectCoordinates',\n\t    value: function _projectCoordinates() {\n\t      var _this3 = this;\n\t\n\t      var point;\n\t      return this._coordinates.map(function (_coordinates) {\n\t        return _coordinates.map(function (latlon) {\n\t          point = _this3._world.latLonToPoint(latlon);\n\t\n\t          // TODO: Is offset ever being used or needed?\n\t          if (!_this3._offset) {\n\t            _this3._offset = (0, _geoPoint.point)(0, 0);\n\t            _this3._offset.x = -1 * point.x;\n\t            _this3._offset.y = -1 * point.y;\n\t\n\t            _this3._pointScale = _this3._world.pointScale(latlon);\n\t          }\n\t\n\t          return point;\n\t        });\n\t      });\n\t    }\n\t\n\t    // Transform line representation into attribute arrays that can be used by\n\t    // THREE.BufferGeometry\n\t    //\n\t    // TODO: Can this be simplified? It's messy and huge\n\t  }, {\n\t    key: '_toAttributes',\n\t    value: function _toAttributes(line) {\n\t      // Three components per vertex\n\t      var vertices = new Float32Array(line.verticesCount * 3);\n\t      var colours = new Float32Array(line.verticesCount * 3);\n\t\n\t      var pickingIds;\n\t      if (line.pickingId) {\n\t        // One component per vertex\n\t        pickingIds = new Float32Array(line.verticesCount);\n\t      }\n\t\n\t      var _vertices = line.vertices;\n\t      var _colour = line.colours;\n\t\n\t      var normals;\n\t      var _normals;\n\t      if (line.normals) {\n\t        normals = new Float32Array(line.verticesCount * 3);\n\t        _normals = line.normals;\n\t      }\n\t\n\t      var _pickingId;\n\t      if (pickingIds) {\n\t        _pickingId = line.pickingId;\n\t      }\n\t\n\t      var lastIndex = 0;\n\t\n\t      for (var i = 0; i < _vertices.length; i++) {\n\t        var ax = _vertices[i][0];\n\t        var ay = _vertices[i][1];\n\t        var az = _vertices[i][2];\n\t\n\t        var nx;\n\t        var ny;\n\t        var nz;\n\t        if (_normals) {\n\t          nx = _normals[i][0];\n\t          ny = _normals[i][1];\n\t          nz = _normals[i][2];\n\t        }\n\t\n\t        var c1 = _colour[i];\n\t\n\t        vertices[lastIndex * 3 + 0] = ax;\n\t        vertices[lastIndex * 3 + 1] = ay;\n\t        vertices[lastIndex * 3 + 2] = az;\n\t\n\t        if (normals) {\n\t          normals[lastIndex * 3 + 0] = nx;\n\t          normals[lastIndex * 3 + 1] = ny;\n\t          normals[lastIndex * 3 + 2] = nz;\n\t        }\n\t\n\t        colours[lastIndex * 3 + 0] = c1[0];\n\t        colours[lastIndex * 3 + 1] = c1[1];\n\t        colours[lastIndex * 3 + 2] = c1[2];\n\t\n\t        if (pickingIds) {\n\t          pickingIds[lastIndex] = _pickingId;\n\t        }\n\t\n\t        lastIndex++;\n\t      }\n\t\n\t      var attributes = {\n\t        vertices: vertices,\n\t        colours: colours\n\t      };\n\t\n\t      if (normals) {\n\t        attributes.normals = normals;\n\t      }\n\t\n\t      if (pickingIds) {\n\t        attributes.pickingIds = pickingIds;\n\t      }\n\t\n\t      return attributes;\n\t    }\n\t\n\t    // Returns true if the line is flat (has no height)\n\t  }, {\n\t    key: 'isFlat',\n\t    value: function isFlat() {\n\t      return this._flat;\n\t    }\n\t\n\t    // Returns true if coordinates refer to a single geometry\n\t    //\n\t    // For example, not coordinates for a MultiLineString GeoJSON feature\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      if (this._pickingMesh) {\n\t        // TODO: Properly dispose of picking mesh\n\t        this._pickingMesh = null;\n\t      }\n\t\n\t      this.clearCoordinates();\n\t      this.clearBufferAttributes();\n\t\n\t      // Run common destruction logic from parent\n\t      _get(Object.getPrototypeOf(PolylineLayer.prototype), 'destroy', this).call(this);\n\t    }\n\t  }], [{\n\t    key: 'isSingle',\n\t    value: function isSingle(coordinates) {\n\t      return !Array.isArray(coordinates[0][0]);\n\t    }\n\t  }]);\n\t\n\t  return PolylineLayer;\n\t})(_Layer3['default']);\n\t\n\texports['default'] = PolylineLayer;\n\t\n\tvar noNew = function noNew(coordinates, options) {\n\t  return new PolylineLayer(coordinates, options);\n\t};\n\t\n\texports.polylineLayer = noNew;\n\n/***/ },\n/* 71 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// TODO: Move duplicated logic between geometry layrs into GeometryLayer\n\t\n\t// TODO: Look at ways to drop unneeded references to array buffers, etc to\n\t// reduce memory footprint\n\t\n\t// TODO: Point features may be using custom models / meshes and so an approach\n\t// needs to be found to allow these to be brokwn down into buffer attributes for\n\t// merging\n\t//\n\t// Can probably use fromGeometry() or setFromObject() from THREE.BufferGeometry\n\t// and pull out the attributes\n\t\n\t// TODO: Support sprite objects using textures\n\t\n\t// TODO: Provide option to billboard geometry so it always faces the camera\n\t\n\t// TODO: Support dynamic updating / hiding / animation of geometry\n\t//\n\t// This could be pretty hard as it's all packed away within BufferGeometry and\n\t// may even be merged by another layer (eg. GeoJSONLayer)\n\t//\n\t// How much control should this layer support? Perhaps a different or custom\n\t// layer would be better suited for animation, for example.\n\t\n\tvar _Layer2 = __webpack_require__(30);\n\t\n\tvar _Layer3 = _interopRequireDefault(_Layer2);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _geoLatLon = __webpack_require__(5);\n\t\n\tvar _geoPoint = __webpack_require__(6);\n\t\n\tvar _enginePickingMaterial = __webpack_require__(67);\n\t\n\tvar _enginePickingMaterial2 = _interopRequireDefault(_enginePickingMaterial);\n\t\n\tvar _utilBuffer = __webpack_require__(66);\n\t\n\tvar _utilBuffer2 = _interopRequireDefault(_utilBuffer);\n\t\n\tvar PointLayer = (function (_Layer) {\n\t  _inherits(PointLayer, _Layer);\n\t\n\t  function PointLayer(coordinates, options) {\n\t    _classCallCheck(this, PointLayer);\n\t\n\t    var defaults = {\n\t      output: true,\n\t      interactive: false,\n\t      // THREE.Geometry or THREE.BufferGeometry to use for point output\n\t      geometry: null,\n\t      // Custom material override\n\t      //\n\t      // TODO: Should this be in the style object?\n\t      material: null,\n\t      onMesh: null,\n\t      // This default style is separate to Util.GeoJSON.defaultStyle\n\t      style: {\n\t        pointColor: '#ff0000'\n\t      }\n\t    };\n\t\n\t    var _options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    _get(Object.getPrototypeOf(PointLayer.prototype), 'constructor', this).call(this, _options);\n\t\n\t    // Return coordinates as array of points so it's easy to support\n\t    // MultiPoint features (a single point would be a MultiPoint with a\n\t    // single point in the array)\n\t    this._coordinates = PointLayer.isSingle(coordinates) ? [coordinates] : coordinates;\n\t\n\t    // Point features are always flat (for now at least)\n\t    //\n\t    // This won't always be the case once custom point objects / meshes are\n\t    // added\n\t    this._flat = true;\n\t  }\n\t\n\t  _createClass(PointLayer, [{\n\t    key: '_onAdd',\n\t    value: function _onAdd(world) {\n\t      this._setCoordinates();\n\t\n\t      if (this._options.interactive) {\n\t        // Only add to picking mesh if this layer is controlling output\n\t        //\n\t        // Otherwise, assume another component will eventually add a mesh to\n\t        // the picking scene\n\t        if (this.isOutput()) {\n\t          this._pickingMesh = new _three2['default'].Object3D();\n\t          this.addToPicking(this._pickingMesh);\n\t        }\n\t\n\t        this._setPickingId();\n\t        this._addPickingEvents();\n\t      }\n\t\n\t      // Store geometry representation as instances of THREE.BufferAttribute\n\t      this._setBufferAttributes();\n\t\n\t      if (this.isOutput()) {\n\t        // Set mesh if not merging elsewhere\n\t        this._setMesh(this._bufferAttributes);\n\t\n\t        // Output mesh\n\t        this.add(this._mesh);\n\t      }\n\t    }\n\t\n\t    // Return center of point as a LatLon\n\t    //\n\t    // This is used for things like placing popups / UI elements on the layer\n\t  }, {\n\t    key: 'getCenter',\n\t    value: function getCenter() {\n\t      return this._center;\n\t    }\n\t\n\t    // Return point bounds in geographic coordinates\n\t    //\n\t    // While not useful for single points, it could be useful for MultiPoint\n\t    //\n\t    // TODO: Implement getBounds()\n\t  }, {\n\t    key: 'getBounds',\n\t    value: function getBounds() {}\n\t\n\t    // Get unique ID for picking interaction\n\t  }, {\n\t    key: '_setPickingId',\n\t    value: function _setPickingId() {\n\t      this._pickingId = this.getPickingId();\n\t    }\n\t\n\t    // Set up and re-emit interaction events\n\t  }, {\n\t    key: '_addPickingEvents',\n\t    value: function _addPickingEvents() {\n\t      var _this = this;\n\t\n\t      // TODO: Find a way to properly remove this listener on destroy\n\t      this._world.on('pick-' + this._pickingId, function (point2d, point3d, intersects) {\n\t        // Re-emit click event from the layer\n\t        _this.emit('click', _this, point2d, point3d, intersects);\n\t      });\n\t    }\n\t\n\t    // Create and store reference to THREE.BufferAttribute data for this layer\n\t  }, {\n\t    key: '_setBufferAttributes',\n\t    value: function _setBufferAttributes() {\n\t      var _this2 = this;\n\t\n\t      var height = 0;\n\t\n\t      // Convert height into world units\n\t      if (this._options.style.pointHeight) {\n\t        height = this._world.metresToWorld(this._options.style.pointHeight, this._pointScale);\n\t      }\n\t\n\t      var colour = new _three2['default'].Color();\n\t      colour.set(this._options.style.pointColor);\n\t\n\t      var geometry;\n\t\n\t      // Use default geometry if none has been provided or the provided geometry\n\t      // isn't valid\n\t      if (!this._options.geometry || !this._options.geometry instanceof _three2['default'].Geometry || !this._options.geometry instanceof _three2['default'].BufferGeometry) {\n\t        // Debug geometry for points is a thin bar\n\t        //\n\t        // TODO: Allow point geometry to be customised / overridden\n\t        var geometryWidth = this._world.metresToWorld(25, this._pointScale);\n\t        var geometryHeight = this._world.metresToWorld(200, this._pointScale);\n\t        var _geometry = new _three2['default'].BoxGeometry(geometryWidth, geometryHeight, geometryWidth);\n\t\n\t        // Shift geometry up so it sits on the ground\n\t        _geometry.translate(0, geometryHeight * 0.5, 0);\n\t\n\t        // Pull attributes out of debug geometry\n\t        geometry = new _three2['default'].BufferGeometry().fromGeometry(_geometry);\n\t      } else {\n\t        if (this._options.geometry instanceof _three2['default'].BufferGeometry) {\n\t          geometry = this._options.geometry;\n\t        } else {\n\t          geometry = new _three2['default'].BufferGeometry().fromGeometry(this._options.geometry);\n\t        }\n\t      }\n\t\n\t      // For each point\n\t      var attributes = this._projectedCoordinates.map(function (coordinate) {\n\t        var _vertices = [];\n\t        var _normals = [];\n\t        var _colours = [];\n\t\n\t        var _geometry = geometry.clone();\n\t\n\t        _geometry.translate(coordinate.x, height, coordinate.y);\n\t\n\t        var _vertices = _geometry.attributes.position.clone().array;\n\t        var _normals = _geometry.attributes.normal.clone().array;\n\t        var _colours = _geometry.attributes.color.clone().array;\n\t\n\t        for (var i = 0; i < _colours.length; i += 3) {\n\t          _colours[i] = colour.r;\n\t          _colours[i + 1] = colour.g;\n\t          _colours[i + 2] = colour.b;\n\t        }\n\t\n\t        var _point = {\n\t          vertices: _vertices,\n\t          normals: _normals,\n\t          colours: _colours\n\t        };\n\t\n\t        if (_this2._options.interactive && _this2._pickingId) {\n\t          // Inject picking ID\n\t          // point.pickingId = this._pickingId;\n\t          _point.pickingIds = new Float32Array(_vertices.length / 3);\n\t          for (var i = 0; i < _point.pickingIds.length; i++) {\n\t            _point.pickingIds[i] = _this2._pickingId;\n\t          }\n\t        }\n\t\n\t        // Convert point representation to proper attribute arrays\n\t        // return this._toAttributes(_point);\n\t        return _point;\n\t      });\n\t\n\t      this._bufferAttributes = _utilBuffer2['default'].mergeAttributes(attributes);\n\t\n\t      // Original attributes are no longer required so free the memory\n\t      attributes = null;\n\t    }\n\t  }, {\n\t    key: 'getBufferAttributes',\n\t    value: function getBufferAttributes() {\n\t      return this._bufferAttributes;\n\t    }\n\t\n\t    // Used by external components to clear some memory when the attributes\n\t    // are no longer required to be stored in this layer\n\t    //\n\t    // For example, you would want to clear the attributes here after merging them\n\t    // using something like the GeoJSONLayer\n\t  }, {\n\t    key: 'clearBufferAttributes',\n\t    value: function clearBufferAttributes() {\n\t      this._bufferAttributes = null;\n\t    }\n\t\n\t    // Used by external components to clear some memory when the coordinates\n\t    // are no longer required to be stored in this layer\n\t    //\n\t    // For example, you would want to clear the coordinates here after this\n\t    // layer is merged in something like the GeoJSONLayer\n\t  }, {\n\t    key: 'clearCoordinates',\n\t    value: function clearCoordinates() {\n\t      this._coordinates = null;\n\t      this._projectedCoordinates = null;\n\t    }\n\t\n\t    // Create and store mesh from buffer attributes\n\t    //\n\t    // This is only called if the layer is controlling its own output\n\t  }, {\n\t    key: '_setMesh',\n\t    value: function _setMesh(attributes) {\n\t      var geometry = new _three2['default'].BufferGeometry();\n\t\n\t      // itemSize = 3 because there are 3 values (components) per vertex\n\t      geometry.addAttribute('position', new _three2['default'].BufferAttribute(attributes.vertices, 3));\n\t      geometry.addAttribute('normal', new _three2['default'].BufferAttribute(attributes.normals, 3));\n\t      geometry.addAttribute('color', new _three2['default'].BufferAttribute(attributes.colours, 3));\n\t\n\t      if (attributes.pickingIds) {\n\t        geometry.addAttribute('pickingId', new _three2['default'].BufferAttribute(attributes.pickingIds, 1));\n\t      }\n\t\n\t      geometry.computeBoundingBox();\n\t\n\t      var material;\n\t\n\t      if (this._options.material && this._options.material instanceof _three2['default'].Material) {\n\t        material = this._options.material;\n\t      } else if (!this._world._environment._skybox) {\n\t        material = new _three2['default'].MeshBasicMaterial({\n\t          vertexColors: _three2['default'].VertexColors\n\t          // side: THREE.BackSide\n\t        });\n\t      } else {\n\t          material = new _three2['default'].MeshStandardMaterial({\n\t            vertexColors: _three2['default'].VertexColors\n\t            // side: THREE.BackSide\n\t          });\n\t          material.roughness = 1;\n\t          material.metalness = 0.1;\n\t          material.envMapIntensity = 3;\n\t          material.envMap = this._world._environment._skybox.getRenderTarget();\n\t        }\n\t\n\t      var mesh;\n\t\n\t      // Pass mesh through callback, if defined\n\t      if (typeof this._options.onMesh === 'function') {\n\t        mesh = this._options.onMesh(geometry, material);\n\t      } else {\n\t        mesh = new _three2['default'].Mesh(geometry, material);\n\t\n\t        mesh.castShadow = true;\n\t        // mesh.receiveShadow = true;\n\t      }\n\t\n\t      if (this._options.interactive && this._pickingMesh) {\n\t        material = new _enginePickingMaterial2['default']();\n\t        // material.side = THREE.BackSide;\n\t\n\t        var pickingMesh = new _three2['default'].Mesh(geometry, material);\n\t        this._pickingMesh.add(pickingMesh);\n\t      }\n\t\n\t      this._mesh = mesh;\n\t    }\n\t\n\t    // Convert and project coordinates\n\t    //\n\t    // TODO: Calculate bounds\n\t  }, {\n\t    key: '_setCoordinates',\n\t    value: function _setCoordinates() {\n\t      this._bounds = [];\n\t      this._coordinates = this._convertCoordinates(this._coordinates);\n\t\n\t      this._projectedBounds = [];\n\t      this._projectedCoordinates = this._projectCoordinates();\n\t\n\t      this._center = this._coordinates;\n\t    }\n\t\n\t    // Recursively convert input coordinates into LatLon objects\n\t    //\n\t    // Calculate geographic bounds at the same time\n\t    //\n\t    // TODO: Calculate geographic bounds\n\t  }, {\n\t    key: '_convertCoordinates',\n\t    value: function _convertCoordinates(coordinates) {\n\t      return coordinates.map(function (coordinate) {\n\t        return (0, _geoLatLon.latLon)(coordinate[1], coordinate[0]);\n\t      });\n\t    }\n\t\n\t    // Recursively project coordinates into world positions\n\t    //\n\t    // Calculate world bounds, offset and pointScale at the same time\n\t    //\n\t    // TODO: Calculate world bounds\n\t  }, {\n\t    key: '_projectCoordinates',\n\t    value: function _projectCoordinates() {\n\t      var _this3 = this;\n\t\n\t      var _point;\n\t      return this._coordinates.map(function (latlon) {\n\t        _point = _this3._world.latLonToPoint(latlon);\n\t\n\t        // TODO: Is offset ever being used or needed?\n\t        if (!_this3._offset) {\n\t          _this3._offset = (0, _geoPoint.point)(0, 0);\n\t          _this3._offset.x = -1 * _point.x;\n\t          _this3._offset.y = -1 * _point.y;\n\t\n\t          _this3._pointScale = _this3._world.pointScale(latlon);\n\t        }\n\t\n\t        return _point;\n\t      });\n\t    }\n\t\n\t    // Transform line representation into attribute arrays that can be used by\n\t    // THREE.BufferGeometry\n\t    //\n\t    // TODO: Can this be simplified? It's messy and huge\n\t  }, {\n\t    key: '_toAttributes',\n\t    value: function _toAttributes(line) {\n\t      // Three components per vertex\n\t      var vertices = new Float32Array(line.verticesCount * 3);\n\t      var colours = new Float32Array(line.verticesCount * 3);\n\t\n\t      var pickingIds;\n\t      if (line.pickingId) {\n\t        // One component per vertex\n\t        pickingIds = new Float32Array(line.verticesCount);\n\t      }\n\t\n\t      var _vertices = line.vertices;\n\t      var _colour = line.colours;\n\t\n\t      var _pickingId;\n\t      if (pickingIds) {\n\t        _pickingId = line.pickingId;\n\t      }\n\t\n\t      var lastIndex = 0;\n\t\n\t      for (var i = 0; i < _vertices.length; i++) {\n\t        var ax = _vertices[i][0];\n\t        var ay = _vertices[i][1];\n\t        var az = _vertices[i][2];\n\t\n\t        var c1 = _colour[i];\n\t\n\t        vertices[lastIndex * 3 + 0] = ax;\n\t        vertices[lastIndex * 3 + 1] = ay;\n\t        vertices[lastIndex * 3 + 2] = az;\n\t\n\t        colours[lastIndex * 3 + 0] = c1[0];\n\t        colours[lastIndex * 3 + 1] = c1[1];\n\t        colours[lastIndex * 3 + 2] = c1[2];\n\t\n\t        if (pickingIds) {\n\t          pickingIds[lastIndex] = _pickingId;\n\t        }\n\t\n\t        lastIndex++;\n\t      }\n\t\n\t      var attributes = {\n\t        vertices: vertices,\n\t        colours: colours\n\t      };\n\t\n\t      if (pickingIds) {\n\t        attributes.pickingIds = pickingIds;\n\t      }\n\t\n\t      return attributes;\n\t    }\n\t\n\t    // Returns true if the line is flat (has no height)\n\t  }, {\n\t    key: 'isFlat',\n\t    value: function isFlat() {\n\t      return this._flat;\n\t    }\n\t\n\t    // Returns true if coordinates refer to a single geometry\n\t    //\n\t    // For example, not coordinates for a MultiPoint GeoJSON feature\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      if (this._pickingMesh) {\n\t        // TODO: Properly dispose of picking mesh\n\t        this._pickingMesh = null;\n\t      }\n\t\n\t      this.clearCoordinates();\n\t      this.clearBufferAttributes();\n\t\n\t      // Run common destruction logic from parent\n\t      _get(Object.getPrototypeOf(PointLayer.prototype), 'destroy', this).call(this);\n\t    }\n\t  }], [{\n\t    key: 'isSingle',\n\t    value: function isSingle(coordinates) {\n\t      return !Array.isArray(coordinates[0]);\n\t    }\n\t  }]);\n\t\n\t  return PointLayer;\n\t})(_Layer3['default']);\n\t\n\texports['default'] = PointLayer;\n\t\n\tvar noNew = function noNew(coordinates, options) {\n\t  return new PointLayer(coordinates, options);\n\t};\n\t\n\texports.pointLayer = noNew;\n\n/***/ },\n/* 72 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _GeoJSONTileLayer2 = __webpack_require__(54);\n\t\n\tvar _GeoJSONTileLayer3 = _interopRequireDefault(_GeoJSONTileLayer2);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar TopoJSONTileLayer = (function (_GeoJSONTileLayer) {\n\t  _inherits(TopoJSONTileLayer, _GeoJSONTileLayer);\n\t\n\t  function TopoJSONTileLayer(path, options) {\n\t    _classCallCheck(this, TopoJSONTileLayer);\n\t\n\t    var defaults = {\n\t      topojson: true\n\t    };\n\t\n\t    options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    _get(Object.getPrototypeOf(TopoJSONTileLayer.prototype), 'constructor', this).call(this, path, options);\n\t  }\n\t\n\t  return TopoJSONTileLayer;\n\t})(_GeoJSONTileLayer3['default']);\n\t\n\texports['default'] = TopoJSONTileLayer;\n\t\n\tvar noNew = function noNew(path, options) {\n\t  return new TopoJSONTileLayer(path, options);\n\t};\n\t\n\texports.topoJSONTileLayer = noNew;\n\n/***/ },\n/* 73 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _GeoJSONLayer2 = __webpack_require__(56);\n\t\n\tvar _GeoJSONLayer3 = _interopRequireDefault(_GeoJSONLayer2);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar TopoJSONLayer = (function (_GeoJSONLayer) {\n\t  _inherits(TopoJSONLayer, _GeoJSONLayer);\n\t\n\t  function TopoJSONLayer(topojson, options) {\n\t    _classCallCheck(this, TopoJSONLayer);\n\t\n\t    var defaults = {\n\t      topojson: true\n\t    };\n\t\n\t    options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    _get(Object.getPrototypeOf(TopoJSONLayer.prototype), 'constructor', this).call(this, topojson, options);\n\t  }\n\t\n\t  return TopoJSONLayer;\n\t})(_GeoJSONLayer3['default']);\n\t\n\texports['default'] = TopoJSONLayer;\n\t\n\tvar noNew = function noNew(topojson, options) {\n\t  return new TopoJSONLayer(topojson, options);\n\t};\n\t\n\t// Initialise without requiring new keyword\n\texports.topoJSONLayer = noNew;\n\n/***/ },\n/* 74 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t/**\n\t * Created by masayuki on 20/07/2016.\n\t */\n\t\n\tvar _SimObjectLayer2 = __webpack_require__(75);\n\t\n\tvar _SimObjectLayer3 = _interopRequireDefault(_SimObjectLayer2);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _ModelRepository = __webpack_require__(85);\n\t\n\tvar _ModelRepository2 = _interopRequireDefault(_ModelRepository);\n\t\n\tvar _PedestrianModel = __webpack_require__(86);\n\t\n\tvar _PedestrianModel2 = _interopRequireDefault(_PedestrianModel);\n\t\n\tvar _Pedestrian = __webpack_require__(88);\n\t\n\tvar _Pedestrian2 = _interopRequireDefault(_Pedestrian);\n\t\n\tvar MODEL_PREFIX = 'pedestrian:';\n\t\n\tvar PedestrianLayer = (function (_SimObjectLayer) {\n\t  _inherits(PedestrianLayer, _SimObjectLayer);\n\t\n\t  function PedestrianLayer(models, options) {\n\t    _classCallCheck(this, PedestrianLayer);\n\t\n\t    var defaults = {\n\t      output: true\n\t    };\n\t\n\t    var _options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    _get(Object.getPrototypeOf(PedestrianLayer.prototype), 'constructor', this).call(this, _options);\n\t\n\t    var modelDefaults = {\n\t      file: {\n\t        body: null\n\t      },\n\t      scale: 1,\n\t      translation: { x: 0, y: 0, z: 0 },\n\t      rotation: { rx: 0, ry: 0, rz: 0 }\n\t    };\n\t    for (key in models) {\n\t      models[key] = (0, _lodashAssign2['default'])({}, modelDefaults, models[key]);\n\t    }\n\t\n\t    this._modelsLoaded = false;\n\t    this._models = (0, _lodashAssign2['default'])({}, models);\n\t    this._entries = [];\n\t  }\n\t\n\t  _createClass(PedestrianLayer, [{\n\t    key: '_onAdd',\n\t    value: function _onAdd(world) {\n\t      _get(Object.getPrototypeOf(PedestrianLayer.prototype), '_onAdd', this).call(this, world);\n\t\n\t      if (this.isOutput()) {\n\t        // add callback\n\t        this.on('loadCompleted', this._onLoadCompleted);\n\t\n\t        // load models\n\t        this._loadModels();\n\t      }\n\t    }\n\t  }, {\n\t    key: '_loadModels',\n\t    value: function _loadModels() {\n\t      var self = this;\n\t\n\t      // load models iteratively\n\t      var models = this._models;\n\t      Object.keys(models).forEach(function (modelName) {\n\t        var model = models[modelName];\n\t\n\t        var scale = 1.0;\n\t        var translation = new _three2['default'].Vector3();\n\t        var rotation = new _three2['default'].Vector3();\n\t\n\t        if (model.scale) {\n\t          scale = model.scale;\n\t        }\n\t        if (model.translation) {\n\t          translation.set(model.translation.x, model.translation.y, model.translation.z);\n\t        }\n\t        if (model.rotation) {\n\t          rotation.set(model.rotation.x, model.rotation.y, model.rotation.z);\n\t        }\n\t\n\t        // create a model\n\t        var pedestrianModel = new _PedestrianModel2['default']({\n\t          bodyURL: model.file.body,\n\t          scale: scale,\n\t          translation: translation,\n\t          rotation: rotation\n\t        }, callback);\n\t\n\t        // register to the repos\n\t        _ModelRepository2['default'].add(MODEL_PREFIX + modelName, pedestrianModel);\n\t      });\n\t\n\t      // callback\n\t      var counter = 0;\n\t      var len = Object.keys(models).length;\n\t      function callback(scope) {\n\t        if (++counter >= len) {\n\t          // loaded all models\n\t          self.emit('loadCompleted');\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: '_onLoadCompleted',\n\t    value: function _onLoadCompleted() {\n\t      this._modelsLoaded = true;\n\t\n\t      // iterate over all the pedestrians already added and add meshes to the world\n\t      for (var i = 0; i < this._entries.length; i++) {\n\t        var entry = this._entries[i];\n\t        if (entry.pedestrian === null) {\n\t          this._addPedestrianInternal(entry);\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'addPedestrian',\n\t    value: function addPedestrian(modelName, latlon, angle, options) {\n\t      if (!_ModelRepository2['default'].contains(MODEL_PREFIX + modelName)) {\n\t        throw new Error('Pedestrian model ' + modelName + ' does not exist.');\n\t      }\n\t\n\t      var self = this;\n\t\n\t      var entry = {\n\t        id: undefined,\n\t        modelName: modelName,\n\t        latlon: latlon,\n\t        angle: angle,\n\t        options: options,\n\t        pedestrian: null\n\t      };\n\t      var total = this._entries.push(entry);\n\t      entry.id = total - 1;\n\t\n\t      // add pedestrian if the model is already loaded\n\t      this._addPedestrianInternal(entry);\n\t\n\t      return entry;\n\t    }\n\t  }, {\n\t    key: '_addPedestrianInternal',\n\t    value: function _addPedestrianInternal(entry) {\n\t      if (this._modelsLoaded) {\n\t\n\t        // instantiate the pedestrian\n\t        var pedestrianModel = _ModelRepository2['default'].get(MODEL_PREFIX + entry.modelName);\n\t        var pedestrian = new _Pedestrian2['default'](pedestrianModel);\n\t\n\t        // add the pedestrian to the layer\n\t        this.add(pedestrian);\n\t        entry.pedestrian = pedestrian;\n\t\n\t        // set the pedestrian's location\n\t        this.setLocation(entry.id, entry.latlon.lat, entry.latlon.lon, entry.angle);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getPedestrian',\n\t    value: function getPedestrian(id) {\n\t      if (id in this._entries) {\n\t        return this._entries[id];\n\t      }\n\t      return null;\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      // Run common destruction logic from parent\n\t      _get(Object.getPrototypeOf(PedestrianLayer.prototype), 'destroy', this).call(this);\n\t    }\n\t  }]);\n\t\n\t  return PedestrianLayer;\n\t})(_SimObjectLayer3['default']);\n\t\n\texports['default'] = PedestrianLayer;\n\t\n\tvar noNew = function noNew(models, options) {\n\t  return new PedestrianLayer(models, options);\n\t};\n\t\n\texports.pedestrianLayer = noNew;\n\n/***/ },\n/* 75 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _Layer2 = __webpack_require__(30);\n\t\n\tvar _Layer3 = _interopRequireDefault(_Layer2);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _geoLatLon = __webpack_require__(5);\n\t\n\tvar _geoPoint = __webpack_require__(6);\n\t\n\tvar _earcut = __webpack_require__(64);\n\t\n\tvar _earcut2 = _interopRequireDefault(_earcut);\n\t\n\tvar _utilExtrudePolygon = __webpack_require__(65);\n\t\n\tvar _utilExtrudePolygon2 = _interopRequireDefault(_utilExtrudePolygon);\n\t\n\tvar _utilBuffer = __webpack_require__(66);\n\t\n\tvar _utilBuffer2 = _interopRequireDefault(_utilBuffer);\n\t\n\tvar _vendorGPUComputationRenderer = __webpack_require__(76);\n\t\n\tvar _vendorGPUComputationRenderer2 = _interopRequireDefault(_vendorGPUComputationRenderer);\n\t\n\tvar _SimObject = __webpack_require__(77);\n\t\n\tvar _SimObject2 = _interopRequireDefault(_SimObject);\n\t\n\tvar _VehicleVelocityShader = __webpack_require__(78);\n\t\n\tvar _VehicleVelocityShader2 = _interopRequireDefault(_VehicleVelocityShader);\n\t\n\tvar _VehiclePositionShader = __webpack_require__(79);\n\t\n\tvar _VehiclePositionShader2 = _interopRequireDefault(_VehiclePositionShader);\n\t\n\tvar _VehicleShader = __webpack_require__(80);\n\t\n\tvar _VehicleShader2 = _interopRequireDefault(_VehicleShader);\n\t\n\tvar _utilObjectUtils = __webpack_require__(81);\n\t\n\tvar _utilObjectUtils2 = _interopRequireDefault(_utilObjectUtils);\n\t\n\t/**\n\t * Object Layer that supports GPGPU object extrapolations\n\t */\n\t\n\tvar SimObjectLayer = (function (_Layer) {\n\t  _inherits(SimObjectLayer, _Layer);\n\t\n\t  function SimObjectLayer(options) {\n\t    _classCallCheck(this, SimObjectLayer);\n\t\n\t    var defaults = {\n\t      output: true,\n\t      dynamic: true, // indicates if each object needs to be updated in every frame update\n\t      // simulation:\n\t      enableGpuComputation: false,\n\t      simWidth: 2\n\t    };\n\t\n\t    var _options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    _get(Object.getPrototypeOf(SimObjectLayer.prototype), 'constructor', this).call(this, _options);\n\t\n\t    this._simObjects = [];\n\t    this._gpuCompute = null;\n\t  }\n\t\n\t  _createClass(SimObjectLayer, [{\n\t    key: '_initComputeRenderer',\n\t    value: function _initComputeRenderer(world) {\n\t      var gpuCompute = new _vendorGPUComputationRenderer2['default'](this._options.simWidth, this._options.simWidth, world._engine._renderer);\n\t\n\t      // create textures\n\t      var textureAcceleration = gpuCompute.createTexture();\n\t      var textureVelocity = gpuCompute.createTexture();\n\t      var texturePosition = gpuCompute.createTexture();\n\t\n\t      var velocityVariable = gpuCompute.addVariable('textureVelocity', _VehicleVelocityShader2['default'], textureVelocity);\n\t      var positionVariable = gpuCompute.addVariable('texturePosition', _VehiclePositionShader2['default'], texturePosition);\n\t\n\t      gpuCompute.setVariableDependencies(velocityVariable, [positionVariable, velocityVariable]);\n\t      gpuCompute.setVariableDependencies(positionVariable, [positionVariable, velocityVariable]);\n\t\n\t      var positionUniforms = positionVariable.material.uniforms;\n\t      var velocityUniforms = velocityVariable.material.uniforms;\n\t\n\t      velocityVariable.wrapS = _three2['default'].RepeatWrapping;\n\t      velocityVariable.wrapT = _three2['default'].RepeatWrapping;\n\t      positionVariable.wrapS = _three2['default'].RepeatWrapping;\n\t      positionVariable.wrapT = _three2['default'].RepeatWrapping;\n\t\n\t      velocityUniforms.textureAcceleration.value = textureAcceleration;\n\t\n\t      var error = gpuCompute.init();\n\t      if (error !== null) {\n\t        console.error(error);\n\t      }\n\t\n\t      this._gpuCompute = gpuCompute;\n\t      this._textureAcceleration = textureAcceleration;\n\t      this._textureVelocity = textureVelocity;\n\t      this._texturePosition = texturePosition;\n\t      this._positionVariable = positionVariable;\n\t      this._velocityVariable = velocityVariable;\n\t      this._positionUniforms = positionUniforms;\n\t      this._velocityUniforms = velocityUniforms;\n\t    }\n\t\n\t    // add SimObject\n\t  }, {\n\t    key: 'add',\n\t    value: function add(simObject) {\n\t      // push to the array\n\t      var total = this._simObjects.push(simObject);\n\t      simObject.id = total - 1;\n\t\n\t      // enable cpu update if necessary\n\t      simObject.updatePosition = this._options.dynamic && !this._options.enableGpuComputation;\n\t\n\t      // add Object3D to the layer\n\t      _get(Object.getPrototypeOf(SimObjectLayer.prototype), 'add', this).call(this, simObject.root);\n\t\n\t      // add CSS2DObject to the DOM2D layer\n\t      this.addDOM2D(simObject.label);\n\t    }\n\t\n\t    // remove SimObject\n\t  }, {\n\t    key: 'remove',\n\t    value: function remove(simObject) {\n\t      // remove from the array\n\t      this._simObjects.splice(this._simObjects.indexOf(simObject), 1);\n\t\n\t      // remove Object3D from the layer\n\t      _get(Object.getPrototypeOf(SimObjectLayer.prototype), 'remove', this).call(this, simObject.root);\n\t\n\t      // remove CSS2DObject from the DOM2D layer\n\t      this.removeDOM2D(simObject.label);\n\t    }\n\t  }, {\n\t    key: '_onAdd',\n\t    value: function _onAdd(world) {\n\t      _get(Object.getPrototypeOf(SimObjectLayer.prototype), '_onAdd', this).call(this, world);\n\t\n\t      var self = this;\n\t\n\t      if (this.isOutput()) {\n\t        if (this._options.enableGpuComputation) {\n\t          // initialize GPUComputationRenderer\n\t          this._initComputeRenderer(world);\n\t        }\n\t\n\t        // add listener\n\t        world.on('preUpdate', function (delta) {\n\t          self._onWorldUpdate(delta);\n\t        });\n\t      }\n\t    }\n\t  }, {\n\t    key: '_onWorldUpdate',\n\t    value: function _onWorldUpdate(delta) {\n\t      this._performUpdate(delta);\n\t      this._performSimUpdate(delta);\n\t    }\n\t  }, {\n\t    key: '_performUpdate',\n\t    value: function _performUpdate(delta) {\n\t      for (var i = 0; i < this._simObjects.length; i++) {\n\t        this._simObjects[i].update(delta);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_performSimUpdate',\n\t    value: function _performSimUpdate(delta) {\n\t      if (this._gpuCompute) {\n\t        var now = performance.now();\n\t\n\t        this._positionUniforms.time.value = now;\n\t        this._positionUniforms.delta.value = delta;\n\t        this._velocityUniforms.time.value = now;\n\t        this._velocityUniforms.delta.value = delta;\n\t\n\t        this._gpuCompute.compute();\n\t\n\t        // transfer objects' velocity parameters from gpu to cpu\n\t        var texturePosition = this._gpuCompute.readVariable(this._positionVariable, this._texturePosition);\n\t        var textureVelocity = this._gpuCompute.readVariable(this._velocityVariable, this._textureVelocity);\n\t        for (var i = 0; i < this._simObjects.length; i++) {\n\t          var object = this._simObjects[i];\n\t\n\t          var x = texturePosition.image.data[i * 4 + 0];\n\t          var y = texturePosition.image.data[i * 4 + 1];\n\t          var z = texturePosition.image.data[i * 4 + 2];\n\t          var angle = texturePosition.image.data[i * 4 + 3];\n\t          var velocity = textureVelocity.image.data[i * 4 + 0];\n\t\n\t          object.setPosition(x, y, z);\n\t          object.setAngle(-angle);\n\t          object.setVelocity(velocity);\n\t        }\n\t\n\t        // (for gpgpu rendering (no transfer to cpu))\n\t        // for (var i = 0; i < this._vehicles.length; i++) {\n\t        //   var vehicle = this._vehicles[i];\n\t        //   if (vehicle.mesh) {\n\t        //     vehicle.mesh.material.uniforms.texturePosition.value = this._gpuCompute.getCurrentRenderTarget(this._positionVariable).texture;\n\t        //     if (vehicle.mesh.material.uniforms.texture) {\n\t        //       vehicle.mesh.material.uniforms.texture.value = this._textures[vehicle.modelName];\n\t        //     }\n\t        //   }\n\t        // }\n\t      }\n\t    }\n\t\n\t    /**\n\t     * Set the location of a specific object\n\t     *\n\t     * @param {number} id SimObject id\n\t     * @param {number} lat latitude\n\t     * @param {number} lon longitude\n\t     * @param {number} angle angle\n\t     */\n\t  }, {\n\t    key: 'setLocation',\n\t    value: function setLocation(id, lat, lon, angle) {\n\t      // calculate the position\n\t      var point = this._world.latLonToPoint((0, _geoLatLon.latLon)(lat, lon));\n\t      this.setPosition(id, point.x, 0, point.y, angle);\n\t    }\n\t\n\t    /**\n\t     * Set the position of a specific object\n\t     *\n\t     * @param {number} id SimObject id\n\t     * @param {number} x x\n\t     * @param {number} y y\n\t     * @param {number} z z\n\t     * @param {number} angle angle\n\t     */\n\t  }, {\n\t    key: 'setPosition',\n\t    value: function setPosition(id, x, y, z, angle) {\n\t      this._setPosition(id, x, y, z, angle);\n\t      this._setSimPosition(id, x, y, z, angle);\n\t    }\n\t  }, {\n\t    key: '_setPosition',\n\t    value: function _setPosition(id, x, y, z, angle) {\n\t      // if the vehicle exists\n\t      if (id in this._simObjects) {\n\t        var simObject = this._simObjects[id];\n\t\n\t        // update the vehicle\n\t        simObject.setPosition(x, y, z);\n\t        simObject.setAngle(angle);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_setSimPosition',\n\t    value: function _setSimPosition(id, x, y, z, angle) {\n\t      if (this._gpuCompute) {\n\t        console.log('_setSimPosition: ' + id + ', ' + x + ', ' + y + ', ' + z + ', ' + angle + ')');\n\t\n\t        // transmit from gpu to cpu\n\t        var texturePosition = this._gpuCompute.readVariable(this._positionVariable, this._texturePosition);\n\t\n\t        // (for extrapolation) update data\n\t        texturePosition.image.data[id * 4 + 0] = x;\n\t        texturePosition.image.data[id * 4 + 1] = y;\n\t        texturePosition.image.data[id * 4 + 2] = z;\n\t        texturePosition.image.data[id * 4 + 3] = angle;\n\t        texturePosition.needsUpdate = true;\n\t\n\t        // transmit from cpu to gpu\n\t        this._gpuCompute.updateVariable(this._positionVariable, texturePosition);\n\t      }\n\t    }\n\t\n\t    /**\n\t     * Set the velocity of a specific object\n\t     *\n\t     * @param {number} id SimObject id\n\t     * @param {number} vx x\n\t     * @param {number} vy y\n\t     * @param {number} vz z\n\t     * @param {number} wheel wheel\n\t     */\n\t  }, {\n\t    key: 'setVelocity',\n\t    value: function setVelocity(id, vx, vy, vz, wheel) {\n\t      this._setVelocity(id, vx, vy, vz, wheel);\n\t      this._setSimVelocity(id, vx, vy, vz, wheel);\n\t    }\n\t  }, {\n\t    key: '_setVelocity',\n\t    value: function _setVelocity(id, vx, vy, vz, wheel) {\n\t      // if the vehicle exists\n\t      if (id in this._simObjects) {\n\t        var simObject = this._simObjects[id];\n\t\n\t        // update the vehicle\n\t        simObject.setVelocity(vx); // TODO: use vy, vz?\n\t      }\n\t    }\n\t  }, {\n\t    key: '_setSimVelocity',\n\t    value: function _setSimVelocity(id, vx, vy, vz, wheel) {\n\t      if (this._gpuCompute) {\n\t        console.log('_setSimVelocity: ' + id + ', ' + vx + ', ' + vy + ', ' + vz + ', ' + wheel + ')');\n\t\n\t        // transmit from gpu to cpu\n\t        var textureVelocity = this._gpuCompute.readVariable(this._velocityVariable, this._textureVelocity);\n\t\n\t        // update data\n\t        textureVelocity.image.data[id * 4 + 0] = vx;\n\t        textureVelocity.image.data[id * 4 + 1] = vy;\n\t        textureVelocity.image.data[id * 4 + 2] = vz;\n\t        textureVelocity.image.data[id * 4 + 3] = wheel;\n\t        textureVelocity.needsUpdate = true;\n\t\n\t        // transmit from cpu to gpu\n\t        this._gpuCompute.updateVariable(this._velocityVariable, textureVelocity);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_setSimAcceleration',\n\t    value: function _setSimAcceleration(id, ax, ay, az, aw) {\n\t      if (this._gpuCompute) {\n\t        // update data in cpu-memory\n\t        this._velocityUniforms.textureAcceleration.value.image.data[id * 4 + 0] = ax;\n\t        this._velocityUniforms.textureAcceleration.value.image.data[id * 4 + 1] = ay;\n\t        this._velocityUniforms.textureAcceleration.value.image.data[id * 4 + 2] = az;\n\t        this._velocityUniforms.textureAcceleration.value.image.data[id * 4 + 3] = aw;\n\t        this._velocityUniforms.textureAcceleration.value.needsUpdate = true;\n\t      }\n\t    }\n\t\n\t    //\n\t    // locations = {\n\t    //   0: {lat: 0.0, lon: 0.0, angle: 0.0},\n\t    //   1: {lat: 1.0, lon: 1.0, angle: 0.0},\n\t    //   ...\n\t    //   id: {lat: lat, lon: lon, angle: angle}\n\t    // }\n\t    //\n\t  }, {\n\t    key: '_setSimLocations',\n\t    value: function _setSimLocations(locations) {\n\t      var self = this;\n\t\n\t      var positions = {};\n\t      Object.keys(locations).forEach(function (id) {\n\t        var point = self._world.latLonToPoint((0, _geoLatLon.latLon)(locations[id].lat, locations[id].lon));\n\t        positions[id] = { x: point.x, y: 0.0, z: point.y, angle: locations[id].angle };\n\t      });\n\t\n\t      this._setSimPositions(positions);\n\t    }\n\t\n\t    //\n\t    // positions = {\n\t    //   0: {x: 0.0, y: 0.0, z: 0.0, angle: 0.0},\n\t    //   1: {x: 1.0, y: 1.0, z: 1.0, angle: 0.0},\n\t    //   ...\n\t    //   id: {x: x, y: y, z: z, angle: angle}\n\t    // }\n\t    //\n\t  }, {\n\t    key: '_setSimPositions',\n\t    value: function _setSimPositions(positions) {\n\t      if (this._gpuCompute) {\n\t        // transmit from gpu to cpu\n\t        var texturePosition = this._gpuCompute.readVariable(this._positionVariable, this._texturePosition);\n\t\n\t        // update data\n\t        Object.keys(positions).forEach(function (id) {\n\t          // (for extrapolation)\n\t          texturePosition.image.data[id * 4 + 0] = positions[id].x;\n\t          texturePosition.image.data[id * 4 + 1] = positions[id].y;\n\t          texturePosition.image.data[id * 4 + 2] = positions[id].z;\n\t          texturePosition.image.data[id * 4 + 3] = positions[id].angle;\n\t        });\n\t        texturePosition.needsUpdate = true;\n\t\n\t        // transmit from cpu to gpu\n\t        this._gpuCompute.updateVariable(this._positionVariable, texturePosition);\n\t      }\n\t    }\n\t\n\t    //\n\t    // velocities = {\n\t    //   0: {vx: 0.0, vy: 0.0, vz: 0.0, wheel: 0.0},\n\t    //   1: {vx: 1.0, vy: 1.0, vz: 1.0, wheel: 0.0},\n\t    //   ...\n\t    //   id: {vx: vx, vy: vy, vz: vz, wheel: wheel}\n\t    // }\n\t    //\n\t  }, {\n\t    key: '_setSimVelocities',\n\t    value: function _setSimVelocities(velocities) {\n\t      if (this._gpuCompute) {\n\t        // transmit from gpu to cpu\n\t        var textureVelocity = this._gpuCompute.readVariable(this._velocityVariable, this._textureVelocity);\n\t\n\t        // update data\n\t        Object.keys(velocities).forEach(function (id) {\n\t          textureVelocity.image.data[id * 4 + 0] = velocities[id].vx;\n\t          textureVelocity.image.data[id * 4 + 1] = velocities[id].vy;\n\t          textureVelocity.image.data[id * 4 + 2] = velocities[id].vz;\n\t          textureVelocity.image.data[id * 4 + 3] = velocities[id].wheel;\n\t        });\n\t        textureVelocity.needsUpdate = true;\n\t\n\t        // transmit from cpu to gpu\n\t        this._gpuCompute.updateVariable(this._velocityVariable, textureVelocity);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_setSimAccelerations',\n\t    value: function _setSimAccelerations(accelerations) {}\n\t    // TODO: implement a function to update all of the vehicles' accelerations\n\t\n\t    /**\n\t     * Set the label class\n\t     *\n\t     * @param {number} id\n\t     * @param {string} className\n\t     */\n\t\n\t  }, {\n\t    key: 'setLabelClass',\n\t    value: function setLabelClass(id, className) {\n\t      // if the vehicle exists\n\t      if (id in this._simObjects) {\n\t        var simObject = this._simObjects[id];\n\t\n\t        // update the text\n\t        simObject.setLabelClass(className);\n\t      }\n\t    }\n\t\n\t    /**\n\t     * Set the label text\n\t     *\n\t     * @param {number} id\n\t     * @param {string} text\n\t     */\n\t  }, {\n\t    key: 'setLabelText',\n\t    value: function setLabelText(id, text) {\n\t      // if the vehicle exists\n\t      if (id in this._simObjects) {\n\t        var simObject = this._simObjects[id];\n\t\n\t        // update the text\n\t        simObject.setLabelText(text);\n\t      }\n\t    }\n\t\n\t    /**\n\t     * Sets the label offset\n\t     *\n\t     * @param {Number} id id\n\t     * @param {Number} x x\n\t     * @param {Number} y y\n\t     * @param {Number} z z\n\t     */\n\t  }, {\n\t    key: 'setLabelOffset',\n\t    value: function setLabelOffset(id, x, y, z) {\n\t      // if the object exists\n\t      if (id in this._simObjects) {\n\t        var simObject = this._simObjects[id];\n\t\n\t        // update the offset\n\t        simObject.setLabelOffset(x, y, z);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_debug',\n\t    value: function _debug() {\n\t      var texturePosition = this._gpuCompute.readVariable(this._positionVariable);\n\t      var textureVelocity = this._gpuCompute.readVariable(this._velocityVariable);\n\t\n\t      console.log('texturePosition:');\n\t      console.log(texturePosition.image.data);\n\t      console.log('textureVelocity:');\n\t      console.log(textureVelocity.image.data);\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      // Run common destruction logic from parent\n\t      _get(Object.getPrototypeOf(SimObjectLayer.prototype), 'destroy', this).call(this);\n\t    }\n\t  }]);\n\t\n\t  return SimObjectLayer;\n\t})(_Layer3['default']);\n\t\n\texports['default'] = SimObjectLayer;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 76 */\n/***/ function(module, exports) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t// jscs:disable\n\t/* eslint-disable */\n\t/**\n\t * @author yomboprime https://github.com/yomboprime\n\t *\n\t * GPUComputationRenderer, based on SimulationRenderer by zz85\n\t *\n\t * The GPUComputationRenderer uses the concept of variables. These variables are RGBA float textures that hold 4 floats\n\t * for each compute element (texel)\n\t *\n\t * Each variable has a fragment shader that defines the computation made to obtain the variable in question.\n\t * You can use as many variables you need, and make dependencies so you can use textures of other variables in the shader\n\t * (the sampler uniforms are added automatically) Most of the variables will need themselves as dependency.\n\t *\n\t * The renderer has actually two render targets per variable, to make ping-pong. Textures from the current frame are used\n\t * as inputs to render the textures of the next frame.\n\t *\n\t * The render targets of the variables can be used as input textures for your visualization shaders.\n\t *\n\t * Variable names should be valid identifiers and should not collide with THREE GLSL used identifiers.\n\t * a common approach could be to use 'texture' prefixing the variable name; i.e texturePosition, textureVelocity...\n\t *\n\t * The size of the computation (sizeX * sizeY) is defined as 'resolution' automatically in the shader. For example:\n\t * #DEFINE resolution vec2( 1024.0, 1024.0 )\n\t *\n\t * -------------\n\t *\n\t * Basic use:\n\t *\n\t * // Initialization...\n\t *\n\t * // Create computation renderer\n\t * var gpuCompute = new GPUComputationRenderer( 1024, 1024, renderer );\n\t *\n\t * // Create initial state float textures\n\t * var pos0 = gpuCompute.createTexture();\n\t * var vel0 = gpuCompute.createTexture();\n\t * // and fill in here the texture data...\n\t *\n\t * // Add texture variables\n\t * var velVar = gpuCompute.addVariable( \"textureVelocity\", fragmentShaderVel, pos0 );\n\t * var posVar = gpuCompute.addVariable( \"texturePosition\", fragmentShaderPos, vel0 );\n\t *\n\t * // Add variable dependencies\n\t * gpuCompute.setVariableDependencies( velVar, [ velVar, posVar ] );\n\t * gpuCompute.setVariableDependencies( posVar, [ velVar, posVar ] );\n\t *\n\t * // Add custom uniforms\n\t * velVar.material.uniforms.time = { value: 0.0 };\n\t *\n\t * // Check for completeness\n\t * var error = gpuCompute.init();\n\t * if ( error !== null ) {\n\t *\t\tconsole.error( error );\n\t * }\n\t *\n\t *\n\t * // In each frame...\n\t *\n\t * // Compute!\n\t * gpuCompute.compute();\n\t *\n\t * // Update texture uniforms in your visualization materials with the gpu renderer output\n\t * myMaterial.uniforms.myTexture.value = gpuCompute.getCurrentRenderTarget( posVar ).texture;\n\t *\n\t * // Do your rendering\n\t * renderer.render( myScene, myCamera );\n\t *\n\t *\n\t * // If needed...\n\t *\n\t * // transmit texture data from gpu-memory to cpu-memory\n\t * var vel = gpuCompute.readVariable( velVar );\n\t * var pos = gpuCompute.readVariable( posVar );\n\t *\n\t * // update texture in cpu-memory\n\t * vel.image.data[0] += 1.0;\n\t * pos.image.data[0] += 2.0;\n\t *\n\t * // transmit texture data from cpu-memory to gpu-memory\n\t * gpuCompute.updateVariable( velVar, vel );\n\t * gpuCompute.updateVariable( posVar, pos );\n\t *\n\t * -------------\n\t *\n\t * Also, you can use utility functions to create ShaderMaterial and perform computations (rendering between textures)\n\t * Note that the shaders can have multiple input textures.\n\t *\n\t * var myFilter1 = gpuCompute.createShaderMaterial( myFilterFragmentShader1, { theTexture: { value: null } } );\n\t * var myFilter2 = gpuCompute.createShaderMaterial( myFilterFragmentShader2, { theTexture: { value: null } } );\n\t *\n\t * var inputTexture = gpuCompute.createTexture();\n\t *\n\t * // Fill in here inputTexture...\n\t *\n\t * myFilter1.uniforms.theTexture.value = inputTexture;\n\t *\n\t * var myRenderTarget = gpuCompute.createRenderTarget();\n\t * myFilter2.uniforms.theTexture.value = myRenderTarget.texture;\n\t *\n\t * var outputRenderTarget = gpuCompute.createRenderTarget();\n\t *\n\t * // Now use the output texture where you want:\n\t * myMaterial.uniforms.map.value = outputRenderTarget.texture;\n\t *\n\t * // And compute each frame, before rendering to screen:\n\t * gpuCompute.doRenderTarget( myFilter1, myRenderTarget );\n\t * gpuCompute.doRenderTarget( myFilter2, outputRenderTarget );\n\t *\n\t *\n\t *\n\t * @param {int} sizeX Computation problem size is always 2d: sizeX * sizeY elements.\n\t * @param {int} sizeY Computation problem size is always 2d: sizeX * sizeY elements.\n\t * @param {WebGLRenderer} renderer The renderer\n\t */\n\t\n\tfunction GPUComputationRenderer(sizeX, sizeY, renderer) {\n\t\n\t  this.variables = [];\n\t\n\t  this.currentTextureIndex = 0;\n\t\n\t  var scene = new THREE.Scene();\n\t\n\t  var camera = new THREE.Camera();\n\t  camera.position.z = 1;\n\t\n\t  var passThruUniforms = {\n\t    texture: { value: null }\n\t  };\n\t\n\t  var passThruShader = createShaderMaterial(getPassThroughFragmentShader(), passThruUniforms);\n\t\n\t  var mesh = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2), passThruShader);\n\t  scene.add(mesh);\n\t\n\t  // modified by Masayuki (2016-07-12)\n\t  this.addVariable = function (variableName, shader, initialValueTexture) {\n\t\n\t    if (shader.vertexShader) {\n\t      console.warn(\"GPUComputationRenderer: Shader's property vertexShader will be ignored\");\n\t    }\n\t    if (!shader.fragmentShader) {\n\t      throw new Error(\"Shader does not have the property: fragmentShader\");\n\t    }\n\t\n\t    var material = this.createShaderMaterial(shader.fragmentShader, shader.uniforms);\n\t\n\t    var variable = {\n\t      name: variableName,\n\t      initialValueTexture: initialValueTexture,\n\t      material: material,\n\t      dependencies: null,\n\t      renderTargets: [],\n\t      wrapS: null,\n\t      wrapT: null,\n\t      minFilter: THREE.NearestFilter,\n\t      magFilter: THREE.NearestFilter\n\t    };\n\t\n\t    this.variables.push(variable);\n\t\n\t    return variable;\n\t  };\n\t\n\t  // this.addVariable = function( variableName, computeFragmentShader, initialValueTexture ) {\n\t  //\n\t  //   var material = this.createShaderMaterial( computeFragmentShader );\n\t  //\n\t  //   var variable = {\n\t  //     name: variableName,\n\t  //     initialValueTexture: initialValueTexture,\n\t  //     material: material,\n\t  //     dependencies: null,\n\t  //     renderTargets: [],\n\t  //     wrapS: null,\n\t  //     wrapT: null,\n\t  //     minFilter: THREE.NearestFilter,\n\t  //     magFilter: THREE.NearestFilter\n\t  //   };\n\t  //\n\t  //   this.variables.push( variable );\n\t  //\n\t  //   return variable;\n\t  //\n\t  // };\n\t\n\t  this.setVariableDependencies = function (variable, dependencies) {\n\t\n\t    variable.dependencies = dependencies;\n\t  };\n\t\n\t  this.init = function () {\n\t\n\t    if (!renderer.extensions.get(\"OES_texture_float\")) {\n\t\n\t      return \"No OES_texture_float support for float textures.\";\n\t    }\n\t\n\t    if (renderer.capabilities.maxVertexTextures === 0) {\n\t\n\t      return \"No support for vertex shader textures.\";\n\t    }\n\t\n\t    for (var i = 0; i < this.variables.length; i++) {\n\t\n\t      var variable = this.variables[i];\n\t\n\t      // Creates rendertargets and initialize them with input texture\n\t      variable.renderTargets[0] = this.createRenderTarget(sizeX, sizeY, variable.wrapS, variable.wrapT, variable.minFilter, variable.magFilter);\n\t      variable.renderTargets[1] = this.createRenderTarget(sizeX, sizeY, variable.wrapS, variable.wrapT, variable.minFilter, variable.magFilter);\n\t      this.renderTexture(variable.initialValueTexture, variable.renderTargets[0]);\n\t      this.renderTexture(variable.initialValueTexture, variable.renderTargets[1]);\n\t\n\t      // Adds dependencies uniforms to the ShaderMaterial\n\t      var material = variable.material;\n\t      var uniforms = material.uniforms;\n\t      if (variable.dependencies !== null) {\n\t\n\t        for (var d = 0; d < variable.dependencies.length; d++) {\n\t\n\t          var depVar = variable.dependencies[d];\n\t\n\t          if (depVar.name !== variable.name) {\n\t\n\t            // Checks if variable exists\n\t            var found = false;\n\t            for (var j = 0; j < this.variables.length; j++) {\n\t\n\t              if (depVar.name === this.variables[j].name) {\n\t                found = true;\n\t                break;\n\t              }\n\t            }\n\t            if (!found) {\n\t              return \"Variable dependency not found. Variable=\" + variable.name + \", dependency=\" + depVar.name;\n\t            }\n\t          }\n\t\n\t          uniforms[depVar.name] = { value: null };\n\t\n\t          material.fragmentShader = \"\\nuniform sampler2D \" + depVar.name + \";\\n\" + material.fragmentShader;\n\t        }\n\t      }\n\t    }\n\t\n\t    this.currentTextureIndex = 0;\n\t\n\t    return null;\n\t  };\n\t\n\t  this.compute = function () {\n\t\n\t    var currentTextureIndex = this.currentTextureIndex;\n\t    var nextTextureIndex = this.currentTextureIndex === 0 ? 1 : 0;\n\t\n\t    for (var i = 0, il = this.variables.length; i < il; i++) {\n\t\n\t      var variable = this.variables[i];\n\t\n\t      // Sets texture dependencies uniforms\n\t      if (variable.dependencies !== null) {\n\t\n\t        var uniforms = variable.material.uniforms;\n\t        for (var d = 0, dl = variable.dependencies.length; d < dl; d++) {\n\t\n\t          var depVar = variable.dependencies[d];\n\t\n\t          uniforms[depVar.name].value = depVar.renderTargets[currentTextureIndex].texture;\n\t        }\n\t      }\n\t\n\t      // Performs the computation for this variable\n\t      this.doRenderTarget(variable.material, variable.renderTargets[nextTextureIndex]);\n\t    }\n\t\n\t    this.currentTextureIndex = nextTextureIndex;\n\t  };\n\t\n\t  this.getCurrentRenderTarget = function (variable) {\n\t\n\t    return variable.renderTargets[this.currentTextureIndex];\n\t  };\n\t\n\t  this.getAlternateRenderTarget = function (variable) {\n\t\n\t    return variable.renderTargets[this.currentTextureIndex === 0 ? 1 : 0];\n\t  };\n\t\n\t  function addResolutionDefine(materialShader) {\n\t\n\t    materialShader.defines.resolution = 'vec2( ' + sizeX.toFixed(1) + ', ' + sizeY.toFixed(1) + \" )\";\n\t  };\n\t  this.addResolutionDefine = addResolutionDefine;\n\t\n\t  // The following functions can be used to compute things manually\n\t\n\t  function createShaderMaterial(computeFragmentShader, uniforms) {\n\t\n\t    uniforms = uniforms || {};\n\t\n\t    var material = new THREE.ShaderMaterial({\n\t      uniforms: uniforms,\n\t      vertexShader: getPassThroughVertexShader(),\n\t      fragmentShader: computeFragmentShader\n\t    });\n\t\n\t    addResolutionDefine(material);\n\t\n\t    return material;\n\t  };\n\t  this.createShaderMaterial = createShaderMaterial;\n\t\n\t  this.createRenderTarget = function (sizeXTexture, sizeYTexture, wrapS, wrapT, minFilter, magFilter) {\n\t\n\t    sizeXTexture = sizeXTexture || sizeX;\n\t    sizeYTexture = sizeYTexture || sizeY;\n\t\n\t    wrapS = wrapS || THREE.ClampToEdgeWrapping;\n\t    wrapT = wrapT || THREE.ClampToEdgeWrapping;\n\t\n\t    minFilter = minFilter || THREE.NearestFilter;\n\t    magFilter = magFilter || THREE.NearestFilter;\n\t\n\t    var renderTarget = new THREE.WebGLRenderTarget(sizeXTexture, sizeYTexture, {\n\t      wrapS: wrapS,\n\t      wrapT: wrapT,\n\t      minFilter: minFilter,\n\t      magFilter: magFilter,\n\t      format: THREE.RGBAFormat,\n\t      type: THREE.FloatType,\n\t      stencilBuffer: false\n\t    });\n\t\n\t    return renderTarget;\n\t  };\n\t\n\t  this.createTexture = function (sizeXTexture, sizeYTexture) {\n\t\n\t    sizeXTexture = sizeXTexture || sizeX;\n\t    sizeYTexture = sizeYTexture || sizeY;\n\t\n\t    var a = new Float32Array(sizeXTexture * sizeYTexture * 4);\n\t    var texture = new THREE.DataTexture(a, sizeX, sizeY, THREE.RGBAFormat, THREE.FloatType);\n\t    texture.needsUpdate = true;\n\t\n\t    return texture;\n\t  };\n\t\n\t  this.renderTexture = function (input, output) {\n\t\n\t    // Takes a texture, and render out in rendertarget\n\t    // input = Texture\n\t    // output = RenderTarget\n\t\n\t    passThruUniforms.texture.value = input;\n\t\n\t    this.doRenderTarget(passThruShader, output);\n\t\n\t    passThruUniforms.texture.value = null;\n\t  };\n\t\n\t  this.doRenderTarget = function (material, output, forceClear) {\n\t\n\t    mesh.material = material;\n\t    renderer.render(scene, camera, output, forceClear || false);\n\t    mesh.material = passThruShader;\n\t  };\n\t\n\t  // The following functions are added by Masayuki (2016-07-13)\n\t\n\t  this.readVariable = function (variable, output) {\n\t\n\t    // reads pixels in a texture on gpu into a buffer on cpu\n\t    // variable = Variable\n\t    // output = Texture\n\t\n\t    var renderTarget = this.getCurrentRenderTarget(variable);\n\t    var texture = renderTarget.texture;\n\t    output = output || this.createTexture(renderTarget.width, renderTarget.height);\n\t\n\t    this.renderTexture(texture, this.getAlternateRenderTarget(variable));\n\t\n\t    var gl = renderer.getContext();\n\t    gl.readPixels(0, 0, renderTarget.width, renderTarget.height, gl.RGBA, gl.FLOAT, output.image.data);\n\t    output.needsUpdate = true;\n\t\n\t    return output;\n\t  };\n\t\n\t  this.updateVariable = function (variable, texture) {\n\t    this.renderTexture(texture, variable.renderTargets[0]);\n\t    this.renderTexture(texture, variable.renderTargets[1]);\n\t  };\n\t\n\t  // Shaders\n\t\n\t  function getPassThroughVertexShader() {\n\t\n\t    return \"void main()\t{\\n\" + \"\\n\" + \"\tgl_Position = vec4( position, 1.0 );\\n\" + \"\\n\" + \"}\\n\";\n\t  }\n\t\n\t  function getPassThroughFragmentShader() {\n\t\n\t    return \"uniform sampler2D texture;\\n\" + \"\\n\" + \"void main() {\\n\" + \"\\n\" + \"\tvec2 uv = gl_FragCoord.xy / resolution.xy;\\n\" + \"\\n\" + \"\tgl_FragColor = texture2D( texture, uv );\\n\" + \"\\n\" + \"}\\n\";\n\t  }\n\t}\n\t\n\texports[\"default\"] = GPUComputationRenderer;\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 77 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\t/**\n\t * Created by masayuki on 20/07/2016.\n\t */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar SimObject = (function () {\n\t  function SimObject() {\n\t    _classCallCheck(this, SimObject);\n\t\n\t    // properties\n\t    this.id = undefined;\n\t    this.angle = 0.0;\n\t    this.velocity = 0.0;\n\t    this.updatePosition = false;\n\t\n\t    // 3D Object\n\t    this.root = undefined;\n\t\n\t    // 2D Object\n\t    this.label = undefined;\n\t    this.labelOffset = new _three2['default'].Vector3();\n\t\n\t    // --- construct\n\t    this._createSimObject();\n\t  }\n\t\n\t  // --- API\n\t  /**\n\t   * Add THREE.Object3D object directly\n\t   * @param {object} object\n\t   */\n\t\n\t  _createClass(SimObject, [{\n\t    key: 'add',\n\t    value: function add(object) {\n\t      this.root.add(object);\n\t    }\n\t\n\t    /**\n\t     * Remove THREE.Object3D object directly\n\t     * @param {object} object\n\t     */\n\t  }, {\n\t    key: 'remove',\n\t    value: function remove(object) {\n\t      this.root.remove(object);\n\t    }\n\t\n\t    /**\n\t     * sets the object position\n\t     * @param {Number} x x\n\t     * @param {Number} y y\n\t     * @param {Number} z z\n\t     */\n\t  }, {\n\t    key: 'setPosition',\n\t    value: function setPosition(x, y, z) {\n\t      this.root.position.set(x, y, z);\n\t      this.label.position.copy(this.root.position).add(this.labelOffset);\n\t    }\n\t\n\t    /**\n\t     * sets the object angle\n\t     * @param {Number} angle angle in [rad]\n\t     */\n\t  }, {\n\t    key: 'setAngle',\n\t    value: function setAngle(angle) {\n\t      this.angle = angle;\n\t      this.root.rotation.y = angle;\n\t    }\n\t\n\t    /**\n\t     * sets the vehicle's velocity\n\t     * @param {Number} velocity velocity in [m/s]\n\t     */\n\t  }, {\n\t    key: 'setVelocity',\n\t    value: function setVelocity(velocity) {\n\t      this.velocity = velocity;\n\t    }\n\t\n\t    /**\n\t     * sets the label class\n\t     * @param className\n\t     */\n\t  }, {\n\t    key: 'setLabelClass',\n\t    value: function setLabelClass(className) {\n\t      this.label.element.className = className;\n\t    }\n\t\n\t    /**\n\t     * sets the label text\n\t     * @param text\n\t     */\n\t  }, {\n\t    key: 'setLabelText',\n\t    value: function setLabelText(text) {\n\t      this.label.element.textContent = text;\n\t    }\n\t\n\t    /**\n\t     * sets the label offset\n\t     *\n\t     * @param {Number} x x\n\t     * @param {Number} y y\n\t     * @param {Number} z z\n\t     */\n\t  }, {\n\t    key: 'setLabelOffset',\n\t    value: function setLabelOffset(x, y, z) {\n\t      this.labelOffset.set(x, y, z);\n\t    }\n\t\n\t    /**\n\t     * update the object\n\t     * @param {Number} delta\n\t     */\n\t  }, {\n\t    key: 'update',\n\t    value: function update(delta) {\n\t\n\t      var forwardDelta = delta * this.velocity;\n\t\n\t      // position\n\t      if (this.updatePosition) {\n\t        this.root.position.x += Math.cos(-this.angle) * forwardDelta;\n\t        this.root.position.z += Math.sin(-this.angle) * forwardDelta;\n\t        this.label.position.copy(this.root.position).add(this.labelOffset);\n\t\n\t        this.root.rotation.y = this.angle;\n\t      }\n\t    }\n\t\n\t    // --- internal helper methods\n\t  }, {\n\t    key: '_createSimObject',\n\t    value: function _createSimObject() {\n\t      // construct this object\n\t\n\t      // root\n\t      this.root = new _three2['default'].Object3D();\n\t\n\t      // [DEBUG] arrow\n\t      var from = new _three2['default'].Vector3(0, 0, 0);\n\t      var to = new _three2['default'].Vector3(50, 0, 0);\n\t      var direction = to.clone().sub(from);\n\t      var length = direction.length();\n\t      var arrowHelper = new _three2['default'].ArrowHelper(direction.normalize(), from, length, 0xff0000);\n\t      this.root.add(arrowHelper);\n\t\n\t      // label\n\t      var text = document.createElement('div');\n\t      this.label = new _three2['default'].CSS2DObject(text);\n\t    }\n\t  }, {\n\t    key: '_adjustLabelOffset',\n\t    value: function _adjustLabelOffset() {\n\t      var bbox = new _three2['default'].Box3().setFromObject(this.root);\n\t      this.setLabelOffset(0, bbox.max.y + 1, 0);\n\t    }\n\t\n\t    // ---\n\t\n\t  }]);\n\t\n\t  return SimObject;\n\t})();\n\t\n\texports['default'] = SimObject;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 78 */\n/***/ function(module, exports) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\t/* To be used by GPUComputationRenderer */\n\tvar VehicleVelocityShader = {\n\t\n\t  uniforms: {\n\t\n\t    \"time\": { type: \"f\", value: 0.0 },\n\t    \"delta\": { type: \"f\", value: 0.0 },\n\t    \"textureAcceleration\": { type: \"t\", value: null }\n\t\n\t  },\n\t\n\t  vertexShader: [].join('\\n'),\n\t\n\t  fragmentShader: [\"uniform float time;\", \"uniform float delta; // about 0.016\", \"uniform sampler2D textureAcceleration;\", \"const float PI = 3.141592653589793;\", \"const float PI_05 = PI / 2.0;\", \"const float PI_2 = PI * 2.0;\", \"const float L = 2.0;\", \"const float SPEED_LIMIT = 10.0;\", \"void main() {\", \" vec2 uv = gl_FragCoord.xy / resolution.xy;\", \" vec4 selfVelocity = texture2D( textureVelocity, uv );\", \" vec4 selfAcceleration = texture2D( textureAcceleration, uv );\", \" float velocity = selfVelocity.x;\", \" float wheel = selfVelocity.w;\", \" float acceleration = selfAcceleration.x;\", \" // update velocity\", \" velocity += acceleration;\", \" gl_FragColor = vec4(velocity, 0.0, 0.0, wheel);\",\n\t\n\t  // \" vec4 selfVelocity = texture2D( textureVelocity, uv );\",\n\t  // \" vec3 velocity = selfVelocity.xyz;\",\n\t  // \" float velocityScalar = length( velocity );\",\n\t  // \" float wheel = selfVelocity.w;\",\n\t  //\n\t  // \" vec3 selfAcceleration = texture2D( textureAcceleration, uv ).xyz;\",\n\t  //\n\t  // \" // update the velocity in accordance with the centripetal force\",\n\t  // \" float a = wheel / L * velocityScalar * velocityScalar;\",\n\t  // \" vec3 centripetalAcceleration = vec3( - a / velocityScalar * velocity.z, 0.0, a / velocityScalar * velocity.x );\",\n\t  // \" velocity += delta * centripetalAcceleration;\",\n\t  // \" velocity *= velocityScalar / length( velocity );\",\n\t  //\n\t  // \" // update velocity\",\n\t  // \" velocity += delta * selfAcceleration;\",\n\t  //\n\t  // \"\tfloat limit = SPEED_LIMIT;\",\n\t  //\n\t  // \"\t// Speed Limits\",\n\t  // \"\t//if ( length( velocity ) > limit ) {\",\n\t  // \"\t//\tvelocity = normalize( velocity ) * limit;\",\n\t  // \"\t//}\",\n\t  //\n\t  // \"\tgl_FragColor = vec4( velocity, wheel );\",\n\t\n\t  \"}\"].join('\\n')\n\t\n\t};\n\t\n\texports[\"default\"] = VehicleVelocityShader;\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 79 */\n/***/ function(module, exports) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\tvar VehiclePositionShader = {\n\t\n\t  uniforms: {\n\t\n\t    \"time\": { type: \"f\", value: 0.0 },\n\t    \"delta\": { type: \"f\", value: 0.0 }\n\t  },\n\t\n\t  // \"textureTargetPosition\":  {type: \"t\", value: null}, // (for interpolation)\n\t  // \"t\":                {type: \"f\", value: 0.0}, // (for interpolation)\n\t\n\t  vertexShader: [].join('\\n'),\n\t\n\t  fragmentShader: [\"uniform float time;\", \"uniform float delta;\", \"uniform sampler2D textureTargetPosition;\", \"uniform float t;\", \"const float PI = 3.141592653589793;\", \"const float L = 2.0;\", \"const float T = 1.0;\", \"void main() {\", \" vec2 uv = gl_FragCoord.xy / resolution.xy;\",\n\t\n\t  // (for extrapolation)\n\t  \" vec4 selfPosition = texture2D( texturePosition, uv );\", \" vec4 selfVelocity = texture2D( textureVelocity, uv );\", \" vec3 position = selfPosition.xyz;\", \" float velocity = selfVelocity.x;\", \" float angle = selfPosition.w;\", \" float wheel = selfVelocity.w;\", \" float angular_velocity = wheel / L * velocity;\", \" angle += delta * angular_velocity;\", \" if( angle >  PI ) { angle -= 2.0 * PI; }\", \" if( angle < -PI ) { angle += 2.0 * PI; }\", \" position.x += delta * velocity * cos( angle );\", \" position.z += delta * velocity * sin( angle );\", \" gl_FragColor = vec4( position, angle );\",\n\t\n\t  // (for interpolation)\n\t  // \" vec4 selfPosition = texture2D( texturePosition, uv );\",\n\t  // \" vec4 selfTargetPosition = texture2D( textureTargetPosition, uv );\",\n\t  //\n\t  // \" selfPosition.x = mix( selfPosition.x, selfTargetPosition.x, t / T );\",\n\t  // \" selfPosition.y = mix( selfPosition.y, selfTargetPosition.y, t / T );\",\n\t  // \" selfPosition.z = mix( selfPosition.z, selfTargetPosition.z, t / T );\",\n\t  // \" selfPosition.w = mix( selfPosition.w, selfTargetPosition.w, t / T );\",\n\t  //\n\t  // \" gl_FragColor = selfPosition;\",\n\t\n\t  // \" vec4 selfPosition = texture2D( texturePosition, uv );\",\n\t  // \" vec4 selfVelocity = texture2D( textureVelocity, uv );\",\n\t  //\n\t  // \" vec3 position = selfPosition.xyz;\",\n\t  // \" vec3 velocity = selfVelocity.xyz;\",\n\t  // \" float angle = selfPosition.w;\",\n\t  // \" float wheel = selfVelocity.w;\",\n\t  //\n\t  // \" // calculate the angular velocity\",\n\t  // \" float angular_velocity = wheel / L * length( velocity );\",\n\t  //\n\t  // \" // update the position\",\n\t  // \" position += delta * velocity;\",\n\t  // \" angle += delta * angular_velocity;\",\n\t  // \" if ( angle >  PI ) { angle -= 2.*PI; }\",\n\t  // \" if ( angle < -PI ) { angle += 2.*PI; }\",\n\t  //\n\t  // \" gl_FragColor = vec4( position, angle );\",\n\t\n\t  \"}\"].join('\\n')\n\t\n\t};\n\t\n\texports[\"default\"] = VehiclePositionShader;\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 80 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar VehicleShader = {\n\t\n\t  uniforms: {\n\t\n\t    \"reference\": { type: \"v2\", value: null },\n\t    \"texturePosition\": { type: \"t\", value: null },\n\t    \"texture\": { type: \"t\", value: null },\n\t    \"color\": { type: \"c\", value: new _three2[\"default\"].Color(0xff2200) }\n\t\n\t  },\n\t\n\t  vertexShader: [\"uniform vec2 reference;\", \"uniform sampler2D texturePosition;\", \"varying vec2 vUv;\", \"mat4 rotationMatrix(vec3 axis, float angle)\", \"{\", \"    axis = normalize(axis);\", \"    float s = sin(angle);\", \"    float c = cos(angle);\", \"    float oc = 1.0 - c;\", \"    \", \"    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\", \"                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\", \"                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\", \"                0.0,                                0.0,                                0.0,                                1.0);\", \"}\", \"void main() {\", \" vUv = uv;\", \" // retrieve the simulated position of this vehicle\", \" vec4 selfPosition = texture2D( texturePosition, reference );\", \"\tvec3 simPos = selfPosition.xyz;\", \" float angle = selfPosition.w;\", \" // tmp\", \" vec4 newPosition = vec4( position, 1.0 );\", \" // rotate\", \" mat4 rotYMatrix = rotationMatrix( vec3( 0., 1., 0. ), angle );\", \" newPosition = rotYMatrix * newPosition;\", \" // calcuate the actual position by adding the simulated position\", \"\tnewPosition = modelMatrix * newPosition;\", \" newPosition.xyz += simPos;\", \"\tgl_Position = projectionMatrix * viewMatrix * newPosition;\", \"}\"].join('\\n'),\n\t\n\t  fragmentShader: [\"uniform sampler2D texture;\", \"uniform vec3 color;\", \"varying vec2 vUv;\", \"void main() {\", \" gl_FragColor = texture2D( texture, vUv );\", \"// gl_FragColor = vec4( color, 1. );\", \"}\"].join('\\n')\n\t\n\t};\n\t\n\texports[\"default\"] = VehicleShader;\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 81 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t/*\n\t * Object helpers\n\t */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _operative = __webpack_require__(82);\n\t\n\tvar _operative2 = _interopRequireDefault(_operative);\n\t\n\tvar _vendorSimplifyModifier = __webpack_require__(83);\n\t\n\tvar _vendorSimplifyModifier2 = _interopRequireDefault(_vendorSimplifyModifier);\n\t\n\tvar _WorkerUtils = __webpack_require__(84);\n\t\n\tvar _WorkerUtils2 = _interopRequireDefault(_WorkerUtils);\n\t\n\tvar ObjectUtils = (function () {\n\t\n\t  // Create UV from geometry's faces\n\t  var createUV = function createUV(geometry) {\n\t    geometry.computeBoundingBox();\n\t\n\t    var max = geometry.boundingBox.max;\n\t    var min = geometry.boundingBox.min;\n\t    var offset = new _three2['default'].Vector2(0 - min.x, 0 - min.y);\n\t    var range = new _three2['default'].Vector2(max.x - min.x, max.y - min.y);\n\t    var faces = geometry.faces;\n\t\n\t    geometry.faceVertexUvs[0] = [];\n\t\n\t    for (var i = 0; i < faces.length; i++) {\n\t      var v1 = geometry.vertices[faces[i].a];\n\t      var v2 = geometry.vertices[faces[i].b];\n\t      var v3 = geometry.vertices[faces[i].c];\n\t\n\t      geometry.faceVertexUvs[0].push([new _three2['default'].Vector2((v1.x + offset.x) / range.x, (v1.y + offset.y) / range.y), new _three2['default'].Vector2((v2.x + offset.x) / range.x, (v2.y + offset.y) / range.y), new _three2['default'].Vector2((v3.x + offset.x) / range.x, (v3.y + offset.y) / range.y)]);\n\t    }\n\t\n\t    geometry.uvsNeedUpdate = true;\n\t  };\n\t\n\t  var objectToGeometry = function objectToGeometry(geometry) {\n\t    var newGeo = new _three2['default'].Geometry();\n\t\n\t    for (i = 0; i < geometry.vertices.length; i++) {\n\t      var v = geometry.vertices[i];\n\t      newGeo.vertices.push(new _three2['default'].Vector3(v.x, v.y, v.z));\n\t    }\n\t    for (i = 0; i < geometry.faces.length; i++) {\n\t      var f = geometry.faces[i];\n\t      newGeo.faces.push(new _three2['default'].Face3(f.a, f.b, f.c, f.normal, f.color, f.materialIndex));\n\t    }\n\t\n\t    return newGeo;\n\t  };\n\t\n\t  // Reduce vertices and simplify a geometry\n\t  var simplifyGeometry = function simplifyGeometry(geometry, reduceCount, callback) {\n\t\n\t    reduceCount = reduceCount | geometry.vertices.length * 0.5;\n\t    var func = (0, _operative2['default'])(function (geometry, reduceCount, cb) {\n\t      // NOTE these codes run on a webworker thread, so all of the variables outside this scope are unavailable.\n\t\n\t      // hack\n\t      console.assert = function (b) {\n\t        if (!b) {\n\t          throw new Error('assertion failed');\n\t        }\n\t      };\n\t\n\t      // deferred\n\t      var d = this.deferred();\n\t\n\t      // convert \"[Object object]\" to \"[THREE.Geometry]\"\n\t      geometry = VIZI.Util.ObjectUtils.objectToGeometry(geometry);\n\t\n\t      // modify the geometry\n\t      var modifier = new VIZI.Util.ObjectUtils.SimplifyModifier();\n\t      var geometry = modifier.modify(geometry, reduceCount | 0);\n\t\n\t      // return to the main thread\n\t      cb(geometry);\n\t    }, _WorkerUtils2['default'].getDependencies());\n\t\n\t    // call the webworker procedure from the main thread\n\t    func(geometry, reduceCount, function (geometry) {\n\t      // callback called on the main thread\n\t\n\t      // convert \"[Object object]\" to \"[THREE.Geometry]\"\n\t      geometry = objectToGeometry(geometry);\n\t\n\t      // callback to the function caller\n\t      if (callback) {\n\t        callback(geometry);\n\t      }\n\t    });\n\t  };\n\t\n\t  return {\n\t    createUV: createUV,\n\t    objectToGeometry: objectToGeometry,\n\t    simplifyGeometry: simplifyGeometry,\n\t    SimplifyModifier: _vendorSimplifyModifier2['default']\n\t  };\n\t})();\n\t\n\texports['default'] = ObjectUtils;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 82 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_82__;\n\n/***/ },\n/* 83 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t/*\n\t *\t@author zz85 / http://twitter.com/blurspline / http://www.lab4games.net/zz85/blog\n\t *\n\t *\tSimplification Geometry Modifier\n\t *    - based on code and technique\n\t *\t  - by Stan Melax in 1998\n\t *\t  - Progressive Mesh type Polygon Reduction Algorithm\n\t *    - http://www.melax.com/polychop/\n\t */\n\t\n\tvar SimplifyModifier = function SimplifyModifier() {};\n\t\n\t(function () {\n\t\n\t  var cb = new _three2['default'].Vector3(),\n\t      ab = new _three2['default'].Vector3();\n\t\n\t  function pushIfUnique(array, object) {\n\t\n\t    if (array.indexOf(object) === -1) array.push(object);\n\t  }\n\t\n\t  function removeFromArray(array, object) {\n\t\n\t    var k = array.indexOf(object);\n\t    if (k > -1) array.splice(k, 1);\n\t  }\n\t\n\t  function computeEdgeCollapseCost(u, v) {\n\t\n\t    // if we collapse edge uv by moving u to v then how\n\t    // much different will the model change, i.e. the \"error\".\n\t\n\t    var edgelength = v.position.distanceTo(u.position);\n\t    var curvature = 0;\n\t\n\t    var sideFaces = [];\n\t    var i,\n\t        uFaces = u.faces,\n\t        il = u.faces.length,\n\t        face,\n\t        sideFace;\n\t\n\t    // find the \"sides\" triangles that are on the edge uv\n\t    for (i = 0; i < il; i++) {\n\t\n\t      face = u.faces[i];\n\t\n\t      if (face.hasVertex(v)) {\n\t\n\t        sideFaces.push(face);\n\t      }\n\t    }\n\t\n\t    // use the triangle facing most away from the sides\n\t    // to determine our curvature term\n\t    for (i = 0; i < il; i++) {\n\t\n\t      var minCurvature = 1;\n\t      face = u.faces[i];\n\t\n\t      for (var j = 0; j < sideFaces.length; j++) {\n\t\n\t        sideFace = sideFaces[j];\n\t        // use dot product of face normals.\n\t        var dotProd = face.normal.dot(sideFace.normal);\n\t        minCurvature = Math.min(minCurvature, (1.001 - dotProd) / 2);\n\t      }\n\t\n\t      curvature = Math.max(curvature, minCurvature);\n\t    }\n\t\n\t    // crude approach in attempt to preserve borders\n\t    // though it seems not to be totally correct\n\t    var borders = 0;\n\t    if (sideFaces.length < 2) {\n\t\n\t      // we add some arbitrary cost for borders,\n\t      // borders += 10;\n\t      curvature = 1;\n\t    }\n\t\n\t    var amt = edgelength * curvature + borders;\n\t\n\t    return amt;\n\t  }\n\t\n\t  function computeEdgeCostAtVertex(v) {\n\t    // compute the edge collapse cost for all edges that start\n\t    // from vertex v.  Since we are only interested in reducing\n\t    // the object by selecting the min cost edge at each step, we\n\t    // only cache the cost of the least cost edge at this vertex\n\t    // (in member variable collapse) as well as the value of the\n\t    // cost (in member variable collapseCost).\n\t\n\t    if (v.neighbors.length === 0) {\n\t\n\t      // collapse if no neighbors.\n\t      v.collapseNeighbor = null;\n\t      v.collapseCost = -0.01;\n\t\n\t      return;\n\t    }\n\t\n\t    v.collapseCost = 100000;\n\t    v.collapseNeighbor = null;\n\t\n\t    // search all neighboring edges for \"least cost\" edge\n\t    for (var i = 0; i < v.neighbors.length; i++) {\n\t\n\t      var collapseCost = computeEdgeCollapseCost(v, v.neighbors[i]);\n\t\n\t      if (!v.collapseNeighbor) {\n\t        v.collapseNeighbor = v.neighbors[i];\n\t        v.collapseCost = collapseCost;\n\t        v.minCost = collapseCost;\n\t        v.totalCost = 0;\n\t        v.costCount = 0;\n\t      }\n\t\n\t      v.costCount++;\n\t      v.totalCost += collapseCost;\n\t\n\t      if (collapseCost < v.minCost) {\n\t\n\t        v.collapseNeighbor = v.neighbors[i];\n\t        v.minCost = collapseCost;\n\t      }\n\t    }\n\t\n\t    // we average the cost of collapsing at this vertex\n\t    v.collapseCost = v.totalCost / v.costCount;\n\t    // v.collapseCost = v.minCost;\n\t  }\n\t\n\t  function removeVertex(v, vertices) {\n\t\n\t    console.assert(v.faces.length === 0);\n\t\n\t    while (v.neighbors.length) {\n\t\n\t      var n = v.neighbors.pop();\n\t      removeFromArray(n.neighbors, v);\n\t    }\n\t\n\t    removeFromArray(vertices, v);\n\t  }\n\t\n\t  function removeFace(f, faces) {\n\t\n\t    removeFromArray(faces, f);\n\t\n\t    if (f.v1) removeFromArray(f.v1.faces, f);\n\t    if (f.v2) removeFromArray(f.v2.faces, f);\n\t    if (f.v3) removeFromArray(f.v3.faces, f);\n\t\n\t    // TODO optimize this!\n\t    var vs = [this.v1, this.v2, this.v3];\n\t    var v1, v2;\n\t\n\t    for (var i = 0; i < 3; i++) {\n\t      v1 = vs[i];\n\t      v2 = vs[(i + 1) % 3];\n\t\n\t      if (!v1 || !v2) continue;\n\t      v1.removeIfNonNeighbor(v2);\n\t      v2.removeIfNonNeighbor(v1);\n\t    }\n\t  }\n\t\n\t  function collapse(vertices, faces, u, v) {\n\t    // u and v are pointers to vertices of an edge\n\t\n\t    // Collapse the edge uv by moving vertex u onto v\n\t\n\t    if (!v) {\n\t\n\t      // u is a vertex all by itself so just delete it..\n\t      removeVertex(u, vertices);\n\t      return;\n\t    }\n\t\n\t    var i;\n\t    var tmpVertices = [];\n\t\n\t    for (i = 0; i < u.neighbors.length; i++) {\n\t\n\t      tmpVertices.push(u.neighbors[i]);\n\t    }\n\t\n\t    // delete triangles on edge uv:\n\t    for (i = u.faces.length - 1; i >= 0; i--) {\n\t\n\t      if (u.faces[i].hasVertex(v)) {\n\t\n\t        removeFace(u.faces[i], faces);\n\t      }\n\t    }\n\t\n\t    // update remaining triangles to have v instead of u\n\t    for (i = u.faces.length - 1; i >= 0; i--) {\n\t\n\t      u.faces[i].replaceVertex(u, v);\n\t    }\n\t\n\t    removeVertex(u, vertices);\n\t\n\t    // recompute the edge collapse costs in neighborhood\n\t    for (i = 0; i < tmpVertices.length; i++) {\n\t\n\t      computeEdgeCostAtVertex(tmpVertices[i]);\n\t    }\n\t  }\n\t\n\t  function minimumCostEdge(vertices) {\n\t\n\t    // O(n * n) approach. TODO optimize this\n\t\n\t    var least = vertices[0];\n\t\n\t    for (var i = 0; i < vertices.length; i++) {\n\t\n\t      if (vertices[i].collapseCost < least.collapseCost) {\n\t\n\t        least = vertices[i];\n\t      }\n\t    }\n\t\n\t    return least;\n\t  }\n\t\n\t  // we use a triangle class to represent structure of face slightly differently\n\t\n\t  function Triangle(v1, v2, v3, a, b, c) {\n\t    this.a = a;\n\t    this.b = b;\n\t    this.c = c;\n\t\n\t    this.v1 = v1;\n\t    this.v2 = v2;\n\t    this.v3 = v3;\n\t\n\t    this.normal = new _three2['default'].Vector3();\n\t\n\t    this.computeNormal();\n\t\n\t    v1.faces.push(this);\n\t    v1.addUniqueNeighbor(v2);\n\t    v1.addUniqueNeighbor(v3);\n\t\n\t    v2.faces.push(this);\n\t    v2.addUniqueNeighbor(v1);\n\t    v2.addUniqueNeighbor(v3);\n\t\n\t    v3.faces.push(this);\n\t    v3.addUniqueNeighbor(v1);\n\t    v3.addUniqueNeighbor(v2);\n\t  }\n\t\n\t  Triangle.prototype.computeNormal = function () {\n\t\n\t    var vA = this.v1.position;\n\t    var vB = this.v2.position;\n\t    var vC = this.v3.position;\n\t\n\t    cb.subVectors(vC, vB);\n\t    ab.subVectors(vA, vB);\n\t    cb.cross(ab).normalize();\n\t\n\t    this.normal.copy(cb);\n\t  };\n\t\n\t  Triangle.prototype.hasVertex = function (v) {\n\t\n\t    return v === this.v1 || v === this.v2 || v === this.v3;\n\t  };\n\t\n\t  Triangle.prototype.replaceVertex = function (oldv, newv) {\n\t\n\t    if (oldv === this.v1) this.v1 = newv;else if (oldv === this.v2) this.v2 = newv;else if (oldv === this.v3) this.v3 = newv;\n\t\n\t    removeFromArray(oldv.faces, this);\n\t    newv.faces.push(this);\n\t\n\t    oldv.removeIfNonNeighbor(this.v1);\n\t    this.v1.removeIfNonNeighbor(oldv);\n\t\n\t    oldv.removeIfNonNeighbor(this.v2);\n\t    this.v2.removeIfNonNeighbor(oldv);\n\t\n\t    oldv.removeIfNonNeighbor(this.v3);\n\t    this.v3.removeIfNonNeighbor(oldv);\n\t\n\t    this.v1.addUniqueNeighbor(this.v2);\n\t    this.v1.addUniqueNeighbor(this.v3);\n\t\n\t    this.v2.addUniqueNeighbor(this.v1);\n\t    this.v2.addUniqueNeighbor(this.v3);\n\t\n\t    this.v3.addUniqueNeighbor(this.v1);\n\t    this.v3.addUniqueNeighbor(this.v2);\n\t\n\t    this.computeNormal();\n\t  };\n\t\n\t  function Vertex(v, id) {\n\t\n\t    this.position = v;\n\t\n\t    this.id = id; // old index id\n\t\n\t    this.faces = []; // faces vertex is connected\n\t    this.neighbors = []; // neighbouring vertices aka \"adjacentVertices\"\n\t\n\t    // these will be computed in computeEdgeCostAtVertex()\n\t    this.collapseCost = 0; // cost of collapsing this vertex, the less the better. aka objdist\n\t    this.collapseNeighbor = null; // best candinate for collapsing\n\t  }\n\t\n\t  Vertex.prototype.addUniqueNeighbor = function (vertex) {\n\t    pushIfUnique(this.neighbors, vertex);\n\t  };\n\t\n\t  Vertex.prototype.removeIfNonNeighbor = function (n) {\n\t\n\t    var neighbors = this.neighbors;\n\t    var faces = this.faces;\n\t\n\t    var offset = neighbors.indexOf(n);\n\t    if (offset === -1) return;\n\t    for (var i = 0; i < faces.length; i++) {\n\t\n\t      if (faces[i].hasVertex(n)) return;\n\t    }\n\t\n\t    neighbors.splice(offset, 1);\n\t  };\n\t\n\t  SimplifyModifier.prototype.modify = function (geometry, count) {\n\t\n\t    if (geometry instanceof _three2['default'].BufferGeometry && !geometry.vertices && !geometry.faces) {\n\t      console.log('converting BufferGeometry to Geometry');\n\t      geometry = new _three2['default'].Geometry().fromBufferGeometry(geometry);\n\t    }\n\t\n\t    geometry.mergeVertices();\n\t\n\t    var oldVertices = geometry.vertices; // Three Position\n\t    var oldFaces = geometry.faces; // Three Face\n\t\n\t    var newGeometry = new _three2['default'].Geometry();\n\t\n\t    // conversion\n\t    var vertices = new Array(oldVertices.length); // Simplify Custom Vertex Struct\n\t    var faces = new Array(oldFaces.length); // Simplify Custom Traignle Struct\n\t\n\t    var i, il, face;\n\t\n\t    //\n\t    // put data of original geometry in different data structures\n\t    //\n\t\n\t    // add vertices\n\t    for (i = 0, il = oldVertices.length; i < il; i++) {\n\t\n\t      vertices[i] = new Vertex(oldVertices[i], i);\n\t    }\n\t\n\t    // add faces\n\t    for (i = 0, il = oldFaces.length; i < il; i++) {\n\t\n\t      face = oldFaces[i];\n\t      faces[i] = new Triangle(vertices[face.a], vertices[face.b], vertices[face.c], face.a, face.b, face.c);\n\t    }\n\t\n\t    // compute all edge collapse costs\n\t    for (i = 0, il = vertices.length; i < il; i++) {\n\t\n\t      computeEdgeCostAtVertex(vertices[i]);\n\t    }\n\t\n\t    var permutation = new Array(vertices.length);\n\t    var map = new Array(vertices.length);\n\t\n\t    var nextVertex;\n\t\n\t    var z = count;\n\t\n\t    // console.time('z')\n\t    // console.profile('zz');\n\t\n\t    while (z--) {\n\t      nextVertex = minimumCostEdge(vertices);\n\t      if (!nextVertex) {\n\t        console.log('no next vertex');\n\t        break;\n\t      }\n\t      collapse(vertices, faces, nextVertex, nextVertex.collapseNeighbor);\n\t    }\n\t\n\t    // console.profileEnd('zz');\n\t    // console.timeEnd('z')\n\t\n\t    // TODO convert to buffer geometry.\n\t    var newGeo = new _three2['default'].Geometry();\n\t\n\t    for (i = 0; i < vertices.length; i++) {\n\t\n\t      var v = vertices[i];\n\t      newGeo.vertices.push(v.position);\n\t    }\n\t\n\t    for (i = 0; i < faces.length; i++) {\n\t\n\t      var tri = faces[i];\n\t      newGeo.faces.push(new _three2['default'].Face3(vertices.indexOf(tri.v1), vertices.indexOf(tri.v2), vertices.indexOf(tri.v3)));\n\t    }\n\t\n\t    return newGeo;\n\t  };\n\t})();\n\t\n\texports['default'] = SimplifyModifier;\n\t\n\t_three2['default'].SimplifyModifier = SimplifyModifier;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 84 */\n/***/ function(module, exports) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t/**\n\t * Worker Utils\n\t */\n\t\n\tvar WorkerUtils = (function () {\n\t\n\t  var self = this;\n\t\n\t  /** base directory */\n\t  var base = (function () {\n\t    var current = (function () {\n\t      if (!self.isWorker) {\n\t        if (document.currentScript) {\n\t          return document.currentScript.src;\n\t        } else {\n\t          var scripts = document.getElementsByTagName('script');\n\t          var script = scripts[scripts.length - 1];\n\t          if (script.src) {\n\t            return script.src;\n\t          }\n\t        }\n\t      }\n\t    })();\n\t    if (current) {\n\t      return dirname(current);\n\t    }\n\t  })();\n\t\n\t  /** Definition: Worker dependencies */\n\t  var dependencies = [base + '/three.min.js', base + '/vizicities-worker.min.js'];\n\t\n\t  /**\n\t   * Returns worker dependencies\n\t   *\n\t   * @returns {string[]}\n\t   */\n\t  var getDependencies = function getDependencies() {\n\t    return dependencies;\n\t  };\n\t\n\t  // --- internal helper methods\n\t  function basename(path) {\n\t    return path.replace(/\\\\/g, '/').replace(/.*\\//, '');\n\t  }\n\t  function dirname(path) {\n\t    return path.replace(/\\\\/g, '/').replace(/\\/[^\\/]*$/, '');;\n\t  }\n\t  // ---\n\t\n\t  // return the utility object\n\t  return {\n\t    getDependencies: getDependencies\n\t  };\n\t})();\n\t\n\texports['default'] = WorkerUtils;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 85 */\n/***/ function(module, exports) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * Created by masayuki on 17/07/2016.\n\t */\n\t\n\tvar ModelRepository = (function () {\n\t  function ModelRepository() {\n\t    _classCallCheck(this, ModelRepository);\n\t\n\t    this._map = {};\n\t  }\n\t\n\t  _createClass(ModelRepository, [{\n\t    key: \"add\",\n\t    value: function add(modelName, model) {\n\t      this._map[modelName] = model;\n\t    }\n\t  }, {\n\t    key: \"get\",\n\t    value: function get(modelName) {\n\t      return this._map[modelName];\n\t    }\n\t  }, {\n\t    key: \"contains\",\n\t    value: function contains(modelName) {\n\t      return modelName in this._map;\n\t    }\n\t  }]);\n\t\n\t  return ModelRepository;\n\t})();\n\t\n\tvar modelRepository = new ModelRepository();\n\t\n\texports[\"default\"] = modelRepository;\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 86 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t/**\n\t * Created by masayuki on 20/07/2016.\n\t */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _vendorBinaryLoader = __webpack_require__(87);\n\t\n\tvar _vendorBinaryLoader2 = _interopRequireDefault(_vendorBinaryLoader);\n\t\n\tvar PedestrianModel = function PedestrianModel(parameters, callback) {\n\t\n\t  var scope = this;\n\t  var p = parameters;\n\t\n\t  // file paths\n\t  this.bodyURL = p.bodyURL || null;\n\t\n\t  // parameters\n\t  this.scale = p.scale || 1.0;\n\t  this.translation = p.translation || new _three2['default'].Vector3();\n\t  this.rotation = p.rotation || new _three2['default'].Vector3();\n\t\n\t  // callback\n\t  this.callback = callback;\n\t\n\t  // status\n\t  this.loaded = false;\n\t\n\t  // internal use\n\t  this.bodyGeometry = null;\n\t  this.bodyMaterials = null;\n\t\n\t  // construct\n\t  if (scope.bodyURL) {\n\t    // load binaries\n\t    var jloader = new _three2['default'].JSONLoader();\n\t    jloader.load(scope.bodyURL, function (geometry, materials) {\n\t      createBody(geometry, materials);\n\t    });\n\t  }\n\t\n\t  // internal helper methods\n\t  function createBody(geometry, materials) {\n\t    scope.bodyGeometry = geometry;\n\t    scope.bodyMaterials = materials;\n\t\n\t    for (i = 0, max = materials.length; i < max; i = i + 1) {\n\t      materials[i].morphTargets = true;\n\t    }\n\t\n\t    onCreated();\n\t  }\n\t  function onCreated() {\n\t    if (scope.bodyGeometry) {\n\t      scope.loaded = true;\n\t\n\t      // callback\n\t      if (scope.callback) {\n\t        scope.callback(scope);\n\t      }\n\t    }\n\t  }\n\t};\n\t\n\texports['default'] = PedestrianModel;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 87 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar BinaryLoader = function BinaryLoader(manager) {\n\t\n\t  if (typeof manager === 'boolean') {\n\t\n\t    console.warn('THREE.BinaryLoader: showStatus parameter has been removed from constructor.');\n\t    manager = undefined;\n\t  }\n\t\n\t  this.manager = manager !== undefined ? manager : _three2['default'].DefaultLoadingManager;\n\t};\n\t\n\tBinaryLoader.prototype = {\n\t\n\t  constructor: _three2['default'].BinaryLoader,\n\t\n\t  // Load models generated by slim OBJ converter with BINARY option (converter_obj_three_slim.py -t binary)\n\t  //  - binary models consist of two files: JS and BIN\n\t  //  - parameters\n\t  //\t\t- url (required)\n\t  //\t\t- callback (required)\n\t  //\t\t- texturePath (optional: if not specified, textures will be assumed to be in the same folder as JS model file)\n\t  //\t\t- binaryPath (optional: if not specified, binary file will be assumed to be in the same folder as JS model file)\n\t  load: function load(url, onLoad, onProgress, onError) {\n\t\n\t    // todo: unify load API to for easier SceneLoader use\n\t\n\t    var texturePath = this.texturePath || _three2['default'].Loader.prototype.extractUrlBase(url);\n\t    var binaryPath = this.binaryPath || _three2['default'].Loader.prototype.extractUrlBase(url);\n\t\n\t    // #1 load JS part via web worker\n\t\n\t    var scope = this;\n\t\n\t    var jsonloader = new _three2['default'].XHRLoader(this.manager);\n\t    jsonloader.load(url, function (data) {\n\t\n\t      var json = JSON.parse(data);\n\t\n\t      var bufferUrl = binaryPath + json.buffers;\n\t\n\t      var bufferLoader = new _three2['default'].XHRLoader(scope.manager);\n\t      bufferLoader.setResponseType('arraybuffer');\n\t      bufferLoader.load(bufferUrl, function (bufData) {\n\t\n\t        // IEWEBGL needs this ???\n\t        //buffer = ( new Uint8Array( xhr.responseBody ) ).buffer;\n\t\n\t        //// iOS and other XMLHttpRequest level 1 ???\n\t\n\t        scope.parse(bufData, onLoad, texturePath, json.materials);\n\t      }, onProgress, onError);\n\t    }, onProgress, onError);\n\t  },\n\t\n\t  setBinaryPath: function setBinaryPath(value) {\n\t\n\t    this.binaryPath = value;\n\t  },\n\t\n\t  setCrossOrigin: function setCrossOrigin(value) {\n\t\n\t    this.crossOrigin = value;\n\t  },\n\t\n\t  setTexturePath: function setTexturePath(value) {\n\t\n\t    this.texturePath = value;\n\t  },\n\t\n\t  parse: function parse(data, callback, texturePath, jsonMaterials) {\n\t\n\t    var Model = function Model(texturePath) {\n\t\n\t      var scope = this,\n\t          currentOffset = 0,\n\t          md,\n\t          normals = [],\n\t          uvs = [],\n\t          start_tri_flat,\n\t          start_tri_smooth,\n\t          start_tri_flat_uv,\n\t          start_tri_smooth_uv,\n\t          start_quad_flat,\n\t          start_quad_smooth,\n\t          start_quad_flat_uv,\n\t          start_quad_smooth_uv,\n\t          tri_size,\n\t          quad_size,\n\t          len_tri_flat,\n\t          len_tri_smooth,\n\t          len_tri_flat_uv,\n\t          len_tri_smooth_uv,\n\t          len_quad_flat,\n\t          len_quad_smooth,\n\t          len_quad_flat_uv,\n\t          len_quad_smooth_uv;\n\t\n\t      _three2['default'].Geometry.call(this);\n\t\n\t      md = parseMetaData(data, currentOffset);\n\t\n\t      currentOffset += md.header_bytes;\n\t      /*\n\t       md.vertex_index_bytes = Uint32Array.BYTES_PER_ELEMENT;\n\t       md.material_index_bytes = Uint16Array.BYTES_PER_ELEMENT;\n\t       md.normal_index_bytes = Uint32Array.BYTES_PER_ELEMENT;\n\t       md.uv_index_bytes = Uint32Array.BYTES_PER_ELEMENT;\n\t       */\n\t      // buffers sizes\n\t\n\t      tri_size = md.vertex_index_bytes * 3 + md.material_index_bytes;\n\t      quad_size = md.vertex_index_bytes * 4 + md.material_index_bytes;\n\t\n\t      len_tri_flat = md.ntri_flat * tri_size;\n\t      len_tri_smooth = md.ntri_smooth * (tri_size + md.normal_index_bytes * 3);\n\t      len_tri_flat_uv = md.ntri_flat_uv * (tri_size + md.uv_index_bytes * 3);\n\t      len_tri_smooth_uv = md.ntri_smooth_uv * (tri_size + md.normal_index_bytes * 3 + md.uv_index_bytes * 3);\n\t\n\t      len_quad_flat = md.nquad_flat * quad_size;\n\t      len_quad_smooth = md.nquad_smooth * (quad_size + md.normal_index_bytes * 4);\n\t      len_quad_flat_uv = md.nquad_flat_uv * (quad_size + md.uv_index_bytes * 4);\n\t      len_quad_smooth_uv = md.nquad_smooth_uv * (quad_size + md.normal_index_bytes * 4 + md.uv_index_bytes * 4);\n\t\n\t      // read buffers\n\t\n\t      currentOffset += init_vertices(currentOffset);\n\t\n\t      currentOffset += init_normals(currentOffset);\n\t      currentOffset += handlePadding(md.nnormals * 3);\n\t\n\t      currentOffset += init_uvs(currentOffset);\n\t\n\t      start_tri_flat = currentOffset;\n\t      start_tri_smooth = start_tri_flat + len_tri_flat + handlePadding(md.ntri_flat * 2);\n\t      start_tri_flat_uv = start_tri_smooth + len_tri_smooth + handlePadding(md.ntri_smooth * 2);\n\t      start_tri_smooth_uv = start_tri_flat_uv + len_tri_flat_uv + handlePadding(md.ntri_flat_uv * 2);\n\t\n\t      start_quad_flat = start_tri_smooth_uv + len_tri_smooth_uv + handlePadding(md.ntri_smooth_uv * 2);\n\t      start_quad_smooth = start_quad_flat + len_quad_flat + handlePadding(md.nquad_flat * 2);\n\t      start_quad_flat_uv = start_quad_smooth + len_quad_smooth + handlePadding(md.nquad_smooth * 2);\n\t      start_quad_smooth_uv = start_quad_flat_uv + len_quad_flat_uv + handlePadding(md.nquad_flat_uv * 2);\n\t\n\t      // have to first process faces with uvs\n\t      // so that face and uv indices match\n\t\n\t      init_triangles_flat_uv(start_tri_flat_uv);\n\t      init_triangles_smooth_uv(start_tri_smooth_uv);\n\t\n\t      init_quads_flat_uv(start_quad_flat_uv);\n\t      init_quads_smooth_uv(start_quad_smooth_uv);\n\t\n\t      // now we can process untextured faces\n\t\n\t      init_triangles_flat(start_tri_flat);\n\t      init_triangles_smooth(start_tri_smooth);\n\t\n\t      init_quads_flat(start_quad_flat);\n\t      init_quads_smooth(start_quad_smooth);\n\t\n\t      this.computeFaceNormals();\n\t\n\t      function handlePadding(n) {\n\t\n\t        return n % 4 ? 4 - n % 4 : 0;\n\t      }\n\t\n\t      function parseMetaData(data, offset) {\n\t\n\t        var metaData = {\n\t\n\t          'signature': parseString(data, offset, 12),\n\t          'header_bytes': parseUChar8(data, offset + 12),\n\t\n\t          'vertex_coordinate_bytes': parseUChar8(data, offset + 13),\n\t          'normal_coordinate_bytes': parseUChar8(data, offset + 14),\n\t          'uv_coordinate_bytes': parseUChar8(data, offset + 15),\n\t\n\t          'vertex_index_bytes': parseUChar8(data, offset + 16),\n\t          'normal_index_bytes': parseUChar8(data, offset + 17),\n\t          'uv_index_bytes': parseUChar8(data, offset + 18),\n\t          'material_index_bytes': parseUChar8(data, offset + 19),\n\t\n\t          'nvertices': parseUInt32(data, offset + 20),\n\t          'nnormals': parseUInt32(data, offset + 20 + 4 * 1),\n\t          'nuvs': parseUInt32(data, offset + 20 + 4 * 2),\n\t\n\t          'ntri_flat': parseUInt32(data, offset + 20 + 4 * 3),\n\t          'ntri_smooth': parseUInt32(data, offset + 20 + 4 * 4),\n\t          'ntri_flat_uv': parseUInt32(data, offset + 20 + 4 * 5),\n\t          'ntri_smooth_uv': parseUInt32(data, offset + 20 + 4 * 6),\n\t\n\t          'nquad_flat': parseUInt32(data, offset + 20 + 4 * 7),\n\t          'nquad_smooth': parseUInt32(data, offset + 20 + 4 * 8),\n\t          'nquad_flat_uv': parseUInt32(data, offset + 20 + 4 * 9),\n\t          'nquad_smooth_uv': parseUInt32(data, offset + 20 + 4 * 10)\n\t\n\t        };\n\t        /*\n\t         console.log( \"signature: \" + metaData.signature );\n\t          console.log( \"header_bytes: \" + metaData.header_bytes );\n\t         console.log( \"vertex_coordinate_bytes: \" + metaData.vertex_coordinate_bytes );\n\t         console.log( \"normal_coordinate_bytes: \" + metaData.normal_coordinate_bytes );\n\t         console.log( \"uv_coordinate_bytes: \" + metaData.uv_coordinate_bytes );\n\t          console.log( \"vertex_index_bytes: \" + metaData.vertex_index_bytes );\n\t         console.log( \"normal_index_bytes: \" + metaData.normal_index_bytes );\n\t         console.log( \"uv_index_bytes: \" + metaData.uv_index_bytes );\n\t         console.log( \"material_index_bytes: \" + metaData.material_index_bytes );\n\t          console.log( \"nvertices: \" + metaData.nvertices );\n\t         console.log( \"nnormals: \" + metaData.nnormals );\n\t         console.log( \"nuvs: \" + metaData.nuvs );\n\t          console.log( \"ntri_flat: \" + metaData.ntri_flat );\n\t         console.log( \"ntri_smooth: \" + metaData.ntri_smooth );\n\t         console.log( \"ntri_flat_uv: \" + metaData.ntri_flat_uv );\n\t         console.log( \"ntri_smooth_uv: \" + metaData.ntri_smooth_uv );\n\t          console.log( \"nquad_flat: \" + metaData.nquad_flat );\n\t         console.log( \"nquad_smooth: \" + metaData.nquad_smooth );\n\t         console.log( \"nquad_flat_uv: \" + metaData.nquad_flat_uv );\n\t         console.log( \"nquad_smooth_uv: \" + metaData.nquad_smooth_uv );\n\t          var total = metaData.header_bytes\n\t         + metaData.nvertices * metaData.vertex_coordinate_bytes * 3\n\t         + metaData.nnormals * metaData.normal_coordinate_bytes * 3\n\t         + metaData.nuvs * metaData.uv_coordinate_bytes * 2\n\t         + metaData.ntri_flat * ( metaData.vertex_index_bytes*3 + metaData.material_index_bytes )\n\t         + metaData.ntri_smooth * ( metaData.vertex_index_bytes*3 + metaData.material_index_bytes + metaData.normal_index_bytes*3 )\n\t         + metaData.ntri_flat_uv * ( metaData.vertex_index_bytes*3 + metaData.material_index_bytes + metaData.uv_index_bytes*3 )\n\t         + metaData.ntri_smooth_uv * ( metaData.vertex_index_bytes*3 + metaData.material_index_bytes + metaData.normal_index_bytes*3 + metaData.uv_index_bytes*3 )\n\t         + metaData.nquad_flat * ( metaData.vertex_index_bytes*4 + metaData.material_index_bytes )\n\t         + metaData.nquad_smooth * ( metaData.vertex_index_bytes*4 + metaData.material_index_bytes + metaData.normal_index_bytes*4 )\n\t         + metaData.nquad_flat_uv * ( metaData.vertex_index_bytes*4 + metaData.material_index_bytes + metaData.uv_index_bytes*4 )\n\t         + metaData.nquad_smooth_uv * ( metaData.vertex_index_bytes*4 + metaData.material_index_bytes + metaData.normal_index_bytes*4 + metaData.uv_index_bytes*4 );\n\t         console.log( \"total bytes: \" + total );\n\t         */\n\t\n\t        return metaData;\n\t      }\n\t\n\t      function parseString(data, offset, length) {\n\t\n\t        var charArray = new Uint8Array(data, offset, length);\n\t\n\t        var text = \"\";\n\t\n\t        for (var i = 0; i < length; i++) {\n\t\n\t          text += String.fromCharCode(charArray[offset + i]);\n\t        }\n\t\n\t        return text;\n\t      }\n\t\n\t      function parseUChar8(data, offset) {\n\t\n\t        var charArray = new Uint8Array(data, offset, 1);\n\t\n\t        return charArray[0];\n\t      }\n\t\n\t      function parseUInt32(data, offset) {\n\t\n\t        var intArray = new Uint32Array(data, offset, 1);\n\t\n\t        return intArray[0];\n\t      }\n\t\n\t      function init_vertices(start) {\n\t\n\t        var nElements = md.nvertices;\n\t\n\t        var coordArray = new Float32Array(data, start, nElements * 3);\n\t\n\t        var i, x, y, z;\n\t\n\t        for (i = 0; i < nElements; i++) {\n\t\n\t          x = coordArray[i * 3];\n\t          y = coordArray[i * 3 + 1];\n\t          z = coordArray[i * 3 + 2];\n\t\n\t          scope.vertices.push(new _three2['default'].Vector3(x, y, z));\n\t        }\n\t\n\t        return nElements * 3 * Float32Array.BYTES_PER_ELEMENT;\n\t      }\n\t\n\t      function init_normals(start) {\n\t\n\t        var nElements = md.nnormals;\n\t\n\t        if (nElements) {\n\t\n\t          var normalArray = new Int8Array(data, start, nElements * 3);\n\t\n\t          var i, x, y, z;\n\t\n\t          for (i = 0; i < nElements; i++) {\n\t\n\t            x = normalArray[i * 3];\n\t            y = normalArray[i * 3 + 1];\n\t            z = normalArray[i * 3 + 2];\n\t\n\t            normals.push(x / 127, y / 127, z / 127);\n\t          }\n\t        }\n\t\n\t        return nElements * 3 * Int8Array.BYTES_PER_ELEMENT;\n\t      }\n\t\n\t      function init_uvs(start) {\n\t\n\t        var nElements = md.nuvs;\n\t\n\t        if (nElements) {\n\t\n\t          var uvArray = new Float32Array(data, start, nElements * 2);\n\t\n\t          var i, u, v;\n\t\n\t          for (i = 0; i < nElements; i++) {\n\t\n\t            u = uvArray[i * 2];\n\t            v = uvArray[i * 2 + 1];\n\t\n\t            uvs.push(u, v);\n\t          }\n\t        }\n\t\n\t        return nElements * 2 * Float32Array.BYTES_PER_ELEMENT;\n\t      }\n\t\n\t      function init_uvs3(nElements, offset) {\n\t\n\t        var i, uva, uvb, uvc, u1, u2, u3, v1, v2, v3;\n\t\n\t        var uvIndexBuffer = new Uint32Array(data, offset, 3 * nElements);\n\t\n\t        for (i = 0; i < nElements; i++) {\n\t\n\t          uva = uvIndexBuffer[i * 3];\n\t          uvb = uvIndexBuffer[i * 3 + 1];\n\t          uvc = uvIndexBuffer[i * 3 + 2];\n\t\n\t          u1 = uvs[uva * 2];\n\t          v1 = uvs[uva * 2 + 1];\n\t\n\t          u2 = uvs[uvb * 2];\n\t          v2 = uvs[uvb * 2 + 1];\n\t\n\t          u3 = uvs[uvc * 2];\n\t          v3 = uvs[uvc * 2 + 1];\n\t\n\t          scope.faceVertexUvs[0].push([new _three2['default'].Vector2(u1, v1), new _three2['default'].Vector2(u2, v2), new _three2['default'].Vector2(u3, v3)]);\n\t        }\n\t      }\n\t\n\t      function init_uvs4(nElements, offset) {\n\t\n\t        var i, uva, uvb, uvc, uvd, u1, u2, u3, u4, v1, v2, v3, v4;\n\t\n\t        var uvIndexBuffer = new Uint32Array(data, offset, 4 * nElements);\n\t\n\t        for (i = 0; i < nElements; i++) {\n\t\n\t          uva = uvIndexBuffer[i * 4];\n\t          uvb = uvIndexBuffer[i * 4 + 1];\n\t          uvc = uvIndexBuffer[i * 4 + 2];\n\t          uvd = uvIndexBuffer[i * 4 + 3];\n\t\n\t          u1 = uvs[uva * 2];\n\t          v1 = uvs[uva * 2 + 1];\n\t\n\t          u2 = uvs[uvb * 2];\n\t          v2 = uvs[uvb * 2 + 1];\n\t\n\t          u3 = uvs[uvc * 2];\n\t          v3 = uvs[uvc * 2 + 1];\n\t\n\t          u4 = uvs[uvd * 2];\n\t          v4 = uvs[uvd * 2 + 1];\n\t\n\t          scope.faceVertexUvs[0].push([new _three2['default'].Vector2(u1, v1), new _three2['default'].Vector2(u2, v2), new _three2['default'].Vector2(u4, v4)]);\n\t\n\t          scope.faceVertexUvs[0].push([new _three2['default'].Vector2(u2, v2), new _three2['default'].Vector2(u3, v3), new _three2['default'].Vector2(u4, v4)]);\n\t        }\n\t      }\n\t\n\t      function init_faces3_flat(nElements, offsetVertices, offsetMaterials) {\n\t\n\t        var i, a, b, c, m;\n\t\n\t        var vertexIndexBuffer = new Uint32Array(data, offsetVertices, 3 * nElements);\n\t        var materialIndexBuffer = new Uint16Array(data, offsetMaterials, nElements);\n\t\n\t        for (i = 0; i < nElements; i++) {\n\t\n\t          a = vertexIndexBuffer[i * 3];\n\t          b = vertexIndexBuffer[i * 3 + 1];\n\t          c = vertexIndexBuffer[i * 3 + 2];\n\t\n\t          m = materialIndexBuffer[i];\n\t\n\t          scope.faces.push(new _three2['default'].Face3(a, b, c, null, null, m));\n\t        }\n\t      }\n\t\n\t      function init_faces4_flat(nElements, offsetVertices, offsetMaterials) {\n\t\n\t        var i, a, b, c, d, m;\n\t\n\t        var vertexIndexBuffer = new Uint32Array(data, offsetVertices, 4 * nElements);\n\t        var materialIndexBuffer = new Uint16Array(data, offsetMaterials, nElements);\n\t\n\t        for (i = 0; i < nElements; i++) {\n\t\n\t          a = vertexIndexBuffer[i * 4];\n\t          b = vertexIndexBuffer[i * 4 + 1];\n\t          c = vertexIndexBuffer[i * 4 + 2];\n\t          d = vertexIndexBuffer[i * 4 + 3];\n\t\n\t          m = materialIndexBuffer[i];\n\t\n\t          scope.faces.push(new _three2['default'].Face3(a, b, d, null, null, m));\n\t          scope.faces.push(new _three2['default'].Face3(b, c, d, null, null, m));\n\t        }\n\t      }\n\t\n\t      function init_faces3_smooth(nElements, offsetVertices, offsetNormals, offsetMaterials) {\n\t\n\t        var i, a, b, c, m;\n\t        var na, nb, nc;\n\t\n\t        var vertexIndexBuffer = new Uint32Array(data, offsetVertices, 3 * nElements);\n\t        var normalIndexBuffer = new Uint32Array(data, offsetNormals, 3 * nElements);\n\t        var materialIndexBuffer = new Uint16Array(data, offsetMaterials, nElements);\n\t\n\t        for (i = 0; i < nElements; i++) {\n\t\n\t          a = vertexIndexBuffer[i * 3];\n\t          b = vertexIndexBuffer[i * 3 + 1];\n\t          c = vertexIndexBuffer[i * 3 + 2];\n\t\n\t          na = normalIndexBuffer[i * 3];\n\t          nb = normalIndexBuffer[i * 3 + 1];\n\t          nc = normalIndexBuffer[i * 3 + 2];\n\t\n\t          m = materialIndexBuffer[i];\n\t\n\t          var nax = normals[na * 3],\n\t              nay = normals[na * 3 + 1],\n\t              naz = normals[na * 3 + 2],\n\t              nbx = normals[nb * 3],\n\t              nby = normals[nb * 3 + 1],\n\t              nbz = normals[nb * 3 + 2],\n\t              ncx = normals[nc * 3],\n\t              ncy = normals[nc * 3 + 1],\n\t              ncz = normals[nc * 3 + 2];\n\t\n\t          scope.faces.push(new _three2['default'].Face3(a, b, c, [new _three2['default'].Vector3(nax, nay, naz), new _three2['default'].Vector3(nbx, nby, nbz), new _three2['default'].Vector3(ncx, ncy, ncz)], null, m));\n\t        }\n\t      }\n\t\n\t      function init_faces4_smooth(nElements, offsetVertices, offsetNormals, offsetMaterials) {\n\t\n\t        var i, a, b, c, d, m;\n\t        var na, nb, nc, nd;\n\t\n\t        var vertexIndexBuffer = new Uint32Array(data, offsetVertices, 4 * nElements);\n\t        var normalIndexBuffer = new Uint32Array(data, offsetNormals, 4 * nElements);\n\t        var materialIndexBuffer = new Uint16Array(data, offsetMaterials, nElements);\n\t\n\t        for (i = 0; i < nElements; i++) {\n\t\n\t          a = vertexIndexBuffer[i * 4];\n\t          b = vertexIndexBuffer[i * 4 + 1];\n\t          c = vertexIndexBuffer[i * 4 + 2];\n\t          d = vertexIndexBuffer[i * 4 + 3];\n\t\n\t          na = normalIndexBuffer[i * 4];\n\t          nb = normalIndexBuffer[i * 4 + 1];\n\t          nc = normalIndexBuffer[i * 4 + 2];\n\t          nd = normalIndexBuffer[i * 4 + 3];\n\t\n\t          m = materialIndexBuffer[i];\n\t\n\t          var nax = normals[na * 3],\n\t              nay = normals[na * 3 + 1],\n\t              naz = normals[na * 3 + 2],\n\t              nbx = normals[nb * 3],\n\t              nby = normals[nb * 3 + 1],\n\t              nbz = normals[nb * 3 + 2],\n\t              ncx = normals[nc * 3],\n\t              ncy = normals[nc * 3 + 1],\n\t              ncz = normals[nc * 3 + 2],\n\t              ndx = normals[nd * 3],\n\t              ndy = normals[nd * 3 + 1],\n\t              ndz = normals[nd * 3 + 2];\n\t\n\t          scope.faces.push(new _three2['default'].Face3(a, b, d, [new _three2['default'].Vector3(nax, nay, naz), new _three2['default'].Vector3(nbx, nby, nbz), new _three2['default'].Vector3(ndx, ndy, ndz)], null, m));\n\t\n\t          scope.faces.push(new _three2['default'].Face3(b, c, d, [new _three2['default'].Vector3(nbx, nby, nbz), new _three2['default'].Vector3(ncx, ncy, ncz), new _three2['default'].Vector3(ndx, ndy, ndz)], null, m));\n\t        }\n\t      }\n\t\n\t      function init_triangles_flat(start) {\n\t\n\t        var nElements = md.ntri_flat;\n\t\n\t        if (nElements) {\n\t\n\t          var offsetMaterials = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n\t          init_faces3_flat(nElements, start, offsetMaterials);\n\t        }\n\t      }\n\t\n\t      function init_triangles_flat_uv(start) {\n\t\n\t        var nElements = md.ntri_flat_uv;\n\t\n\t        if (nElements) {\n\t\n\t          var offsetUvs = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n\t          var offsetMaterials = offsetUvs + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n\t\n\t          init_faces3_flat(nElements, start, offsetMaterials);\n\t          init_uvs3(nElements, offsetUvs);\n\t        }\n\t      }\n\t\n\t      function init_triangles_smooth(start) {\n\t\n\t        var nElements = md.ntri_smooth;\n\t\n\t        if (nElements) {\n\t\n\t          var offsetNormals = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n\t          var offsetMaterials = offsetNormals + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n\t\n\t          init_faces3_smooth(nElements, start, offsetNormals, offsetMaterials);\n\t        }\n\t      }\n\t\n\t      function init_triangles_smooth_uv(start) {\n\t\n\t        var nElements = md.ntri_smooth_uv;\n\t\n\t        if (nElements) {\n\t\n\t          var offsetNormals = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n\t          var offsetUvs = offsetNormals + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n\t          var offsetMaterials = offsetUvs + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n\t\n\t          init_faces3_smooth(nElements, start, offsetNormals, offsetMaterials);\n\t          init_uvs3(nElements, offsetUvs);\n\t        }\n\t      }\n\t\n\t      function init_quads_flat(start) {\n\t\n\t        var nElements = md.nquad_flat;\n\t\n\t        if (nElements) {\n\t\n\t          var offsetMaterials = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n\t          init_faces4_flat(nElements, start, offsetMaterials);\n\t        }\n\t      }\n\t\n\t      function init_quads_flat_uv(start) {\n\t\n\t        var nElements = md.nquad_flat_uv;\n\t\n\t        if (nElements) {\n\t\n\t          var offsetUvs = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n\t          var offsetMaterials = offsetUvs + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n\t\n\t          init_faces4_flat(nElements, start, offsetMaterials);\n\t          init_uvs4(nElements, offsetUvs);\n\t        }\n\t      }\n\t\n\t      function init_quads_smooth(start) {\n\t\n\t        var nElements = md.nquad_smooth;\n\t\n\t        if (nElements) {\n\t\n\t          var offsetNormals = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n\t          var offsetMaterials = offsetNormals + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n\t\n\t          init_faces4_smooth(nElements, start, offsetNormals, offsetMaterials);\n\t        }\n\t      }\n\t\n\t      function init_quads_smooth_uv(start) {\n\t\n\t        var nElements = md.nquad_smooth_uv;\n\t\n\t        if (nElements) {\n\t\n\t          var offsetNormals = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n\t          var offsetUvs = offsetNormals + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n\t          var offsetMaterials = offsetUvs + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n\t\n\t          init_faces4_smooth(nElements, start, offsetNormals, offsetMaterials);\n\t          init_uvs4(nElements, offsetUvs);\n\t        }\n\t      }\n\t    };\n\t\n\t    Model.prototype = Object.create(_three2['default'].Geometry.prototype);\n\t    Model.prototype.constructor = Model;\n\t\n\t    var geometry = new Model(texturePath);\n\t    var materials = _three2['default'].Loader.prototype.initMaterials(jsonMaterials, texturePath, this.crossOrigin);\n\t\n\t    callback(geometry, materials);\n\t  }\n\t\n\t};\n\t\n\texports['default'] = BinaryLoader;\n\t\n\t_three2['default'].BinaryLoader = BinaryLoader;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 88 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\t/**\n\t * Created by masayuki on 20/07/2016.\n\t */\n\t\n\tvar _SimObject2 = __webpack_require__(77);\n\t\n\tvar _SimObject3 = _interopRequireDefault(_SimObject2);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar TOTAL_FRAMES = 60;\n\t\n\tvar Pedestrian = (function (_SimObject) {\n\t  _inherits(Pedestrian, _SimObject);\n\t\n\t  function Pedestrian(pedestrianModel, callback) {\n\t    _classCallCheck(this, Pedestrian);\n\t\n\t    _get(Object.getPrototypeOf(Pedestrian.prototype), 'constructor', this).call(this);\n\t\n\t    // parameters\n\t    this.model = pedestrianModel;\n\t    this.callback = callback || function (self) {};\n\t\n\t    // properties\n\t    this.lastKeyFrame = 0;\n\t    this.currentKeyFrame = 0;\n\t    this.updateMorph = true;\n\t\n\t    // Meshes\n\t    this.bodyMesh = null;\n\t\n\t    // --- make a pedestrian\n\t    this._createPedestrian();\n\t  }\n\t\n\t  _createClass(Pedestrian, [{\n\t    key: 'update',\n\t    value: function update(delta) {\n\t      _get(Object.getPrototypeOf(Pedestrian.prototype), 'update', this).call(this, delta);\n\t\n\t      // morph animation\n\t      if (this.updateMorph) {\n\t        this.bodyMesh.update(delta);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_createPedestrian',\n\t    value: function _createPedestrian() {\n\t      var self = this;\n\t\n\t      if (this.model.loaded) {\n\t        var root = new _three2['default'].Object3D();\n\t\n\t        // retrieve parameters from vehicleModel\n\t        var modelScale = this.model.scale;\n\t        var modelTranslation = this.model.translation;\n\t        var modelRotation = this.model.rotation;\n\t        var bodyGeometry = this.model.bodyGeometry;\n\t        var bodyMaterials = this.model.bodyMaterials;\n\t\n\t        // temporary variables\n\t        var s = modelScale,\n\t            t = modelTranslation,\n\t            r = modelRotation;\n\t        var delta = new _three2['default'].Vector3();\n\t\n\t        // materials\n\t        var bodyFaceMaterial = new _three2['default'].MeshFaceMaterial(bodyMaterials);\n\t\n\t        // create body mesh\n\t        this.bodyMesh = new _three2['default'].MorphBlendMesh(bodyGeometry, bodyFaceMaterial);\n\t        this.bodyMesh.scale.set(s, s, s);\n\t        this.bodyMesh.animationsList.forEach(function (animation) {\n\t          animation.active = true; // activate all animations\n\t        });\n\t        root.add(this.bodyMesh);\n\t\n\t        // translation and rotation\n\t        root.position.set(t.x, t.y, t.z);\n\t        root.rotation.set(r.x, r.y, r.z);\n\t\n\t        // finish\n\t        this.add(root);\n\t\n\t        // adjust the label\n\t        this._adjustLabelOffset();\n\t\n\t        // callback\n\t        if (this.callback) {\n\t          this.callback(self);\n\t        }\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return Pedestrian;\n\t})(_SimObject3['default']);\n\t\n\texports['default'] = Pedestrian;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 89 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// TODO: Move duplicated logic between geometry layrs into GeometryLayer\n\t\n\t// TODO: Look at ways to drop unneeded references to array buffers, etc to\n\t// reduce memory footprint\n\t\n\t// TODO: Support dynamic updating / hiding / animation of geometry\n\t//\n\t// This could be pretty hard as it's all packed away within BufferGeometry and\n\t// may even be merged by another layer (eg. GeoJSONLayer)\n\t//\n\t// How much control should this layer support? Perhaps a different or custom\n\t// layer would be better suited for animation, for example.\n\t\n\t// TODO: Allow _setBufferAttributes to use a custom function passed in to\n\t// generate a custom mesh\n\t\n\tvar _SimObjectLayer2 = __webpack_require__(75);\n\t\n\tvar _SimObjectLayer3 = _interopRequireDefault(_SimObjectLayer2);\n\t\n\tvar _lodashAssign = __webpack_require__(3);\n\t\n\tvar _lodashAssign2 = _interopRequireDefault(_lodashAssign);\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _geoLatLon = __webpack_require__(5);\n\t\n\tvar _geoPoint = __webpack_require__(6);\n\t\n\tvar _earcut = __webpack_require__(64);\n\t\n\tvar _earcut2 = _interopRequireDefault(_earcut);\n\t\n\tvar _utilExtrudePolygon = __webpack_require__(65);\n\t\n\tvar _utilExtrudePolygon2 = _interopRequireDefault(_utilExtrudePolygon);\n\t\n\tvar _utilBuffer = __webpack_require__(66);\n\t\n\tvar _utilBuffer2 = _interopRequireDefault(_utilBuffer);\n\t\n\tvar _vendorGPUComputationRenderer = __webpack_require__(76);\n\t\n\tvar _vendorGPUComputationRenderer2 = _interopRequireDefault(_vendorGPUComputationRenderer);\n\t\n\tvar _VehicleModel = __webpack_require__(90);\n\t\n\tvar _VehicleModel2 = _interopRequireDefault(_VehicleModel);\n\t\n\tvar _ModelRepository = __webpack_require__(85);\n\t\n\tvar _ModelRepository2 = _interopRequireDefault(_ModelRepository);\n\t\n\tvar _Vehicle = __webpack_require__(91);\n\t\n\tvar _Vehicle2 = _interopRequireDefault(_Vehicle);\n\t\n\tvar _vendorBinaryLoader = __webpack_require__(87);\n\t\n\tvar _vendorBinaryLoader2 = _interopRequireDefault(_vendorBinaryLoader);\n\t\n\tvar _VehicleVelocityShader = __webpack_require__(78);\n\t\n\tvar _VehicleVelocityShader2 = _interopRequireDefault(_VehicleVelocityShader);\n\t\n\tvar _VehiclePositionShader = __webpack_require__(79);\n\t\n\tvar _VehiclePositionShader2 = _interopRequireDefault(_VehiclePositionShader);\n\t\n\tvar _VehicleShader = __webpack_require__(80);\n\t\n\tvar _VehicleShader2 = _interopRequireDefault(_VehicleShader);\n\t\n\tvar _utilObjectUtils = __webpack_require__(81);\n\t\n\tvar _utilObjectUtils2 = _interopRequireDefault(_utilObjectUtils);\n\t\n\tvar MODEL_PREFIX = 'vehicle:';\n\t\n\tvar VehicleLayer = (function (_SimObjectLayer) {\n\t  _inherits(VehicleLayer, _SimObjectLayer);\n\t\n\t  function VehicleLayer(models, options) {\n\t    _classCallCheck(this, VehicleLayer);\n\t\n\t    var defaults = {\n\t      output: true\n\t    };\n\t\n\t    var _options = (0, _lodashAssign2['default'])({}, defaults, options);\n\t\n\t    _get(Object.getPrototypeOf(VehicleLayer.prototype), 'constructor', this).call(this, _options);\n\t\n\t    var modelDefaults = {\n\t      file: {\n\t        body: null,\n\t        wheel: null\n\t      },\n\t      scale: 1,\n\t      translation: { x: 0, y: 0, z: 0 },\n\t      rotation: { rx: 0, ry: 0, rz: 0 }\n\t    };\n\t    for (key in models) {\n\t      models[key] = (0, _lodashAssign2['default'])({}, modelDefaults, models[key]);\n\t    }\n\t\n\t    this._modelsLoaded = false;\n\t    this._models = (0, _lodashAssign2['default'])({}, models);\n\t    this._entries = [];\n\t  }\n\t\n\t  _createClass(VehicleLayer, [{\n\t    key: '_onAdd',\n\t    value: function _onAdd(world) {\n\t      _get(Object.getPrototypeOf(VehicleLayer.prototype), '_onAdd', this).call(this, world);\n\t\n\t      if (this.isOutput()) {\n\t        // add callback\n\t        this.on('loadCompleted', this._onLoadCompleted);\n\t\n\t        // load models\n\t        this._loadModels();\n\t      }\n\t    }\n\t  }, {\n\t    key: '_loadModels',\n\t    value: function _loadModels() {\n\t      var self = this;\n\t\n\t      // load models iteratively\n\t      var models = this._models;\n\t      Object.keys(models).forEach(function (modelName) {\n\t        var model = models[modelName];\n\t\n\t        var scale = 1.0;\n\t        var translation = new _three2['default'].Vector3();\n\t        var rotation = new _three2['default'].Vector3();\n\t        var wheelOffset = null;\n\t\n\t        if (model.scale) {\n\t          scale = model.scale;\n\t        }\n\t        if (model.translation) {\n\t          translation.set(model.translation.x, model.translation.y, model.translation.z);\n\t        }\n\t        if (model.rotation) {\n\t          rotation.set(model.rotation.x, model.rotation.y, model.rotation.z);\n\t        }\n\t        if (model.wheelOffset) {\n\t          wheelOffset = new _three2['default'].Vector3(model.wheelOffset.x, model.wheelOffset.y, model.wheelOffset.z);\n\t        }\n\t\n\t        // create a model\n\t        var vehicleModel = new _VehicleModel2['default']({\n\t          bodyURL: model.file.body,\n\t          wheelURL: model.file.wheel,\n\t          scale: scale,\n\t          translation: translation,\n\t          rotation: rotation,\n\t          wheelOffset: wheelOffset\n\t        }, callback);\n\t\n\t        // register to the repos\n\t        _ModelRepository2['default'].add(MODEL_PREFIX + modelName, vehicleModel);\n\t      });\n\t\n\t      // callback\n\t      var counter = 0;\n\t      var len = Object.keys(models).length;\n\t      function callback(scope) {\n\t        if (++counter >= len) {\n\t          // loaded all models\n\t          self.emit('loadCompleted');\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: '_onLoadCompleted',\n\t    value: function _onLoadCompleted() {\n\t      this._modelsLoaded = true;\n\t\n\t      // iterate over all the vehicles already added and add meshes to the world\n\t      for (var i = 0; i < this._entries.length; i++) {\n\t        var entry = this._entries[i];\n\t        if (entry.vehicle === null) {\n\t          this._addVehicleInternal(entry);\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'addVehicle',\n\t    value: function addVehicle(modelName, latlon, angle, options) {\n\t      if (!_ModelRepository2['default'].contains(MODEL_PREFIX + modelName)) {\n\t        throw new Error('Vehicle model ' + modelName + ' does not exist.');\n\t      }\n\t\n\t      var self = this;\n\t\n\t      var entry = {\n\t        id: undefined,\n\t        modelName: modelName,\n\t        latlon: latlon,\n\t        angle: angle,\n\t        options: options,\n\t        vehicle: null\n\t      };\n\t      var total = this._entries.push(entry);\n\t      entry.id = total - 1;\n\t\n\t      // add vehicle if the model is already loaded\n\t      this._addVehicleInternal(entry);\n\t\n\t      return entry;\n\t    }\n\t  }, {\n\t    key: '_addVehicleInternal',\n\t    value: function _addVehicleInternal(entry) {\n\t      if (this._modelsLoaded) {\n\t\n\t        // instantiate the vehicle\n\t        var vehicleModel = _ModelRepository2['default'].get(MODEL_PREFIX + entry.modelName);\n\t        var vehicle = new _Vehicle2['default'](vehicleModel);\n\t\n\t        // add the vehicle to the layer\n\t        this.add(vehicle);\n\t        entry.vehicle = vehicle;\n\t\n\t        // set the vehicle's location\n\t        this.setLocation(entry.id, entry.latlon.lat, entry.latlon.lon, entry.angle);\n\t\n\t        // var id = vehicle.id;\n\t        //\n\t        // var model = this._models[vehicle.modelName];\n\t        // var geometry = this._geometries[vehicle.modelName];\n\t        //\n\t        // var material = new THREE.MeshLambertMaterial({ color: 0x995500, opacity: 1.0, transparent: false });\n\t        // // var material = new THREE.ShaderMaterial({\n\t        // //   uniforms: {\n\t        // //     'reference':        { type: 'v2', value: null },\n\t        // //     'texturePosition':  { type: 't',  value: null },\n\t        // //     'texture':          { type: 't',  value: null },\n\t        // //     'color':            { type: 'c',  value: new THREE.Color(0x995500) }\n\t        // //   },\n\t        // //   vertexShader: VehicleShader.vertexShader,\n\t        // //   fragmentShader: VehicleShader.fragmentShader\n\t        // // });\n\t        // // material.uniforms.reference.value = new THREE.Vector2(x, y);\n\t        //\n\t        // var mesh = new THREE.Mesh(geometry, material);\n\t        // mesh.scale.x = mesh.scale.y = mesh.scale.z = model.scale;\n\t        // mesh.rotation.set(model.rotation.rx, model.rotation.ry, model.rotation.rz);\n\t        // mesh.position.set(model.translation.x, model.translation.y, model.translation.z);\n\t        //\n\t        // this.add(mesh);\n\t        // vehicle.model = model;\n\t        // vehicle.mesh = mesh;\n\t        // vehicle.setLocation(vehicle.latlon.lat, vehicle.latlon.lon, vehicle.angle);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getVehicle',\n\t    value: function getVehicle(id) {\n\t      if (id in this._entries) {\n\t        return this._entries[id];\n\t      }\n\t      return null;\n\t    }\n\t  }, {\n\t    key: '_setVelocity',\n\t    value: function _setVelocity(id, vx, vy, vz, wheel) {\n\t      _get(Object.getPrototypeOf(VehicleLayer.prototype), '_setVelocity', this).call(this, id, vx, vy, vz, wheel);\n\t\n\t      // if the vehicle exists\n\t      if (id in this._simObjects) {\n\t        var simObject = this._simObjects[id];\n\t        simObject.setWheelAngle(wheel);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      // Run common destruction logic from parent\n\t      _get(Object.getPrototypeOf(VehicleLayer.prototype), 'destroy', this).call(this);\n\t    }\n\t  }]);\n\t\n\t  return VehicleLayer;\n\t})(_SimObjectLayer3['default']);\n\t\n\texports['default'] = VehicleLayer;\n\t\n\tvar noNew = function noNew(models, options) {\n\t  return new VehicleLayer(models, options);\n\t};\n\t\n\texports.vehicleLayer = noNew;\n\n/***/ },\n/* 90 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t/**\n\t * Created by masayuki on 17/07/2016.\n\t */\n\t\n\tvar _three = __webpack_require__(8);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _vendorBinaryLoader = __webpack_require__(87);\n\t\n\tvar _vendorBinaryLoader2 = _interopRequireDefault(_vendorBinaryLoader);\n\t\n\tvar _utilObjectUtils = __webpack_require__(81);\n\t\n\tvar _utilObjectUtils2 = _interopRequireDefault(_utilObjectUtils);\n\t\n\tvar VehicleModel = function VehicleModel(parameters, callback) {\n\t\n\t  var scope = this;\n\t  var p = parameters;\n\t\n\t  // file paths\n\t  this.bodyURL = p.bodyURL || null;\n\t  this.wheelURL = p.wheelURL || null;\n\t\n\t  // parameters\n\t  this.scale = p.scale || 1.0;\n\t  this.translation = p.translation || new _three2['default'].Vector3();\n\t  this.rotation = p.rotation || new _three2['default'].Vector3();\n\t  this.wheelOffset = p.wheelOffset || new _three2['default'].Vector3();\n\t  this.autoWheelOffset = p.autoWheelOffset || true;\n\t\n\t  // properties\n\t  this.wheelDiameter = 1.0;\n\t\n\t  // callback\n\t  this.callback = callback;\n\t\n\t  // status\n\t  this.loaded = false;\n\t\n\t  // internal use\n\t  this.bodyGeometry = null;\n\t  this.bodyMaterials = null;\n\t\n\t  this.wheelGeometry = null;\n\t  this.wheelMaterials = null;\n\t\n\t  // construct\n\t  if (scope.bodyURL && scope.wheelURL) {\n\t    // load binaries\n\t    var bloader = new _three2['default'].BinaryLoader();\n\t    bloader.load(scope.bodyURL, function (geometry, materials) {\n\t      createBody(geometry, materials);\n\t    });\n\t    bloader.load(scope.wheelURL, function (geometry, materials) {\n\t      createWheel(geometry, materials);\n\t    });\n\t  }\n\t\n\t  // internal helper methods\n\t  function createBody(geometry, materials) {\n\t    geometry.sortFacesByMaterialIndex();\n\t    geometry.computeVertexNormals();\n\t\n\t    scope.bodyGeometry = geometry;\n\t    scope.bodyMaterials = materials;\n\t\n\t    onCreated();\n\t  }\n\t  function createWheel(geometry, materials) {\n\t    geometry.sortFacesByMaterialIndex();\n\t    geometry.computeVertexNormals();\n\t\n\t    scope.wheelGeometry = geometry;\n\t    scope.wheelMaterials = materials;\n\t\n\t    onCreated();\n\t  }\n\t  function onCreated() {\n\t    if (scope.bodyGeometry && scope.wheelGeometry) {\n\t      scope.loaded = true;\n\t\n\t      // wheel\n\t      scope.wheelGeometry.computeBoundingBox();\n\t      var wbb = scope.wheelGeometry.boundingBox;\n\t\n\t      // compute wheel diameter\n\t      scope.wheelDiameter = wbb.max.y - wbb.min.y;\n\t\n\t      // compute wheel offsets\n\t      if (scope.autoWheelOffset) {\n\t        scope.wheelOffset.addVectors(wbb.min, wbb.max);\n\t        scope.wheelOffset.multiplyScalar(0.5);\n\t\n\t        scope.wheelGeometry.center();\n\t      }\n\t\n\t      // callback\n\t      if (scope.callback) {\n\t        scope.callback(scope);\n\t      }\n\t    }\n\t  }\n\t};\n\t\n\texports['default'] = VehicleModel;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 91 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// jscs:disable\n\t/* eslint-disable */\n\t\n\t/**\n\t * Created by masayuki on 17/07/2016.\n\t */\n\t\n\tvar _SimObject2 = __webpack_require__(77);\n\t\n\tvar _SimObject3 = _interopRequireDefault(_SimObject2);\n\t\n\tvar Vehicle = (function (_SimObject) {\n\t  _inherits(Vehicle, _SimObject);\n\t\n\t  function Vehicle(vehicleModel, callback) {\n\t    _classCallCheck(this, Vehicle);\n\t\n\t    _get(Object.getPrototypeOf(Vehicle.prototype), 'constructor', this).call(this);\n\t\n\t    // parameters\n\t    this.model = vehicleModel;\n\t    this.callback = callback || function (self) {};\n\t\n\t    // properties\n\t    this.wheelAngle = 0.0;\n\t    this.wheelDiameter = 1.0;\n\t    this.updateWheel = true;\n\t\n\t    // 3D Object\n\t    this.frontLeftWheelRoot = new THREE.Object3D();\n\t    this.frontRightWheelRoot = new THREE.Object3D();\n\t\n\t    // Meshes\n\t    this.bodyMesh = null;\n\t    this.frontLeftWheelMesh = null;\n\t    this.frontRightWheelMesh = null;\n\t    this.rearLeftWheelMesh = null;\n\t    this.rearRightWheelMesh = null;\n\t\n\t    // --- constants\n\t    this.STEERING_RADIUS_RATIO = 0.0023 / vehicleModel.scale;\n\t\n\t    // --- make a vehicle\n\t    this._createVehicle();\n\t  }\n\t\n\t  // --- API\n\t  /**\n\t   * sets the vehicle's wheel angle, relative to the vehicle\n\t   * @param wheelAngle angle in [rad]\n\t   */\n\t\n\t  _createClass(Vehicle, [{\n\t    key: 'setWheelAngle',\n\t    value: function setWheelAngle(wheelAngle) {\n\t      this.wheelAngle = wheelAngle;\n\t\n\t      this.frontLeftWheelRoot.rotation.y = wheelAngle;\n\t      this.frontRightWheelRoot.rotation.y = wheelAngle;\n\t    }\n\t  }, {\n\t    key: 'setVelocity',\n\t\n\t    /**\n\t     * sets the vehicle's velocity\n\t     * @param velocity velocity in [m/s]\n\t     */\n\t    value: function setVelocity(velocity) {\n\t      _get(Object.getPrototypeOf(Vehicle.prototype), 'setVelocity', this).call(this, velocity);\n\t    }\n\t\n\t    /**\n\t     * update the vehicle\n\t     * @param delta\n\t     */\n\t  }, {\n\t    key: 'update',\n\t    value: function update(delta) {\n\t\n\t      var forwardDelta = delta * this.velocity;\n\t\n\t      // position\n\t      if (this.updatePosition) {\n\t        this.angle += forwardDelta * this.STEERING_RADIUS_RATIO * this.wheelAngle;\n\t      }\n\t\n\t      _get(Object.getPrototypeOf(Vehicle.prototype), 'update', this).call(this, delta);\n\t\n\t      // wheels rolling\n\t      if (this.updateWheel) {\n\t        var angularSpeedRatio = 1 / (this.model.scale * (this.wheelDiameter / 2.));\n\t        var wheelDelta = forwardDelta * angularSpeedRatio;\n\t\n\t        this.frontLeftWheelMesh.rotation.x += wheelDelta;\n\t        this.frontRightWheelMesh.rotation.x += wheelDelta;\n\t        this.rearLeftWheelMesh.rotation.x += wheelDelta;\n\t        this.rearRightWheelMesh.rotation.x += wheelDelta;\n\t      }\n\t    }\n\t\n\t    // --- internal helper methods\n\t  }, {\n\t    key: '_createVehicle',\n\t    value: function _createVehicle() {\n\t      var self = this;\n\t\n\t      if (this.model.loaded) {\n\t        var root = new THREE.Object3D();\n\t\n\t        // retrieve parameters from vehicleModel\n\t        var modelScale = this.model.scale;\n\t        var modelTranslation = this.model.translation;\n\t        var modelRotation = this.model.rotation;\n\t        var wheelOffset = this.model.wheelOffset;\n\t        var wheelDiameter = this.model.wheelDiameter;\n\t        var bodyGeometry = this.model.bodyGeometry;\n\t        var bodyMaterials = this.model.bodyMaterials;\n\t        var wheelGeometry = this.model.wheelGeometry;\n\t        var wheelMaterials = this.model.wheelMaterials;\n\t\n\t        // properties\n\t        this.wheelDiameter = wheelDiameter;\n\t\n\t        // temporary variables\n\t        var s = modelScale,\n\t            t = modelTranslation,\n\t            r = modelRotation;\n\t        var delta = new THREE.Vector3();\n\t\n\t        // setup combined materials\n\t        var bodyFaceMaterial = new THREE.MultiMaterial(bodyMaterials);\n\t        var wheelFaceMaterial = new THREE.MultiMaterial(wheelMaterials);\n\t        // var bodyFaceMaterial = new THREE.MeshFaceMaterial(bodyMaterials);\n\t        // var wheelFaceMaterial = new THREE.MeshFaceMaterial(wheelMaterials);\n\t        // var bodyFaceMaterial = new THREE.MeshPhongMaterial({ color: 0x00000bb });\n\t        // var wheelFaceMaterial = new THREE.MeshPhongMaterial({ color: 0x333333 });\n\t\n\t        // create body mesh\n\t        this.bodyMesh = new THREE.Mesh(bodyGeometry, bodyFaceMaterial);\n\t        this.bodyMesh.scale.set(s, s, s);\n\t        root.add(this.bodyMesh);\n\t\n\t        // create wheel meshes\n\t        // front left\n\t        delta.multiplyVectors(wheelOffset, new THREE.Vector3(s, s, s));\n\t        this.frontLeftWheelRoot.position.add(delta);\n\t        this.frontLeftWheelMesh = new THREE.Mesh(wheelGeometry, wheelFaceMaterial);\n\t        this.frontLeftWheelMesh.scale.set(s, s, s);\n\t        this.frontLeftWheelMesh.rotateY(0.0);\n\t        this.frontLeftWheelRoot.add(this.frontLeftWheelMesh);\n\t        root.add(this.frontLeftWheelRoot);\n\t        // front right\n\t        delta.multiplyVectors(wheelOffset, new THREE.Vector3(-s, s, s));\n\t        this.frontRightWheelRoot.position.add(delta);\n\t        this.frontRightWheelMesh = new THREE.Mesh(wheelGeometry, wheelFaceMaterial);\n\t        this.frontRightWheelMesh.scale.set(s, s, s);\n\t        this.frontRightWheelMesh.rotateY(Math.PI);\n\t        this.frontRightWheelRoot.add(this.frontRightWheelMesh);\n\t        root.add(this.frontRightWheelRoot);\n\t        // rear left\n\t        delta.multiplyVectors(wheelOffset, new THREE.Vector3(s, s, -s));\n\t        this.rearLeftWheelMesh = new THREE.Mesh(wheelGeometry, wheelFaceMaterial);\n\t        this.rearLeftWheelMesh.scale.set(s, s, s);\n\t        this.rearLeftWheelMesh.rotateY(0.0);\n\t        this.rearLeftWheelMesh.position.add(delta);\n\t        root.add(this.rearLeftWheelMesh);\n\t        // rear right\n\t        delta.multiplyVectors(wheelOffset, new THREE.Vector3(-s, s, -s));\n\t        this.rearRightWheelMesh = new THREE.Mesh(wheelGeometry, wheelFaceMaterial);\n\t        this.rearRightWheelMesh.scale.set(s, s, s);\n\t        this.rearRightWheelMesh.rotateY(Math.PI);\n\t        this.rearRightWheelMesh.position.add(delta);\n\t        root.add(this.rearRightWheelMesh);\n\t\n\t        // translation and rotation\n\t        root.position.set(t.x, t.y, t.z);\n\t        root.rotation.set(r.x, r.y, r.z);\n\t\n\t        // finish\n\t        this.add(root);\n\t\n\t        // adjust the label\n\t        this._adjustLabelOffset();\n\t\n\t        // callback\n\t        if (this.callback) {\n\t          this.callback(self);\n\t        }\n\t      }\n\t    }\n\t\n\t    // ---\n\t\n\t  }]);\n\t\n\t  return Vehicle;\n\t})(_SimObject3['default']);\n\t\n\texports['default'] = Vehicle;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 92 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t// TODO: A lot of these utils don't need to be in separate, tiny files\n\t\n\tvar _wrapNum = __webpack_require__(93);\n\t\n\tvar _wrapNum2 = _interopRequireDefault(_wrapNum);\n\t\n\tvar _extrudePolygon = __webpack_require__(65);\n\t\n\tvar _extrudePolygon2 = _interopRequireDefault(_extrudePolygon);\n\t\n\tvar _GeoJSON = __webpack_require__(60);\n\t\n\tvar _GeoJSON2 = _interopRequireDefault(_GeoJSON);\n\t\n\tvar _Buffer = __webpack_require__(66);\n\t\n\tvar _Buffer2 = _interopRequireDefault(_Buffer);\n\t\n\tvar _ObjectUtils = __webpack_require__(81);\n\t\n\tvar _ObjectUtils2 = _interopRequireDefault(_ObjectUtils);\n\t\n\tvar _WorkerUtils = __webpack_require__(84);\n\t\n\tvar _WorkerUtils2 = _interopRequireDefault(_WorkerUtils);\n\t\n\tvar Util = {};\n\t\n\tUtil.wrapNum = _wrapNum2['default'];\n\tUtil.extrudePolygon = _extrudePolygon2['default'];\n\tUtil.GeoJSON = _GeoJSON2['default'];\n\tUtil.Buffer = _Buffer2['default'];\n\tUtil.ObjectUtils = _ObjectUtils2['default'];\n\tUtil.WorkerUtils = _WorkerUtils2['default'];\n\t\n\texports['default'] = Util;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 93 */\n/***/ function(module, exports) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t/*\n\t * Wrap the given number to lie within a certain range (eg. longitude)\n\t *\n\t * Based on:\n\t * https://github.com/Leaflet/Leaflet/blob/master/src/core/Util.js\n\t */\n\t\n\tvar wrapNum = function wrapNum(x, range, includeMax) {\n\t  var max = range[1];\n\t  var min = range[0];\n\t  var d = max - min;\n\t  return x === max && includeMax ? x : ((x - min) % d + d) % d + min;\n\t};\n\t\n\texports[\"default\"] = wrapNum;\n\tmodule.exports = exports[\"default\"];\n\n/***/ }\n/******/ ])\n});\n;"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap caf8c35838d39d5cb7ab\n **/","import World, {world} from './World';\nimport Controls from './controls/index';\n\nimport Geo from './geo/Geo.js';\n\nimport Layer, {layer} from './layer/Layer';\nimport EnvironmentLayer, {environmentLayer} from './layer/environment/EnvironmentLayer';\nimport ImageTileLayer, {imageTileLayer} from './layer/tile/ImageTileLayer';\nimport GeoJSONTileLayer, {geoJSONTileLayer} from './layer/tile/GeoJSONTileLayer';\nimport TopoJSONTileLayer, {topoJSONTileLayer} from './layer/tile/TopoJSONTileLayer';\nimport GeoJSONLayer, {geoJSONLayer} from './layer/GeoJSONLayer';\nimport TopoJSONLayer, {topoJSONLayer} from './layer/TopoJSONLayer';\nimport PolygonLayer, {polygonLayer} from './layer/geometry/PolygonLayer';\nimport PolylineLayer, {polylineLayer} from './layer/geometry/PolylineLayer';\nimport PointLayer, {pointLayer} from './layer/geometry/PointLayer';\nimport PedestrianLayer, {pedestrianLayer} from './layer/object/PedestrianLayer';\nimport VehicleLayer, {vehicleLayer} from './layer/object/VehicleLayer';\n\nimport Point, {point} from './geo/Point';\nimport LatLon, {latLon} from './geo/LatLon';\n\nimport PickingMaterial from './engine/PickingMaterial';\n\nimport Util from './util/index';\n\nconst VIZI = {\n  version: '0.3',\n\n  // Public API\n  World: World,\n  world: world,\n  Controls: Controls,\n  Geo: Geo,\n  Layer: Layer,\n  layer: layer,\n  EnvironmentLayer: EnvironmentLayer,\n  environmentLayer: environmentLayer,\n  ImageTileLayer: ImageTileLayer,\n  imageTileLayer: imageTileLayer,\n  GeoJSONTileLayer: GeoJSONTileLayer,\n  geoJSONTileLayer: geoJSONTileLayer,\n  TopoJSONTileLayer: TopoJSONTileLayer,\n  topoJSONTileLayer: topoJSONTileLayer,\n  GeoJSONLayer: GeoJSONLayer,\n  geoJSONLayer: geoJSONLayer,\n  TopoJSONLayer: TopoJSONLayer,\n  topoJSONLayer: topoJSONLayer,\n  PolygonLayer: PolygonLayer,\n  polygonLayer: polygonLayer,\n  PolylineLayer: PolylineLayer,\n  polylineLayer: polylineLayer,\n  PointLayer: PointLayer,\n  pointLayer: pointLayer,\n  PedestrianLayer: PedestrianLayer,\n  pedestrianLayer: pedestrianLayer,\n  VehicleLayer: VehicleLayer,\n  vehicleLayer: vehicleLayer,\n  Point: Point,\n  point: point,\n  LatLon: LatLon,\n  latLon: latLon,\n  PickingMaterial: PickingMaterial,\n  Util: Util\n};\n\nexport default VIZI;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vizicities.js\n **/","import EventEmitter from 'eventemitter3';\nimport extend from 'lodash.assign';\nimport Geo from './geo/Geo';\nimport {point as Point} from './geo/Point';\nimport {latLon as LatLon} from './geo/LatLon';\nimport Engine from './engine/Engine';\nimport EnvironmentLayer from './layer/environment/EnvironmentLayer';\n\n// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\n// Pretty much any event someone using ViziCities would need will be emitted or\n// proxied by World (eg. render events, etc)\n\nclass World extends EventEmitter {\n  constructor(domId, options) {\n    super();\n\n    var defaults = {\n      skybox: false,\n      postProcessing: false\n    };\n\n    this.options = extend({}, defaults, options);\n\n    this._layers = [];\n    this._controls = [];\n\n    this._initContainer(domId);\n    this._initAttribution();\n    this._initEngine();\n    this._initEnvironment();\n    this._initEvents();\n\n    this._pause = false;\n\n    // Kick off the update and render loop\n    this._update();\n  }\n\n  _initContainer(domId) {\n    this._container = document.getElementById(domId);\n  }\n\n  _initAttribution() {\n    var message = '<a href=\"http://vizicities.com\" target=\"_blank\">Powered by ViziCities</a>';\n\n    var element = document.createElement('div');\n    element.classList.add('vizicities-attribution');\n\n    element.innerHTML = message;\n\n    this._container.appendChild(element);\n  }\n\n  _initEngine() {\n    this._engine = new Engine(this._container, this);\n\n    // Engine events\n    //\n    // Consider proxying these through events on World for public access\n    // this._engine.on('preRender', () => {});\n    // this._engine.on('postRender', () => {});\n  }\n\n  _initEnvironment() {\n    // Not sure if I want to keep this as a private API\n    //\n    // Makes sense to allow others to customise their environment so perhaps\n    // add some method of disable / overriding the environment settings\n    this._environment = new EnvironmentLayer({\n      skybox: this.options.skybox\n    }).addTo(this);\n  }\n\n  _initEvents() {\n    this.on('controlsMoveEnd', this._onControlsMoveEnd);\n  }\n\n  _onControlsMoveEnd(point) {\n    var _point = Point(point.x, point.z);\n    this._resetView(this.pointToLatLon(_point), _point);\n  }\n\n  // Reset world view\n  _resetView(latlon, point) {\n    this.emit('preResetView');\n\n    this._moveStart();\n    this._move(latlon, point);\n    this._moveEnd();\n\n    this.emit('postResetView');\n  }\n\n  _moveStart() {\n    this.emit('moveStart');\n  }\n\n  _move(latlon, point) {\n    this._lastPosition = latlon;\n    this.emit('move', latlon, point);\n  }\n  _moveEnd() {\n    this.emit('moveEnd');\n  }\n\n  _update() {\n    if (this._pause) {\n      return;\n    }\n\n    var delta = this._engine.clock.getDelta();\n\n    // Once _update is called it will run forever, for now\n    window.requestAnimationFrame(this._update.bind(this));\n\n    // Update controls\n    this._controls.forEach(controls => {\n      controls.update(delta);\n    });\n\n    this.emit('preUpdate', delta);\n    this._engine.update(delta);\n    this.emit('postUpdate', delta);\n  }\n\n  // Set world view\n  setView(latlon) {\n    // Store initial geographic coordinate for the [0,0,0] world position\n    //\n    // The origin point doesn't move in three.js / 3D space so only set it once\n    // here instead of every time _resetView is called\n    //\n    // If it was updated every time then coorindates would shift over time and\n    // would be out of place / context with previously-placed points (0,0 would\n    // refer to a different point each time)\n    this._originLatlon = latlon;\n    this._originPoint = this.project(latlon);\n\n    this._resetView(latlon);\n    return this;\n  }\n\n  // Return world geographic position\n  getPosition() {\n    return this._lastPosition;\n  }\n\n  // Transform geographic coordinate to world point\n  //\n  // This doesn't take into account the origin offset\n  //\n  // For example, this takes a geographic coordinate and returns a point\n  // relative to the origin point of the projection (not the world)\n  project(latlon) {\n    return Geo.latLonToPoint(LatLon(latlon));\n  }\n\n  // Transform world point to geographic coordinate\n  //\n  // This doesn't take into account the origin offset\n  //\n  // For example, this takes a point relative to the origin point of the\n  // projection (not the world) and returns a geographic coordinate\n  unproject(point) {\n    return Geo.pointToLatLon(Point(point));\n  }\n\n  // Takes into account the origin offset\n  //\n  // For example, this takes a geographic coordinate and returns a point\n  // relative to the three.js / 3D origin (0,0)\n  latLonToPoint(latlon) {\n    var projectedPoint = this.project(LatLon(latlon));\n    return projectedPoint._subtract(this._originPoint);\n  }\n\n  // Takes into account the origin offset\n  //\n  // For example, this takes a point relative to the three.js / 3D origin (0,0)\n  // and returns the exact geographic coordinate at that point\n  pointToLatLon(point) {\n    var projectedPoint = Point(point).add(this._originPoint);\n    return this.unproject(projectedPoint);\n  }\n\n  // Return pointscale for a given geographic coordinate\n  pointScale(latlon, accurate) {\n    return Geo.pointScale(latlon, accurate);\n  }\n\n  // Convert from real meters to world units\n  //\n  // TODO: Would be nice not to have to pass in a pointscale here\n  metresToWorld(metres, pointScale, zoom) {\n    return Geo.metresToWorld(metres, pointScale, zoom);\n  }\n\n  // Convert from real meters to world units\n  //\n  // TODO: Would be nice not to have to pass in a pointscale here\n  worldToMetres(worldUnits, pointScale, zoom) {\n    return Geo.worldToMetres(worldUnits, pointScale, zoom);\n  }\n\n  // Unsure if it's a good idea to expose this here for components like\n  // GridLayer to use (eg. to keep track of a frustum)\n  getCamera() {\n    return this._engine._camera;\n  }\n\n  addLayer(layer) {\n    layer._addToWorld(this);\n\n    this._layers.push(layer);\n\n    if (layer.isOutput() && layer.isOutputToScene()) {\n      // Could move this into Layer but it'll do here for now\n      this._engine._scene.add(layer._object3D);\n      this._engine._domScene3D.add(layer._domObject3D);\n      this._engine._domScene2D.add(layer._domObject2D);\n    }\n\n    this.emit('layerAdded', layer);\n    return this;\n  }\n\n  // Remove layer from world and scene but don't destroy it entirely\n  removeLayer(layer) {\n    var layerIndex = this._layers.indexOf(layer);\n\n    if (layerIndex > -1) {\n      // Remove from this._layers\n      this._layers.splice(layerIndex, 1);\n    };\n\n    if (layer.isOutput() && layer.isOutputToScene()) {\n      this._engine._scene.remove(layer._object3D);\n      this._engine._domScene3D.remove(layer._domObject3D);\n      this._engine._domScene2D.remove(layer._domObject2D);\n    }\n\n    this.emit('layerRemoved');\n    return this;\n  }\n\n  addControls(controls) {\n    controls._addToWorld(this);\n\n    this._controls.push(controls);\n\n    this.emit('controlsAdded', controls);\n    return this;\n  }\n\n  // Remove controls from world but don't destroy them entirely\n  removeControls(controls) {\n    var controlsIndex = this._controls.indexOf(controlsIndex);\n\n    if (controlsIndex > -1) {\n      this._controls.splice(controlsIndex, 1);\n    };\n\n    this.emit('controlsRemoved', controls);\n    return this;\n  }\n\n  stop() {\n    this._pause = true;\n  }\n\n  start() {\n    this._pause = false;\n    this._update();\n  }\n\n  // Destroys the world(!) and removes it from the scene and memory\n  //\n  // TODO: World out why so much three.js stuff is left in the heap after this\n  destroy() {\n    this.stop();\n\n    // Remove listeners\n    this.off('controlsMoveEnd', this._onControlsMoveEnd);\n\n    var i;\n\n    // Remove all controls\n    var controls;\n    for (i = this._controls.length - 1; i >= 0; i--) {\n      controls = this._controls[0];\n      this.removeControls(controls);\n      controls.destroy();\n    };\n\n    // Remove all layers\n    var layer;\n    for (i = this._layers.length - 1; i >= 0; i--) {\n      layer = this._layers[0];\n      this.removeLayer(layer);\n      layer.destroy();\n    };\n\n    // Environment layer is removed with the other layers\n    this._environment = null;\n\n    this._engine.destroy();\n    this._engine = null;\n\n    // Clean the container / remove the canvas\n    while (this._container.firstChild) {\n      this._container.removeChild(this._container.firstChild);\n    }\n\n    this._container = null;\n  }\n}\n\nexport default World;\n\nvar noNew = function(domId, options) {\n  return new World(domId, options);\n};\n\n// Initialise without requiring new keyword\nexport {noNew as world};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/World.js\n **/","'use strict';\n\nvar has = Object.prototype.hasOwnProperty;\n\n//\n// We store our EE objects in a plain object whose properties are event names.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// `~` to make sure that the built-in object properties are not overridden or\n// used as an attack vector.\n// We also assume that `Object.create(null)` is available when the event name\n// is an ES6 Symbol.\n//\nvar prefix = typeof Object.create !== 'function' ? '~' : false;\n\n/**\n * Representation of a single EventEmitter function.\n *\n * @param {Function} fn Event handler to be called.\n * @param {Mixed} context Context for function execution.\n * @param {Boolean} [once=false] Only emit once\n * @api private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Minimal EventEmitter interface that is molded against the Node.js\n * EventEmitter interface.\n *\n * @constructor\n * @api public\n */\nfunction EventEmitter() { /* Nothing to set */ }\n\n/**\n * Hold the assigned EventEmitters by name.\n *\n * @type {Object}\n * @private\n */\nEventEmitter.prototype._events = undefined;\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @api public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var events = this._events\n    , names = []\n    , name;\n\n  if (!events) return names;\n\n  for (name in events) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return a list of assigned event listeners.\n *\n * @param {String} event The events that should be listed.\n * @param {Boolean} exists We only need to know if there are listeners.\n * @returns {Array|Boolean}\n * @api public\n */\nEventEmitter.prototype.listeners = function listeners(event, exists) {\n  var evt = prefix ? prefix + event : event\n    , available = this._events && this._events[evt];\n\n  if (exists) return !!available;\n  if (!available) return [];\n  if (available.fn) return [available.fn];\n\n  for (var i = 0, l = available.length, ee = new Array(l); i < l; i++) {\n    ee[i] = available[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Emit an event to all registered event listeners.\n *\n * @param {String} event The name of the event.\n * @returns {Boolean} Indication if we've emitted an event.\n * @api public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events || !this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if ('function' === typeof listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Register a new EventListener for the given event.\n *\n * @param {String} event Name of the event.\n * @param {Function} fn Callback function.\n * @param {Mixed} [context=this] The context of the function.\n * @api public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  var listener = new EE(fn, context || this)\n    , evt = prefix ? prefix + event : event;\n\n  if (!this._events) this._events = prefix ? {} : Object.create(null);\n  if (!this._events[evt]) this._events[evt] = listener;\n  else {\n    if (!this._events[evt].fn) this._events[evt].push(listener);\n    else this._events[evt] = [\n      this._events[evt], listener\n    ];\n  }\n\n  return this;\n};\n\n/**\n * Add an EventListener that's only called once.\n *\n * @param {String} event Name of the event.\n * @param {Function} fn Callback function.\n * @param {Mixed} [context=this] The context of the function.\n * @api public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  var listener = new EE(fn, context || this, true)\n    , evt = prefix ? prefix + event : event;\n\n  if (!this._events) this._events = prefix ? {} : Object.create(null);\n  if (!this._events[evt]) this._events[evt] = listener;\n  else {\n    if (!this._events[evt].fn) this._events[evt].push(listener);\n    else this._events[evt] = [\n      this._events[evt], listener\n    ];\n  }\n\n  return this;\n};\n\n/**\n * Remove event listeners.\n *\n * @param {String} event The event we want to remove.\n * @param {Function} fn The listener that we need to find.\n * @param {Mixed} context Only remove listeners matching this context.\n * @param {Boolean} once Only remove once listeners.\n * @api public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events || !this._events[evt]) return this;\n\n  var listeners = this._events[evt]\n    , events = [];\n\n  if (fn) {\n    if (listeners.fn) {\n      if (\n           listeners.fn !== fn\n        || (once && !listeners.once)\n        || (context && listeners.context !== context)\n      ) {\n        events.push(listeners);\n      }\n    } else {\n      for (var i = 0, length = listeners.length; i < length; i++) {\n        if (\n             listeners[i].fn !== fn\n          || (once && !listeners[i].once)\n          || (context && listeners[i].context !== context)\n        ) {\n          events.push(listeners[i]);\n        }\n      }\n    }\n  }\n\n  //\n  // Reset the array, or remove it completely if we have no more listeners.\n  //\n  if (events.length) {\n    this._events[evt] = events.length === 1 ? events[0] : events;\n  } else {\n    delete this._events[evt];\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners or only the listeners for the specified event.\n *\n * @param {String} event The event want to remove all listeners for.\n * @api public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  if (!this._events) return this;\n\n  if (event) delete this._events[prefix ? prefix + event : event];\n  else this._events = prefix ? {} : Object.create(null);\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// This function doesn't apply anymore.\n//\nEventEmitter.prototype.setMaxListeners = function setMaxListeners() {\n  return this;\n};\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/eventemitter3/index.js\n ** module id = 2\n ** module chunks = 0\n **/","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]';\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\n/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object),\n    nativeMax = Math.max;\n\n/** Detect if properties shadowing those on `Object.prototype` are non-enumerable. */\nvar nonEnumShadows = !propertyIsEnumerable.call({ 'valueOf': 1 }, 'valueOf');\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  // Safari 9 makes `arguments.length` enumerable in strict mode.\n  var result = (isArray(value) || isArguments(value))\n    ? baseTimes(value.length, String)\n    : [];\n\n  var length = result.length,\n      skipIndexes = !!length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (key == 'length' || isIndex(key, length)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    object[key] = value;\n  }\n}\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = array;\n    return apply(func, this, otherArgs);\n  };\n}\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    assignValue(object, key, newValue === undefined ? source[key] : newValue);\n  }\n  return object;\n}\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nfunction isArguments(value) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  return isArrayLikeObject(value) && hasOwnProperty.call(value, 'callee') &&\n    (!propertyIsEnumerable.call(value, 'callee') || objectToString.call(value) == argsTag);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Assigns own enumerable string keyed properties of source objects to the\n * destination object. Source objects are applied from left to right.\n * Subsequent sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object` and is loosely based on\n * [`Object.assign`](https://mdn.io/Object/assign).\n *\n * @static\n * @memberOf _\n * @since 0.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.assignIn\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * function Bar() {\n *   this.c = 3;\n * }\n *\n * Foo.prototype.b = 2;\n * Bar.prototype.d = 4;\n *\n * _.assign({ 'a': 0 }, new Foo, new Bar);\n * // => { 'a': 1, 'c': 3 }\n */\nvar assign = createAssigner(function(object, source) {\n  if (nonEnumShadows || isPrototype(source) || isArrayLike(source)) {\n    copyObject(source, keys(source), object);\n    return;\n  }\n  for (var key in source) {\n    if (hasOwnProperty.call(source, key)) {\n      assignValue(object, key, source[key]);\n    }\n  }\n});\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = assign;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash.assign/index.js\n ** module id = 3\n ** module chunks = 0\n **/","import {latLon as LatLon} from './LatLon';\nimport {point as Point} from './Point';\n\nvar Geo = {};\n\n// Radius / WGS84 semi-major axis\nGeo.R = 6378137;\nGeo.MAX_LATITUDE = 85.0511287798;\n\n// WGS84 eccentricity\nGeo.ECC = 0.081819191;\nGeo.ECC2 = 0.081819191 * 0.081819191;\n\nGeo.project = function(latlon) {\n  var d = Math.PI / 180;\n  var max = Geo.MAX_LATITUDE;\n  var lat = Math.max(Math.min(max, latlon.lat), -max);\n  var sin = Math.sin(lat * d);\n\n  return Point(\n    Geo.R * latlon.lon * d,\n    Geo.R * Math.log((1 + sin) / (1 - sin)) / 2\n  );\n},\n\nGeo.unproject = function(point) {\n  var d = 180 / Math.PI;\n\n  return LatLon(\n    (2 * Math.atan(Math.exp(point.y / Geo.R)) - (Math.PI / 2)) * d,\n    point.x * d / Geo.R\n  );\n};\n\n// Converts geo coords to pixel / WebGL ones\n// This just reverses the Y axis to match WebGL\nGeo.latLonToPoint = function(latlon) {\n  var projected = Geo.project(latlon);\n  projected.y *= -1;\n\n  return projected;\n};\n\n// Converts pixel / WebGL coords to geo coords\n// This just reverses the Y axis to match WebGL\nGeo.pointToLatLon = function(point) {\n  var _point = Point(point.x, point.y * -1);\n  return Geo.unproject(_point);\n};\n\n// Scale factor for converting between real metres and projected metres\n//\n// projectedMetres = realMetres * pointScale\n// realMetres = projectedMetres / pointScale\n//\n// Accurate scale factor uses proper Web Mercator scaling\n// See pg.9: http://www.hydrometronics.com/downloads/Web%20Mercator%20-%20Non-Conformal,%20Non-Mercator%20(notes).pdf\n// See: http://jsfiddle.net/robhawkes/yws924cf/\nGeo.pointScale = function(latlon, accurate) {\n  var rad = Math.PI / 180;\n\n  var k;\n\n  if (!accurate) {\n    k = 1 / Math.cos(latlon.lat * rad);\n\n    // [scaleX, scaleY]\n    return [k, k];\n  } else {\n    var lat = latlon.lat * rad;\n    var lon = latlon.lon * rad;\n\n    var a = Geo.R;\n\n    var sinLat = Math.sin(lat);\n    var sinLat2 = sinLat * sinLat;\n\n    var cosLat = Math.cos(lat);\n\n    // Radius meridian\n    var p = a * (1 - Geo.ECC2) / Math.pow(1 - Geo.ECC2 * sinLat2, 3 / 2);\n\n    // Radius prime meridian\n    var v = a / Math.sqrt(1 - Geo.ECC2 * sinLat2);\n\n    // Scale N/S\n    var h = (a / p) / cosLat;\n\n    // Scale E/W\n    k = (a / v) / cosLat;\n\n    // [scaleX, scaleY]\n    return [k, h];\n  }\n};\n\n// Convert real metres to projected units\n//\n// Latitude scale is chosen because it fluctuates more than longitude\nGeo.metresToProjected = function(metres, pointScale) {\n  return metres * pointScale[1];\n};\n\n// Convert projected units to real metres\n//\n// Latitude scale is chosen because it fluctuates more than longitude\nGeo.projectedToMetres = function(projectedUnits, pointScale) {\n  return projectedUnits / pointScale[1];\n};\n\n// Convert real metres to a value in world (WebGL) units\nGeo.metresToWorld = function(metres, pointScale) {\n  // Transform metres to projected metres using the latitude point scale\n  //\n  // Latitude scale is chosen because it fluctuates more than longitude\n  var projectedMetres = Geo.metresToProjected(metres, pointScale);\n\n  var scale = Geo.scale();\n\n  // Scale projected metres\n  var scaledMetres = (scale * projectedMetres);\n\n  return scaledMetres;\n};\n\n// Convert world (WebGL) units to a value in real metres\nGeo.worldToMetres = function(worldUnits, pointScale) {\n  var scale = Geo.scale();\n\n  var projectedUnits = worldUnits / scale;\n  var realMetres = Geo.projectedToMetres(projectedUnits, pointScale);\n\n  return realMetres;\n};\n\n// If zoom is provided, returns the map width in pixels for a given zoom\n// Else, provides fixed scale value\nGeo.scale = function(zoom) {\n  // If zoom is provided then return scale based on map tile zoom\n  if (zoom >= 0) {\n    return 256 * Math.pow(2, zoom);\n  // Else, return fixed scale value to expand projected coordinates from\n  // their 0 to 1 range into something more practical\n  } else {\n    return 1;\n  }\n};\n\n// Returns zoom level for a given scale value\n// This only works with a scale value that is based on map pixel width\nGeo.zoom = function(scale) {\n  return Math.log(scale / 256) / Math.LN2;\n};\n\n// Distance between two geographical points using spherical law of cosines\n// approximation or Haversine\n//\n// See: http://www.movable-type.co.uk/scripts/latlong.html\nGeo.distance = function(latlon1, latlon2, accurate) {\n  var rad = Math.PI / 180;\n\n  var lat1;\n  var lat2;\n\n  var a;\n\n  if (!accurate) {\n    lat1 = latlon1.lat * rad;\n    lat2 = latlon2.lat * rad;\n\n    a = Math.sin(lat1) * Math.sin(lat2) + Math.cos(lat1) * Math.cos(lat2) * Math.cos((latlon2.lon - latlon1.lon) * rad);\n\n    return Geo.R * Math.acos(Math.min(a, 1));\n  } else {\n    lat1 = latlon1.lat * rad;\n    lat2 = latlon2.lat * rad;\n\n    var lon1 = latlon1.lon * rad;\n    var lon2 = latlon2.lon * rad;\n\n    var deltaLat = lat2 - lat1;\n    var deltaLon = lon2 - lon1;\n\n    var halfDeltaLat = deltaLat / 2;\n    var halfDeltaLon = deltaLon / 2;\n\n    a = Math.sin(halfDeltaLat) * Math.sin(halfDeltaLat) + Math.cos(lat1) * Math.cos(lat2) * Math.sin(halfDeltaLon) * Math.sin(halfDeltaLon);\n\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n\n    return Geo.R * c;\n  }\n};\n\nGeo.bounds = (function() {\n  var d = Geo.R * Math.PI;\n  return [[-d, -d], [d, d]];\n})();\n\nexport default Geo;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geo/Geo.js\n **/","/*\n * LatLon is a helper class for ensuring consistent geographic coordinates.\n *\n * Based on:\n * https://github.com/Leaflet/Leaflet/blob/master/src/geo/LatLng.js\n */\n\nclass LatLon {\n  constructor(lat, lon, alt) {\n    if (isNaN(lat) || isNaN(lon)) {\n      throw new Error('Invalid LatLon object: (' + lat + ', ' + lon + ')');\n    }\n\n    this.lat = +lat;\n    this.lon = +lon;\n\n    if (alt !== undefined) {\n      this.alt = +alt;\n    }\n  }\n\n  clone() {\n    return new LatLon(this.lat, this.lon, this.alt);\n  }\n}\n\nexport default LatLon;\n\n// Accepts (LatLon), ([lat, lon, alt]), ([lat, lon]) and (lat, lon, alt)\n// Also converts between lng and lon\nvar noNew = function(a, b, c) {\n  if (a instanceof LatLon) {\n    return a;\n  }\n  if (Array.isArray(a) && typeof a[0] !== 'object') {\n    if (a.length === 3) {\n      return new LatLon(a[0], a[1], a[2]);\n    }\n    if (a.length === 2) {\n      return new LatLon(a[0], a[1]);\n    }\n    return null;\n  }\n  if (a === undefined || a === null) {\n    return a;\n  }\n  if (typeof a === 'object' && 'lat' in a) {\n    return new LatLon(a.lat, 'lng' in a ? a.lng : a.lon, a.alt);\n  }\n  if (b === undefined) {\n    return null;\n  }\n  return new LatLon(a, b, c);\n};\n\n// Initialise without requiring new keyword\nexport {noNew as latLon};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geo/LatLon.js\n **/","/*\n * Point is a helper class for ensuring consistent world positions.\n *\n * Based on:\n * https://github.com/Leaflet/Leaflet/blob/master/src/geo/Point.js\n */\n\nclass Point {\n  constructor(x, y, round) {\n    this.x = (round ? Math.round(x) : x);\n    this.y = (round ? Math.round(y) : y);\n  }\n\n  clone() {\n    return new Point(this.x, this.y);\n  }\n\n  // Non-destructive\n  add(point) {\n    return this.clone()._add(_point(point));\n  }\n\n  // Destructive\n  _add(point) {\n    this.x += point.x;\n    this.y += point.y;\n    return this;\n  }\n\n  // Non-destructive\n  subtract(point) {\n    return this.clone()._subtract(_point(point));\n  }\n\n  // Destructive\n  _subtract(point) {\n    this.x -= point.x;\n    this.y -= point.y;\n    return this;\n  }\n}\n\nexport default Point;\n\n// Accepts (point), ([x, y]) and (x, y, round)\nvar _point = function(x, y, round) {\n  if (x instanceof Point) {\n    return x;\n  }\n  if (Array.isArray(x)) {\n    return new Point(x[0], x[1]);\n  }\n  if (x === undefined || x === null) {\n    return x;\n  }\n  return new Point(x, y, round);\n};\n\n// Initialise without requiring new keyword\nexport {_point as point};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geo/Point.js\n **/","import EventEmitter from 'eventemitter3';\nimport THREE from 'three';\nimport Scene from './Scene';\nimport DOMScene3D from './DOMScene3D';\nimport DOMScene2D from './DOMScene2D';\nimport Renderer from './Renderer';\nimport DOMRenderer3D from './DOMRenderer3D';\nimport DOMRenderer2D from './DOMRenderer2D';\nimport Camera from './Camera';\nimport Picking from './Picking';\nimport EffectComposer from './EffectComposer';\nimport RenderPass from '../vendor/RenderPass';\nimport ShaderPass from '../vendor/ShaderPass';\nimport CopyShader from '../vendor/CopyShader';\nimport HorizontalTiltShiftShader from '../vendor/HorizontalTiltShiftShader';\nimport VerticalTiltShiftShader from '../vendor/VerticalTiltShiftShader';\nimport FXAAShader from '../vendor/FXAAShader';\n\nclass Engine extends EventEmitter {\n  constructor(container, world) {\n    console.log('Init Engine');\n\n    super();\n\n    this._world = world;\n\n    this._scene = Scene;\n    this._domScene3D = DOMScene3D;\n    this._domScene2D = DOMScene2D;\n\n    var antialias = (this._world.options.postProcessing) ? false : true;\n    this._renderer = Renderer(container, antialias);\n    this._domRenderer3D = DOMRenderer3D(container);\n    this._domRenderer2D = DOMRenderer2D(container);\n\n    this._camera = Camera(container);\n\n    this._container = container;\n\n    // TODO: Make this optional\n    this._picking = Picking(this._world, this._renderer, this._camera);\n\n    this.clock = new THREE.Clock();\n\n    this._frustum = new THREE.Frustum();\n\n    if (this._world.options.postProcessing) {\n      this._initPostProcessing();\n    }\n  }\n\n  // TODO: Set up composer to automatically resize on viewport change\n  // TODO: Update passes that rely on width / height on resize\n  // TODO: Merge default passes into a single shader / pass for performance\n  _initPostProcessing() {\n    var renderPass = new RenderPass(this._scene, this._camera);\n\n    // TODO: Look at using @mattdesl's optimised FXAA shader\n    // https://github.com/mattdesl/three-shader-fxaa\n    var fxaaPass = new ShaderPass(FXAAShader);\n\n    var hblurPass = new ShaderPass(HorizontalTiltShiftShader);\n    var vblurPass = new ShaderPass(VerticalTiltShiftShader);\n    var bluriness = 5;\n\n    hblurPass.uniforms.r.value = vblurPass.uniforms.r.value = 0.6;\n\n    var copyPass = new ShaderPass(CopyShader);\n    copyPass.renderToScreen = true;\n\n    this._composer = EffectComposer(this._renderer, this._container);\n\n    this._composer.addPass(renderPass);\n    this._composer.addPass(fxaaPass);\n    this._composer.addPass(hblurPass);\n    this._composer.addPass(vblurPass);\n    this._composer.addPass(copyPass);\n\n    var self = this;\n    var updatePostProcessingSize = function() {\n      var width = self._container.clientWidth;\n      var height = self._container.clientHeight;\n\n      // TODO: Re-enable this when perf issues can be solved\n      //\n      // Rendering double the resolution of the screen can be really slow\n      // var pixelRatio = window.devicePixelRatio;\n      var pixelRatio = 1;\n\n      fxaaPass.uniforms.resolution.value.set(1 / (width * pixelRatio), 1 / (height * pixelRatio));\n\n      hblurPass.uniforms.h.value = bluriness / (width * pixelRatio);\n      vblurPass.uniforms.v.value = bluriness / (height * pixelRatio);\n    };\n\n    updatePostProcessingSize();\n    window.addEventListener('resize', updatePostProcessingSize, false);\n  }\n\n  update(delta) {\n    this.emit('preRender');\n\n    if (this._world.options.postProcessing) {\n      this._composer.render(delta);\n    } else {\n      this._renderer.render(this._scene, this._camera);\n    }\n\n    // Render picking scene\n    // this._renderer.render(this._picking._pickingScene, this._camera);\n\n    // Render DOM scenes\n    this._domRenderer3D.render(this._domScene3D, this._camera);\n    this._domRenderer2D.render(this._domScene2D, this._camera);\n\n    this.emit('postRender');\n  }\n\n  destroy() {\n    // Remove any remaining objects from scene\n    var child;\n    for (var i = this._scene.children.length - 1; i >= 0; i--) {\n      child = this._scene.children[i];\n\n      if (!child) {\n        continue;\n      }\n\n      this._scene.remove(child);\n\n      if (child.geometry) {\n        // Dispose of mesh and materials\n        child.geometry.dispose();\n        child.geometry = null;\n      }\n\n      if (child.material) {\n        if (child.material.map) {\n          child.material.map.dispose();\n          child.material.map = null;\n        }\n\n        child.material.dispose();\n        child.material = null;\n      }\n    };\n\n    for (var i = this._domScene3D.children.length - 1; i >= 0; i--) {\n      child = this._domScene3D.children[i];\n\n      if (!child) {\n        continue;\n      }\n\n      this._domScene3D.remove(child);\n    };\n\n    for (var i = this._domScene2D.children.length - 1; i >= 0; i--) {\n      child = this._domScene2D.children[i];\n\n      if (!child) {\n        continue;\n      }\n\n      this._domScene2D.remove(child);\n    };\n\n    this._picking.destroy();\n    this._picking = null;\n\n    this._world = null;\n    this._scene = null;\n    this._domScene3D = null;\n    this._domScene2D = null;\n\n    this._composer = null;\n    this._renderer = null;\n\n    this._domRenderer3D = null;\n    this._domRenderer2D = null;\n    this._camera = null;\n    this._clock = null;\n    this._frustum = null;\n  }\n}\n\nexport default Engine;\n\n// // Initialise without requiring new keyword\n// export default function(container, world) {\n//   return new Engine(container, world);\n// };\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/engine/Engine.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_8__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"THREE\"\n ** module id = 8\n ** module chunks = 0\n **/","import THREE from 'three';\n\n// This can be imported from anywhere and will still reference the same scene,\n// though there is a helper reference in Engine.scene\n\nexport default (function() {\n  var scene = new THREE.Scene();\n\n  // TODO: Re-enable when this works with the skybox\n  // scene.fog = new THREE.Fog(0xffffff, 1, 15000);\n  return scene;\n})();\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/engine/Scene.js\n **/","import THREE from 'three';\n\n// This can be imported from anywhere and will still reference the same scene,\n// though there is a helper reference in Engine.scene\n\nexport default (function() {\n  var scene = new THREE.Scene();\n  return scene;\n})();\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/engine/DOMScene3D.js\n **/","import THREE from 'three';\n\n// This can be imported from anywhere and will still reference the same scene,\n// though there is a helper reference in Engine.scene\n\nexport default (function() {\n  var scene = new THREE.Scene();\n  return scene;\n})();\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/engine/DOMScene2D.js\n **/","import THREE from 'three';\nimport Scene from './Scene';\n\n// This can only be accessed from Engine.renderer if you want to reference the\n// same scene in multiple places\n\nexport default function(container, antialias) {\n  var renderer = new THREE.WebGLRenderer({\n    antialias: antialias\n  });\n\n  // TODO: Re-enable when this works with the skybox\n  // renderer.setClearColor(Scene.fog.color, 1);\n\n  renderer.setClearColor(0xffffff, 1);\n\n  // TODO: Re-enable this when perf issues can be solved\n  //\n  // Rendering double the resolution of the screen can be really slow\n  // var pixelRatio = window.devicePixelRatio;\n  var pixelRatio = 1;\n\n  renderer.setPixelRatio(pixelRatio);\n\n  // Gamma settings make things look nicer\n  renderer.gammaInput = true;\n  renderer.gammaOutput = true;\n\n  renderer.shadowMap.enabled = true;\n\n  // TODO: Work out which of the shadowmap types is best\n  // https://github.com/mrdoob/three.js/blob/r56/src/Three.js#L107\n  // renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n\n  // TODO: Check that leaving this as default (CullFrontFace) is right\n  // renderer.shadowMap.cullFace = THREE.CullFaceBack;\n\n  container.appendChild(renderer.domElement);\n\n  var updateSize = function() {\n    renderer.setSize(container.clientWidth, container.clientHeight);\n  };\n\n  window.addEventListener('resize', updateSize, false);\n  updateSize();\n\n  return renderer;\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/engine/Renderer.js\n **/","import THREE from 'three';\nimport {CSS3DRenderer} from '../vendor/CSS3DRenderer';\nimport DOMScene3D from './DOMScene3D';\n\n// This can only be accessed from Engine.renderer if you want to reference the\n// same scene in multiple places\n\nexport default function(container) {\n  var renderer = new CSS3DRenderer();\n\n  renderer.domElement.style.position = 'absolute';\n  renderer.domElement.style.top = 0;\n\n  container.appendChild(renderer.domElement);\n\n  var updateSize = function() {\n    renderer.setSize(container.clientWidth, container.clientHeight);\n  };\n\n  window.addEventListener('resize', updateSize, false);\n  updateSize();\n\n  return renderer;\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/engine/DOMRenderer3D.js\n **/","// jscs:disable\n/* eslint-disable */\n\n/**\n * Based on http://www.emagix.net/academic/mscs-project/item/camera-sync-with-css3-and-webgl-threejs\n * @author mrdoob / http://mrdoob.com/\n */\n\nimport THREE from 'three';\n\nvar CSS3DObject = function ( element ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.element = element;\n\tthis.element.style.position = 'absolute';\n\n\tthis.addEventListener( 'removed', function ( event ) {\n\n\t\tif ( this.element.parentNode !== null ) {\n\n\t\t\tthis.element.parentNode.removeChild( this.element );\n\n\t\t}\n\n\t} );\n\n};\n\nCSS3DObject.prototype = Object.create( THREE.Object3D.prototype );\nCSS3DObject.prototype.constructor = CSS3DObject;\n\nvar CSS3DSprite = function ( element ) {\n\n\tCSS3DObject.call( this, element );\n\n};\n\nCSS3DSprite.prototype = Object.create( CSS3DObject.prototype );\nCSS3DSprite.prototype.constructor = CSS3DSprite;\n\n//\n\nvar CSS3DRenderer = function () {\n\n\tconsole.log( 'THREE.CSS3DRenderer', THREE.REVISION );\n\n\tvar _width, _height;\n\tvar _widthHalf, _heightHalf;\n\n\tvar matrix = new THREE.Matrix4();\n\n\tvar cache = {\n\t\tcamera: { fov: 0, style: '' },\n\t\tobjects: {}\n\t};\n\n\tvar domElement = document.createElement( 'div' );\n\tdomElement.style.overflow = 'hidden';\n\n\tdomElement.style.WebkitTransformStyle = 'preserve-3d';\n\tdomElement.style.MozTransformStyle = 'preserve-3d';\n\tdomElement.style.oTransformStyle = 'preserve-3d';\n\tdomElement.style.transformStyle = 'preserve-3d';\n\n\tthis.domElement = domElement;\n\n\tvar cameraElement = document.createElement( 'div' );\n\n\tcameraElement.style.WebkitTransformStyle = 'preserve-3d';\n\tcameraElement.style.MozTransformStyle = 'preserve-3d';\n\tcameraElement.style.oTransformStyle = 'preserve-3d';\n\tcameraElement.style.transformStyle = 'preserve-3d';\n\n\tdomElement.appendChild( cameraElement );\n\n\tthis.setClearColor = function () {};\n\n\tthis.getSize = function() {\n\n\t\treturn {\n\t\t\twidth: _width,\n\t\t\theight: _height\n\t\t};\n\n\t};\n\n\tthis.setSize = function ( width, height ) {\n\n\t\t_width = width;\n\t\t_height = height;\n\n\t\t_widthHalf = _width / 2;\n\t\t_heightHalf = _height / 2;\n\n\t\tdomElement.style.width = width + 'px';\n\t\tdomElement.style.height = height + 'px';\n\n\t\tcameraElement.style.width = width + 'px';\n\t\tcameraElement.style.height = height + 'px';\n\n\t};\n\n\tvar epsilon = function ( value ) {\n\n\t\treturn Math.abs( value ) < Number.EPSILON ? 0 : value;\n\n\t};\n\n\tvar getCameraCSSMatrix = function ( matrix ) {\n\n\t\tvar elements = matrix.elements;\n\n\t\treturn 'matrix3d(' +\n\t\t\tepsilon( elements[ 0 ] ) + ',' +\n\t\t\tepsilon( - elements[ 1 ] ) + ',' +\n\t\t\tepsilon( elements[ 2 ] ) + ',' +\n\t\t\tepsilon( elements[ 3 ] ) + ',' +\n\t\t\tepsilon( elements[ 4 ] ) + ',' +\n\t\t\tepsilon( - elements[ 5 ] ) + ',' +\n\t\t\tepsilon( elements[ 6 ] ) + ',' +\n\t\t\tepsilon( elements[ 7 ] ) + ',' +\n\t\t\tepsilon( elements[ 8 ] ) + ',' +\n\t\t\tepsilon( - elements[ 9 ] ) + ',' +\n\t\t\tepsilon( elements[ 10 ] ) + ',' +\n\t\t\tepsilon( elements[ 11 ] ) + ',' +\n\t\t\tepsilon( elements[ 12 ] ) + ',' +\n\t\t\tepsilon( - elements[ 13 ] ) + ',' +\n\t\t\tepsilon( elements[ 14 ] ) + ',' +\n\t\t\tepsilon( elements[ 15 ] ) +\n\t\t')';\n\n\t};\n\n\tvar getObjectCSSMatrix = function ( matrix ) {\n\n\t\tvar elements = matrix.elements;\n\n\t\treturn 'translate3d(-50%,-50%,0) matrix3d(' +\n\t\t\tepsilon( elements[ 0 ] ) + ',' +\n\t\t\tepsilon( elements[ 1 ] ) + ',' +\n\t\t\tepsilon( elements[ 2 ] ) + ',' +\n\t\t\tepsilon( elements[ 3 ] ) + ',' +\n\t\t\tepsilon( - elements[ 4 ] ) + ',' +\n\t\t\tepsilon( - elements[ 5 ] ) + ',' +\n\t\t\tepsilon( - elements[ 6 ] ) + ',' +\n\t\t\tepsilon( - elements[ 7 ] ) + ',' +\n\t\t\tepsilon( elements[ 8 ] ) + ',' +\n\t\t\tepsilon( elements[ 9 ] ) + ',' +\n\t\t\tepsilon( elements[ 10 ] ) + ',' +\n\t\t\tepsilon( elements[ 11 ] ) + ',' +\n\t\t\tepsilon( elements[ 12 ] ) + ',' +\n\t\t\tepsilon( elements[ 13 ] ) + ',' +\n\t\t\tepsilon( elements[ 14 ] ) + ',' +\n\t\t\tepsilon( elements[ 15 ] ) +\n\t\t')';\n\n\t};\n\n\tvar renderObject = function ( object, camera ) {\n\n\t\tif ( object instanceof CSS3DObject ) {\n\n\t\t\tvar style;\n\n\t\t\tif ( object instanceof CSS3DSprite ) {\n\n\t\t\t\t// http://swiftcoder.wordpress.com/2008/11/25/constructing-a-billboard-matrix/\n\n\t\t\t\tmatrix.copy( camera.matrixWorldInverse );\n\t\t\t\tmatrix.transpose();\n\t\t\t\tmatrix.copyPosition( object.matrixWorld );\n\t\t\t\tmatrix.scale( object.scale );\n\n\t\t\t\tmatrix.elements[ 3 ] = 0;\n\t\t\t\tmatrix.elements[ 7 ] = 0;\n\t\t\t\tmatrix.elements[ 11 ] = 0;\n\t\t\t\tmatrix.elements[ 15 ] = 1;\n\n\t\t\t\tstyle = getObjectCSSMatrix( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tstyle = getObjectCSSMatrix( object.matrixWorld );\n\n\t\t\t}\n\n\t\t\tvar element = object.element;\n\t\t\tvar cachedStyle = cache.objects[ object.id ];\n\n\t\t\tif ( cachedStyle === undefined || cachedStyle !== style ) {\n\n\t\t\t\telement.style.WebkitTransform = style;\n\t\t\t\telement.style.MozTransform = style;\n\t\t\t\telement.style.oTransform = style;\n\t\t\t\telement.style.transform = style;\n\n\t\t\t\tcache.objects[ object.id ] = style;\n\n\t\t\t}\n\n\t\t\tif ( element.parentNode !== cameraElement ) {\n\n\t\t\t\tcameraElement.appendChild( element );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( var i = 0, l = object.children.length; i < l; i ++ ) {\n\n\t\t\trenderObject( object.children[ i ], camera );\n\n\t\t}\n\n\t};\n\n\tthis.render = function ( scene, camera ) {\n\n\t\tvar fov = 0.5 / Math.tan( THREE.Math.degToRad( camera.fov * 0.5 ) ) * _height;\n\n\t\tif ( cache.camera.fov !== fov ) {\n\n\t\t\tdomElement.style.WebkitPerspective = fov + 'px';\n\t\t\tdomElement.style.MozPerspective = fov + 'px';\n\t\t\tdomElement.style.oPerspective = fov + 'px';\n\t\t\tdomElement.style.perspective = fov + 'px';\n\n\t\t\tcache.camera.fov = fov;\n\n\t\t}\n\n\t\tscene.updateMatrixWorld();\n\n\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\tcamera.matrixWorldInverse.getInverse( camera.matrixWorld );\n\n\t\tvar style = 'translate3d(0,0,' + fov + 'px)' + getCameraCSSMatrix( camera.matrixWorldInverse ) +\n\t\t\t' translate3d(' + _widthHalf + 'px,' + _heightHalf + 'px, 0)';\n\n\t\tif ( cache.camera.style !== style ) {\n\n\t\t\tcameraElement.style.WebkitTransform = style;\n\t\t\tcameraElement.style.MozTransform = style;\n\t\t\tcameraElement.style.oTransform = style;\n\t\t\tcameraElement.style.transform = style;\n\n\t\t\tcache.camera.style = style;\n\n\t\t}\n\n\t\trenderObject( scene, camera );\n\n\t};\n\n};\n\nexport {CSS3DObject as CSS3DObject};\nexport {CSS3DSprite as CSS3DSprite};\nexport {CSS3DRenderer as CSS3DRenderer};\n\nTHREE.CSS3DObject = CSS3DObject;\nTHREE.CSS3DSprite = CSS3DSprite;\nTHREE.CSS3DRenderer = CSS3DRenderer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/CSS3DRenderer.js\n **/","import THREE from 'three';\nimport {CSS2DRenderer} from '../vendor/CSS2DRenderer';\nimport DOMScene2D from './DOMScene2D';\n\n// This can only be accessed from Engine.renderer if you want to reference the\n// same scene in multiple places\n\nexport default function(container) {\n  var renderer = new CSS2DRenderer();\n\n  renderer.domElement.style.position = 'absolute';\n  renderer.domElement.style.top = 0;\n\n  container.appendChild(renderer.domElement);\n\n  var updateSize = function() {\n    renderer.setSize(container.clientWidth, container.clientHeight);\n  };\n\n  window.addEventListener('resize', updateSize, false);\n  updateSize();\n\n  return renderer;\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/engine/DOMRenderer2D.js\n **/","// jscs:disable\n/* eslint-disable */\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nimport THREE from 'three';\n\nvar CSS2DObject = function ( element ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.element = element;\n\tthis.element.style.position = 'absolute';\n\n\tthis.addEventListener( 'removed', function ( event ) {\n\n\t\tif ( this.element.parentNode !== null ) {\n\n\t\t\tthis.element.parentNode.removeChild( this.element );\n\n\t\t}\n\n\t} );\n\n};\n\nCSS2DObject.prototype = Object.create( THREE.Object3D.prototype );\nCSS2DObject.prototype.constructor = CSS2DObject;\n\n//\n\nvar CSS2DRenderer = function () {\n\n\tconsole.log( 'THREE.CSS2DRenderer', THREE.REVISION );\n\n\tvar _width, _height;\n\tvar _widthHalf, _heightHalf;\n\n\tvar vector = new THREE.Vector3();\n\tvar viewMatrix = new THREE.Matrix4();\n\tvar viewProjectionMatrix = new THREE.Matrix4();\n\n\tvar frustum = new THREE.Frustum();\n\n\tvar domElement = document.createElement( 'div' );\n\tdomElement.style.overflow = 'hidden';\n\n\tthis.domElement = domElement;\n\n\tthis.setSize = function ( width, height ) {\n\n\t\t_width = width;\n\t\t_height = height;\n\n\t\t_widthHalf = _width / 2;\n\t\t_heightHalf = _height / 2;\n\n\t\tdomElement.style.width = width + 'px';\n\t\tdomElement.style.height = height + 'px';\n\n\t};\n\n\tvar renderObject = function ( object, camera ) {\n\n\t\tif ( object instanceof CSS2DObject ) {\n\n\t\t\tvector.setFromMatrixPosition( object.matrixWorld );\n\t\t\tvector.applyProjection( viewProjectionMatrix );\n\n\t\t\tvar element = object.element;\n\t\t\tvar style = 'translate(-50%,-50%) translate(' + ( vector.x * _widthHalf + _widthHalf ) + 'px,' + ( - vector.y * _heightHalf + _heightHalf ) + 'px)';\n\n\t\t\telement.style.WebkitTransform = style;\n\t\t\telement.style.MozTransform = style;\n\t\t\telement.style.oTransform = style;\n\t\t\telement.style.transform = style;\n\n\t\t\tif ( element.parentNode !== domElement ) {\n\n\t\t\t\tdomElement.appendChild( element );\n\n\t\t\t}\n\n\t\t\t// Hide if outside view frustum\n\t\t\tif (!frustum.containsPoint(object.position)) {\n\t\t\t\telement.style.display = 'none';\n\t\t\t} else {\n\t\t\t\telement.style.display = 'block';\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( var i = 0, l = object.children.length; i < l; i ++ ) {\n\n\t\t\trenderObject( object.children[ i ], camera );\n\n\t\t}\n\n\t};\n\n\tthis.render = function ( scene, camera ) {\n\n\t\tscene.updateMatrixWorld();\n\n\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\tcamera.matrixWorldInverse.getInverse( camera.matrixWorld );\n\n\t\tviewMatrix.copy( camera.matrixWorldInverse.getInverse( camera.matrixWorld ) );\n\t\tviewProjectionMatrix.multiplyMatrices( camera.projectionMatrix, viewMatrix );\n\n\t\tfrustum.setFromMatrix( new THREE.Matrix4().multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse ) );\n\n\t\trenderObject( scene, camera );\n\n\t};\n\n};\n\nexport {CSS2DObject as CSS2DObject};\nexport {CSS2DRenderer as CSS2DRenderer};\n\nTHREE.CSS2DObject = CSS2DObject;\nTHREE.CSS2DRenderer = CSS2DRenderer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/CSS2DRenderer.js\n **/","import THREE from 'three';\n\n// This can only be accessed from Engine.camera if you want to reference the\n// same scene in multiple places\n\n// TODO: Ensure that FOV looks natural on all aspect ratios\n// http://stackoverflow.com/q/26655930/997339\n\nexport default function(container) {\n  var camera = new THREE.PerspectiveCamera(45, 1, 1, 2000000);\n  // var camera = new THREE.PerspectiveCamera(45, 1, 1, 10000);\n  camera.position.y = 4000;\n  camera.position.z = 4000;\n\n  var updateSize = function() {\n    camera.aspect = container.clientWidth / container.clientHeight;\n    camera.updateProjectionMatrix();\n  };\n\n  window.addEventListener('resize', updateSize, false);\n  updateSize();\n\n  return camera;\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/engine/Camera.js\n **/","import THREE from 'three';\nimport {point as Point} from '../geo/Point';\nimport PickingScene from './PickingScene';\n\n// TODO: Look into a way of setting this up without passing in a renderer and\n// camera from the engine\n\n// TODO: Add a basic indicator on or around the mouse pointer when it is over\n// something pickable / clickable\n//\n// A simple transparent disc or ring at the mouse point should work to start, or\n// even just changing the cursor to the CSS 'pointer' style\n//\n// Probably want this on mousemove with a throttled update as not to spam the\n// picking method\n//\n// Relies upon the picking method not redrawing the scene every call due to\n// the way TileLayer invalidates the picking scene\n\nvar nextId = 1;\n\nclass Picking {\n  constructor(world, renderer, camera) {\n    this._world = world;\n    this._renderer = renderer;\n    this._camera = camera;\n\n    this._raycaster = new THREE.Raycaster();\n\n    // TODO: Match this with the line width used in the picking layers\n    this._raycaster.linePrecision = 3;\n\n    this._pickingScene = PickingScene;\n    this._pickingTexture = new THREE.WebGLRenderTarget();\n    this._pickingTexture.texture.minFilter = THREE.LinearFilter;\n    this._pickingTexture.texture.generateMipmaps = false;\n\n    this._nextId = 1;\n\n    this._resizeTexture();\n    this._initEvents();\n  }\n\n  _initEvents() {\n    this._resizeHandler = this._resizeTexture.bind(this);\n    window.addEventListener('resize', this._resizeHandler, false);\n\n    this._mouseUpHandler = this._onMouseUp.bind(this);\n    this._world._container.addEventListener('mouseup', this._mouseUpHandler, false);\n\n    this._world.on('move', this._onWorldMove, this);\n  }\n\n  _onMouseUp(event) {\n    // Only react to main button click\n    if (event.button !== 0) {\n      return;\n    }\n\n    var point = Point(event.clientX, event.clientY);\n\n    var normalisedPoint = Point(0, 0);\n    normalisedPoint.x = (point.x / this._width) * 2 - 1;\n    normalisedPoint.y = -(point.y / this._height) * 2 + 1;\n\n    this._pick(point, normalisedPoint);\n  }\n\n  _onWorldMove() {\n    this._needUpdate = true;\n  }\n\n  // TODO: Ensure this doesn't get out of sync issue with the renderer resize\n  _resizeTexture() {\n    var size = this._renderer.getSize();\n\n    this._width = size.width;\n    this._height = size.height;\n\n    this._pickingTexture.setSize(this._width, this._height);\n    this._pixelBuffer = new Uint8Array(4 * this._width * this._height);\n\n    this._needUpdate = true;\n  }\n\n  // TODO: Make this only re-draw the scene if both an update is needed and the\n  // camera has moved since the last update\n  //\n  // Otherwise it re-draws the scene on every click due to the way LOD updates\n  // work in TileLayer – spamming this.add() and this.remove()\n  //\n  // TODO: Pause updates during map move / orbit / zoom as this is unlikely to\n  // be a point in time where the user cares for picking functionality\n  _update() {\n    if (this._needUpdate) {\n      var texture = this._pickingTexture;\n\n      this._renderer.render(this._pickingScene, this._camera, this._pickingTexture);\n\n      // Read the rendering texture\n      this._renderer.readRenderTargetPixels(texture, 0, 0, texture.width, texture.height, this._pixelBuffer);\n\n      this._needUpdate = false;\n    }\n  }\n\n  _pick(point, normalisedPoint) {\n    this._update();\n\n    var index = point.x + (this._pickingTexture.height - point.y) * this._pickingTexture.width;\n\n    // Interpret the pixel as an ID\n    var id = (this._pixelBuffer[index * 4 + 2] * 255 * 255) + (this._pixelBuffer[index * 4 + 1] * 255) + (this._pixelBuffer[index * 4 + 0]);\n\n    // Skip if ID is 16646655 (white) as the background returns this\n    if (id === 16646655) {\n      return;\n    }\n\n    this._raycaster.setFromCamera(normalisedPoint, this._camera);\n\n    // Perform ray intersection on picking scene\n    //\n    // TODO: Only perform intersection test on the relevant picking mesh\n    var intersects = this._raycaster.intersectObjects(this._pickingScene.children, true);\n\n    var _point2d = point.clone();\n\n    var _point3d;\n    if (intersects.length > 0) {\n      _point3d = intersects[0].point.clone();\n    }\n\n    // Pass along as much data as possible for now until we know more about how\n    // people use the picking API and what the returned data should be\n    //\n    // TODO: Look into the leak potential for passing so much by reference here\n    this._world.emit('pick', id, _point2d, _point3d, intersects);\n    this._world.emit('pick-' + id, _point2d, _point3d, intersects);\n  }\n\n  // Add mesh to picking scene\n  //\n  // Picking ID should already be added as an attribute\n  add(mesh) {\n    this._pickingScene.add(mesh);\n    this._needUpdate = true;\n  }\n\n  // Remove mesh from picking scene\n  remove(mesh) {\n    this._pickingScene.remove(mesh);\n    this._needUpdate = true;\n  }\n\n  // Returns next ID to use for picking\n  getNextId() {\n    return nextId++;\n  }\n\n  destroy() {\n    // TODO: Find a way to properly remove these listeners as they stay\n    // active at the moment\n    window.removeEventListener('resize', this._resizeHandler, false);\n    this._world._container.removeEventListener('mouseup', this._mouseUpHandler, false);\n\n    this._world.off('move', this._onWorldMove);\n\n    if (this._pickingScene.children) {\n      // Remove everything else in the layer\n      var child;\n      for (var i = this._pickingScene.children.length - 1; i >= 0; i--) {\n        child = this._pickingScene.children[i];\n\n        if (!child) {\n          continue;\n        }\n\n        this._pickingScene.remove(child);\n\n        // Probably not a good idea to dispose of geometry due to it being\n        // shared with the non-picking scene\n        // if (child.geometry) {\n        //   // Dispose of mesh and materials\n        //   child.geometry.dispose();\n        //   child.geometry = null;\n        // }\n\n        if (child.material) {\n          if (child.material.map) {\n            child.material.map.dispose();\n            child.material.map = null;\n          }\n\n          child.material.dispose();\n          child.material = null;\n        }\n      }\n    }\n\n    this._pickingScene = null;\n    this._pickingTexture = null;\n    this._pixelBuffer = null;\n\n    this._world = null;\n    this._renderer = null;\n    this._camera = null;\n  }\n}\n\n// Initialise without requiring new keyword\nexport default function(world, renderer, camera) {\n  return new Picking(world, renderer, camera);\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/engine/Picking.js\n **/","import THREE from 'three';\n\n// This can be imported from anywhere and will still reference the same scene,\n// though there is a helper reference in Engine.pickingScene\n\nexport default (function() {\n  var scene = new THREE.Scene();\n  return scene;\n})();\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/engine/PickingScene.js\n **/","import THREE from 'three';\nimport EffectComposer from '../vendor/EffectComposer';\n\nexport default function(renderer, container) {\n  var composer = new EffectComposer(renderer);\n\n  var updateSize = function() {\n    // TODO: Re-enable this when perf issues can be solved\n    //\n    // Rendering double the resolution of the screen can be really slow\n    // var pixelRatio = window.devicePixelRatio;\n    var pixelRatio = 1;\n\n    composer.setSize(container.clientWidth * pixelRatio, container.clientHeight * pixelRatio);\n  };\n\n  window.addEventListener('resize', updateSize, false);\n  updateSize();\n\n  return composer;\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/engine/EffectComposer.js\n **/","// jscs:disable\n/* eslint-disable */\n\nimport THREE from 'three';\nimport CopyShader from './CopyShader';\nimport ShaderPass from './ShaderPass';\nimport MaskPass, {ClearMaskPass} from './MaskPass';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nvar EffectComposer = function ( renderer, renderTarget ) {\n\n\tthis.renderer = renderer;\n\n\tif ( renderTarget === undefined ) {\n\n\t\tvar pixelRatio = renderer.getPixelRatio();\n\n\t\tvar width  = Math.floor( renderer.context.canvas.width  / pixelRatio ) || 1;\n\t\tvar height = Math.floor( renderer.context.canvas.height / pixelRatio ) || 1;\n\t\tvar parameters = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat, stencilBuffer: false };\n\n\t\trenderTarget = new THREE.WebGLRenderTarget( width, height, parameters );\n\n\t}\n\n\tthis.renderTarget1 = renderTarget;\n\tthis.renderTarget2 = renderTarget.clone();\n\n\tthis.writeBuffer = this.renderTarget1;\n\tthis.readBuffer = this.renderTarget2;\n\n\tthis.passes = [];\n\n\tif ( CopyShader === undefined )\n\t\tconsole.error( \"EffectComposer relies on THREE.CopyShader\" );\n\n\tthis.copyPass = new ShaderPass( CopyShader );\n\n};\n\nEffectComposer.prototype = {\n\n\tswapBuffers: function() {\n\n\t\tvar tmp = this.readBuffer;\n\t\tthis.readBuffer = this.writeBuffer;\n\t\tthis.writeBuffer = tmp;\n\n\t},\n\n\taddPass: function ( pass ) {\n\n\t\tthis.passes.push( pass );\n\n\t},\n\n\tinsertPass: function ( pass, index ) {\n\n\t\tthis.passes.splice( index, 0, pass );\n\n\t},\n\n\trender: function ( delta ) {\n\n\t\tthis.writeBuffer = this.renderTarget1;\n\t\tthis.readBuffer = this.renderTarget2;\n\n\t\tvar maskActive = false;\n\n\t\tvar pass, i, il = this.passes.length;\n\n\t\tfor ( i = 0; i < il; i ++ ) {\n\n\t\t\tpass = this.passes[ i ];\n\n\t\t\tif ( ! pass.enabled ) continue;\n\n\t\t\tpass.render( this.renderer, this.writeBuffer, this.readBuffer, delta, maskActive );\n\n\t\t\tif ( pass.needsSwap ) {\n\n\t\t\t\tif ( maskActive ) {\n\n\t\t\t\t\tvar context = this.renderer.context;\n\n\t\t\t\t\tcontext.stencilFunc( context.NOTEQUAL, 1, 0xffffffff );\n\n\t\t\t\t\tthis.copyPass.render( this.renderer, this.writeBuffer, this.readBuffer, delta );\n\n\t\t\t\t\tcontext.stencilFunc( context.EQUAL, 1, 0xffffffff );\n\n\t\t\t\t}\n\n\t\t\t\tthis.swapBuffers();\n\n\t\t\t}\n\n\t\t\tif ( pass instanceof MaskPass ) {\n\n\t\t\t\tmaskActive = true;\n\n\t\t\t} else if ( pass instanceof ClearMaskPass ) {\n\n\t\t\t\tmaskActive = false;\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\treset: function ( renderTarget ) {\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\trenderTarget = this.renderTarget1.clone();\n\n\t\t\tvar pixelRatio = this.renderer.getPixelRatio();\n\n\t\t\trenderTarget.setSize(\n\t\t\t\tMath.floor( this.renderer.context.canvas.width  / pixelRatio ),\n\t\t\t\tMath.floor( this.renderer.context.canvas.height / pixelRatio )\n\t\t\t);\n\n\t\t}\n\n\t\tthis.renderTarget1.dispose();\n\t\tthis.renderTarget1 = renderTarget;\n\t\tthis.renderTarget2.dispose();\n\t\tthis.renderTarget2 = renderTarget.clone();\n\n\t\tthis.writeBuffer = this.renderTarget1;\n\t\tthis.readBuffer = this.renderTarget2;\n\n\t},\n\n\tsetSize: function ( width, height ) {\n\n\t\tthis.renderTarget1.setSize( width, height );\n\t\tthis.renderTarget2.setSize( width, height );\n\n\t}\n\n};\n\nexport default EffectComposer;\nTHREE.EffectComposer = EffectComposer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/EffectComposer.js\n **/","// jscs:disable\n/* eslint-disable */\n\nimport THREE from 'three';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Full-screen textured quad shader\n */\n\nvar CopyShader = {\n\n\tuniforms: {\n\n\t\t\"tDiffuse\": { type: \"t\", value: null },\n\t\t\"opacity\":  { type: \"f\", value: 1.0 }\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vUv = uv;\",\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\t\t\"uniform float opacity;\",\n\n\t\t\"uniform sampler2D tDiffuse;\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vec4 texel = texture2D( tDiffuse, vUv );\",\n\t\t\t\"gl_FragColor = opacity * texel;\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\nexport default CopyShader;\nTHREE.CopyShader = CopyShader;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/CopyShader.js\n **/","// jscs:disable\n/* eslint-disable */\n\nimport THREE from 'three';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nvar ShaderPass = function( shader, textureID ) {\n\n\tthis.textureID = ( textureID !== undefined ) ? textureID : \"tDiffuse\";\n\n\tif ( shader instanceof THREE.ShaderMaterial ) {\n\n\t\tthis.uniforms = shader.uniforms;\n\n\t\tthis.material = shader;\n\n\t}\n\telse if ( shader ) {\n\n\t\tthis.uniforms = THREE.UniformsUtils.clone( shader.uniforms );\n\n\t\tthis.material = new THREE.ShaderMaterial( {\n\n\t\t\tdefines: shader.defines || {},\n\t\t\tuniforms: this.uniforms,\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader\n\n\t\t} );\n\n\t}\n\n\tthis.renderToScreen = false;\n\n\tthis.enabled = true;\n\tthis.needsSwap = true;\n\tthis.clear = false;\n\n\n\tthis.camera = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\tthis.scene = new THREE.Scene();\n\n\tthis.quad = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), null );\n\tthis.scene.add( this.quad );\n\n};\n\nShaderPass.prototype = {\n\n\trender: function( renderer, writeBuffer, readBuffer, delta ) {\n\n\t\tif ( this.uniforms[ this.textureID ] ) {\n\n\t\t\tthis.uniforms[ this.textureID ].value = readBuffer;\n\n\t\t}\n\n\t\tthis.quad.material = this.material;\n\n\t\tif ( this.renderToScreen ) {\n\n\t\t\trenderer.render( this.scene, this.camera );\n\n\t\t} else {\n\n\t\t\trenderer.render( this.scene, this.camera, writeBuffer, this.clear );\n\n\t\t}\n\n\t}\n\n};\n\nexport default ShaderPass;\nTHREE.ShaderPass = ShaderPass;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/ShaderPass.js\n **/","// jscs:disable\n/* eslint-disable */\n\nimport THREE from 'three';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nvar MaskPass = function ( scene, camera ) {\n\n\tthis.scene = scene;\n\tthis.camera = camera;\n\n\tthis.enabled = true;\n\tthis.clear = true;\n\tthis.needsSwap = false;\n\n\tthis.inverse = false;\n\n};\n\nMaskPass.prototype = {\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta ) {\n\n\t\tvar context = renderer.context;\n\n\t\t// don't update color or depth\n\n\t\tcontext.colorMask( false, false, false, false );\n\t\tcontext.depthMask( false );\n\n\t\t// set up stencil\n\n\t\tvar writeValue, clearValue;\n\n\t\tif ( this.inverse ) {\n\n\t\t\twriteValue = 0;\n\t\t\tclearValue = 1;\n\n\t\t} else {\n\n\t\t\twriteValue = 1;\n\t\t\tclearValue = 0;\n\n\t\t}\n\n\t\tcontext.enable( context.STENCIL_TEST );\n\t\tcontext.stencilOp( context.REPLACE, context.REPLACE, context.REPLACE );\n\t\tcontext.stencilFunc( context.ALWAYS, writeValue, 0xffffffff );\n\t\tcontext.clearStencil( clearValue );\n\n\t\t// draw into the stencil buffer\n\n\t\trenderer.render( this.scene, this.camera, readBuffer, this.clear );\n\t\trenderer.render( this.scene, this.camera, writeBuffer, this.clear );\n\n\t\t// re-enable update of color and depth\n\n\t\tcontext.colorMask( true, true, true, true );\n\t\tcontext.depthMask( true );\n\n\t\t// only render where stencil is set to 1\n\n\t\tcontext.stencilFunc( context.EQUAL, 1, 0xffffffff );  // draw if == 1\n\t\tcontext.stencilOp( context.KEEP, context.KEEP, context.KEEP );\n\n\t}\n\n};\n\n\nvar ClearMaskPass = function () {\n\n\tthis.enabled = true;\n\n};\n\nClearMaskPass.prototype = {\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta ) {\n\n\t\tvar context = renderer.context;\n\n\t\tcontext.disable( context.STENCIL_TEST );\n\n\t}\n\n};\n\nexport default MaskPass;\nexport {ClearMaskPass as ClearMaskPass};\n\nTHREE.MaskPass = MaskPass;\nTHREE.ClearMaskPass = ClearMaskPass;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/MaskPass.js\n **/","// jscs:disable\n/* eslint-disable */\n\nimport THREE from 'three';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nvar RenderPass = function ( scene, camera, overrideMaterial, clearColor, clearAlpha ) {\n\n\tthis.scene = scene;\n\tthis.camera = camera;\n\n\tthis.overrideMaterial = overrideMaterial;\n\n\tthis.clearColor = clearColor;\n\tthis.clearAlpha = ( clearAlpha !== undefined ) ? clearAlpha : 1;\n\n\tthis.oldClearColor = new THREE.Color();\n\tthis.oldClearAlpha = 1;\n\n\tthis.enabled = true;\n\tthis.clear = true;\n\tthis.needsSwap = false;\n\n};\n\nRenderPass.prototype = {\n\n\trender: function ( renderer, writeBuffer, readBuffer, delta ) {\n\n\t\tthis.scene.overrideMaterial = this.overrideMaterial;\n\n\t\tif ( this.clearColor ) {\n\n\t\t\tthis.oldClearColor.copy( renderer.getClearColor() );\n\t\t\tthis.oldClearAlpha = renderer.getClearAlpha();\n\n\t\t\trenderer.setClearColor( this.clearColor, this.clearAlpha );\n\n\t\t}\n\n\t\trenderer.render( this.scene, this.camera, readBuffer, this.clear );\n\n\t\tif ( this.clearColor ) {\n\n\t\t\trenderer.setClearColor( this.oldClearColor, this.oldClearAlpha );\n\n\t\t}\n\n\t\tthis.scene.overrideMaterial = null;\n\n\t}\n\n};\n\nexport default RenderPass;\nTHREE.RenderPass = RenderPass;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/RenderPass.js\n **/","// jscs:disable\n/* eslint-disable */\n\nimport THREE from 'three';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Simple fake tilt-shift effect, modulating two pass Gaussian blur (see above) by vertical position\n *\n * - 9 samples per pass\n * - standard deviation 2.7\n * - \"h\" and \"v\" parameters should be set to \"1 / width\" and \"1 / height\"\n * - \"r\" parameter control where \"focused\" horizontal line lies\n */\n\nvar HorizontalTiltShiftShader = {\n\n\tuniforms: {\n\n\t\t\"tDiffuse\": { type: \"t\", value: null },\n\t\t\"h\":        { type: \"f\", value: 1.0 / 512.0 },\n\t\t\"r\":        { type: \"f\", value: 0.35 }\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vUv = uv;\",\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\t\t\"uniform sampler2D tDiffuse;\",\n\t\t\"uniform float h;\",\n\t\t\"uniform float r;\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vec4 sum = vec4( 0.0 );\",\n\n\t\t\t\"float hh = h * abs( r - vUv.y );\",\n\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * hh, vUv.y ) ) * 0.051;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * hh, vUv.y ) ) * 0.0918;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * hh, vUv.y ) ) * 0.12245;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * hh, vUv.y ) ) * 0.1531;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * hh, vUv.y ) ) * 0.1531;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * hh, vUv.y ) ) * 0.12245;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * hh, vUv.y ) ) * 0.0918;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * hh, vUv.y ) ) * 0.051;\",\n\n\t\t\t\"gl_FragColor = sum;\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\nexport default HorizontalTiltShiftShader;\nTHREE.HorizontalTiltShiftShader = HorizontalTiltShiftShader;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/HorizontalTiltShiftShader.js\n **/","// jscs:disable\n/* eslint-disable */\n\nimport THREE from 'three';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Simple fake tilt-shift effect, modulating two pass Gaussian blur (see above) by vertical position\n *\n * - 9 samples per pass\n * - standard deviation 2.7\n * - \"h\" and \"v\" parameters should be set to \"1 / width\" and \"1 / height\"\n * - \"r\" parameter control where \"focused\" horizontal line lies\n */\n\nvar VerticalTiltShiftShader = {\n\n\tuniforms: {\n\n\t\t\"tDiffuse\": { type: \"t\", value: null },\n\t\t\"v\":        { type: \"f\", value: 1.0 / 512.0 },\n\t\t\"r\":        { type: \"f\", value: 0.35 }\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vUv = uv;\",\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\t\t\"uniform sampler2D tDiffuse;\",\n\t\t\"uniform float v;\",\n\t\t\"uniform float r;\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vec4 sum = vec4( 0.0 );\",\n\n\t\t\t\"float vv = v * abs( r - vUv.y );\",\n\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;\",\n\t\t\t\"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;\",\n\n\t\t\t\"gl_FragColor = sum;\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\nexport default VerticalTiltShiftShader;\nTHREE.VerticalTiltShiftShader = VerticalTiltShiftShader;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/VerticalTiltShiftShader.js\n **/","// jscs:disable\n/* eslint-disable */\n\nimport THREE from 'three';\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @author davidedc / http://www.sketchpatch.net/\n *\n * NVIDIA FXAA by Timothy Lottes\n * http://timothylottes.blogspot.com/2011/06/fxaa3-source-released.html\n * - WebGL port by @supereggbert\n * http://www.glge.org/demos/fxaa/\n */\n\nvar FXAAShader = {\n\n\tuniforms: {\n\n\t\t\"tDiffuse\":   { type: \"t\", value: null },\n\t\t\"resolution\": { type: \"v2\", value: new THREE.Vector2( 1 / 1024, 1 / 512 ) }\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"void main() {\",\n\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\t\t\"uniform sampler2D tDiffuse;\",\n\t\t\"uniform vec2 resolution;\",\n\n\t\t\"#define FXAA_REDUCE_MIN   (1.0/128.0)\",\n\t\t\"#define FXAA_REDUCE_MUL   (1.0/8.0)\",\n\t\t\"#define FXAA_SPAN_MAX     8.0\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vec3 rgbNW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ).xyz;\",\n\t\t\t\"vec3 rgbNE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ).xyz;\",\n\t\t\t\"vec3 rgbSW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ).xyz;\",\n\t\t\t\"vec3 rgbSE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ).xyz;\",\n\t\t\t\"vec4 rgbaM  = texture2D( tDiffuse,  gl_FragCoord.xy  * resolution );\",\n\t\t\t\"vec3 rgbM  = rgbaM.xyz;\",\n\t\t\t\"vec3 luma = vec3( 0.299, 0.587, 0.114 );\",\n\n\t\t\t\"float lumaNW = dot( rgbNW, luma );\",\n\t\t\t\"float lumaNE = dot( rgbNE, luma );\",\n\t\t\t\"float lumaSW = dot( rgbSW, luma );\",\n\t\t\t\"float lumaSE = dot( rgbSE, luma );\",\n\t\t\t\"float lumaM  = dot( rgbM,  luma );\",\n\t\t\t\"float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );\",\n\t\t\t\"float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );\",\n\n\t\t\t\"vec2 dir;\",\n\t\t\t\"dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\",\n\t\t\t\"dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\",\n\n\t\t\t\"float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );\",\n\n\t\t\t\"float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );\",\n\t\t\t\"dir = min( vec2( FXAA_SPAN_MAX,  FXAA_SPAN_MAX),\",\n\t\t\t\t  \"max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\",\n\t\t\t\t\t\t\"dir * rcpDirMin)) * resolution;\",\n\t\t\t\"vec4 rgbA = (1.0/2.0) * (\",\n        \t\"texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (1.0/3.0 - 0.5)) +\",\n\t\t\t\"texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (2.0/3.0 - 0.5)));\",\n    \t\t\"vec4 rgbB = rgbA * (1.0/2.0) + (1.0/4.0) * (\",\n\t\t\t\"texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (0.0/3.0 - 0.5)) +\",\n      \t\t\"texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (3.0/3.0 - 0.5)));\",\n    \t\t\"float lumaB = dot(rgbB, vec4(luma, 0.0));\",\n\n\t\t\t\"if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) ) {\",\n\n\t\t\t\t\"gl_FragColor = rgbA;\",\n\n\t\t\t\"} else {\",\n\t\t\t\t\"gl_FragColor = rgbB;\",\n\n\t\t\t\"}\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\nexport default FXAAShader;\nTHREE.FXAAShader = FXAAShader;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/FXAAShader.js\n **/","import Layer from '../Layer';\nimport extend from 'lodash.assign';\nimport THREE from 'three';\nimport Skybox from './Skybox';\n\n// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\nclass EnvironmentLayer extends Layer {\n  constructor(options) {\n    var defaults = {\n      skybox: false\n    };\n\n    var _options = extend({}, defaults, options);\n\n    super(_options);\n  }\n\n  _onAdd() {\n    this._initLights();\n\n    if (this._options.skybox) {\n      this._initSkybox();\n    }\n\n    // this._initGrid();\n  }\n\n  // Not fleshed out or thought through yet\n  //\n  // Lights could potentially be put it their own 'layer' to keep this class\n  // much simpler and less messy\n  _initLights() {\n    // Position doesn't really matter (the angle is important), however it's\n    // used here so the helpers look more natural.\n\n    if (!this._options.skybox) {\n      var directionalLight = new THREE.DirectionalLight(0xffffff, 1);\n      directionalLight.position.x = 10000;\n      directionalLight.position.y = 10000;\n      directionalLight.position.z = 10000;\n\n      // TODO: Get shadows working in non-PBR scenes\n\n      // directionalLight.castShadow = true;\n      //\n      // var d = 100;\n      // directionalLight.shadow.camera.left = -d;\n      // directionalLight.shadow.camera.right = d;\n      // directionalLight.shadow.camera.top = d;\n      // directionalLight.shadow.camera.bottom = -d;\n      //\n      // directionalLight.shadow.camera.near = 10;\n      // directionalLight.shadow.camera.far = 100;\n      //\n      // // TODO: Need to dial in on a good shadowmap size\n      // directionalLight.shadow.mapSize.width = 2048;\n      // directionalLight.shadow.mapSize.height = 2048;\n      //\n      // // directionalLight.shadowBias = -0.0010;\n      // // directionalLight.shadow.darkness = 0.15;\n\n      var directionalLight2 = new THREE.DirectionalLight(0xffffff, 0.5);\n      directionalLight2.position.x = -10000;\n      directionalLight2.position.y = 10000;\n      directionalLight2.position.z = 0;\n\n      var directionalLight3 = new THREE.DirectionalLight(0xffffff, 0.5);\n      directionalLight3.position.x = 10000;\n      directionalLight3.position.y = 10000;\n      directionalLight3.position.z = -10000;\n\n      this.add(directionalLight);\n      this.add(directionalLight2);\n      this.add(directionalLight3);\n\n      // var helper = new THREE.DirectionalLightHelper(directionalLight, 10);\n      // var helper2 = new THREE.DirectionalLightHelper(directionalLight2, 10);\n      // var helper3 = new THREE.DirectionalLightHelper(directionalLight3, 10);\n      //\n      // this.add(helper);\n      // this.add(helper2);\n      // this.add(helper3);\n    } else {\n      // Directional light that will be projected from the sun\n      this._skyboxLight = new THREE.DirectionalLight(0xffffff, 1);\n\n      this._skyboxLight.castShadow = true;\n\n      var d = 10000;\n      this._skyboxLight.shadow.camera.left = -d;\n      this._skyboxLight.shadow.camera.right = d;\n      this._skyboxLight.shadow.camera.top = d;\n      this._skyboxLight.shadow.camera.bottom = -d;\n\n      this._skyboxLight.shadow.camera.near = 10000;\n      this._skyboxLight.shadow.camera.far = 70000;\n\n      // TODO: Need to dial in on a good shadowmap size\n      this._skyboxLight.shadow.mapSize.width = 2048;\n      this._skyboxLight.shadow.mapSize.height = 2048;\n\n      // this._skyboxLight.shadowBias = -0.0010;\n      // this._skyboxLight.shadow.darkness = 0.15;\n\n      // this._object3D.add(new THREE.CameraHelper(this._skyboxLight.shadow.camera));\n\n      this.add(this._skyboxLight);\n    }\n  }\n\n  _initSkybox() {\n    this._skybox = new Skybox(this._world, this._skyboxLight);\n    this.add(this._skybox._mesh);\n  }\n\n  // Add grid helper for context during initial development\n  _initGrid() {\n    var size = 4000;\n    var step = 100;\n\n    var gridHelper = new THREE.GridHelper(size, step);\n    this.add(gridHelper);\n  }\n\n  // Clean up environment\n  destroy() {\n    this._skyboxLight = null;\n\n    this.remove(this._skybox._mesh);\n    this._skybox.destroy();\n    this._skybox = null;\n\n    super.destroy();\n  }\n}\n\nexport default EnvironmentLayer;\n\nvar noNew = function(options) {\n  return new EnvironmentLayer(options);\n};\n\n// Initialise without requiring new keyword\nexport {noNew as environmentLayer};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/environment/EnvironmentLayer.js\n **/","import EventEmitter from 'eventemitter3';\nimport extend from 'lodash.assign';\nimport THREE from 'three';\nimport Scene from '../engine/Scene';\nimport {CSS3DObject} from '../vendor/CSS3DRenderer';\nimport {CSS2DObject} from '../vendor/CSS2DRenderer';\n\n// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\n// TODO: Need a single move method that handles moving all the various object\n// layers so that the DOM layers stay in sync with the 3D layer\n\n// TODO: Double check that objects within the _object3D Object3D parent are frustum\n// culled even if the layer position stays at the default (0,0,0) and the child\n// objects are positioned much further away\n//\n// Or does the layer being at (0,0,0) prevent the child objects from being\n// culled because the layer parent is effectively always in view even if the\n// child is actually out of camera\n\nclass Layer extends EventEmitter {\n  constructor(options) {\n    super();\n\n    var defaults = {\n      output: true,\n      outputToScene: true\n    };\n\n    this._options = extend({}, defaults, options);\n\n    if (this.isOutput()) {\n      this._object3D = new THREE.Object3D();\n\n      this._dom3D = document.createElement('div');\n      this._domObject3D = new CSS3DObject(this._dom3D);\n\n      this._dom2D = document.createElement('div');\n      this._domObject2D = new CSS2DObject(this._dom2D);\n    }\n  }\n\n  // Add THREE object directly to layer\n  add(object) {\n    this._object3D.add(object);\n  }\n\n  // Remove THREE object from to layer\n  remove(object) {\n    this._object3D.remove(object);\n  }\n\n  addDOM3D(object) {\n    this._domObject3D.add(object);\n  }\n\n  removeDOM3D(object) {\n    this._domObject3D.remove(object);\n  }\n\n  addDOM2D(object) {\n    this._domObject2D.add(object);\n  }\n\n  removeDOM2D(object) {\n    this._domObject2D.remove(object);\n  }\n\n  // Add layer to world instance and store world reference\n  addTo(world) {\n    world.addLayer(this);\n    return this;\n  }\n\n  // Internal method called by World.addLayer to actually add the layer\n  _addToWorld(world) {\n    this._world = world;\n    this._onAdd(world);\n    this.emit('added');\n  }\n\n  _onAdd(world) {}\n\n  getPickingId() {\n    if (this._world._engine._picking) {\n      return this._world._engine._picking.getNextId();\n    }\n\n    return false;\n  }\n\n  // TODO: Tidy this up and don't access so many private properties to work\n  addToPicking(object) {\n    if (!this._world._engine._picking) {\n      return;\n    }\n\n    this._world._engine._picking.add(object);\n  }\n\n  removeFromPicking(object) {\n    if (!this._world._engine._picking) {\n      return;\n    }\n\n    this._world._engine._picking.remove(object);\n  }\n\n  isOutput() {\n    return this._options.output;\n  }\n\n  isOutputToScene() {\n    return this._options.outputToScene;\n  }\n\n  // Destroys the layer and removes it from the scene and memory\n  destroy() {\n    if (this._object3D && this._object3D.children) {\n      // Remove everything else in the layer\n      var child;\n      for (var i = this._object3D.children.length - 1; i >= 0; i--) {\n        child = this._object3D.children[i];\n\n        if (!child) {\n          continue;\n        }\n\n        this.remove(child);\n\n        if (child.geometry) {\n          // Dispose of mesh and materials\n          child.geometry.dispose();\n          child.geometry = null;\n        }\n\n        if (child.material) {\n          if (child.material.map) {\n            child.material.map.dispose();\n            child.material.map = null;\n          }\n\n          child.material.dispose();\n          child.material = null;\n        }\n      }\n    }\n\n    if (this._domObject3D && this._domObject3D.children) {\n      // Remove everything else in the layer\n      var child;\n      for (var i = this._domObject3D.children.length - 1; i >= 0; i--) {\n        child = this._domObject3D.children[i];\n\n        if (!child) {\n          continue;\n        }\n\n        this.removeDOM3D(child);\n      }\n    }\n\n    if (this._domObject2D && this._domObject2D.children) {\n      // Remove everything else in the layer\n      var child;\n      for (var i = this._domObject2D.children.length - 1; i >= 0; i--) {\n        child = this._domObject2D.children[i];\n\n        if (!child) {\n          continue;\n        }\n\n        this.removeDOM2D(child);\n      }\n    }\n\n    this._domObject3D = null;\n    this._domObject2D = null;\n\n    this._world = null;\n    this._object3D = null;\n  }\n}\n\nexport default Layer;\n\nvar noNew = function(options) {\n  return new Layer(options);\n};\n\nexport {noNew as layer};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/Layer.js\n **/","import THREE from 'three';\nimport Sky from './Sky';\nimport throttle from 'lodash.throttle';\n\n// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\nvar cubemap = {\n  vertexShader: [\n\t\t'varying vec3 vPosition;',\n\t\t'void main() {',\n\t\t\t'vPosition = position;',\n\t\t\t'gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\n\t\t'}'\n\t].join('\\n'),\n\n  fragmentShader: [\n    'uniform samplerCube cubemap;',\n    'varying vec3 vPosition;',\n\n    'void main() {',\n      'gl_FragColor = textureCube(cubemap, normalize(vPosition));',\n    '}'\n  ].join('\\n')\n};\n\nclass Skybox {\n  constructor(world, light) {\n    this._world = world;\n    this._light = light;\n\n    this._settings = {\n      distance: 38000,\n      turbidity: 10,\n      reileigh: 2,\n      mieCoefficient: 0.005,\n      mieDirectionalG: 0.8,\n      luminance: 1,\n      // 0.48 is a cracking dusk / sunset\n      // 0.4 is a beautiful early-morning / late-afternoon\n      // 0.2 is a nice day time\n      inclination: 0.48, // Elevation / inclination\n      azimuth: 0.25, // Facing front\n    };\n\n    this._initSkybox();\n    this._updateUniforms();\n    this._initEvents();\n  }\n\n  _initEvents() {\n    // Throttled to 1 per 100ms\n    this._throttledWorldUpdate = throttle(this._update, 100);\n    this._world.on('preUpdate', this._throttledWorldUpdate, this);\n  }\n\n  _initSkybox() {\n    // Cube camera for skybox\n    this._cubeCamera = new THREE.CubeCamera(1, 20000000, 128);\n\n    // Cube material\n    var cubeTarget = this._cubeCamera.renderTarget;\n\n    // Add Sky Mesh\n    this._sky = new Sky();\n    this._skyScene = new THREE.Scene();\n    this._skyScene.add(this._sky.mesh);\n\n    // Add Sun Helper\n    this._sunSphere = new THREE.Mesh(\n      new THREE.SphereBufferGeometry(2000, 16, 8),\n      new THREE.MeshBasicMaterial({\n        color: 0xffffff\n      })\n    );\n\n    // TODO: This isn't actually visible because it's not added to the layer\n    // this._sunSphere.visible = true;\n\n    var skyboxUniforms = {\n      cubemap: { type: 't', value: cubeTarget }\n    };\n\n    var skyboxMat = new THREE.ShaderMaterial({\n      uniforms: skyboxUniforms,\n      vertexShader: cubemap.vertexShader,\n      fragmentShader: cubemap.fragmentShader,\n      side: THREE.BackSide\n    });\n\n    this._mesh = new THREE.Mesh(new THREE.BoxGeometry(1900000, 1900000, 1900000), skyboxMat);\n\n    this._updateSkybox = true;\n  }\n\n  _updateUniforms() {\n    var settings = this._settings;\n    var uniforms = this._sky.uniforms;\n    uniforms.turbidity.value = settings.turbidity;\n    uniforms.reileigh.value = settings.reileigh;\n    uniforms.luminance.value = settings.luminance;\n    uniforms.mieCoefficient.value = settings.mieCoefficient;\n    uniforms.mieDirectionalG.value = settings.mieDirectionalG;\n\n    var theta = Math.PI * (settings.inclination - 0.5);\n    var phi = 2 * Math.PI * (settings.azimuth - 0.5);\n\n    this._sunSphere.position.x = settings.distance * Math.cos(phi);\n    this._sunSphere.position.y = settings.distance * Math.sin(phi) * Math.sin(theta);\n    this._sunSphere.position.z = settings.distance * Math.sin(phi) * Math.cos(theta);\n\n    // Move directional light to sun position\n    this._light.position.copy(this._sunSphere.position);\n\n    this._sky.uniforms.sunPosition.value.copy(this._sunSphere.position);\n  }\n\n  _update(delta) {\n    if (this._updateSkybox) {\n      this._updateSkybox = false;\n    } else {\n      return;\n    }\n\n    // if (!this._angle) {\n    //   this._angle = 0;\n    // }\n    //\n    // // Animate inclination\n    // this._angle += Math.PI * delta;\n    // this._settings.inclination = 0.5 * (Math.sin(this._angle) / 2 + 0.5);\n\n    // Update light intensity depending on elevation of sun (day to night)\n    this._light.intensity = 1 - 0.95 * (this._settings.inclination / 0.5);\n\n    // // console.log(delta, this._angle, this._settings.inclination);\n    //\n    // TODO: Only do this when the uniforms have been changed\n    this._updateUniforms();\n\n    // TODO: Only do this when the cubemap has actually changed\n    this._cubeCamera.updateCubeMap(this._world._engine._renderer, this._skyScene);\n  }\n\n  getRenderTarget() {\n    return this._cubeCamera.renderTarget;\n  }\n\n  setInclination(inclination) {\n    this._settings.inclination = inclination;\n    this._updateSkybox = true;\n  }\n\n  // Destroy the skybox and remove it from memory\n  destroy() {\n    this._world.off('preUpdate', this._throttledWorldUpdate);\n    this._throttledWorldUpdate = null;\n\n    this._world = null;\n    this._light = null;\n\n    this._cubeCamera = null;\n\n    this._sky.mesh.geometry.dispose();\n    this._sky.mesh.geometry = null;\n\n    if (this._sky.mesh.material.map) {\n      this._sky.mesh.material.map.dispose();\n      this._sky.mesh.material.map = null;\n    }\n\n    this._sky.mesh.material.dispose();\n    this._sky.mesh.material = null;\n\n    this._sky.mesh = null;\n    this._sky = null;\n\n    this._skyScene = null;\n\n    this._sunSphere.geometry.dispose();\n    this._sunSphere.geometry = null;\n\n    if (this._sunSphere.material.map) {\n      this._sunSphere.material.map.dispose();\n      this._sunSphere.material.map = null;\n    }\n\n    this._sunSphere.material.dispose();\n    this._sunSphere.material = null;\n\n    this._sunSphere = null;\n\n    this._mesh.geometry.dispose();\n    this._mesh.geometry = null;\n\n    if (this._mesh.material.map) {\n      this._mesh.material.map.dispose();\n      this._mesh.material.map = null;\n    }\n\n    this._mesh.material.dispose();\n    this._mesh.material = null;\n  }\n}\n\nexport default Skybox;\n\nvar noNew = function(world, light) {\n  return new Skybox(world, light);\n};\n\n// Initialise without requiring new keyword\nexport {noNew as skybox};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/environment/Skybox.js\n **/","// jscs:disable\n/*eslint eqeqeq:0*/\n\n/**\n * @author zz85 / https://github.com/zz85\n *\n * Based on 'A Practical Analytic Model for Daylight'\n * aka The Preetham Model, the de facto standard analytic skydome model\n * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\n *\n * First implemented by Simon Wallner\n * http://www.simonwallner.at/projects/atmospheric-scattering\n *\n * Improved by Martin Upitis\n * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\n *\n * Three.js integration by zz85 http://twitter.com/blurspline\n*/\n\nimport THREE from 'three';\n\nTHREE.ShaderLib[ 'sky' ] = {\n\n\tuniforms: {\n\n\t\tluminance:\t { type: 'f', value: 1 },\n\t\tturbidity:\t { type: 'f', value: 2 },\n\t\treileigh:\t { type: 'f', value: 1 },\n\t\tmieCoefficient:\t { type: 'f', value: 0.005 },\n\t\tmieDirectionalG: { type: 'f', value: 0.8 },\n\t\tsunPosition: \t { type: 'v3', value: new THREE.Vector3() }\n\n\t},\n\n\tvertexShader: [\n\n\t\t'varying vec3 vWorldPosition;',\n\n\t\t'void main() {',\n\n\t\t\t'vec4 worldPosition = modelMatrix * vec4( position, 1.0 );',\n\t\t\t'vWorldPosition = worldPosition.xyz;',\n\n\t\t\t'gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\n\n\t\t'}',\n\n\t].join( '\\n' ),\n\n\tfragmentShader: [\n\n\t\t'uniform sampler2D skySampler;',\n\t\t'uniform vec3 sunPosition;',\n\t\t'varying vec3 vWorldPosition;',\n\n\t\t'vec3 cameraPos = vec3(0., 0., 0.);',\n\t\t'// uniform sampler2D sDiffuse;',\n\t\t'// const float turbidity = 10.0; //',\n\t\t'// const float reileigh = 2.; //',\n\t\t'// const float luminance = 1.0; //',\n\t\t'// const float mieCoefficient = 0.005;',\n\t\t'// const float mieDirectionalG = 0.8;',\n\n\t\t'uniform float luminance;',\n\t\t'uniform float turbidity;',\n\t\t'uniform float reileigh;',\n\t\t'uniform float mieCoefficient;',\n\t\t'uniform float mieDirectionalG;',\n\n\t\t'// constants for atmospheric scattering',\n\t\t'const float e = 2.71828182845904523536028747135266249775724709369995957;',\n\t\t'const float pi = 3.141592653589793238462643383279502884197169;',\n\n\t\t'const float n = 1.0003; // refractive index of air',\n\t\t'const float N = 2.545E25; // number of molecules per unit volume for air at',\n\t\t\t\t\t\t\t\t'// 288.15K and 1013mb (sea level -45 celsius)',\n\t\t'const float pn = 0.035;\t// depolatization factor for standard air',\n\n\t\t'// wavelength of used primaries, according to preetham',\n\t\t'const vec3 lambda = vec3(680E-9, 550E-9, 450E-9);',\n\n\t\t'// mie stuff',\n\t\t'// K coefficient for the primaries',\n\t\t'const vec3 K = vec3(0.686, 0.678, 0.666);',\n\t\t'const float v = 4.0;',\n\n\t\t'// optical length at zenith for molecules',\n\t\t'const float rayleighZenithLength = 8.4E3;',\n\t\t'const float mieZenithLength = 1.25E3;',\n\t\t'const vec3 up = vec3(0.0, 1.0, 0.0);',\n\n\t\t'const float EE = 1000.0;',\n\t\t'const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;',\n\t\t'// 66 arc seconds -> degrees, and the cosine of that',\n\n\t\t'// earth shadow hack',\n\t\t'const float cutoffAngle = pi/1.95;',\n\t\t'const float steepness = 1.5;',\n\n\n\t\t'vec3 totalRayleigh(vec3 lambda)',\n\t\t'{',\n\t\t\t'return (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn));',\n\t\t'}',\n\n\t\t// see http://blenderartists.org/forum/showthread.php?321110-Shaders-and-Skybox-madness\n\t\t'// A simplied version of the total Reayleigh scattering to works on browsers that use ANGLE',\n\t\t'vec3 simplifiedRayleigh()',\n\t\t'{',\n\t\t\t'return 0.0005 / vec3(94, 40, 18);',\n\t\t\t// return 0.00054532832366 / (3.0 * 2.545E25 * pow(vec3(680E-9, 550E-9, 450E-9), vec3(4.0)) * 6.245);\n\t\t'}',\n\n\t\t'float rayleighPhase(float cosTheta)',\n\t\t'{\t ',\n\t\t\t'return (3.0 / (16.0*pi)) * (1.0 + pow(cosTheta, 2.0));',\n\t\t'//\treturn (1.0 / (3.0*pi)) * (1.0 + pow(cosTheta, 2.0));',\n\t\t'//\treturn (3.0 / 4.0) * (1.0 + pow(cosTheta, 2.0));',\n\t\t'}',\n\n\t\t'vec3 totalMie(vec3 lambda, vec3 K, float T)',\n\t\t'{',\n\t\t\t'float c = (0.2 * T ) * 10E-18;',\n\t\t\t'return 0.434 * c * pi * pow((2.0 * pi) / lambda, vec3(v - 2.0)) * K;',\n\t\t'}',\n\n\t\t'float hgPhase(float cosTheta, float g)',\n\t\t'{',\n\t\t\t'return (1.0 / (4.0*pi)) * ((1.0 - pow(g, 2.0)) / pow(1.0 - 2.0*g*cosTheta + pow(g, 2.0), 1.5));',\n\t\t'}',\n\n\t\t'float sunIntensity(float zenithAngleCos)',\n\t\t'{',\n\t\t\t'return EE * max(0.0, 1.0 - exp(-((cutoffAngle - acos(zenithAngleCos))/steepness)));',\n\t\t'}',\n\n\t\t'// float logLuminance(vec3 c)',\n\t\t'// {',\n\t\t'// \treturn log(c.r * 0.2126 + c.g * 0.7152 + c.b * 0.0722);',\n\t\t'// }',\n\n\t\t'// Filmic ToneMapping http://filmicgames.com/archives/75',\n\t\t'float A = 0.15;',\n\t\t'float B = 0.50;',\n\t\t'float C = 0.10;',\n\t\t'float D = 0.20;',\n\t\t'float E = 0.02;',\n\t\t'float F = 0.30;',\n\t\t'float W = 1000.0;',\n\n\t\t'vec3 Uncharted2Tonemap(vec3 x)',\n\t\t'{',\n\t\t   'return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;',\n\t\t'}',\n\n\n\t\t'void main() ',\n\t\t'{',\n\t\t\t'float sunfade = 1.0-clamp(1.0-exp((sunPosition.y/450000.0)),0.0,1.0);',\n\n\t\t\t'// luminance =  1.0 ;// vWorldPosition.y / 450000. + 0.5; //sunPosition.y / 450000. * 1. + 0.5;',\n\n\t\t\t '// gl_FragColor = vec4(sunfade, sunfade, sunfade, 1.0);',\n\n\t\t\t'float reileighCoefficient = reileigh - (1.0* (1.0-sunfade));',\n\n\t\t\t'vec3 sunDirection = normalize(sunPosition);',\n\n\t\t\t'float sunE = sunIntensity(dot(sunDirection, up));',\n\n\t\t\t'// extinction (absorbtion + out scattering) ',\n\t\t\t'// rayleigh coefficients',\n\n\t\t\t// 'vec3 betaR = totalRayleigh(lambda) * reileighCoefficient;',\n\t\t\t'vec3 betaR = simplifiedRayleigh() * reileighCoefficient;',\n\n\t\t\t'// mie coefficients',\n\t\t\t'vec3 betaM = totalMie(lambda, K, turbidity) * mieCoefficient;',\n\n\t\t\t'// optical length',\n\t\t\t'// cutoff angle at 90 to avoid singularity in next formula.',\n\t\t\t'float zenithAngle = acos(max(0.0, dot(up, normalize(vWorldPosition - cameraPos))));',\n\t\t\t'float sR = rayleighZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));',\n\t\t\t'float sM = mieZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));',\n\n\n\n\t\t\t'// combined extinction factor\t',\n\t\t\t'vec3 Fex = exp(-(betaR * sR + betaM * sM));',\n\n\t\t\t'// in scattering',\n\t\t\t'float cosTheta = dot(normalize(vWorldPosition - cameraPos), sunDirection);',\n\n\t\t\t'float rPhase = rayleighPhase(cosTheta*0.5+0.5);',\n\t\t\t'vec3 betaRTheta = betaR * rPhase;',\n\n\t\t\t'float mPhase = hgPhase(cosTheta, mieDirectionalG);',\n\t\t\t'vec3 betaMTheta = betaM * mPhase;',\n\n\n\t\t\t'vec3 Lin = pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * (1.0 - Fex),vec3(1.5));',\n\t\t\t'Lin *= mix(vec3(1.0),pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * Fex,vec3(1.0/2.0)),clamp(pow(1.0-dot(up, sunDirection),5.0),0.0,1.0));',\n\n\t\t\t'//nightsky',\n\t\t\t'vec3 direction = normalize(vWorldPosition - cameraPos);',\n\t\t\t'float theta = acos(direction.y); // elevation --> y-axis, [-pi/2, pi/2]',\n\t\t\t'float phi = atan(direction.z, direction.x); // azimuth --> x-axis [-pi/2, pi/2]',\n\t\t\t'vec2 uv = vec2(phi, theta) / vec2(2.0*pi, pi) + vec2(0.5, 0.0);',\n\t\t\t'// vec3 L0 = texture2D(skySampler, uv).rgb+0.1 * Fex;',\n\t\t\t'vec3 L0 = vec3(0.1) * Fex;',\n\n\t\t\t'// composition + solar disc',\n\t\t\t'//if (cosTheta > sunAngularDiameterCos)',\n\t\t\t'float sundisk = smoothstep(sunAngularDiameterCos,sunAngularDiameterCos+0.00002,cosTheta);',\n\t\t\t'// if (normalize(vWorldPosition - cameraPos).y>0.0)',\n\t\t\t'L0 += (sunE * 19000.0 * Fex)*sundisk;',\n\n\n\t\t\t'vec3 whiteScale = 1.0/Uncharted2Tonemap(vec3(W));',\n\n\t\t\t'vec3 texColor = (Lin+L0);   ',\n\t\t\t'texColor *= 0.04 ;',\n\t\t\t'texColor += vec3(0.0,0.001,0.0025)*0.3;',\n\n\t\t\t'float g_fMaxLuminance = 1.0;',\n\t\t\t'float fLumScaled = 0.1 / luminance;     ',\n\t\t\t'float fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (g_fMaxLuminance * g_fMaxLuminance)))) / (1.0 + fLumScaled); ',\n\n\t\t\t'float ExposureBias = fLumCompressed;',\n\n\t\t\t'vec3 curr = Uncharted2Tonemap((log2(2.0/pow(luminance,4.0)))*texColor);',\n\t\t\t'vec3 color = curr*whiteScale;',\n\n\t\t\t'vec3 retColor = pow(color,vec3(1.0/(1.2+(1.2*sunfade))));',\n\n\n\t\t\t'gl_FragColor.rgb = retColor;',\n\n\t\t\t'gl_FragColor.a = 1.0;',\n\t\t'}',\n\n\t].join( '\\n' )\n\n};\n\nvar Sky = function () {\n\n\tvar skyShader = THREE.ShaderLib[ 'sky' ];\n\tvar skyUniforms = THREE.UniformsUtils.clone( skyShader.uniforms );\n\n\tvar skyMat = new THREE.ShaderMaterial( {\n\t\tfragmentShader: skyShader.fragmentShader,\n\t\tvertexShader: skyShader.vertexShader,\n\t\tuniforms: skyUniforms,\n\t\tside: THREE.BackSide\n\t} );\n\n\tvar skyGeo = new THREE.SphereBufferGeometry( 450000, 32, 15 );\n\tvar skyMesh = new THREE.Mesh( skyGeo, skyMat );\n\n\n\t// Expose variables\n\tthis.mesh = skyMesh;\n\tthis.uniforms = skyUniforms;\n\n};\n\nexport default Sky;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/environment/Sky.js\n **/","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = throttle;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lodash.throttle/index.js\n ** module id = 33\n ** module chunks = 0\n **/","import Orbit, {orbit} from './Controls.Orbit';\n\nconst Controls = {\n  Orbit: Orbit,\n  orbit, orbit\n};\n\nexport default Controls;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/controls/index.js\n **/","import EventEmitter from 'eventemitter3';\nimport THREE from 'three';\nimport OrbitControls from '../vendor/OrbitControls';\nimport TweenLite from 'TweenLite';\n\n// Prevent animation from pausing when tab is inactive\nTweenLite.lagSmoothing(0);\n\nclass Orbit extends EventEmitter {\n  constructor() {\n    super();\n  }\n\n  // Proxy control events\n  //\n  // There's currently no distinction between pan, orbit and zoom events\n  _initEvents() {\n    this._controls.addEventListener('start', (event) => {\n      this._world.emit('controlsMoveStart', event.target.target);\n    });\n\n    this._controls.addEventListener('change', (event) => {\n      this._world.emit('controlsMove', event.target.target);\n    });\n\n    this._controls.addEventListener('end', (event) => {\n      this._world.emit('controlsMoveEnd', event.target.target);\n    });\n  }\n\n  // Moving the camera along the [x,y,z] axis based on a target position\n  panTo(point, animate) {}\n  panBy(pointDelta, animate) {}\n\n  // Zooming the camera in and out\n  zoomTo(metres, animate) {}\n  zoomBy(metresDelta, animate) {}\n\n  // Force camera to look at something other than the target\n  lookAt(point, animate) {}\n\n  // Make camera look at the target\n  lookAtTarget() {}\n\n  // Tilt (up and down)\n  tiltTo(angle, animate) {}\n  tiltBy(angleDelta, animate) {}\n\n  // Rotate (left and right)\n  rotateTo(angle, animate) {}\n  rotateBy(angleDelta, animate) {}\n\n  // Fly to the given point, animating pan and tilt/rotation to final position\n  // with nice zoom out and in\n  //\n  // TODO: Calling flyTo a second time before the previous animation has\n  // completed should immediately start the new animation from wherever the\n  // previous one has got to\n  //\n  // TODO: Long-distance pans should prevent the quadtree grid from trying to\n  // update by not firing the control update events every frame until the\n  // pan velocity calms down a bit\n  //\n  // TODO: Long-distance plans should zoom out further\n  flyToPoint(point, duration, zoom) {\n    // Animation time in seconds\n    var animationTime = duration || 2;\n\n    var self = this;\n\n    this._flyTarget = new THREE.Vector3(point.x, 0, point.y);\n\n    // Calculate delta from current position to fly target\n    var diff = new THREE.Vector3().subVectors(this._controls.target, this._flyTarget);\n\n    this._flyTween = new TweenLite(\n      {\n        x: 0,\n        z: 0,\n        // zoom: 0,\n        prev: {\n          x: 0,\n          z: 0\n        }\n      },\n      animationTime,\n      {\n        x: diff.x,\n        z: diff.z,\n        // zoom: 1,\n        onUpdate: function(tween) {\n          var controls = this._controls;\n\n          // Work out difference since last frame\n          var deltaX = tween.target.x - tween.target.prev.x;\n          var deltaZ = tween.target.z - tween.target.prev.z;\n\n          // Move some fraction toward the target point\n          controls.panLeft(deltaX, controls.object.matrix);\n          controls.panUp(deltaZ, controls.object.matrix);\n\n          tween.target.prev.x = tween.target.x;\n          tween.target.prev.z = tween.target.z;\n\n          // console.log(Math.sin((tween.target.zoom - 0.5) * Math.PI));\n\n          // TODO: Get zoom to dolly in and out on pan\n          // controls.object.zoom -= Math.sin((tween.target.zoom - 0.5) * Math.PI);\n          // controls.object.updateProjectionMatrix();\n        },\n        onComplete: function(tween) {\n          // console.log(`Arrived at flyTarget`);\n          self._flyTarget = null;\n        },\n        onUpdateParams: ['{self}'],\n        onCompleteParams: ['{self}'],\n        callbackScope: this,\n        ease: Power1.easeInOut\n      }\n    );\n\n    if (!zoom) {\n      return;\n    }\n\n    var zoomTime = animationTime / 2;\n\n    this._zoomTweenIn = new TweenLite(\n      {\n        zoom: 0\n      },\n      zoomTime,\n      {\n        zoom: 1,\n        onUpdate: function(tween) {\n          var controls = this._controls;\n          controls.dollyIn(1 - 0.01 * tween.target.zoom);\n        },\n        onComplete: function(tween) {},\n        onUpdateParams: ['{self}'],\n        onCompleteParams: ['{self}'],\n        callbackScope: this,\n        ease: Power1.easeInOut\n      }\n    );\n\n    this._zoomTweenOut = new TweenLite(\n      {\n        zoom: 0\n      },\n      zoomTime,\n      {\n        zoom: 1,\n        delay: zoomTime,\n        onUpdate: function(tween) {\n          var controls = this._controls;\n          controls.dollyOut(0.99 + 0.01 * tween.target.zoom);\n        },\n        onComplete: function(tween) {},\n        onUpdateParams: ['{self}'],\n        onCompleteParams: ['{self}'],\n        callbackScope: this,\n        ease: Power1.easeInOut\n      }\n    );\n  }\n\n  flyToLatLon(latlon, duration, noZoom) {\n    var point = this._world.latLonToPoint(latlon);\n    this.flyToPoint(point, duration, noZoom);\n  }\n\n  // TODO: Make this animate over a user-defined period of time\n  //\n  // Perhaps use TweenMax for now and implement as a more lightweight solution\n  // later on once it all works\n  // _animateFlyTo(delta) {\n  //   var controls = this._controls;\n  //\n  //   // this._controls.panLeft(50, controls._controls.object.matrix);\n  //   // this._controls.panUp(50, controls._controls.object.matrix);\n  //   // this._controls.dollyIn(this._controls.getZoomScale());\n  //   // this._controls.dollyOut(this._controls.getZoomScale());\n  //\n  //   // Calculate delta from current position to fly target\n  //   var diff = new THREE.Vector3().subVectors(this._controls.target, this._flyTarget);\n  //\n  //   // 1000 units per second\n  //   var speed = 1000 * (delta / 1000);\n  //\n  //   // Remove fly target after arrival and snap to target\n  //   if (diff.length() < 0.01) {\n  //     console.log(`Arrived at flyTarget`);\n  //     this._flyTarget = null;\n  //     speed = 1;\n  //   }\n  //\n  //   // Move some fraction toward the target point\n  //   controls.panLeft(diff.x * speed, controls.object.matrix);\n  //   controls.panUp(diff.z * speed, controls.object.matrix);\n  // }\n\n  // Proxy to OrbitControls.update()\n  update(delta) {\n    this._controls.update(delta);\n  }\n\n  // Add controls to world instance and store world reference\n  addTo(world) {\n    world.addControls(this);\n    return this;\n  }\n\n  // Internal method called by World.addControls to actually add the controls\n  _addToWorld(world) {\n    this._world = world;\n\n    // TODO: Override panLeft and panUp methods to prevent panning on Y axis\n    // See: http://stackoverflow.com/a/26188674/997339\n    this._controls = new OrbitControls(world._engine._camera, world._container);\n\n    // Disable keys for now as no events are fired for them anyway\n    this._controls.keys = false;\n\n    // 89 degrees\n    this._controls.maxPolarAngle = 1.5533;\n\n    // this._controls.enableDamping = true;\n    // this._controls.dampingFactor = 0.25;\n\n    this._initEvents();\n\n    this.emit('added');\n  }\n\n  // Destroys the controls and removes them from memory\n  destroy() {\n    // TODO: Remove event listeners\n\n    this._controls.dispose();\n\n    this._world = null;\n    this._controls = null;\n  }\n}\n\nexport default Orbit;\n\nvar noNew = function() {\n  return new Orbit();\n};\n\n// Initialise without requiring new keyword\nexport {noNew as orbit};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/controls/Controls.Orbit.js\n **/","// jscs:disable\n/* eslint-disable */\n\nimport THREE from 'three';\nimport Hammer from 'hammerjs';\n\n/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n */\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one finger move\n//    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n//    Pan - right mouse, or arrow keys / touch: three finter swipe\n\nvar OrbitControls = function ( object, domElement ) {\n\n\tthis.object = object;\n\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\n\n\t// Set to false to disable this control\n\tthis.enabled = true;\n\n\t// \"target\" sets the location of focus, where the object orbits around\n\tthis.target = new THREE.Vector3();\n\n\t// How far you can dolly in and out ( PerspectiveCamera only )\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\t// How far you can zoom in and out ( OrthographicCamera only )\n\tthis.minZoom = 0;\n\tthis.maxZoom = Infinity;\n\n\t// How far you can orbit vertically, upper and lower limits.\n\t// Range is 0 to Math.PI radians.\n\tthis.minPolarAngle = 0; // radians\n\tthis.maxPolarAngle = Math.PI; // radians\n\n\t// How far you can orbit horizontally, upper and lower limits.\n\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n\tthis.minAzimuthAngle = - Infinity; // radians\n\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t// Set to true to enable damping (inertia)\n\t// If damping is enabled, you must call controls.update() in your animation loop\n\tthis.enableDamping = false;\n\tthis.dampingFactor = 0.25;\n\n\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t// Set to false to disable zooming\n\tthis.enableZoom = true;\n\tthis.zoomSpeed = 1.0;\n\n\t// Set to false to disable rotating\n\tthis.enableRotate = true;\n\tthis.rotateSpeed = 1.0;\n\n\t// Set to false to disable panning\n\tthis.enablePan = true;\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t// Set to true to automatically rotate around the target\n\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\tthis.autoRotate = false;\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t// Set to false to disable use of the keys\n\tthis.enableKeys = true;\n\n\t// The four arrow keys\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t// Mouse buttons\n\tthis.mouseButtons = { ORBIT: THREE.MOUSE.LEFT, ZOOM: THREE.MOUSE.MIDDLE, PAN: THREE.MOUSE.RIGHT };\n\n\t// for reset\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\tthis.zoom0 = this.object.zoom;\n\n\t//\n\t// public methods\n\t//\n\n\tthis.getPolarAngle = function () {\n\n\t\treturn phi;\n\n\t};\n\n\tthis.getAzimuthalAngle = function () {\n\n\t\treturn theta;\n\n\t};\n\n\tthis.reset = function () {\n\n\t\tscope.target.copy( scope.target0 );\n\t\tscope.object.position.copy( scope.position0 );\n\t\tscope.object.zoom = scope.zoom0;\n\n\t\tscope.object.updateProjectionMatrix();\n\t\tscope.dispatchEvent( changeEvent );\n\n\t\tscope.update();\n\n\t\tstate = STATE.NONE;\n\n\t};\n\n\t// this method is exposed, but perhaps it would be better if we can make it private...\n\tthis.update = function() {\n\n\t\tvar offset = new THREE.Vector3();\n\n\t\t// so camera.up is the orbit axis\n\t\tvar quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );\n\t\tvar quatInverse = quat.clone().inverse();\n\n\t\tvar lastPosition = new THREE.Vector3();\n\t\tvar lastQuaternion = new THREE.Quaternion();\n\n\t\treturn function () {\n\n\t\t\tvar position = scope.object.position;\n\n\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t// angle from z-axis around y-axis\n\n\t\t\ttheta = Math.atan2( offset.x, offset.z );\n\n\t\t\t// angle from y-axis\n\n\t\t\tphi = Math.atan2( Math.sqrt( offset.x * offset.x + offset.z * offset.z ), offset.y );\n\n\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t}\n\n\t\t\ttheta += thetaDelta;\n\t\t\tphi += phiDelta;\n\n\t\t\t// restrict theta to be between desired limits\n\t\t\ttheta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, theta ) );\n\n\t\t\t// restrict phi to be between desired limits\n\t\t\tphi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, phi ) );\n\n\t\t\t// restrict phi to be betwee EPS and PI-EPS\n\t\t\tphi = Math.max( EPS, Math.min( Math.PI - EPS, phi ) );\n\n\t\t\tvar radius = offset.length() * scale;\n\n\t\t\t// restrict radius to be between desired limits\n\t\t\tradius = Math.max( scope.minDistance, Math.min( scope.maxDistance, radius ) );\n\n\t\t\t// move target to panned location\n\t\t\tscope.target.add( panOffset );\n\n\t\t\toffset.x = radius * Math.sin( phi ) * Math.sin( theta );\n\t\t\toffset.y = radius * Math.cos( phi );\n\t\t\toffset.z = radius * Math.sin( phi ) * Math.cos( theta );\n\n\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tthetaDelta *= ( 1 - scope.dampingFactor );\n\t\t\t\tphiDelta *= ( 1 - scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tthetaDelta = 0;\n\t\t\t\tphiDelta = 0;\n\n\t\t\t}\n\n\t\t\tscale = 1;\n\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t// update condition is:\n\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\tif ( zoomChanged ||\n\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\tzoomChanged = false;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t};\n\n\t}();\n\n\tthis.dispose = function() {\n\n\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );\n\t\tscope.domElement.removeEventListener( 'mousedown', onMouseDown, false );\n\t\tscope.domElement.removeEventListener( 'mousewheel', onMouseWheel, false );\n\t\tscope.domElement.removeEventListener( 'MozMousePixelScroll', onMouseWheel, false ); // firefox\n\n\t\tscope.domElement.removeEventListener( 'touchstart', onTouchStart, false );\n\t\tscope.domElement.removeEventListener( 'touchend', onTouchEnd, false );\n\t\tscope.domElement.removeEventListener( 'touchmove', onTouchMove, false );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\t\tdocument.removeEventListener( 'mouseout', onMouseUp, false );\n\n\t\twindow.removeEventListener( 'keydown', onKeyDown, false );\n\n\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t};\n\n\t//\n\t// internals\n\t//\n\n\tvar scope = this;\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start' };\n\tvar endEvent = { type: 'end' };\n\n\tvar STATE = { NONE : - 1, ROTATE : 0, DOLLY : 1, PAN : 2, TOUCH_ROTATE : 3, TOUCH_DOLLY : 4, TOUCH_PAN : 5 };\n\n\tvar state = STATE.NONE;\n\n\tvar EPS = 0.000001;\n\n\t// current position in spherical coordinates\n\tvar theta;\n\tvar phi;\n\n\tvar phiDelta = 0;\n\tvar thetaDelta = 0;\n\tvar scale = 1;\n\tvar panOffset = new THREE.Vector3();\n\tvar zoomChanged = false;\n\n\tvar rotateStart = new THREE.Vector2();\n\tvar rotateEnd = new THREE.Vector2();\n\tvar rotateDelta = new THREE.Vector2();\n\n\tvar panStart = new THREE.Vector2();\n\tvar panEnd = new THREE.Vector2();\n\tvar panDelta = new THREE.Vector2();\n\n\tvar dollyStart = new THREE.Vector2();\n\tvar dollyEnd = new THREE.Vector2();\n\tvar dollyDelta = new THREE.Vector2();\n\n\tfunction getAutoRotationAngle() {\n\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t}\n\n\tfunction getZoomScale() {\n\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t}\n\n\tfunction rotateLeft( angle ) {\n\n\t\tthetaDelta -= angle;\n\n\t}\n\n\tfunction rotateUp( angle ) {\n\n\t\tphiDelta -= angle;\n\n\t}\n\n\tvar panLeft = function() {\n\n\t\tvar v = new THREE.Vector3();\n\n\t\t// return function panLeft( distance, objectMatrix ) {\n    //\n\t\t// \tvar te = objectMatrix.elements;\n    //\n\t\t// \t// get X column of objectMatrix\n\t\t// \tv.set( te[ 0 ], te[ 1 ], te[ 2 ] );\n    //\n\t\t// \tv.multiplyScalar( - distance );\n    //\n\t\t// \tpanOffset.add( v );\n    //\n\t\t// };\n\n    // Fixed panning to x/y plane\n    return function panLeft(distance, objectMatrix) {\n\t    var te = objectMatrix.elements;\n\t    // var adjDist = distance / Math.cos(phi);\n\n\t    v.set(te[ 0 ], 0, te[ 2 ]);\n\t    v.multiplyScalar(-distance);\n\n\t    panOffset.add(v);\n\t  };\n\n\t}();\n\n  // Fixed panning to x/y plane\n\tvar panUp = function() {\n\n\t\tvar v = new THREE.Vector3();\n\n\t\t// return function panUp( distance, objectMatrix ) {\n    //\n\t\t// \tvar te = objectMatrix.elements;\n    //\n\t\t// \t// get Y column of objectMatrix\n\t\t// \tv.set( te[ 4 ], te[ 5 ], te[ 6 ] );\n    //\n\t\t// \tv.multiplyScalar( distance );\n    //\n\t\t// \tpanOffset.add( v );\n    //\n\t\t// };\n\n    return function panUp(distance, objectMatrix) {\n\t    var te = objectMatrix.elements;\n\t    var adjDist = distance / Math.cos(phi);\n\n\t    v.set(te[ 4 ], 0, te[ 6 ]);\n\t    v.multiplyScalar(adjDist);\n\n\t    panOffset.add(v);\n\t  };\n\n\t}();\n\n\t// deltaX and deltaY are in pixels; right and down are positive\n\tvar pan = function() {\n\n\t\tvar offset = new THREE.Vector3();\n\n\t\treturn function( deltaX, deltaY ) {\n\n\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\t\tif ( scope.object instanceof THREE.PerspectiveCamera ) {\n\n\t\t\t\t// perspective\n\t\t\t\tvar position = scope.object.position;\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\tvar targetDistance = offset.length();\n\n\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t// we actually don't use screenWidth, since perspective camera is fixed to screen height\n\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else if ( scope.object instanceof THREE.OrthographicCamera ) {\n\n\t\t\t\t// orthographic\n\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / element.clientWidth, scope.object.matrix );\n\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else {\n\n\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\tscope.enablePan = false;\n\n\t\t\t}\n\n\t\t};\n\n\t}();\n\n\tfunction dollyIn( dollyScale ) {\n\n\t\tif ( scope.object instanceof THREE.PerspectiveCamera ) {\n\n\t\t\tscale /= dollyScale;\n\n\t\t} else if ( scope.object instanceof THREE.OrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\tfunction dollyOut( dollyScale ) {\n\n\t\tif ( scope.object instanceof THREE.PerspectiveCamera ) {\n\n\t\t\tscale *= dollyScale;\n\n\t\t} else if ( scope.object instanceof THREE.OrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t//\n\t// event callbacks - update the object state\n\t//\n\n\tfunction handleMouseDownRotate( event ) {\n\n\t\t//console.log( 'handleMouseDownRotate' );\n\n\t\trotateStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownDolly( event ) {\n\n\t\t//console.log( 'handleMouseDownDolly' );\n\n\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownPan( event ) {\n\n\t\t//console.log( 'handleMouseDownPan' );\n\n\t\tpanStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseMoveRotate( event ) {\n\n\t\t//console.log( 'handleMouseMoveRotate' );\n\n\t\trotateEnd.set( event.clientX, event.clientY );\n\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\t// rotating across whole screen goes 360 degrees around\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\n\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMoveDolly( event ) {\n\n\t\t//console.log( 'handleMouseMoveDolly' );\n\n\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t}\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMovePan( event ) {\n\n\t\t//console.log( 'handleMouseMovePan' );\n\n\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\tpanDelta.subVectors( panEnd, panStart );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseUp( event ) {\n\n\t\t//console.log( 'handleMouseUp' );\n\n\t}\n\n\tfunction handleMouseWheel( event ) {\n\n\t\t//console.log( 'handleMouseWheel' );\n\n\t\tvar delta = 0;\n\n\t\tif ( event.wheelDelta !== undefined ) {\n\n\t\t\t// WebKit / Opera / Explorer 9\n\n\t\t\tdelta = event.wheelDelta;\n\n\t\t} else if ( event.detail !== undefined ) {\n\n\t\t\t// Firefox\n\n\t\t\tdelta = - event.detail;\n\n\t\t}\n\n\t\tif ( delta > 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t} else if ( delta < 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t}\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleKeyDown( event ) {\n\n\t\t//console.log( 'handleKeyDown' );\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase scope.keys.UP:\n\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.LEFT:\n\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.RIGHT:\n\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartRotate( event ) {\n\n\t\t//console.log( 'handleTouchStartRotate' );\n\n\t\trotateStart.set( event.pointers[ 0 ].pageX, event.pointers[ 0 ].pageY );\n\n\t}\n\n\tfunction handleTouchStartDolly( event ) {\n\n\t\t//console.log( 'handleTouchStartDolly' );\n\n\t\tvar dx = event.pointers[ 0 ].pageX - event.pointers[ 1 ].pageX;\n\t\tvar dy = event.pointers[ 0 ].pageY - event.pointers[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyStart.set( 0, distance );\n\n\t}\n\n\tfunction handleTouchStartPan( event ) {\n\n\t\t//console.log( 'handleTouchStartPan' );\n\n\t\tpanStart.set( event.deltaX, event.deltaY );\n\n\t}\n\n\tfunction handleTouchMoveRotate( event ) {\n\n\t\t//console.log( 'handleTouchMoveRotate' );\n\n\t\trotateEnd.set( event.pointers[ 0 ].pageX, event.pointers[ 0 ].pageY );\n\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\t// rotating across whole screen goes 360 degrees around\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\n\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleTouchMoveDolly( event ) {\n\n\t\t//console.log( 'handleTouchMoveDolly' );\n\n\t\tvar dx = event.pointers[ 0 ].pageX - event.pointers[ 1 ].pageX;\n\t\tvar dy = event.pointers[ 0 ].pageY - event.pointers[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyEnd.set( 0, distance );\n\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t}\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleTouchMovePan( event ) {\n\n\t\t//console.log( 'handleTouchMovePan' );\n\n\t\tpanEnd.set( event.deltaX, event.deltaY );\n\n\t\tpanDelta.subVectors( panEnd, panStart );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleTouchEnd( event ) {\n\n\t\t//console.log( 'handleTouchEnd' );\n\n\t}\n\n\t//\n\t// event handlers - FSM: listen for events and reset state\n\t//\n\n\tfunction onMouseDown( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tif ( event.button === scope.mouseButtons.ORBIT ) {\n\n\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\thandleMouseDownRotate( event );\n\n\t\t\tstate = STATE.ROTATE;\n\n\t\t} else if ( event.button === scope.mouseButtons.ZOOM ) {\n\n\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\thandleMouseDownDolly( event );\n\n\t\t\tstate = STATE.DOLLY;\n\n\t\t} else if ( event.button === scope.mouseButtons.PAN ) {\n\n\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\thandleMouseDownPan( event );\n\n\t\t\tstate = STATE.PAN;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\n\t\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\n\t\t\tdocument.addEventListener( 'mouseout', onMouseUp, false );\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tif ( state === STATE.ROTATE ) {\n\n\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\thandleMouseMoveRotate( event );\n\n\t\t} else if ( state === STATE.DOLLY ) {\n\n\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\thandleMouseMoveDolly( event );\n\n\t\t} else if ( state === STATE.PAN ) {\n\n\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\thandleMouseMovePan( event );\n\n\t\t}\n\n\t}\n\n\tfunction onMouseUp( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleMouseUp( event );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\t\tdocument.removeEventListener( 'mouseout', onMouseUp, false );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onMouseWheel( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\thandleMouseWheel( event );\n\n\t\tscope.dispatchEvent( startEvent ); // not sure why these are here...\n\t\tscope.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction onKeyDown( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;\n\n\t\thandleKeyDown( event );\n\n\t}\n\n\tfunction onTouchStart( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\t// one-fingered touch: rotate\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchStartRotate( event );\n\n\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\t// two-fingered touch: dolly\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleTouchStartDolly( event );\n\n\t\t\t\tstate = STATE.TOUCH_DOLLY;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 3: // three-fingered touch: pan\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchStartPan( event );\n\n\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onTouchMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1: // one-fingered touch: rotate\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_ROTATE ) return; // is this needed?...\n\n\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2: // two-fingered touch: dolly\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_DOLLY ) return; // is this needed?...\n\n\t\t\t\thandleTouchMoveDolly( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 3: // three-fingered touch: pan\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_PAN ) return; // is this needed?...\n\n\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t}\n\n\tfunction onTouchEnd( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleTouchEnd( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onContextMenu( event ) {\n\n\t\tevent.preventDefault();\n\n\t}\n\n\t//\n\n\tscope.domElement.addEventListener( 'contextmenu', onContextMenu, false );\n\n\tscope.domElement.addEventListener( 'mousedown', onMouseDown, false );\n\tscope.domElement.addEventListener( 'mousewheel', onMouseWheel, false );\n\tscope.domElement.addEventListener( 'MozMousePixelScroll', onMouseWheel, false ); // firefox\n\n\t// scope.domElement.addEventListener( 'touchstart', onTouchStart, false );\n\t// scope.domElement.addEventListener( 'touchend', onTouchEnd, false );\n\t// scope.domElement.addEventListener( 'touchmove', onTouchMove, false );\n\n\tscope.hammer = new Hammer(scope.domElement);\n\n\tscope.hammer.get('pan').set({\n\t\tpointers: 0,\n\t\tdirection: Hammer.DIRECTION_ALL\n\t});\n\n\tscope.hammer.get('pinch').set({\n\t\tenable: true,\n\t\tthreshold: 0.1\n\t});\n\n\tscope.hammer.on('panstart', function(event) {\n\t\tif (scope.enabled === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.pointerType === 'mouse') {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.pointers.length === 1) {\n\t\t\tif (scope.enablePan === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\thandleTouchStartPan(event);\n\t\t\t// panStart.set(event.deltaX, event.deltaY);\n\n\t\t\tstate = STATE.TOUCH_PAN;\n\t\t} else if (event.pointers.length === 2) {\n\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\thandleTouchStartRotate( event );\n\n\t\t\tstate = STATE.TOUCH_ROTATE;\n\t\t}\n\n\t\tif (state !== STATE.NONE) {\n\t\t\tscope.dispatchEvent(startEvent);\n\t\t}\n\t});\n\n\tscope.hammer.on('panend', function(event) {\n\t\tif (event.pointerType === 'mouse') {\n\t\t\treturn;\n\t\t}\n\n\t\tonTouchEnd(event);\n\t});\n\n\tscope.hammer.on('panmove', function(event) {\n\t\tif ( scope.enabled === false ) return;\n\n\t\tif (event.pointerType === 'mouse') {\n\t\t\treturn;\n\t\t}\n\n\t\t// event.preventDefault();\n\t\t// event.stopPropagation();\n\n\t\tif (event.pointers.length === 1) {\n\t\t\tif ( scope.enablePan === false ) return;\n\t\t\tif ( state !== STATE.TOUCH_PAN ) return; // is this needed?...\n\n\t\t\thandleTouchMovePan( event );\n\n\t\t\t// panEnd.set( event.deltaX, event.deltaY );\n\t\t\t//\n\t\t\t// panDelta.subVectors( panEnd, panStart );\n\t\t\t//\n\t\t\t// pan( panDelta.x, panDelta.y );\n\t\t\t//\n\t\t\t// panStart.copy( panEnd );\n\t\t\t//\n\t\t\t// scope.update();\n\t\t} else if (event.pointers.length === 2) {\n\t\t\tif ( scope.enableRotate === false ) return;\n\t\t\tif ( state !== STATE.TOUCH_ROTATE ) return; // is this needed?...\n\n\t\t\thandleTouchMoveRotate( event );\n\t\t}\n\t});\n\n\tscope.hammer.on('pinchstart', function(event) {\n\t\tif ( scope.enabled === false ) return;\n\n\t\tif (event.pointerType === 'mouse') {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( scope.enableZoom === false ) return;\n\n\t\thandleTouchStartDolly( event );\n\n\t\t// var dx = event.pointers[ 0 ].pageX - event.pointers[ 1 ].pageX;\n\t\t// var dy = event.pointers[ 0 ].pageY - event.pointers[ 1 ].pageY;\n\t\t//\n\t\t// var distance = Math.sqrt( dx * dx + dy * dy );\n\t\t//\n\t\t// dollyStart.set( 0, distance );\n\t\t//\n\t\tstate = STATE.TOUCH_DOLLY;\n\n\t\tif (state !== STATE.NONE) {\n\t\t\tscope.dispatchEvent(startEvent);\n\t\t}\n\t});\n\n\tscope.hammer.on('pinchend', function(event) {\n\t\tif (event.pointerType === 'mouse') {\n\t\t\treturn;\n\t\t}\n\n\t\tonTouchEnd(event);\n\t});\n\n\tscope.hammer.on('pinchmove', function(event) {\n\t\tif ( scope.enabled === false ) return;\n\n\t\tif (event.pointerType === 'mouse') {\n\t\t\treturn;\n\t\t}\n\n\t\t// event.preventDefault();\n\t\t// event.stopPropagation();\n\n\t\tif ( scope.enableZoom === false ) return;\n\t\tif ( state !== STATE.TOUCH_DOLLY ) return; // is this needed?...\n\n\t\thandleTouchMoveDolly( event );\n\n\t\t// var dx = event.pointers[ 0 ].pageX - event.pointers[ 1 ].pageX;\n\t\t// var dy = event.pointers[ 0 ].pageY - event.pointers[ 1 ].pageY;\n\t\t//\n\t\t// var distance = Math.sqrt( dx * dx + dy * dy );\n\t\t//\n\t\t// dollyEnd.set( 0, distance );\n\t\t//\n\t\t// dollyDelta.subVectors( dollyEnd, dollyStart );\n\t\t//\n\t\t// if ( dollyDelta.y > 0 ) {\n\t\t//\n\t\t// \tdollyOut( getZoomScale() );\n\t\t//\n\t\t// } else if ( dollyDelta.y < 0 ) {\n\t\t//\n\t\t// \tdollyIn( getZoomScale() );\n\t\t//\n\t\t// }\n\t\t//\n\t\t// dollyStart.copy( dollyEnd );\n\t\t//\n\t\t// scope.update();\n\t});\n\n\twindow.addEventListener( 'keydown', onKeyDown, false );\n\n\t// Expose controls methods for programmatic control\n\tthis.panLeft = panLeft;\n\tthis.panUp = panUp;\n\tthis.pan = pan;\n\tthis.dollyIn = dollyIn;\n\tthis.dollyOut = dollyOut;\n\tthis.getZoomScale = getZoomScale;\n\tthis.rotateLeft = rotateLeft;\n\tthis.rotateUp = rotateUp;\n\n\t// force an update at start\n\n\tthis.update();\n\n};\n\nOrbitControls.prototype = Object.create( THREE.EventDispatcher.prototype );\nOrbitControls.prototype.constructor = THREE.OrbitControls;\n\nObject.defineProperties( OrbitControls.prototype, {\n\n\tcenter: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .center has been renamed to .target' );\n\t\t\treturn this.target;\n\n\t\t}\n\n\t},\n\n\t// backward compatibility\n\n\tnoZoom: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n\t\t\treturn ! this.enableZoom;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\n\t\t\tthis.enableZoom = ! value;\n\n\t\t}\n\n\t},\n\n\tnoRotate: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n\t\t\treturn ! this.enableRotate;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\n\t\t\tthis.enableRotate = ! value;\n\n\t\t}\n\n\t},\n\n\tnoPan: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\n\t\t\treturn ! this.enablePan;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\n\t\t\tthis.enablePan = ! value;\n\n\t\t}\n\n\t},\n\n\tnoKeys: {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n\t\t\treturn ! this.enableKeys;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\n\t\t\tthis.enableKeys = ! value;\n\n\t\t}\n\n\t},\n\n\tstaticMoving : {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n\t\t\treturn ! this.constraint.enableDamping;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\n\t\t\tthis.constraint.enableDamping = ! value;\n\n\t\t}\n\n\t},\n\n\tdynamicDampingFactor : {\n\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n\t\t\treturn this.constraint.dampingFactor;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\n\t\t\tthis.constraint.dampingFactor = value;\n\n\t\t}\n\n\t}\n\n} );\n\nexport default OrbitControls;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/OrbitControls.js\n **/","/*! Hammer.JS - v2.0.7 - 2016-04-22\n * http://hammerjs.github.io/\n *\n * Copyright (c) 2016 Jorik Tangelder;\n * Licensed under the MIT license */\n(function(window, document, exportName, undefined) {\n  'use strict';\n\nvar VENDOR_PREFIXES = ['', 'webkit', 'Moz', 'MS', 'ms', 'o'];\nvar TEST_ELEMENT = document.createElement('div');\n\nvar TYPE_FUNCTION = 'function';\n\nvar round = Math.round;\nvar abs = Math.abs;\nvar now = Date.now;\n\n/**\n * set a timeout with a given scope\n * @param {Function} fn\n * @param {Number} timeout\n * @param {Object} context\n * @returns {number}\n */\nfunction setTimeoutContext(fn, timeout, context) {\n    return setTimeout(bindFn(fn, context), timeout);\n}\n\n/**\n * if the argument is an array, we want to execute the fn on each entry\n * if it aint an array we don't want to do a thing.\n * this is used by all the methods that accept a single and array argument.\n * @param {*|Array} arg\n * @param {String} fn\n * @param {Object} [context]\n * @returns {Boolean}\n */\nfunction invokeArrayArg(arg, fn, context) {\n    if (Array.isArray(arg)) {\n        each(arg, context[fn], context);\n        return true;\n    }\n    return false;\n}\n\n/**\n * walk objects and arrays\n * @param {Object} obj\n * @param {Function} iterator\n * @param {Object} context\n */\nfunction each(obj, iterator, context) {\n    var i;\n\n    if (!obj) {\n        return;\n    }\n\n    if (obj.forEach) {\n        obj.forEach(iterator, context);\n    } else if (obj.length !== undefined) {\n        i = 0;\n        while (i < obj.length) {\n            iterator.call(context, obj[i], i, obj);\n            i++;\n        }\n    } else {\n        for (i in obj) {\n            obj.hasOwnProperty(i) && iterator.call(context, obj[i], i, obj);\n        }\n    }\n}\n\n/**\n * wrap a method with a deprecation warning and stack trace\n * @param {Function} method\n * @param {String} name\n * @param {String} message\n * @returns {Function} A new function wrapping the supplied method.\n */\nfunction deprecate(method, name, message) {\n    var deprecationMessage = 'DEPRECATED METHOD: ' + name + '\\n' + message + ' AT \\n';\n    return function() {\n        var e = new Error('get-stack-trace');\n        var stack = e && e.stack ? e.stack.replace(/^[^\\(]+?[\\n$]/gm, '')\n            .replace(/^\\s+at\\s+/gm, '')\n            .replace(/^Object.<anonymous>\\s*\\(/gm, '{anonymous}()@') : 'Unknown Stack Trace';\n\n        var log = window.console && (window.console.warn || window.console.log);\n        if (log) {\n            log.call(window.console, deprecationMessage, stack);\n        }\n        return method.apply(this, arguments);\n    };\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} target\n * @param {...Object} objects_to_assign\n * @returns {Object} target\n */\nvar assign;\nif (typeof Object.assign !== 'function') {\n    assign = function assign(target) {\n        if (target === undefined || target === null) {\n            throw new TypeError('Cannot convert undefined or null to object');\n        }\n\n        var output = Object(target);\n        for (var index = 1; index < arguments.length; index++) {\n            var source = arguments[index];\n            if (source !== undefined && source !== null) {\n                for (var nextKey in source) {\n                    if (source.hasOwnProperty(nextKey)) {\n                        output[nextKey] = source[nextKey];\n                    }\n                }\n            }\n        }\n        return output;\n    };\n} else {\n    assign = Object.assign;\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} dest\n * @param {Object} src\n * @param {Boolean} [merge=false]\n * @returns {Object} dest\n */\nvar extend = deprecate(function extend(dest, src, merge) {\n    var keys = Object.keys(src);\n    var i = 0;\n    while (i < keys.length) {\n        if (!merge || (merge && dest[keys[i]] === undefined)) {\n            dest[keys[i]] = src[keys[i]];\n        }\n        i++;\n    }\n    return dest;\n}, 'extend', 'Use `assign`.');\n\n/**\n * merge the values from src in the dest.\n * means that properties that exist in dest will not be overwritten by src\n * @param {Object} dest\n * @param {Object} src\n * @returns {Object} dest\n */\nvar merge = deprecate(function merge(dest, src) {\n    return extend(dest, src, true);\n}, 'merge', 'Use `assign`.');\n\n/**\n * simple class inheritance\n * @param {Function} child\n * @param {Function} base\n * @param {Object} [properties]\n */\nfunction inherit(child, base, properties) {\n    var baseP = base.prototype,\n        childP;\n\n    childP = child.prototype = Object.create(baseP);\n    childP.constructor = child;\n    childP._super = baseP;\n\n    if (properties) {\n        assign(childP, properties);\n    }\n}\n\n/**\n * simple function bind\n * @param {Function} fn\n * @param {Object} context\n * @returns {Function}\n */\nfunction bindFn(fn, context) {\n    return function boundFn() {\n        return fn.apply(context, arguments);\n    };\n}\n\n/**\n * let a boolean value also be a function that must return a boolean\n * this first item in args will be used as the context\n * @param {Boolean|Function} val\n * @param {Array} [args]\n * @returns {Boolean}\n */\nfunction boolOrFn(val, args) {\n    if (typeof val == TYPE_FUNCTION) {\n        return val.apply(args ? args[0] || undefined : undefined, args);\n    }\n    return val;\n}\n\n/**\n * use the val2 when val1 is undefined\n * @param {*} val1\n * @param {*} val2\n * @returns {*}\n */\nfunction ifUndefined(val1, val2) {\n    return (val1 === undefined) ? val2 : val1;\n}\n\n/**\n * addEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction addEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.addEventListener(type, handler, false);\n    });\n}\n\n/**\n * removeEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction removeEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.removeEventListener(type, handler, false);\n    });\n}\n\n/**\n * find if a node is in the given parent\n * @method hasParent\n * @param {HTMLElement} node\n * @param {HTMLElement} parent\n * @return {Boolean} found\n */\nfunction hasParent(node, parent) {\n    while (node) {\n        if (node == parent) {\n            return true;\n        }\n        node = node.parentNode;\n    }\n    return false;\n}\n\n/**\n * small indexOf wrapper\n * @param {String} str\n * @param {String} find\n * @returns {Boolean} found\n */\nfunction inStr(str, find) {\n    return str.indexOf(find) > -1;\n}\n\n/**\n * split string on whitespace\n * @param {String} str\n * @returns {Array} words\n */\nfunction splitStr(str) {\n    return str.trim().split(/\\s+/g);\n}\n\n/**\n * find if a array contains the object using indexOf or a simple polyFill\n * @param {Array} src\n * @param {String} find\n * @param {String} [findByKey]\n * @return {Boolean|Number} false when not found, or the index\n */\nfunction inArray(src, find, findByKey) {\n    if (src.indexOf && !findByKey) {\n        return src.indexOf(find);\n    } else {\n        var i = 0;\n        while (i < src.length) {\n            if ((findByKey && src[i][findByKey] == find) || (!findByKey && src[i] === find)) {\n                return i;\n            }\n            i++;\n        }\n        return -1;\n    }\n}\n\n/**\n * convert array-like objects to real arrays\n * @param {Object} obj\n * @returns {Array}\n */\nfunction toArray(obj) {\n    return Array.prototype.slice.call(obj, 0);\n}\n\n/**\n * unique array with objects based on a key (like 'id') or just by the array's value\n * @param {Array} src [{id:1},{id:2},{id:1}]\n * @param {String} [key]\n * @param {Boolean} [sort=False]\n * @returns {Array} [{id:1},{id:2}]\n */\nfunction uniqueArray(src, key, sort) {\n    var results = [];\n    var values = [];\n    var i = 0;\n\n    while (i < src.length) {\n        var val = key ? src[i][key] : src[i];\n        if (inArray(values, val) < 0) {\n            results.push(src[i]);\n        }\n        values[i] = val;\n        i++;\n    }\n\n    if (sort) {\n        if (!key) {\n            results = results.sort();\n        } else {\n            results = results.sort(function sortUniqueArray(a, b) {\n                return a[key] > b[key];\n            });\n        }\n    }\n\n    return results;\n}\n\n/**\n * get the prefixed property\n * @param {Object} obj\n * @param {String} property\n * @returns {String|Undefined} prefixed\n */\nfunction prefixed(obj, property) {\n    var prefix, prop;\n    var camelProp = property[0].toUpperCase() + property.slice(1);\n\n    var i = 0;\n    while (i < VENDOR_PREFIXES.length) {\n        prefix = VENDOR_PREFIXES[i];\n        prop = (prefix) ? prefix + camelProp : property;\n\n        if (prop in obj) {\n            return prop;\n        }\n        i++;\n    }\n    return undefined;\n}\n\n/**\n * get a unique id\n * @returns {number} uniqueId\n */\nvar _uniqueId = 1;\nfunction uniqueId() {\n    return _uniqueId++;\n}\n\n/**\n * get the window object of an element\n * @param {HTMLElement} element\n * @returns {DocumentView|Window}\n */\nfunction getWindowForElement(element) {\n    var doc = element.ownerDocument || element;\n    return (doc.defaultView || doc.parentWindow || window);\n}\n\nvar MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\n\nvar SUPPORT_TOUCH = ('ontouchstart' in window);\nvar SUPPORT_POINTER_EVENTS = prefixed(window, 'PointerEvent') !== undefined;\nvar SUPPORT_ONLY_TOUCH = SUPPORT_TOUCH && MOBILE_REGEX.test(navigator.userAgent);\n\nvar INPUT_TYPE_TOUCH = 'touch';\nvar INPUT_TYPE_PEN = 'pen';\nvar INPUT_TYPE_MOUSE = 'mouse';\nvar INPUT_TYPE_KINECT = 'kinect';\n\nvar COMPUTE_INTERVAL = 25;\n\nvar INPUT_START = 1;\nvar INPUT_MOVE = 2;\nvar INPUT_END = 4;\nvar INPUT_CANCEL = 8;\n\nvar DIRECTION_NONE = 1;\nvar DIRECTION_LEFT = 2;\nvar DIRECTION_RIGHT = 4;\nvar DIRECTION_UP = 8;\nvar DIRECTION_DOWN = 16;\n\nvar DIRECTION_HORIZONTAL = DIRECTION_LEFT | DIRECTION_RIGHT;\nvar DIRECTION_VERTICAL = DIRECTION_UP | DIRECTION_DOWN;\nvar DIRECTION_ALL = DIRECTION_HORIZONTAL | DIRECTION_VERTICAL;\n\nvar PROPS_XY = ['x', 'y'];\nvar PROPS_CLIENT_XY = ['clientX', 'clientY'];\n\n/**\n * create new input type manager\n * @param {Manager} manager\n * @param {Function} callback\n * @returns {Input}\n * @constructor\n */\nfunction Input(manager, callback) {\n    var self = this;\n    this.manager = manager;\n    this.callback = callback;\n    this.element = manager.element;\n    this.target = manager.options.inputTarget;\n\n    // smaller wrapper around the handler, for the scope and the enabled state of the manager,\n    // so when disabled the input events are completely bypassed.\n    this.domHandler = function(ev) {\n        if (boolOrFn(manager.options.enable, [manager])) {\n            self.handler(ev);\n        }\n    };\n\n    this.init();\n\n}\n\nInput.prototype = {\n    /**\n     * should handle the inputEvent data and trigger the callback\n     * @virtual\n     */\n    handler: function() { },\n\n    /**\n     * bind the events\n     */\n    init: function() {\n        this.evEl && addEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && addEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && addEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    },\n\n    /**\n     * unbind the events\n     */\n    destroy: function() {\n        this.evEl && removeEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && removeEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && removeEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    }\n};\n\n/**\n * create new input type manager\n * called by the Manager constructor\n * @param {Hammer} manager\n * @returns {Input}\n */\nfunction createInputInstance(manager) {\n    var Type;\n    var inputClass = manager.options.inputClass;\n\n    if (inputClass) {\n        Type = inputClass;\n    } else if (SUPPORT_POINTER_EVENTS) {\n        Type = PointerEventInput;\n    } else if (SUPPORT_ONLY_TOUCH) {\n        Type = TouchInput;\n    } else if (!SUPPORT_TOUCH) {\n        Type = MouseInput;\n    } else {\n        Type = TouchMouseInput;\n    }\n    return new (Type)(manager, inputHandler);\n}\n\n/**\n * handle input events\n * @param {Manager} manager\n * @param {String} eventType\n * @param {Object} input\n */\nfunction inputHandler(manager, eventType, input) {\n    var pointersLen = input.pointers.length;\n    var changedPointersLen = input.changedPointers.length;\n    var isFirst = (eventType & INPUT_START && (pointersLen - changedPointersLen === 0));\n    var isFinal = (eventType & (INPUT_END | INPUT_CANCEL) && (pointersLen - changedPointersLen === 0));\n\n    input.isFirst = !!isFirst;\n    input.isFinal = !!isFinal;\n\n    if (isFirst) {\n        manager.session = {};\n    }\n\n    // source event is the normalized value of the domEvents\n    // like 'touchstart, mouseup, pointerdown'\n    input.eventType = eventType;\n\n    // compute scale, rotation etc\n    computeInputData(manager, input);\n\n    // emit secret event\n    manager.emit('hammer.input', input);\n\n    manager.recognize(input);\n    manager.session.prevInput = input;\n}\n\n/**\n * extend the data with some usable properties like scale, rotate, velocity etc\n * @param {Object} manager\n * @param {Object} input\n */\nfunction computeInputData(manager, input) {\n    var session = manager.session;\n    var pointers = input.pointers;\n    var pointersLength = pointers.length;\n\n    // store the first input to calculate the distance and direction\n    if (!session.firstInput) {\n        session.firstInput = simpleCloneInputData(input);\n    }\n\n    // to compute scale and rotation we need to store the multiple touches\n    if (pointersLength > 1 && !session.firstMultiple) {\n        session.firstMultiple = simpleCloneInputData(input);\n    } else if (pointersLength === 1) {\n        session.firstMultiple = false;\n    }\n\n    var firstInput = session.firstInput;\n    var firstMultiple = session.firstMultiple;\n    var offsetCenter = firstMultiple ? firstMultiple.center : firstInput.center;\n\n    var center = input.center = getCenter(pointers);\n    input.timeStamp = now();\n    input.deltaTime = input.timeStamp - firstInput.timeStamp;\n\n    input.angle = getAngle(offsetCenter, center);\n    input.distance = getDistance(offsetCenter, center);\n\n    computeDeltaXY(session, input);\n    input.offsetDirection = getDirection(input.deltaX, input.deltaY);\n\n    var overallVelocity = getVelocity(input.deltaTime, input.deltaX, input.deltaY);\n    input.overallVelocityX = overallVelocity.x;\n    input.overallVelocityY = overallVelocity.y;\n    input.overallVelocity = (abs(overallVelocity.x) > abs(overallVelocity.y)) ? overallVelocity.x : overallVelocity.y;\n\n    input.scale = firstMultiple ? getScale(firstMultiple.pointers, pointers) : 1;\n    input.rotation = firstMultiple ? getRotation(firstMultiple.pointers, pointers) : 0;\n\n    input.maxPointers = !session.prevInput ? input.pointers.length : ((input.pointers.length >\n        session.prevInput.maxPointers) ? input.pointers.length : session.prevInput.maxPointers);\n\n    computeIntervalInputData(session, input);\n\n    // find the correct target\n    var target = manager.element;\n    if (hasParent(input.srcEvent.target, target)) {\n        target = input.srcEvent.target;\n    }\n    input.target = target;\n}\n\nfunction computeDeltaXY(session, input) {\n    var center = input.center;\n    var offset = session.offsetDelta || {};\n    var prevDelta = session.prevDelta || {};\n    var prevInput = session.prevInput || {};\n\n    if (input.eventType === INPUT_START || prevInput.eventType === INPUT_END) {\n        prevDelta = session.prevDelta = {\n            x: prevInput.deltaX || 0,\n            y: prevInput.deltaY || 0\n        };\n\n        offset = session.offsetDelta = {\n            x: center.x,\n            y: center.y\n        };\n    }\n\n    input.deltaX = prevDelta.x + (center.x - offset.x);\n    input.deltaY = prevDelta.y + (center.y - offset.y);\n}\n\n/**\n * velocity is calculated every x ms\n * @param {Object} session\n * @param {Object} input\n */\nfunction computeIntervalInputData(session, input) {\n    var last = session.lastInterval || input,\n        deltaTime = input.timeStamp - last.timeStamp,\n        velocity, velocityX, velocityY, direction;\n\n    if (input.eventType != INPUT_CANCEL && (deltaTime > COMPUTE_INTERVAL || last.velocity === undefined)) {\n        var deltaX = input.deltaX - last.deltaX;\n        var deltaY = input.deltaY - last.deltaY;\n\n        var v = getVelocity(deltaTime, deltaX, deltaY);\n        velocityX = v.x;\n        velocityY = v.y;\n        velocity = (abs(v.x) > abs(v.y)) ? v.x : v.y;\n        direction = getDirection(deltaX, deltaY);\n\n        session.lastInterval = input;\n    } else {\n        // use latest velocity info if it doesn't overtake a minimum period\n        velocity = last.velocity;\n        velocityX = last.velocityX;\n        velocityY = last.velocityY;\n        direction = last.direction;\n    }\n\n    input.velocity = velocity;\n    input.velocityX = velocityX;\n    input.velocityY = velocityY;\n    input.direction = direction;\n}\n\n/**\n * create a simple clone from the input used for storage of firstInput and firstMultiple\n * @param {Object} input\n * @returns {Object} clonedInputData\n */\nfunction simpleCloneInputData(input) {\n    // make a simple copy of the pointers because we will get a reference if we don't\n    // we only need clientXY for the calculations\n    var pointers = [];\n    var i = 0;\n    while (i < input.pointers.length) {\n        pointers[i] = {\n            clientX: round(input.pointers[i].clientX),\n            clientY: round(input.pointers[i].clientY)\n        };\n        i++;\n    }\n\n    return {\n        timeStamp: now(),\n        pointers: pointers,\n        center: getCenter(pointers),\n        deltaX: input.deltaX,\n        deltaY: input.deltaY\n    };\n}\n\n/**\n * get the center of all the pointers\n * @param {Array} pointers\n * @return {Object} center contains `x` and `y` properties\n */\nfunction getCenter(pointers) {\n    var pointersLength = pointers.length;\n\n    // no need to loop when only one touch\n    if (pointersLength === 1) {\n        return {\n            x: round(pointers[0].clientX),\n            y: round(pointers[0].clientY)\n        };\n    }\n\n    var x = 0, y = 0, i = 0;\n    while (i < pointersLength) {\n        x += pointers[i].clientX;\n        y += pointers[i].clientY;\n        i++;\n    }\n\n    return {\n        x: round(x / pointersLength),\n        y: round(y / pointersLength)\n    };\n}\n\n/**\n * calculate the velocity between two points. unit is in px per ms.\n * @param {Number} deltaTime\n * @param {Number} x\n * @param {Number} y\n * @return {Object} velocity `x` and `y`\n */\nfunction getVelocity(deltaTime, x, y) {\n    return {\n        x: x / deltaTime || 0,\n        y: y / deltaTime || 0\n    };\n}\n\n/**\n * get the direction between two points\n * @param {Number} x\n * @param {Number} y\n * @return {Number} direction\n */\nfunction getDirection(x, y) {\n    if (x === y) {\n        return DIRECTION_NONE;\n    }\n\n    if (abs(x) >= abs(y)) {\n        return x < 0 ? DIRECTION_LEFT : DIRECTION_RIGHT;\n    }\n    return y < 0 ? DIRECTION_UP : DIRECTION_DOWN;\n}\n\n/**\n * calculate the absolute distance between two points\n * @param {Object} p1 {x, y}\n * @param {Object} p2 {x, y}\n * @param {Array} [props] containing x and y keys\n * @return {Number} distance\n */\nfunction getDistance(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n\n    return Math.sqrt((x * x) + (y * y));\n}\n\n/**\n * calculate the angle between two coordinates\n * @param {Object} p1\n * @param {Object} p2\n * @param {Array} [props] containing x and y keys\n * @return {Number} angle\n */\nfunction getAngle(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n    return Math.atan2(y, x) * 180 / Math.PI;\n}\n\n/**\n * calculate the rotation degrees between two pointersets\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} rotation\n */\nfunction getRotation(start, end) {\n    return getAngle(end[1], end[0], PROPS_CLIENT_XY) + getAngle(start[1], start[0], PROPS_CLIENT_XY);\n}\n\n/**\n * calculate the scale factor between two pointersets\n * no scale is 1, and goes down to 0 when pinched together, and bigger when pinched out\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} scale\n */\nfunction getScale(start, end) {\n    return getDistance(end[0], end[1], PROPS_CLIENT_XY) / getDistance(start[0], start[1], PROPS_CLIENT_XY);\n}\n\nvar MOUSE_INPUT_MAP = {\n    mousedown: INPUT_START,\n    mousemove: INPUT_MOVE,\n    mouseup: INPUT_END\n};\n\nvar MOUSE_ELEMENT_EVENTS = 'mousedown';\nvar MOUSE_WINDOW_EVENTS = 'mousemove mouseup';\n\n/**\n * Mouse events input\n * @constructor\n * @extends Input\n */\nfunction MouseInput() {\n    this.evEl = MOUSE_ELEMENT_EVENTS;\n    this.evWin = MOUSE_WINDOW_EVENTS;\n\n    this.pressed = false; // mousedown state\n\n    Input.apply(this, arguments);\n}\n\ninherit(MouseInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function MEhandler(ev) {\n        var eventType = MOUSE_INPUT_MAP[ev.type];\n\n        // on start we want to have the left mouse button down\n        if (eventType & INPUT_START && ev.button === 0) {\n            this.pressed = true;\n        }\n\n        if (eventType & INPUT_MOVE && ev.which !== 1) {\n            eventType = INPUT_END;\n        }\n\n        // mouse must be down\n        if (!this.pressed) {\n            return;\n        }\n\n        if (eventType & INPUT_END) {\n            this.pressed = false;\n        }\n\n        this.callback(this.manager, eventType, {\n            pointers: [ev],\n            changedPointers: [ev],\n            pointerType: INPUT_TYPE_MOUSE,\n            srcEvent: ev\n        });\n    }\n});\n\nvar POINTER_INPUT_MAP = {\n    pointerdown: INPUT_START,\n    pointermove: INPUT_MOVE,\n    pointerup: INPUT_END,\n    pointercancel: INPUT_CANCEL,\n    pointerout: INPUT_CANCEL\n};\n\n// in IE10 the pointer types is defined as an enum\nvar IE10_POINTER_TYPE_ENUM = {\n    2: INPUT_TYPE_TOUCH,\n    3: INPUT_TYPE_PEN,\n    4: INPUT_TYPE_MOUSE,\n    5: INPUT_TYPE_KINECT // see https://twitter.com/jacobrossi/status/480596438489890816\n};\n\nvar POINTER_ELEMENT_EVENTS = 'pointerdown';\nvar POINTER_WINDOW_EVENTS = 'pointermove pointerup pointercancel';\n\n// IE10 has prefixed support, and case-sensitive\nif (window.MSPointerEvent && !window.PointerEvent) {\n    POINTER_ELEMENT_EVENTS = 'MSPointerDown';\n    POINTER_WINDOW_EVENTS = 'MSPointerMove MSPointerUp MSPointerCancel';\n}\n\n/**\n * Pointer events input\n * @constructor\n * @extends Input\n */\nfunction PointerEventInput() {\n    this.evEl = POINTER_ELEMENT_EVENTS;\n    this.evWin = POINTER_WINDOW_EVENTS;\n\n    Input.apply(this, arguments);\n\n    this.store = (this.manager.session.pointerEvents = []);\n}\n\ninherit(PointerEventInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function PEhandler(ev) {\n        var store = this.store;\n        var removePointer = false;\n\n        var eventTypeNormalized = ev.type.toLowerCase().replace('ms', '');\n        var eventType = POINTER_INPUT_MAP[eventTypeNormalized];\n        var pointerType = IE10_POINTER_TYPE_ENUM[ev.pointerType] || ev.pointerType;\n\n        var isTouch = (pointerType == INPUT_TYPE_TOUCH);\n\n        // get index of the event in the store\n        var storeIndex = inArray(store, ev.pointerId, 'pointerId');\n\n        // start and mouse must be down\n        if (eventType & INPUT_START && (ev.button === 0 || isTouch)) {\n            if (storeIndex < 0) {\n                store.push(ev);\n                storeIndex = store.length - 1;\n            }\n        } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n            removePointer = true;\n        }\n\n        // it not found, so the pointer hasn't been down (so it's probably a hover)\n        if (storeIndex < 0) {\n            return;\n        }\n\n        // update the event in the store\n        store[storeIndex] = ev;\n\n        this.callback(this.manager, eventType, {\n            pointers: store,\n            changedPointers: [ev],\n            pointerType: pointerType,\n            srcEvent: ev\n        });\n\n        if (removePointer) {\n            // remove from the store\n            store.splice(storeIndex, 1);\n        }\n    }\n});\n\nvar SINGLE_TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar SINGLE_TOUCH_TARGET_EVENTS = 'touchstart';\nvar SINGLE_TOUCH_WINDOW_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Touch events input\n * @constructor\n * @extends Input\n */\nfunction SingleTouchInput() {\n    this.evTarget = SINGLE_TOUCH_TARGET_EVENTS;\n    this.evWin = SINGLE_TOUCH_WINDOW_EVENTS;\n    this.started = false;\n\n    Input.apply(this, arguments);\n}\n\ninherit(SingleTouchInput, Input, {\n    handler: function TEhandler(ev) {\n        var type = SINGLE_TOUCH_INPUT_MAP[ev.type];\n\n        // should we handle the touch events?\n        if (type === INPUT_START) {\n            this.started = true;\n        }\n\n        if (!this.started) {\n            return;\n        }\n\n        var touches = normalizeSingleTouches.call(this, ev, type);\n\n        // when done, reset the started state\n        if (type & (INPUT_END | INPUT_CANCEL) && touches[0].length - touches[1].length === 0) {\n            this.started = false;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction normalizeSingleTouches(ev, type) {\n    var all = toArray(ev.touches);\n    var changed = toArray(ev.changedTouches);\n\n    if (type & (INPUT_END | INPUT_CANCEL)) {\n        all = uniqueArray(all.concat(changed), 'identifier', true);\n    }\n\n    return [all, changed];\n}\n\nvar TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar TOUCH_TARGET_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Multi-user touch events input\n * @constructor\n * @extends Input\n */\nfunction TouchInput() {\n    this.evTarget = TOUCH_TARGET_EVENTS;\n    this.targetIds = {};\n\n    Input.apply(this, arguments);\n}\n\ninherit(TouchInput, Input, {\n    handler: function MTEhandler(ev) {\n        var type = TOUCH_INPUT_MAP[ev.type];\n        var touches = getTouches.call(this, ev, type);\n        if (!touches) {\n            return;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction getTouches(ev, type) {\n    var allTouches = toArray(ev.touches);\n    var targetIds = this.targetIds;\n\n    // when there is only one touch, the process can be simplified\n    if (type & (INPUT_START | INPUT_MOVE) && allTouches.length === 1) {\n        targetIds[allTouches[0].identifier] = true;\n        return [allTouches, allTouches];\n    }\n\n    var i,\n        targetTouches,\n        changedTouches = toArray(ev.changedTouches),\n        changedTargetTouches = [],\n        target = this.target;\n\n    // get target touches from touches\n    targetTouches = allTouches.filter(function(touch) {\n        return hasParent(touch.target, target);\n    });\n\n    // collect touches\n    if (type === INPUT_START) {\n        i = 0;\n        while (i < targetTouches.length) {\n            targetIds[targetTouches[i].identifier] = true;\n            i++;\n        }\n    }\n\n    // filter changed touches to only contain touches that exist in the collected target ids\n    i = 0;\n    while (i < changedTouches.length) {\n        if (targetIds[changedTouches[i].identifier]) {\n            changedTargetTouches.push(changedTouches[i]);\n        }\n\n        // cleanup removed touches\n        if (type & (INPUT_END | INPUT_CANCEL)) {\n            delete targetIds[changedTouches[i].identifier];\n        }\n        i++;\n    }\n\n    if (!changedTargetTouches.length) {\n        return;\n    }\n\n    return [\n        // merge targetTouches with changedTargetTouches so it contains ALL touches, including 'end' and 'cancel'\n        uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true),\n        changedTargetTouches\n    ];\n}\n\n/**\n * Combined touch and mouse input\n *\n * Touch has a higher priority then mouse, and while touching no mouse events are allowed.\n * This because touch devices also emit mouse events while doing a touch.\n *\n * @constructor\n * @extends Input\n */\n\nvar DEDUP_TIMEOUT = 2500;\nvar DEDUP_DISTANCE = 25;\n\nfunction TouchMouseInput() {\n    Input.apply(this, arguments);\n\n    var handler = bindFn(this.handler, this);\n    this.touch = new TouchInput(this.manager, handler);\n    this.mouse = new MouseInput(this.manager, handler);\n\n    this.primaryTouch = null;\n    this.lastTouches = [];\n}\n\ninherit(TouchMouseInput, Input, {\n    /**\n     * handle mouse and touch events\n     * @param {Hammer} manager\n     * @param {String} inputEvent\n     * @param {Object} inputData\n     */\n    handler: function TMEhandler(manager, inputEvent, inputData) {\n        var isTouch = (inputData.pointerType == INPUT_TYPE_TOUCH),\n            isMouse = (inputData.pointerType == INPUT_TYPE_MOUSE);\n\n        if (isMouse && inputData.sourceCapabilities && inputData.sourceCapabilities.firesTouchEvents) {\n            return;\n        }\n\n        // when we're in a touch event, record touches to  de-dupe synthetic mouse event\n        if (isTouch) {\n            recordTouches.call(this, inputEvent, inputData);\n        } else if (isMouse && isSyntheticEvent.call(this, inputData)) {\n            return;\n        }\n\n        this.callback(manager, inputEvent, inputData);\n    },\n\n    /**\n     * remove the event listeners\n     */\n    destroy: function destroy() {\n        this.touch.destroy();\n        this.mouse.destroy();\n    }\n});\n\nfunction recordTouches(eventType, eventData) {\n    if (eventType & INPUT_START) {\n        this.primaryTouch = eventData.changedPointers[0].identifier;\n        setLastTouch.call(this, eventData);\n    } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n        setLastTouch.call(this, eventData);\n    }\n}\n\nfunction setLastTouch(eventData) {\n    var touch = eventData.changedPointers[0];\n\n    if (touch.identifier === this.primaryTouch) {\n        var lastTouch = {x: touch.clientX, y: touch.clientY};\n        this.lastTouches.push(lastTouch);\n        var lts = this.lastTouches;\n        var removeLastTouch = function() {\n            var i = lts.indexOf(lastTouch);\n            if (i > -1) {\n                lts.splice(i, 1);\n            }\n        };\n        setTimeout(removeLastTouch, DEDUP_TIMEOUT);\n    }\n}\n\nfunction isSyntheticEvent(eventData) {\n    var x = eventData.srcEvent.clientX, y = eventData.srcEvent.clientY;\n    for (var i = 0; i < this.lastTouches.length; i++) {\n        var t = this.lastTouches[i];\n        var dx = Math.abs(x - t.x), dy = Math.abs(y - t.y);\n        if (dx <= DEDUP_DISTANCE && dy <= DEDUP_DISTANCE) {\n            return true;\n        }\n    }\n    return false;\n}\n\nvar PREFIXED_TOUCH_ACTION = prefixed(TEST_ELEMENT.style, 'touchAction');\nvar NATIVE_TOUCH_ACTION = PREFIXED_TOUCH_ACTION !== undefined;\n\n// magical touchAction value\nvar TOUCH_ACTION_COMPUTE = 'compute';\nvar TOUCH_ACTION_AUTO = 'auto';\nvar TOUCH_ACTION_MANIPULATION = 'manipulation'; // not implemented\nvar TOUCH_ACTION_NONE = 'none';\nvar TOUCH_ACTION_PAN_X = 'pan-x';\nvar TOUCH_ACTION_PAN_Y = 'pan-y';\nvar TOUCH_ACTION_MAP = getTouchActionProps();\n\n/**\n * Touch Action\n * sets the touchAction property or uses the js alternative\n * @param {Manager} manager\n * @param {String} value\n * @constructor\n */\nfunction TouchAction(manager, value) {\n    this.manager = manager;\n    this.set(value);\n}\n\nTouchAction.prototype = {\n    /**\n     * set the touchAction value on the element or enable the polyfill\n     * @param {String} value\n     */\n    set: function(value) {\n        // find out the touch-action by the event handlers\n        if (value == TOUCH_ACTION_COMPUTE) {\n            value = this.compute();\n        }\n\n        if (NATIVE_TOUCH_ACTION && this.manager.element.style && TOUCH_ACTION_MAP[value]) {\n            this.manager.element.style[PREFIXED_TOUCH_ACTION] = value;\n        }\n        this.actions = value.toLowerCase().trim();\n    },\n\n    /**\n     * just re-set the touchAction value\n     */\n    update: function() {\n        this.set(this.manager.options.touchAction);\n    },\n\n    /**\n     * compute the value for the touchAction property based on the recognizer's settings\n     * @returns {String} value\n     */\n    compute: function() {\n        var actions = [];\n        each(this.manager.recognizers, function(recognizer) {\n            if (boolOrFn(recognizer.options.enable, [recognizer])) {\n                actions = actions.concat(recognizer.getTouchAction());\n            }\n        });\n        return cleanTouchActions(actions.join(' '));\n    },\n\n    /**\n     * this method is called on each input cycle and provides the preventing of the browser behavior\n     * @param {Object} input\n     */\n    preventDefaults: function(input) {\n        var srcEvent = input.srcEvent;\n        var direction = input.offsetDirection;\n\n        // if the touch action did prevented once this session\n        if (this.manager.session.prevented) {\n            srcEvent.preventDefault();\n            return;\n        }\n\n        var actions = this.actions;\n        var hasNone = inStr(actions, TOUCH_ACTION_NONE) && !TOUCH_ACTION_MAP[TOUCH_ACTION_NONE];\n        var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y];\n        var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];\n\n        if (hasNone) {\n            //do not prevent defaults if this is a tap gesture\n\n            var isTapPointer = input.pointers.length === 1;\n            var isTapMovement = input.distance < 2;\n            var isTapTouchTime = input.deltaTime < 250;\n\n            if (isTapPointer && isTapMovement && isTapTouchTime) {\n                return;\n            }\n        }\n\n        if (hasPanX && hasPanY) {\n            // `pan-x pan-y` means browser handles all scrolling/panning, do not prevent\n            return;\n        }\n\n        if (hasNone ||\n            (hasPanY && direction & DIRECTION_HORIZONTAL) ||\n            (hasPanX && direction & DIRECTION_VERTICAL)) {\n            return this.preventSrc(srcEvent);\n        }\n    },\n\n    /**\n     * call preventDefault to prevent the browser's default behavior (scrolling in most cases)\n     * @param {Object} srcEvent\n     */\n    preventSrc: function(srcEvent) {\n        this.manager.session.prevented = true;\n        srcEvent.preventDefault();\n    }\n};\n\n/**\n * when the touchActions are collected they are not a valid value, so we need to clean things up. *\n * @param {String} actions\n * @returns {*}\n */\nfunction cleanTouchActions(actions) {\n    // none\n    if (inStr(actions, TOUCH_ACTION_NONE)) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X);\n    var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y);\n\n    // if both pan-x and pan-y are set (different recognizers\n    // for different directions, e.g. horizontal pan but vertical swipe?)\n    // we need none (as otherwise with pan-x pan-y combined none of these\n    // recognizers will work, since the browser would handle all panning\n    if (hasPanX && hasPanY) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    // pan-x OR pan-y\n    if (hasPanX || hasPanY) {\n        return hasPanX ? TOUCH_ACTION_PAN_X : TOUCH_ACTION_PAN_Y;\n    }\n\n    // manipulation\n    if (inStr(actions, TOUCH_ACTION_MANIPULATION)) {\n        return TOUCH_ACTION_MANIPULATION;\n    }\n\n    return TOUCH_ACTION_AUTO;\n}\n\nfunction getTouchActionProps() {\n    if (!NATIVE_TOUCH_ACTION) {\n        return false;\n    }\n    var touchMap = {};\n    var cssSupports = window.CSS && window.CSS.supports;\n    ['auto', 'manipulation', 'pan-y', 'pan-x', 'pan-x pan-y', 'none'].forEach(function(val) {\n\n        // If css.supports is not supported but there is native touch-action assume it supports\n        // all values. This is the case for IE 10 and 11.\n        touchMap[val] = cssSupports ? window.CSS.supports('touch-action', val) : true;\n    });\n    return touchMap;\n}\n\n/**\n * Recognizer flow explained; *\n * All recognizers have the initial state of POSSIBLE when a input session starts.\n * The definition of a input session is from the first input until the last input, with all it's movement in it. *\n * Example session for mouse-input: mousedown -> mousemove -> mouseup\n *\n * On each recognizing cycle (see Manager.recognize) the .recognize() method is executed\n * which determines with state it should be.\n *\n * If the recognizer has the state FAILED, CANCELLED or RECOGNIZED (equals ENDED), it is reset to\n * POSSIBLE to give it another change on the next cycle.\n *\n *               Possible\n *                  |\n *            +-----+---------------+\n *            |                     |\n *      +-----+-----+               |\n *      |           |               |\n *   Failed      Cancelled          |\n *                          +-------+------+\n *                          |              |\n *                      Recognized       Began\n *                                         |\n *                                      Changed\n *                                         |\n *                                  Ended/Recognized\n */\nvar STATE_POSSIBLE = 1;\nvar STATE_BEGAN = 2;\nvar STATE_CHANGED = 4;\nvar STATE_ENDED = 8;\nvar STATE_RECOGNIZED = STATE_ENDED;\nvar STATE_CANCELLED = 16;\nvar STATE_FAILED = 32;\n\n/**\n * Recognizer\n * Every recognizer needs to extend from this class.\n * @constructor\n * @param {Object} options\n */\nfunction Recognizer(options) {\n    this.options = assign({}, this.defaults, options || {});\n\n    this.id = uniqueId();\n\n    this.manager = null;\n\n    // default is enable true\n    this.options.enable = ifUndefined(this.options.enable, true);\n\n    this.state = STATE_POSSIBLE;\n\n    this.simultaneous = {};\n    this.requireFail = [];\n}\n\nRecognizer.prototype = {\n    /**\n     * @virtual\n     * @type {Object}\n     */\n    defaults: {},\n\n    /**\n     * set options\n     * @param {Object} options\n     * @return {Recognizer}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // also update the touchAction, in case something changed about the directions/enabled state\n        this.manager && this.manager.touchAction.update();\n        return this;\n    },\n\n    /**\n     * recognize simultaneous with an other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    recognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'recognizeWith', this)) {\n            return this;\n        }\n\n        var simultaneous = this.simultaneous;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (!simultaneous[otherRecognizer.id]) {\n            simultaneous[otherRecognizer.id] = otherRecognizer;\n            otherRecognizer.recognizeWith(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the simultaneous link. it doesnt remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRecognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRecognizeWith', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        delete this.simultaneous[otherRecognizer.id];\n        return this;\n    },\n\n    /**\n     * recognizer can only run when an other is failing\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    requireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'requireFailure', this)) {\n            return this;\n        }\n\n        var requireFail = this.requireFail;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (inArray(requireFail, otherRecognizer) === -1) {\n            requireFail.push(otherRecognizer);\n            otherRecognizer.requireFailure(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the requireFailure link. it does not remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRequireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRequireFailure', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        var index = inArray(this.requireFail, otherRecognizer);\n        if (index > -1) {\n            this.requireFail.splice(index, 1);\n        }\n        return this;\n    },\n\n    /**\n     * has require failures boolean\n     * @returns {boolean}\n     */\n    hasRequireFailures: function() {\n        return this.requireFail.length > 0;\n    },\n\n    /**\n     * if the recognizer can recognize simultaneous with an other recognizer\n     * @param {Recognizer} otherRecognizer\n     * @returns {Boolean}\n     */\n    canRecognizeWith: function(otherRecognizer) {\n        return !!this.simultaneous[otherRecognizer.id];\n    },\n\n    /**\n     * You should use `tryEmit` instead of `emit` directly to check\n     * that all the needed recognizers has failed before emitting.\n     * @param {Object} input\n     */\n    emit: function(input) {\n        var self = this;\n        var state = this.state;\n\n        function emit(event) {\n            self.manager.emit(event, input);\n        }\n\n        // 'panstart' and 'panmove'\n        if (state < STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n\n        emit(self.options.event); // simple 'eventName' events\n\n        if (input.additionalEvent) { // additional event(panleft, panright, pinchin, pinchout...)\n            emit(input.additionalEvent);\n        }\n\n        // panend and pancancel\n        if (state >= STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n    },\n\n    /**\n     * Check that all the require failure recognizers has failed,\n     * if true, it emits a gesture event,\n     * otherwise, setup the state to FAILED.\n     * @param {Object} input\n     */\n    tryEmit: function(input) {\n        if (this.canEmit()) {\n            return this.emit(input);\n        }\n        // it's failing anyway\n        this.state = STATE_FAILED;\n    },\n\n    /**\n     * can we emit?\n     * @returns {boolean}\n     */\n    canEmit: function() {\n        var i = 0;\n        while (i < this.requireFail.length) {\n            if (!(this.requireFail[i].state & (STATE_FAILED | STATE_POSSIBLE))) {\n                return false;\n            }\n            i++;\n        }\n        return true;\n    },\n\n    /**\n     * update the recognizer\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        // make a new copy of the inputData\n        // so we can change the inputData without messing up the other recognizers\n        var inputDataClone = assign({}, inputData);\n\n        // is is enabled and allow recognizing?\n        if (!boolOrFn(this.options.enable, [this, inputDataClone])) {\n            this.reset();\n            this.state = STATE_FAILED;\n            return;\n        }\n\n        // reset when we've reached the end\n        if (this.state & (STATE_RECOGNIZED | STATE_CANCELLED | STATE_FAILED)) {\n            this.state = STATE_POSSIBLE;\n        }\n\n        this.state = this.process(inputDataClone);\n\n        // the recognizer has recognized a gesture\n        // so trigger an event\n        if (this.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED | STATE_CANCELLED)) {\n            this.tryEmit(inputDataClone);\n        }\n    },\n\n    /**\n     * return the state of the recognizer\n     * the actual recognizing happens in this method\n     * @virtual\n     * @param {Object} inputData\n     * @returns {Const} STATE\n     */\n    process: function(inputData) { }, // jshint ignore:line\n\n    /**\n     * return the preferred touch-action\n     * @virtual\n     * @returns {Array}\n     */\n    getTouchAction: function() { },\n\n    /**\n     * called when the gesture isn't allowed to recognize\n     * like when another is being recognized or it is disabled\n     * @virtual\n     */\n    reset: function() { }\n};\n\n/**\n * get a usable string, used as event postfix\n * @param {Const} state\n * @returns {String} state\n */\nfunction stateStr(state) {\n    if (state & STATE_CANCELLED) {\n        return 'cancel';\n    } else if (state & STATE_ENDED) {\n        return 'end';\n    } else if (state & STATE_CHANGED) {\n        return 'move';\n    } else if (state & STATE_BEGAN) {\n        return 'start';\n    }\n    return '';\n}\n\n/**\n * direction cons to string\n * @param {Const} direction\n * @returns {String}\n */\nfunction directionStr(direction) {\n    if (direction == DIRECTION_DOWN) {\n        return 'down';\n    } else if (direction == DIRECTION_UP) {\n        return 'up';\n    } else if (direction == DIRECTION_LEFT) {\n        return 'left';\n    } else if (direction == DIRECTION_RIGHT) {\n        return 'right';\n    }\n    return '';\n}\n\n/**\n * get a recognizer by name if it is bound to a manager\n * @param {Recognizer|String} otherRecognizer\n * @param {Recognizer} recognizer\n * @returns {Recognizer}\n */\nfunction getRecognizerByNameIfManager(otherRecognizer, recognizer) {\n    var manager = recognizer.manager;\n    if (manager) {\n        return manager.get(otherRecognizer);\n    }\n    return otherRecognizer;\n}\n\n/**\n * This recognizer is just used as a base for the simple attribute recognizers.\n * @constructor\n * @extends Recognizer\n */\nfunction AttrRecognizer() {\n    Recognizer.apply(this, arguments);\n}\n\ninherit(AttrRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof AttrRecognizer\n     */\n    defaults: {\n        /**\n         * @type {Number}\n         * @default 1\n         */\n        pointers: 1\n    },\n\n    /**\n     * Used to check if it the recognizer receives valid input, like input.distance > 10.\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {Boolean} recognized\n     */\n    attrTest: function(input) {\n        var optionPointers = this.options.pointers;\n        return optionPointers === 0 || input.pointers.length === optionPointers;\n    },\n\n    /**\n     * Process the input and return the state for the recognizer\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {*} State\n     */\n    process: function(input) {\n        var state = this.state;\n        var eventType = input.eventType;\n\n        var isRecognized = state & (STATE_BEGAN | STATE_CHANGED);\n        var isValid = this.attrTest(input);\n\n        // on cancel input and we've recognized before, return STATE_CANCELLED\n        if (isRecognized && (eventType & INPUT_CANCEL || !isValid)) {\n            return state | STATE_CANCELLED;\n        } else if (isRecognized || isValid) {\n            if (eventType & INPUT_END) {\n                return state | STATE_ENDED;\n            } else if (!(state & STATE_BEGAN)) {\n                return STATE_BEGAN;\n            }\n            return state | STATE_CHANGED;\n        }\n        return STATE_FAILED;\n    }\n});\n\n/**\n * Pan\n * Recognized when the pointer is down and moved in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PanRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n\n    this.pX = null;\n    this.pY = null;\n}\n\ninherit(PanRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PanRecognizer\n     */\n    defaults: {\n        event: 'pan',\n        threshold: 10,\n        pointers: 1,\n        direction: DIRECTION_ALL\n    },\n\n    getTouchAction: function() {\n        var direction = this.options.direction;\n        var actions = [];\n        if (direction & DIRECTION_HORIZONTAL) {\n            actions.push(TOUCH_ACTION_PAN_Y);\n        }\n        if (direction & DIRECTION_VERTICAL) {\n            actions.push(TOUCH_ACTION_PAN_X);\n        }\n        return actions;\n    },\n\n    directionTest: function(input) {\n        var options = this.options;\n        var hasMoved = true;\n        var distance = input.distance;\n        var direction = input.direction;\n        var x = input.deltaX;\n        var y = input.deltaY;\n\n        // lock to axis?\n        if (!(direction & options.direction)) {\n            if (options.direction & DIRECTION_HORIZONTAL) {\n                direction = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;\n                hasMoved = x != this.pX;\n                distance = Math.abs(input.deltaX);\n            } else {\n                direction = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;\n                hasMoved = y != this.pY;\n                distance = Math.abs(input.deltaY);\n            }\n        }\n        input.direction = direction;\n        return hasMoved && distance > options.threshold && direction & options.direction;\n    },\n\n    attrTest: function(input) {\n        return AttrRecognizer.prototype.attrTest.call(this, input) &&\n            (this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));\n    },\n\n    emit: function(input) {\n\n        this.pX = input.deltaX;\n        this.pY = input.deltaY;\n\n        var direction = directionStr(input.direction);\n\n        if (direction) {\n            input.additionalEvent = this.options.event + direction;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Pinch\n * Recognized when two or more pointers are moving toward (zoom-in) or away from each other (zoom-out).\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PinchRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(PinchRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'pinch',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.scale - 1) > this.options.threshold || this.state & STATE_BEGAN);\n    },\n\n    emit: function(input) {\n        if (input.scale !== 1) {\n            var inOut = input.scale < 1 ? 'in' : 'out';\n            input.additionalEvent = this.options.event + inOut;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Press\n * Recognized when the pointer is down for x ms without any movement.\n * @constructor\n * @extends Recognizer\n */\nfunction PressRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    this._timer = null;\n    this._input = null;\n}\n\ninherit(PressRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PressRecognizer\n     */\n    defaults: {\n        event: 'press',\n        pointers: 1,\n        time: 251, // minimal time of the pointer to be pressed\n        threshold: 9 // a minimal movement is ok, but keep it low\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_AUTO];\n    },\n\n    process: function(input) {\n        var options = this.options;\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTime = input.deltaTime > options.time;\n\n        this._input = input;\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (!validMovement || !validPointers || (input.eventType & (INPUT_END | INPUT_CANCEL) && !validTime)) {\n            this.reset();\n        } else if (input.eventType & INPUT_START) {\n            this.reset();\n            this._timer = setTimeoutContext(function() {\n                this.state = STATE_RECOGNIZED;\n                this.tryEmit();\n            }, options.time, this);\n        } else if (input.eventType & INPUT_END) {\n            return STATE_RECOGNIZED;\n        }\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function(input) {\n        if (this.state !== STATE_RECOGNIZED) {\n            return;\n        }\n\n        if (input && (input.eventType & INPUT_END)) {\n            this.manager.emit(this.options.event + 'up', input);\n        } else {\n            this._input.timeStamp = now();\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Rotate\n * Recognized when two or more pointer are moving in a circular motion.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction RotateRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(RotateRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof RotateRecognizer\n     */\n    defaults: {\n        event: 'rotate',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.rotation) > this.options.threshold || this.state & STATE_BEGAN);\n    }\n});\n\n/**\n * Swipe\n * Recognized when the pointer is moving fast (velocity), with enough distance in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction SwipeRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(SwipeRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof SwipeRecognizer\n     */\n    defaults: {\n        event: 'swipe',\n        threshold: 10,\n        velocity: 0.3,\n        direction: DIRECTION_HORIZONTAL | DIRECTION_VERTICAL,\n        pointers: 1\n    },\n\n    getTouchAction: function() {\n        return PanRecognizer.prototype.getTouchAction.call(this);\n    },\n\n    attrTest: function(input) {\n        var direction = this.options.direction;\n        var velocity;\n\n        if (direction & (DIRECTION_HORIZONTAL | DIRECTION_VERTICAL)) {\n            velocity = input.overallVelocity;\n        } else if (direction & DIRECTION_HORIZONTAL) {\n            velocity = input.overallVelocityX;\n        } else if (direction & DIRECTION_VERTICAL) {\n            velocity = input.overallVelocityY;\n        }\n\n        return this._super.attrTest.call(this, input) &&\n            direction & input.offsetDirection &&\n            input.distance > this.options.threshold &&\n            input.maxPointers == this.options.pointers &&\n            abs(velocity) > this.options.velocity && input.eventType & INPUT_END;\n    },\n\n    emit: function(input) {\n        var direction = directionStr(input.offsetDirection);\n        if (direction) {\n            this.manager.emit(this.options.event + direction, input);\n        }\n\n        this.manager.emit(this.options.event, input);\n    }\n});\n\n/**\n * A tap is ecognized when the pointer is doing a small tap/click. Multiple taps are recognized if they occur\n * between the given interval and position. The delay option can be used to recognize multi-taps without firing\n * a single tap.\n *\n * The eventData from the emitted event contains the property `tapCount`, which contains the amount of\n * multi-taps being recognized.\n * @constructor\n * @extends Recognizer\n */\nfunction TapRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    // previous time and center,\n    // used for tap counting\n    this.pTime = false;\n    this.pCenter = false;\n\n    this._timer = null;\n    this._input = null;\n    this.count = 0;\n}\n\ninherit(TapRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'tap',\n        pointers: 1,\n        taps: 1,\n        interval: 300, // max time between the multi-tap taps\n        time: 250, // max time of the pointer to be down (like finger on the screen)\n        threshold: 9, // a minimal movement is ok, but keep it low\n        posThreshold: 10 // a multi-tap can be a bit off the initial position\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_MANIPULATION];\n    },\n\n    process: function(input) {\n        var options = this.options;\n\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTouchTime = input.deltaTime < options.time;\n\n        this.reset();\n\n        if ((input.eventType & INPUT_START) && (this.count === 0)) {\n            return this.failTimeout();\n        }\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (validMovement && validTouchTime && validPointers) {\n            if (input.eventType != INPUT_END) {\n                return this.failTimeout();\n            }\n\n            var validInterval = this.pTime ? (input.timeStamp - this.pTime < options.interval) : true;\n            var validMultiTap = !this.pCenter || getDistance(this.pCenter, input.center) < options.posThreshold;\n\n            this.pTime = input.timeStamp;\n            this.pCenter = input.center;\n\n            if (!validMultiTap || !validInterval) {\n                this.count = 1;\n            } else {\n                this.count += 1;\n            }\n\n            this._input = input;\n\n            // if tap count matches we have recognized it,\n            // else it has began recognizing...\n            var tapCount = this.count % options.taps;\n            if (tapCount === 0) {\n                // no failing requirements, immediately trigger the tap event\n                // or wait as long as the multitap interval to trigger\n                if (!this.hasRequireFailures()) {\n                    return STATE_RECOGNIZED;\n                } else {\n                    this._timer = setTimeoutContext(function() {\n                        this.state = STATE_RECOGNIZED;\n                        this.tryEmit();\n                    }, options.interval, this);\n                    return STATE_BEGAN;\n                }\n            }\n        }\n        return STATE_FAILED;\n    },\n\n    failTimeout: function() {\n        this._timer = setTimeoutContext(function() {\n            this.state = STATE_FAILED;\n        }, this.options.interval, this);\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function() {\n        if (this.state == STATE_RECOGNIZED) {\n            this._input.tapCount = this.count;\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Simple way to create a manager with a default set of recognizers.\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Hammer(element, options) {\n    options = options || {};\n    options.recognizers = ifUndefined(options.recognizers, Hammer.defaults.preset);\n    return new Manager(element, options);\n}\n\n/**\n * @const {string}\n */\nHammer.VERSION = '2.0.7';\n\n/**\n * default settings\n * @namespace\n */\nHammer.defaults = {\n    /**\n     * set if DOM events are being triggered.\n     * But this is slower and unused by simple implementations, so disabled by default.\n     * @type {Boolean}\n     * @default false\n     */\n    domEvents: false,\n\n    /**\n     * The value for the touchAction property/fallback.\n     * When set to `compute` it will magically set the correct value based on the added recognizers.\n     * @type {String}\n     * @default compute\n     */\n    touchAction: TOUCH_ACTION_COMPUTE,\n\n    /**\n     * @type {Boolean}\n     * @default true\n     */\n    enable: true,\n\n    /**\n     * EXPERIMENTAL FEATURE -- can be removed/changed\n     * Change the parent input target element.\n     * If Null, then it is being set the to main element.\n     * @type {Null|EventTarget}\n     * @default null\n     */\n    inputTarget: null,\n\n    /**\n     * force an input class\n     * @type {Null|Function}\n     * @default null\n     */\n    inputClass: null,\n\n    /**\n     * Default recognizer setup when calling `Hammer()`\n     * When creating a new Manager these will be skipped.\n     * @type {Array}\n     */\n    preset: [\n        // RecognizerClass, options, [recognizeWith, ...], [requireFailure, ...]\n        [RotateRecognizer, {enable: false}],\n        [PinchRecognizer, {enable: false}, ['rotate']],\n        [SwipeRecognizer, {direction: DIRECTION_HORIZONTAL}],\n        [PanRecognizer, {direction: DIRECTION_HORIZONTAL}, ['swipe']],\n        [TapRecognizer],\n        [TapRecognizer, {event: 'doubletap', taps: 2}, ['tap']],\n        [PressRecognizer]\n    ],\n\n    /**\n     * Some CSS properties can be used to improve the working of Hammer.\n     * Add them to this method and they will be set when creating a new Manager.\n     * @namespace\n     */\n    cssProps: {\n        /**\n         * Disables text selection to improve the dragging gesture. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userSelect: 'none',\n\n        /**\n         * Disable the Windows Phone grippers when pressing an element.\n         * @type {String}\n         * @default 'none'\n         */\n        touchSelect: 'none',\n\n        /**\n         * Disables the default callout shown when you touch and hold a touch target.\n         * On iOS, when you touch and hold a touch target such as a link, Safari displays\n         * a callout containing information about the link. This property allows you to disable that callout.\n         * @type {String}\n         * @default 'none'\n         */\n        touchCallout: 'none',\n\n        /**\n         * Specifies whether zooming is enabled. Used by IE10>\n         * @type {String}\n         * @default 'none'\n         */\n        contentZooming: 'none',\n\n        /**\n         * Specifies that an entire element should be draggable instead of its contents. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userDrag: 'none',\n\n        /**\n         * Overrides the highlight color shown when the user taps a link or a JavaScript\n         * clickable element in iOS. This property obeys the alpha value, if specified.\n         * @type {String}\n         * @default 'rgba(0,0,0,0)'\n         */\n        tapHighlightColor: 'rgba(0,0,0,0)'\n    }\n};\n\nvar STOP = 1;\nvar FORCED_STOP = 2;\n\n/**\n * Manager\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Manager(element, options) {\n    this.options = assign({}, Hammer.defaults, options || {});\n\n    this.options.inputTarget = this.options.inputTarget || element;\n\n    this.handlers = {};\n    this.session = {};\n    this.recognizers = [];\n    this.oldCssProps = {};\n\n    this.element = element;\n    this.input = createInputInstance(this);\n    this.touchAction = new TouchAction(this, this.options.touchAction);\n\n    toggleCssProps(this, true);\n\n    each(this.options.recognizers, function(item) {\n        var recognizer = this.add(new (item[0])(item[1]));\n        item[2] && recognizer.recognizeWith(item[2]);\n        item[3] && recognizer.requireFailure(item[3]);\n    }, this);\n}\n\nManager.prototype = {\n    /**\n     * set options\n     * @param {Object} options\n     * @returns {Manager}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // Options that need a little more setup\n        if (options.touchAction) {\n            this.touchAction.update();\n        }\n        if (options.inputTarget) {\n            // Clean up existing event listeners and reinitialize\n            this.input.destroy();\n            this.input.target = options.inputTarget;\n            this.input.init();\n        }\n        return this;\n    },\n\n    /**\n     * stop recognizing for this session.\n     * This session will be discarded, when a new [input]start event is fired.\n     * When forced, the recognizer cycle is stopped immediately.\n     * @param {Boolean} [force]\n     */\n    stop: function(force) {\n        this.session.stopped = force ? FORCED_STOP : STOP;\n    },\n\n    /**\n     * run the recognizers!\n     * called by the inputHandler function on every movement of the pointers (touches)\n     * it walks through all the recognizers and tries to detect the gesture that is being made\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        var session = this.session;\n        if (session.stopped) {\n            return;\n        }\n\n        // run the touch-action polyfill\n        this.touchAction.preventDefaults(inputData);\n\n        var recognizer;\n        var recognizers = this.recognizers;\n\n        // this holds the recognizer that is being recognized.\n        // so the recognizer's state needs to be BEGAN, CHANGED, ENDED or RECOGNIZED\n        // if no recognizer is detecting a thing, it is set to `null`\n        var curRecognizer = session.curRecognizer;\n\n        // reset when the last recognizer is recognized\n        // or when we're in a new session\n        if (!curRecognizer || (curRecognizer && curRecognizer.state & STATE_RECOGNIZED)) {\n            curRecognizer = session.curRecognizer = null;\n        }\n\n        var i = 0;\n        while (i < recognizers.length) {\n            recognizer = recognizers[i];\n\n            // find out if we are allowed try to recognize the input for this one.\n            // 1.   allow if the session is NOT forced stopped (see the .stop() method)\n            // 2.   allow if we still haven't recognized a gesture in this session, or the this recognizer is the one\n            //      that is being recognized.\n            // 3.   allow if the recognizer is allowed to run simultaneous with the current recognized recognizer.\n            //      this can be setup with the `recognizeWith()` method on the recognizer.\n            if (session.stopped !== FORCED_STOP && ( // 1\n                    !curRecognizer || recognizer == curRecognizer || // 2\n                    recognizer.canRecognizeWith(curRecognizer))) { // 3\n                recognizer.recognize(inputData);\n            } else {\n                recognizer.reset();\n            }\n\n            // if the recognizer has been recognizing the input as a valid gesture, we want to store this one as the\n            // current active recognizer. but only if we don't already have an active recognizer\n            if (!curRecognizer && recognizer.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED)) {\n                curRecognizer = session.curRecognizer = recognizer;\n            }\n            i++;\n        }\n    },\n\n    /**\n     * get a recognizer by its event name.\n     * @param {Recognizer|String} recognizer\n     * @returns {Recognizer|Null}\n     */\n    get: function(recognizer) {\n        if (recognizer instanceof Recognizer) {\n            return recognizer;\n        }\n\n        var recognizers = this.recognizers;\n        for (var i = 0; i < recognizers.length; i++) {\n            if (recognizers[i].options.event == recognizer) {\n                return recognizers[i];\n            }\n        }\n        return null;\n    },\n\n    /**\n     * add a recognizer to the manager\n     * existing recognizers with the same event name will be removed\n     * @param {Recognizer} recognizer\n     * @returns {Recognizer|Manager}\n     */\n    add: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'add', this)) {\n            return this;\n        }\n\n        // remove existing\n        var existing = this.get(recognizer.options.event);\n        if (existing) {\n            this.remove(existing);\n        }\n\n        this.recognizers.push(recognizer);\n        recognizer.manager = this;\n\n        this.touchAction.update();\n        return recognizer;\n    },\n\n    /**\n     * remove a recognizer by name or instance\n     * @param {Recognizer|String} recognizer\n     * @returns {Manager}\n     */\n    remove: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'remove', this)) {\n            return this;\n        }\n\n        recognizer = this.get(recognizer);\n\n        // let's make sure this recognizer exists\n        if (recognizer) {\n            var recognizers = this.recognizers;\n            var index = inArray(recognizers, recognizer);\n\n            if (index !== -1) {\n                recognizers.splice(index, 1);\n                this.touchAction.update();\n            }\n        }\n\n        return this;\n    },\n\n    /**\n     * bind event\n     * @param {String} events\n     * @param {Function} handler\n     * @returns {EventEmitter} this\n     */\n    on: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n        if (handler === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            handlers[event] = handlers[event] || [];\n            handlers[event].push(handler);\n        });\n        return this;\n    },\n\n    /**\n     * unbind event, leave emit blank to remove all handlers\n     * @param {String} events\n     * @param {Function} [handler]\n     * @returns {EventEmitter} this\n     */\n    off: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            if (!handler) {\n                delete handlers[event];\n            } else {\n                handlers[event] && handlers[event].splice(inArray(handlers[event], handler), 1);\n            }\n        });\n        return this;\n    },\n\n    /**\n     * emit event to the listeners\n     * @param {String} event\n     * @param {Object} data\n     */\n    emit: function(event, data) {\n        // we also want to trigger dom events\n        if (this.options.domEvents) {\n            triggerDomEvent(event, data);\n        }\n\n        // no handlers, so skip it all\n        var handlers = this.handlers[event] && this.handlers[event].slice();\n        if (!handlers || !handlers.length) {\n            return;\n        }\n\n        data.type = event;\n        data.preventDefault = function() {\n            data.srcEvent.preventDefault();\n        };\n\n        var i = 0;\n        while (i < handlers.length) {\n            handlers[i](data);\n            i++;\n        }\n    },\n\n    /**\n     * destroy the manager and unbinds all events\n     * it doesn't unbind dom events, that is the user own responsibility\n     */\n    destroy: function() {\n        this.element && toggleCssProps(this, false);\n\n        this.handlers = {};\n        this.session = {};\n        this.input.destroy();\n        this.element = null;\n    }\n};\n\n/**\n * add/remove the css properties as defined in manager.options.cssProps\n * @param {Manager} manager\n * @param {Boolean} add\n */\nfunction toggleCssProps(manager, add) {\n    var element = manager.element;\n    if (!element.style) {\n        return;\n    }\n    var prop;\n    each(manager.options.cssProps, function(value, name) {\n        prop = prefixed(element.style, name);\n        if (add) {\n            manager.oldCssProps[prop] = element.style[prop];\n            element.style[prop] = value;\n        } else {\n            element.style[prop] = manager.oldCssProps[prop] || '';\n        }\n    });\n    if (!add) {\n        manager.oldCssProps = {};\n    }\n}\n\n/**\n * trigger dom event\n * @param {String} event\n * @param {Object} data\n */\nfunction triggerDomEvent(event, data) {\n    var gestureEvent = document.createEvent('Event');\n    gestureEvent.initEvent(event, true, true);\n    gestureEvent.gesture = data;\n    data.target.dispatchEvent(gestureEvent);\n}\n\nassign(Hammer, {\n    INPUT_START: INPUT_START,\n    INPUT_MOVE: INPUT_MOVE,\n    INPUT_END: INPUT_END,\n    INPUT_CANCEL: INPUT_CANCEL,\n\n    STATE_POSSIBLE: STATE_POSSIBLE,\n    STATE_BEGAN: STATE_BEGAN,\n    STATE_CHANGED: STATE_CHANGED,\n    STATE_ENDED: STATE_ENDED,\n    STATE_RECOGNIZED: STATE_RECOGNIZED,\n    STATE_CANCELLED: STATE_CANCELLED,\n    STATE_FAILED: STATE_FAILED,\n\n    DIRECTION_NONE: DIRECTION_NONE,\n    DIRECTION_LEFT: DIRECTION_LEFT,\n    DIRECTION_RIGHT: DIRECTION_RIGHT,\n    DIRECTION_UP: DIRECTION_UP,\n    DIRECTION_DOWN: DIRECTION_DOWN,\n    DIRECTION_HORIZONTAL: DIRECTION_HORIZONTAL,\n    DIRECTION_VERTICAL: DIRECTION_VERTICAL,\n    DIRECTION_ALL: DIRECTION_ALL,\n\n    Manager: Manager,\n    Input: Input,\n    TouchAction: TouchAction,\n\n    TouchInput: TouchInput,\n    MouseInput: MouseInput,\n    PointerEventInput: PointerEventInput,\n    TouchMouseInput: TouchMouseInput,\n    SingleTouchInput: SingleTouchInput,\n\n    Recognizer: Recognizer,\n    AttrRecognizer: AttrRecognizer,\n    Tap: TapRecognizer,\n    Pan: PanRecognizer,\n    Swipe: SwipeRecognizer,\n    Pinch: PinchRecognizer,\n    Rotate: RotateRecognizer,\n    Press: PressRecognizer,\n\n    on: addEventListeners,\n    off: removeEventListeners,\n    each: each,\n    merge: merge,\n    extend: extend,\n    assign: assign,\n    inherit: inherit,\n    bindFn: bindFn,\n    prefixed: prefixed\n});\n\n// this prevents errors when Hammer is loaded in the presence of an AMD\n//  style loader but by script tag, not by the loader.\nvar freeGlobal = (typeof window !== 'undefined' ? window : (typeof self !== 'undefined' ? self : {})); // jshint ignore:line\nfreeGlobal.Hammer = Hammer;\n\nif (typeof define === 'function' && define.amd) {\n    define(function() {\n        return Hammer;\n    });\n} else if (typeof module != 'undefined' && module.exports) {\n    module.exports = Hammer;\n} else {\n    window[exportName] = Hammer;\n}\n\n})(window, document, 'Hammer');\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/hammerjs/hammer.js\n ** module id = 37\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_38__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"TweenLite\"\n ** module id = 38\n ** module chunks = 0\n **/","import TileLayer from './TileLayer';\nimport ImageTile from './ImageTile';\nimport ImageTileLayerBaseMaterial from './ImageTileLayerBaseMaterial';\nimport throttle from 'lodash.throttle';\nimport THREE from 'three';\nimport extend from 'lodash.assign';\n\n// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\n// DONE: Find a way to avoid the flashing caused by the gap between old tiles\n// being removed and the new tiles being ready for display\n//\n// DONE: Simplest first step for MVP would be to give each tile mesh the colour\n// of the basemap ground so it blends in a little more, or have a huge ground\n// plane underneath all the tiles that shows through between tile updates.\n//\n// Could keep the old tiles around until the new ones are ready, though they'd\n// probably need to be layered in a way so the old tiles don't overlap new ones,\n// which is similar to how Leaflet approaches this (it has 2 layers)\n//\n// Could keep the tile from the previous quadtree level visible until all 4\n// tiles at the new / current level have finished loading and are displayed.\n// Perhaps by keeping a map of tiles by quadcode and a boolean for each of the\n// child quadcodes showing whether they are loaded and in view. If all true then\n// remove the parent tile, otherwise keep it on a lower layer.\n\n// TODO: Load and display a base layer separate to the LOD grid that is at a low\n// resolution – used as a backup / background to fill in empty areas / distance\n\n// DONE: Fix the issue where some tiles just don't load, or at least the texture\n// never shows up – tends to happen if you quickly zoom in / out past it while\n// it's still loading, leaving a blank space\n\n// TODO: Optimise the request of many image tiles – look at how Leaflet and\n// OpenWebGlobe approach this (eg. batching, queues, etc)\n\n// TODO: Cancel pending tile requests if they get removed from view before they\n// reach a ready state (eg. cancel image requests, etc). Need to ensure that the\n// images are re-requested when the tile is next in scene (even if from cache)\n\n// TODO: Consider not performing an LOD calculation on every frame, instead only\n// on move end so panning, orbiting and zooming stays smooth. Otherwise it's\n// possible for performance to tank if you pan, orbit or zoom rapidly while all\n// the LOD calculations are being made and new tiles requested.\n//\n// Pending tiles should continue to be requested and output to the scene on each\n// frame, but no new LOD calculations should be made.\n\n// This tile layer both updates the quadtree and outputs tiles on every frame\n// (throttled to some amount)\n//\n// This is because the computational complexity of image tiles is generally low\n// and so there isn't much jank when running these calculations and outputs in\n// realtime\n//\n// The benefit to doing this is that the underlying map layer continues to\n// refresh and update during movement, which is an arguably better experience\n\nclass ImageTileLayer extends TileLayer {\n  constructor(path, options) {\n    var defaults = {\n      distance: 300000\n    };\n\n    options = extend({}, defaults, options);\n\n    super(options);\n\n    this._path = path;\n  }\n\n  _onAdd(world) {\n    super._onAdd(world);\n\n    // Add base layer\n    var geom = new THREE.PlaneBufferGeometry(2000000, 2000000, 1);\n\n    var baseMaterial;\n    if (this._world._environment._skybox) {\n      baseMaterial = ImageTileLayerBaseMaterial('#f5f5f3', this._world._environment._skybox.getRenderTarget());\n    } else {\n      baseMaterial = ImageTileLayerBaseMaterial('#f5f5f3');\n    }\n\n    var mesh = new THREE.Mesh(geom, baseMaterial);\n    mesh.renderOrder = 0;\n    mesh.rotation.x = -90 * Math.PI / 180;\n\n    // TODO: It might be overkill to receive a shadow on the base layer as it's\n    // rarely seen (good to have if performance difference is negligible)\n    mesh.receiveShadow = true;\n\n    this._baseLayer = mesh;\n    this.add(mesh);\n\n    // Trigger initial quadtree calculation on the next frame\n    //\n    // TODO: This is a hack to ensure the camera is all set up - a better\n    // solution should be found\n    setTimeout(() => {\n      this._calculateLOD();\n      this._initEvents();\n    }, 0);\n  }\n\n  _initEvents() {\n    // Run LOD calculations based on render calls\n    //\n    // Throttled to 1 LOD calculation per 100ms\n    this._throttledWorldUpdate = throttle(this._onWorldUpdate, 100);\n\n    this._world.on('preUpdate', this._throttledWorldUpdate, this);\n    this._world.on('move', this._onWorldMove, this);\n  }\n\n  _onWorldUpdate() {\n    this._calculateLOD();\n    this._outputTiles();\n  }\n\n  _onWorldMove(latlon, point) {\n    this._moveBaseLayer(point);\n  }\n\n  _moveBaseLayer(point) {\n    this._baseLayer.position.x = point.x;\n    this._baseLayer.position.z = point.y;\n  }\n\n  _createTile(quadcode, layer) {\n    return new ImageTile(quadcode, this._path, layer);\n  }\n\n  // Destroys the layer and removes it from the scene and memory\n  destroy() {\n    this._world.off('preUpdate', this._throttledWorldUpdate);\n    this._world.off('move', this._onWorldMove);\n\n    this._throttledWorldUpdate = null;\n\n    // Dispose of mesh and materials\n    this._baseLayer.geometry.dispose();\n    this._baseLayer.geometry = null;\n\n    if (this._baseLayer.material.map) {\n      this._baseLayer.material.map.dispose();\n      this._baseLayer.material.map = null;\n    }\n\n    this._baseLayer.material.dispose();\n    this._baseLayer.material = null;\n\n    this._baseLayer = null;\n\n    // Run common destruction logic from parent\n    super.destroy();\n  }\n}\n\nexport default ImageTileLayer;\n\nvar noNew = function(path, options) {\n  return new ImageTileLayer(path, options);\n};\n\n// Initialise without requiring new keyword\nexport {noNew as imageTileLayer};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/tile/ImageTileLayer.js\n **/","import Layer from '../Layer';\nimport extend from 'lodash.assign';\nimport TileCache from './TileCache';\nimport THREE from 'three';\n\n// TODO: Consider removing picking from TileLayer instances as there aren't\n// (m)any situations where it would be practical\n//\n// For example, how would you even know what picking IDs to listen to and what\n// to do with them?\n\n// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\n// TODO: Consider keeping a single TileLayer / LOD instance running by default\n// that keeps a standard LOD grid for other layers to utilise, rather than\n// having to create their own, unique LOD grid and duplicate calculations when\n// they're going to use the same grid setup anyway\n//\n// It still makes sense to be able to have a custom LOD grid for some layers as\n// they may want to customise things, maybe not even using a quadtree at all!\n//\n// Perhaps it makes sense to split out the quadtree stuff into a singleton and\n// pass in the necessary parameters each time for the calculation step.\n//\n// Either way, it seems silly to force layers to have to create a new LOD grid\n// each time and create extra, duplicated processing every frame.\n\n// TODO: Allow passing in of options to define min/max LOD and a distance to use\n// for culling tiles beyond that distance.\n\n// DONE: Prevent tiles from being loaded if they are further than a certain\n// distance from the camera and are unlikely to be seen anyway\n\n// TODO: Avoid performing LOD calculation when it isn't required. For example,\n// when nothing has changed since the last frame and there are no tiles to be\n// loaded or in need of rendering\n\n// TODO: Only remove tiles from the layer that aren't to be rendered in the\n// current frame – it seems excessive to remove all tiles and re-add them on\n// every single frame, even if it's just array manipulation\n\n// TODO: Fix LOD calculation so min and max LOD can be changed without causing\n// problems (eg. making min above 5 causes all sorts of issues)\n\n// TODO: Reuse THREE objects where possible instead of creating new instances\n// on every LOD calculation\n\n// TODO: Consider not using THREE or LatLon / Point objects in LOD calculations\n// to avoid creating unnecessary memory for garbage collection\n\n// TODO: Prioritise loading of tiles at highest level in the quadtree (those\n// closest to the camera) so visual inconsistancies during loading are minimised\n\nclass TileLayer extends Layer {\n  constructor(options) {\n    var defaults = {\n      picking: false,\n      maxCache: 1000,\n      maxLOD: 18\n    };\n\n    var _options = extend({}, defaults, options);\n\n    super(_options);\n\n    this._tileCache = new TileCache(this._options.maxCache, tile => {\n      this._destroyTile(tile);\n    });\n\n    // List of tiles from the previous LOD calculation\n    this._tileList = [];\n\n    // TODO: Work out why changing the minLOD causes loads of issues\n    this._minLOD = 3;\n    this._maxLOD = this._options.maxLOD;\n\n    this._frustum = new THREE.Frustum();\n    this._tiles = new THREE.Object3D();\n    this._tilesPicking = new THREE.Object3D();\n  }\n\n  _onAdd(world) {\n    this.addToPicking(this._tilesPicking);\n    this.add(this._tiles);\n  }\n\n  _updateFrustum() {\n    var camera = this._world.getCamera();\n    var projScreenMatrix = new THREE.Matrix4();\n    projScreenMatrix.multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse);\n\n    this._frustum.setFromMatrix(camera.projectionMatrix);\n    this._frustum.setFromMatrix(new THREE.Matrix4().multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse));\n  }\n\n  _tileInFrustum(tile) {\n    var bounds = tile.getBounds();\n    return this._frustum.intersectsBox(new THREE.Box3(new THREE.Vector3(bounds[0], 0, bounds[3]), new THREE.Vector3(bounds[2], 0, bounds[1])));\n  }\n\n  // Update and output tiles from the previous LOD checklist\n  _outputTiles() {\n    if (!this._tiles) {\n      return;\n    }\n\n    // Remove all tiles from layer\n    this._removeTiles();\n\n    // Add / re-add tiles\n    this._tileList.forEach(tile => {\n      // Are the mesh and texture ready?\n      //\n      // If yes, continue\n      // If no, skip\n      if (!tile.isReady()) {\n        return;\n      }\n\n      // Add tile to layer (and to scene) if not already there\n      this._tiles.add(tile.getMesh());\n\n      if (tile.getPickingMesh()) {\n        this._tilesPicking.add(tile.getPickingMesh());\n      }\n    });\n  }\n\n  // Works out tiles in the view frustum and stores them in an array\n  //\n  // Does not output the tiles, deferring this to _outputTiles()\n  _calculateLOD() {\n    if (this._stop || !this._world) {\n      return;\n    }\n\n    // var start = performance.now();\n\n    var camera = this._world.getCamera();\n\n    // 1. Update and retrieve camera frustum\n    this._updateFrustum(this._frustum, camera);\n\n    // 2. Add the four root items of the quadtree to a check list\n    var checkList = this._checklist;\n    checkList = [];\n    checkList.push(this._requestTile('0', this));\n    checkList.push(this._requestTile('1', this));\n    checkList.push(this._requestTile('2', this));\n    checkList.push(this._requestTile('3', this));\n\n    // 3. Call Divide, passing in the check list\n    this._divide(checkList);\n\n    // // 4. Remove all tiles from layer\n    //\n    // Moved to _outputTiles() for now\n    // this._removeTiles();\n\n    // Order tile-list by zoom so nearest tiles are requested first\n    checkList.sort((a, b) => {\n      return a._quadcode.length < b._quadcode.length;\n    });\n\n    // 5. Filter the tiles remaining in the check list\n    this._tileList = checkList.filter((tile, index) => {\n      // Skip tile if it's not in the current view frustum\n      if (!this._tileInFrustum(tile)) {\n        return false;\n      }\n\n      if (this._options.distance && this._options.distance > 0) {\n        // TODO: Can probably speed this up\n        var center = tile.getCenter();\n        var dist = (new THREE.Vector3(center[0], 0, center[1])).sub(camera.position).length();\n\n        // Manual distance limit to cut down on tiles so far away\n        if (dist > this._options.distance) {\n          return false;\n        }\n      }\n\n      // Does the tile have a mesh?\n      //\n      // If yes, continue\n      // If no, generate tile mesh, request texture and skip\n      if (!tile.getMesh()) {\n        tile.requestTileAsync();\n      }\n\n      return true;\n\n      // Are the mesh and texture ready?\n      //\n      // If yes, continue\n      // If no, skip\n      // if (!tile.isReady()) {\n      //   return;\n      // }\n      //\n      // // Add tile to layer (and to scene)\n      // this._tiles.add(tile.getMesh());\n    });\n\n    // console.log(performance.now() - start);\n  }\n\n  _divide(checkList) {\n    var count = 0;\n    var currentItem;\n    var quadcode;\n\n    // 1. Loop until count equals check list length\n    while (count != checkList.length) {\n      currentItem = checkList[count];\n      quadcode = currentItem.getQuadcode();\n\n      // 2. Increase count and continue loop if quadcode equals max LOD / zoom\n      if (currentItem.length === this._maxLOD) {\n        count++;\n        continue;\n      }\n\n      // 3. Else, calculate screen-space error metric for quadcode\n      if (this._screenSpaceError(currentItem)) {\n        // 4. If error is sufficient...\n\n        // 4a. Remove parent item from the check list\n        checkList.splice(count, 1);\n\n        // 4b. Add 4 child items to the check list\n        checkList.push(this._requestTile(quadcode + '0', this));\n        checkList.push(this._requestTile(quadcode + '1', this));\n        checkList.push(this._requestTile(quadcode + '2', this));\n        checkList.push(this._requestTile(quadcode + '3', this));\n\n        // 4d. Continue the loop without increasing count\n        continue;\n      } else {\n        // 5. Else, increase count and continue loop\n        count++;\n      }\n    }\n  }\n\n  _screenSpaceError(tile) {\n    var minDepth = this._minLOD;\n    var maxDepth = this._maxLOD;\n\n    var quadcode = tile.getQuadcode();\n\n    var camera = this._world.getCamera();\n\n    // Tweak this value to refine specific point that each quad is subdivided\n    //\n    // It's used to multiple the dimensions of the tile sides before\n    // comparing against the tile distance from camera\n    var quality = 3.0;\n\n    // 1. Return false if quadcode length equals maxDepth (stop dividing)\n    if (quadcode.length === maxDepth) {\n      return false;\n    }\n\n    // 2. Return true if quadcode length is less than minDepth\n    if (quadcode.length < minDepth) {\n      return true;\n    }\n\n    // 3. Return false if quadcode bounds are not in view frustum\n    if (!this._tileInFrustum(tile)) {\n      return false;\n    }\n\n    var center = tile.getCenter();\n\n    // 4. Calculate screen-space error metric\n    // TODO: Use closest distance to one of the 4 tile corners\n    var dist = (new THREE.Vector3(center[0], 0, center[1])).sub(camera.position).length();\n\n    var error = quality * tile.getSide() / dist;\n\n    // 5. Return true if error is greater than 1.0, else return false\n    return (error > 1.0);\n  }\n\n  _removeTiles() {\n    if (!this._tiles || !this._tiles.children) {\n      return;\n    }\n\n    for (var i = this._tiles.children.length - 1; i >= 0; i--) {\n      this._tiles.remove(this._tiles.children[i]);\n    }\n\n    if (!this._tilesPicking || !this._tilesPicking.children) {\n      return;\n    }\n\n    for (var i = this._tilesPicking.children.length - 1; i >= 0; i--) {\n      this._tilesPicking.remove(this._tilesPicking.children[i]);\n    }\n  }\n\n  // Return a new tile instance\n  _createTile(quadcode, layer) {}\n\n  // Get a cached tile or request a new one if not in cache\n  _requestTile(quadcode, layer) {\n    var tile = this._tileCache.getTile(quadcode);\n\n    if (!tile) {\n      // Set up a brand new tile\n      tile = this._createTile(quadcode, layer);\n\n      // Add tile to cache, though it won't be ready yet as the data is being\n      // requested from various places asynchronously\n      this._tileCache.setTile(quadcode, tile);\n    }\n\n    return tile;\n  }\n\n  _destroyTile(tile) {\n    // Remove tile from scene\n    this._tiles.remove(tile.getMesh());\n\n    // Delete any references to the tile within this component\n\n    // Call destory on tile instance\n    tile.destroy();\n  }\n\n  // Destroys the layer and removes it from the scene and memory\n  destroy() {\n    if (this._tiles.children) {\n      // Remove all tiles\n      for (var i = this._tiles.children.length - 1; i >= 0; i--) {\n        this._tiles.remove(this._tiles.children[i]);\n      }\n    }\n\n    // Remove tile from picking scene\n    this.removeFromPicking(this._tilesPicking);\n\n    if (this._tilesPicking.children) {\n      // Remove all tiles\n      for (var i = this._tilesPicking.children.length - 1; i >= 0; i--) {\n        this._tilesPicking.remove(this._tilesPicking.children[i]);\n      }\n    }\n\n    this._tileCache.destroy();\n    this._tileCache = null;\n\n    this._tiles = null;\n    this._tilesPicking = null;\n    this._frustum = null;\n\n    super.destroy();\n  }\n}\n\nexport default TileLayer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/tile/TileLayer.js\n **/","import LRUCache from 'lru-cache';\n\n// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\n// This process is based on a similar approach taken by OpenWebGlobe\n// See: https://github.com/OpenWebGlobe/WebViewer/blob/master/source/core/globecache.js\n\nclass TileCache {\n  constructor(cacheLimit, onDestroyTile) {\n    this._cache = LRUCache({\n      max: cacheLimit,\n      dispose: (key, tile) => {\n        onDestroyTile(tile);\n      }\n    });\n  }\n\n  // Returns true if all specified tile providers are ready to be used\n  // Otherwise, returns false\n  isReady() {\n    return false;\n  }\n\n  // Get a cached tile without requesting a new one\n  getTile(quadcode) {\n    return this._cache.get(quadcode);\n  }\n\n  // Add tile to cache\n  setTile(quadcode, tile) {\n    this._cache.set(quadcode, tile);\n  }\n\n  // Destroy the cache and remove it from memory\n  //\n  // TODO: Call destroy method on items in cache\n  destroy() {\n    this._cache.reset();\n    this._cache = null;\n  }\n}\n\nexport default TileCache;\n\nvar noNew = function(cacheLimit, onDestroyTile) {\n  return new TileCache(cacheLimit, onDestroyTile);\n};\n\n// Initialise without requiring new keyword\nexport {noNew as tileCache};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/tile/TileCache.js\n **/","module.exports = LRUCache\n\n// This will be a proper iterable 'Map' in engines that support it,\n// or a fakey-fake PseudoMap in older versions.\nvar Map = require('pseudomap')\nvar util = require('util')\n\n// A linked list to keep track of recently-used-ness\nvar Yallist = require('yallist')\n\n// use symbols if possible, otherwise just _props\nvar symbols = {}\nvar hasSymbol = typeof Symbol === 'function'\nvar makeSymbol\n/* istanbul ignore if */\nif (hasSymbol) {\n  makeSymbol = function (key) {\n    return Symbol.for(key)\n  }\n} else {\n  makeSymbol = function (key) {\n    return '_' + key\n  }\n}\n\nfunction priv (obj, key, val) {\n  var sym\n  if (symbols[key]) {\n    sym = symbols[key]\n  } else {\n    sym = makeSymbol(key)\n    symbols[key] = sym\n  }\n  if (arguments.length === 2) {\n    return obj[sym]\n  } else {\n    obj[sym] = val\n    return val\n  }\n}\n\nfunction naiveLength () { return 1 }\n\n// lruList is a yallist where the head is the youngest\n// item, and the tail is the oldest.  the list contains the Hit\n// objects as the entries.\n// Each Hit object has a reference to its Yallist.Node.  This\n// never changes.\n//\n// cache is a Map (or PseudoMap) that matches the keys to\n// the Yallist.Node object.\nfunction LRUCache (options) {\n  if (!(this instanceof LRUCache)) {\n    return new LRUCache(options)\n  }\n\n  if (typeof options === 'number') {\n    options = { max: options }\n  }\n\n  if (!options) {\n    options = {}\n  }\n\n  var max = priv(this, 'max', options.max)\n  // Kind of weird to have a default max of Infinity, but oh well.\n  if (!max ||\n      !(typeof max === 'number') ||\n      max <= 0) {\n    priv(this, 'max', Infinity)\n  }\n\n  var lc = options.length || naiveLength\n  if (typeof lc !== 'function') {\n    lc = naiveLength\n  }\n  priv(this, 'lengthCalculator', lc)\n\n  priv(this, 'allowStale', options.stale || false)\n  priv(this, 'maxAge', options.maxAge || 0)\n  priv(this, 'dispose', options.dispose)\n  this.reset()\n}\n\n// resize the cache when the max changes.\nObject.defineProperty(LRUCache.prototype, 'max', {\n  set: function (mL) {\n    if (!mL || !(typeof mL === 'number') || mL <= 0) {\n      mL = Infinity\n    }\n    priv(this, 'max', mL)\n    trim(this)\n  },\n  get: function () {\n    return priv(this, 'max')\n  },\n  enumerable: true\n})\n\nObject.defineProperty(LRUCache.prototype, 'allowStale', {\n  set: function (allowStale) {\n    priv(this, 'allowStale', !!allowStale)\n  },\n  get: function () {\n    return priv(this, 'allowStale')\n  },\n  enumerable: true\n})\n\nObject.defineProperty(LRUCache.prototype, 'maxAge', {\n  set: function (mA) {\n    if (!mA || !(typeof mA === 'number') || mA < 0) {\n      mA = 0\n    }\n    priv(this, 'maxAge', mA)\n    trim(this)\n  },\n  get: function () {\n    return priv(this, 'maxAge')\n  },\n  enumerable: true\n})\n\n// resize the cache when the lengthCalculator changes.\nObject.defineProperty(LRUCache.prototype, 'lengthCalculator', {\n  set: function (lC) {\n    if (typeof lC !== 'function') {\n      lC = naiveLength\n    }\n    if (lC !== priv(this, 'lengthCalculator')) {\n      priv(this, 'lengthCalculator', lC)\n      priv(this, 'length', 0)\n      priv(this, 'lruList').forEach(function (hit) {\n        hit.length = priv(this, 'lengthCalculator').call(this, hit.value, hit.key)\n        priv(this, 'length', priv(this, 'length') + hit.length)\n      }, this)\n    }\n    trim(this)\n  },\n  get: function () { return priv(this, 'lengthCalculator') },\n  enumerable: true\n})\n\nObject.defineProperty(LRUCache.prototype, 'length', {\n  get: function () { return priv(this, 'length') },\n  enumerable: true\n})\n\nObject.defineProperty(LRUCache.prototype, 'itemCount', {\n  get: function () { return priv(this, 'lruList').length },\n  enumerable: true\n})\n\nLRUCache.prototype.rforEach = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = priv(this, 'lruList').tail; walker !== null;) {\n    var prev = walker.prev\n    forEachStep(this, fn, walker, thisp)\n    walker = prev\n  }\n}\n\nfunction forEachStep (self, fn, node, thisp) {\n  var hit = node.value\n  if (isStale(self, hit)) {\n    del(self, node)\n    if (!priv(self, 'allowStale')) {\n      hit = undefined\n    }\n  }\n  if (hit) {\n    fn.call(thisp, hit.value, hit.key, self)\n  }\n}\n\nLRUCache.prototype.forEach = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = priv(this, 'lruList').head; walker !== null;) {\n    var next = walker.next\n    forEachStep(this, fn, walker, thisp)\n    walker = next\n  }\n}\n\nLRUCache.prototype.keys = function () {\n  return priv(this, 'lruList').toArray().map(function (k) {\n    return k.key\n  }, this)\n}\n\nLRUCache.prototype.values = function () {\n  return priv(this, 'lruList').toArray().map(function (k) {\n    return k.value\n  }, this)\n}\n\nLRUCache.prototype.reset = function () {\n  if (priv(this, 'dispose') &&\n      priv(this, 'lruList') &&\n      priv(this, 'lruList').length) {\n    priv(this, 'lruList').forEach(function (hit) {\n      priv(this, 'dispose').call(this, hit.key, hit.value)\n    }, this)\n  }\n\n  priv(this, 'cache', new Map()) // hash of items by key\n  priv(this, 'lruList', new Yallist()) // list of items in order of use recency\n  priv(this, 'length', 0) // length of items in the list\n}\n\nLRUCache.prototype.dump = function () {\n  return priv(this, 'lruList').map(function (hit) {\n    if (!isStale(this, hit)) {\n      return {\n        k: hit.key,\n        v: hit.value,\n        e: hit.now + (hit.maxAge || 0)\n      }\n    }\n  }, this).toArray().filter(function (h) {\n    return h\n  })\n}\n\nLRUCache.prototype.dumpLru = function () {\n  return priv(this, 'lruList')\n}\n\nLRUCache.prototype.inspect = function (n, opts) {\n  var str = 'LRUCache {'\n  var extras = false\n\n  var as = priv(this, 'allowStale')\n  if (as) {\n    str += '\\n  allowStale: true'\n    extras = true\n  }\n\n  var max = priv(this, 'max')\n  if (max && max !== Infinity) {\n    if (extras) {\n      str += ','\n    }\n    str += '\\n  max: ' + util.inspect(max, opts)\n    extras = true\n  }\n\n  var maxAge = priv(this, 'maxAge')\n  if (maxAge) {\n    if (extras) {\n      str += ','\n    }\n    str += '\\n  maxAge: ' + util.inspect(maxAge, opts)\n    extras = true\n  }\n\n  var lc = priv(this, 'lengthCalculator')\n  if (lc && lc !== naiveLength) {\n    if (extras) {\n      str += ','\n    }\n    str += '\\n  length: ' + util.inspect(priv(this, 'length'), opts)\n    extras = true\n  }\n\n  var didFirst = false\n  priv(this, 'lruList').forEach(function (item) {\n    if (didFirst) {\n      str += ',\\n  '\n    } else {\n      if (extras) {\n        str += ',\\n'\n      }\n      didFirst = true\n      str += '\\n  '\n    }\n    var key = util.inspect(item.key).split('\\n').join('\\n  ')\n    var val = { value: item.value }\n    if (item.maxAge !== maxAge) {\n      val.maxAge = item.maxAge\n    }\n    if (lc !== naiveLength) {\n      val.length = item.length\n    }\n    if (isStale(this, item)) {\n      val.stale = true\n    }\n\n    val = util.inspect(val, opts).split('\\n').join('\\n  ')\n    str += key + ' => ' + val\n  })\n\n  if (didFirst || extras) {\n    str += '\\n'\n  }\n  str += '}'\n\n  return str\n}\n\nLRUCache.prototype.set = function (key, value, maxAge) {\n  maxAge = maxAge || priv(this, 'maxAge')\n\n  var now = maxAge ? Date.now() : 0\n  var len = priv(this, 'lengthCalculator').call(this, value, key)\n\n  if (priv(this, 'cache').has(key)) {\n    if (len > priv(this, 'max')) {\n      del(this, priv(this, 'cache').get(key))\n      return false\n    }\n\n    var node = priv(this, 'cache').get(key)\n    var item = node.value\n\n    // dispose of the old one before overwriting\n    if (priv(this, 'dispose')) {\n      priv(this, 'dispose').call(this, key, item.value)\n    }\n\n    item.now = now\n    item.maxAge = maxAge\n    item.value = value\n    priv(this, 'length', priv(this, 'length') + (len - item.length))\n    item.length = len\n    this.get(key)\n    trim(this)\n    return true\n  }\n\n  var hit = new Entry(key, value, len, now, maxAge)\n\n  // oversized objects fall out of cache automatically.\n  if (hit.length > priv(this, 'max')) {\n    if (priv(this, 'dispose')) {\n      priv(this, 'dispose').call(this, key, value)\n    }\n    return false\n  }\n\n  priv(this, 'length', priv(this, 'length') + hit.length)\n  priv(this, 'lruList').unshift(hit)\n  priv(this, 'cache').set(key, priv(this, 'lruList').head)\n  trim(this)\n  return true\n}\n\nLRUCache.prototype.has = function (key) {\n  if (!priv(this, 'cache').has(key)) return false\n  var hit = priv(this, 'cache').get(key).value\n  if (isStale(this, hit)) {\n    return false\n  }\n  return true\n}\n\nLRUCache.prototype.get = function (key) {\n  return get(this, key, true)\n}\n\nLRUCache.prototype.peek = function (key) {\n  return get(this, key, false)\n}\n\nLRUCache.prototype.pop = function () {\n  var node = priv(this, 'lruList').tail\n  if (!node) return null\n  del(this, node)\n  return node.value\n}\n\nLRUCache.prototype.del = function (key) {\n  del(this, priv(this, 'cache').get(key))\n}\n\nLRUCache.prototype.load = function (arr) {\n  // reset the cache\n  this.reset()\n\n  var now = Date.now()\n  // A previous serialized cache has the most recent items first\n  for (var l = arr.length - 1; l >= 0; l--) {\n    var hit = arr[l]\n    var expiresAt = hit.e || 0\n    if (expiresAt === 0) {\n      // the item was created without expiration in a non aged cache\n      this.set(hit.k, hit.v)\n    } else {\n      var maxAge = expiresAt - now\n      // dont add already expired items\n      if (maxAge > 0) {\n        this.set(hit.k, hit.v, maxAge)\n      }\n    }\n  }\n}\n\nLRUCache.prototype.prune = function () {\n  var self = this\n  priv(this, 'cache').forEach(function (value, key) {\n    get(self, key, false)\n  })\n}\n\nfunction get (self, key, doUse) {\n  var node = priv(self, 'cache').get(key)\n  if (node) {\n    var hit = node.value\n    if (isStale(self, hit)) {\n      del(self, node)\n      if (!priv(self, 'allowStale')) hit = undefined\n    } else {\n      if (doUse) {\n        priv(self, 'lruList').unshiftNode(node)\n      }\n    }\n    if (hit) hit = hit.value\n  }\n  return hit\n}\n\nfunction isStale (self, hit) {\n  if (!hit || (!hit.maxAge && !priv(self, 'maxAge'))) {\n    return false\n  }\n  var stale = false\n  var diff = Date.now() - hit.now\n  if (hit.maxAge) {\n    stale = diff > hit.maxAge\n  } else {\n    stale = priv(self, 'maxAge') && (diff > priv(self, 'maxAge'))\n  }\n  return stale\n}\n\nfunction trim (self) {\n  if (priv(self, 'length') > priv(self, 'max')) {\n    for (var walker = priv(self, 'lruList').tail;\n         priv(self, 'length') > priv(self, 'max') && walker !== null;) {\n      // We know that we're about to delete this one, and also\n      // what the next least recently used key will be, so just\n      // go ahead and set it now.\n      var prev = walker.prev\n      del(self, walker)\n      walker = prev\n    }\n  }\n}\n\nfunction del (self, node) {\n  if (node) {\n    var hit = node.value\n    if (priv(self, 'dispose')) {\n      priv(self, 'dispose').call(this, hit.key, hit.value)\n    }\n    priv(self, 'length', priv(self, 'length') - hit.length)\n    priv(self, 'cache').delete(hit.key)\n    priv(self, 'lruList').removeNode(node)\n  }\n}\n\n// classy, since V8 prefers predictable objects.\nfunction Entry (key, value, length, now, maxAge) {\n  this.key = key\n  this.value = value\n  this.length = length\n  this.now = now\n  this.maxAge = maxAge || 0\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/lru-cache/lib/lru-cache.js\n ** module id = 42\n ** module chunks = 0\n **/","if (process.env.npm_package_name === 'pseudomap' &&\n    process.env.npm_lifecycle_script === 'test')\n  process.env.TEST_PSEUDOMAP = 'true'\n\nif (typeof Map === 'function' && !process.env.TEST_PSEUDOMAP) {\n  module.exports = Map\n} else {\n  module.exports = require('./pseudomap')\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/pseudomap/map.js\n ** module id = 43\n ** module chunks = 0\n **/","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/process/browser.js\n ** module id = 44\n ** module chunks = 0\n **/","var hasOwnProperty = Object.prototype.hasOwnProperty\n\nmodule.exports = PseudoMap\n\nfunction PseudoMap (set) {\n  if (!(this instanceof PseudoMap)) // whyyyyyyy\n    throw new TypeError(\"Constructor PseudoMap requires 'new'\")\n\n  this.clear()\n\n  if (set) {\n    if ((set instanceof PseudoMap) ||\n        (typeof Map === 'function' && set instanceof Map))\n      set.forEach(function (value, key) {\n        this.set(key, value)\n      }, this)\n    else if (Array.isArray(set))\n      set.forEach(function (kv) {\n        this.set(kv[0], kv[1])\n      }, this)\n    else\n      throw new TypeError('invalid argument')\n  }\n}\n\nPseudoMap.prototype.forEach = function (fn, thisp) {\n  thisp = thisp || this\n  Object.keys(this._data).forEach(function (k) {\n    if (k !== 'size')\n      fn.call(thisp, this._data[k].value, this._data[k].key)\n  }, this)\n}\n\nPseudoMap.prototype.has = function (k) {\n  return !!find(this._data, k)\n}\n\nPseudoMap.prototype.get = function (k) {\n  var res = find(this._data, k)\n  return res && res.value\n}\n\nPseudoMap.prototype.set = function (k, v) {\n  set(this._data, k, v)\n}\n\nPseudoMap.prototype.delete = function (k) {\n  var res = find(this._data, k)\n  if (res) {\n    delete this._data[res._index]\n    this._data.size--\n  }\n}\n\nPseudoMap.prototype.clear = function () {\n  var data = Object.create(null)\n  data.size = 0\n\n  Object.defineProperty(this, '_data', {\n    value: data,\n    enumerable: false,\n    configurable: true,\n    writable: false\n  })\n}\n\nObject.defineProperty(PseudoMap.prototype, 'size', {\n  get: function () {\n    return this._data.size\n  },\n  set: function (n) {},\n  enumerable: true,\n  configurable: true\n})\n\nPseudoMap.prototype.values =\nPseudoMap.prototype.keys =\nPseudoMap.prototype.entries = function () {\n  throw new Error('iterators are not implemented in this version')\n}\n\n// Either identical, or both NaN\nfunction same (a, b) {\n  return a === b || a !== a && b !== b\n}\n\nfunction Entry (k, v, i) {\n  this.key = k\n  this.value = v\n  this._index = i\n}\n\nfunction find (data, k) {\n  for (var i = 0, s = '_' + k, key = s;\n       hasOwnProperty.call(data, key);\n       key = s + i++) {\n    if (same(data[key].key, k))\n      return data[key]\n  }\n}\n\nfunction set (data, k, v) {\n  for (var i = 0, s = '_' + k, key = s;\n       hasOwnProperty.call(data, key);\n       key = s + i++) {\n    if (same(data[key].key, k)) {\n      data[key].value = v\n      return\n    }\n  }\n  data.size++\n  data[key] = new Entry(k, v, key)\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/pseudomap/pseudomap.js\n ** module id = 45\n ** module chunks = 0\n **/","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  // Allow for deprecating things in the process of starting up.\n  if (isUndefined(global.process)) {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  if (process.noDeprecation === true) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/util/util.js\n ** module id = 46\n ** module chunks = 0\n **/","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/util/support/isBufferBrowser.js\n ** module id = 47\n ** module chunks = 0\n **/","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/util/~/inherits/inherits_browser.js\n ** module id = 48\n ** module chunks = 0\n **/","module.exports = Yallist\n\nYallist.Node = Node\nYallist.create = Yallist\n\nfunction Yallist (list) {\n  var self = this\n  if (!(self instanceof Yallist)) {\n    self = new Yallist()\n  }\n\n  self.tail = null\n  self.head = null\n  self.length = 0\n\n  if (list && typeof list.forEach === 'function') {\n    list.forEach(function (item) {\n      self.push(item)\n    })\n  } else if (arguments.length > 0) {\n    for (var i = 0, l = arguments.length; i < l; i++) {\n      self.push(arguments[i])\n    }\n  }\n\n  return self\n}\n\nYallist.prototype.removeNode = function (node) {\n  if (node.list !== this) {\n    throw new Error('removing node which does not belong to this list')\n  }\n\n  var next = node.next\n  var prev = node.prev\n\n  if (next) {\n    next.prev = prev\n  }\n\n  if (prev) {\n    prev.next = next\n  }\n\n  if (node === this.head) {\n    this.head = next\n  }\n  if (node === this.tail) {\n    this.tail = prev\n  }\n\n  node.list.length --\n  node.next = null\n  node.prev = null\n  node.list = null\n}\n\nYallist.prototype.unshiftNode = function (node) {\n  if (node === this.head) {\n    return\n  }\n\n  if (node.list) {\n    node.list.removeNode(node)\n  }\n\n  var head = this.head\n  node.list = this\n  node.next = head\n  if (head) {\n    head.prev = node\n  }\n\n  this.head = node\n  if (!this.tail) {\n    this.tail = node\n  }\n  this.length ++\n}\n\nYallist.prototype.pushNode = function (node) {\n  if (node === this.tail) {\n    return\n  }\n\n  if (node.list) {\n    node.list.removeNode(node)\n  }\n\n  var tail = this.tail\n  node.list = this\n  node.prev = tail\n  if (tail) {\n    tail.next = node\n  }\n\n  this.tail = node\n  if (!this.head) {\n    this.head = node\n  }\n  this.length ++\n}\n\nYallist.prototype.push = function () {\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    push(this, arguments[i])\n  }\n  return this.length\n}\n\nYallist.prototype.unshift = function () {\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    unshift(this, arguments[i])\n  }\n  return this.length\n}\n\nYallist.prototype.pop = function () {\n  if (!this.tail)\n    return undefined\n\n  var res = this.tail.value\n  this.tail = this.tail.prev\n  this.tail.next = null\n  this.length --\n  return res\n}\n\nYallist.prototype.shift = function () {\n  if (!this.head)\n    return undefined\n\n  var res = this.head.value\n  this.head = this.head.next\n  this.head.prev = null\n  this.length --\n  return res\n}\n\nYallist.prototype.forEach = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this.head, i = 0; walker !== null; i++) {\n    fn.call(thisp, walker.value, i, this)\n    walker = walker.next\n  }\n}\n\nYallist.prototype.forEachReverse = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this.tail, i = this.length - 1; walker !== null; i--) {\n    fn.call(thisp, walker.value, i, this)\n    walker = walker.prev\n  }\n}\n\nYallist.prototype.get = function (n) {\n  for (var i = 0, walker = this.head; walker !== null && i < n; i++) {\n    // abort out of the list early if we hit a cycle\n    walker = walker.next\n  }\n  if (i === n && walker !== null) {\n    return walker.value\n  }\n}\n\nYallist.prototype.getReverse = function (n) {\n  for (var i = 0, walker = this.tail; walker !== null && i < n; i++) {\n    // abort out of the list early if we hit a cycle\n    walker = walker.prev\n  }\n  if (i === n && walker !== null) {\n    return walker.value\n  }\n}\n\nYallist.prototype.map = function (fn, thisp) {\n  thisp = thisp || this\n  var res = new Yallist()\n  for (var walker = this.head; walker !== null; ) {\n    res.push(fn.call(thisp, walker.value, this))\n    walker = walker.next\n  }\n  return res\n}\n\nYallist.prototype.mapReverse = function (fn, thisp) {\n  thisp = thisp || this\n  var res = new Yallist()\n  for (var walker = this.tail; walker !== null;) {\n    res.push(fn.call(thisp, walker.value, this))\n    walker = walker.prev\n  }\n  return res\n}\n\nYallist.prototype.reduce = function (fn, initial) {\n  var acc\n  var walker = this.head\n  if (arguments.length > 1) {\n    acc = initial\n  } else if (this.head) {\n    walker = this.head.next\n    acc = this.head.value\n  } else {\n    throw new TypeError('Reduce of empty list with no initial value')\n  }\n\n  for (var i = 0; walker !== null; i++) {\n    acc = fn(acc, walker.value, i)\n    walker = walker.next\n  }\n\n  return acc\n}\n\nYallist.prototype.reduceReverse = function (fn, initial) {\n  var acc\n  var walker = this.tail\n  if (arguments.length > 1) {\n    acc = initial\n  } else if (this.tail) {\n    walker = this.tail.prev\n    acc = this.tail.value\n  } else {\n    throw new TypeError('Reduce of empty list with no initial value')\n  }\n\n  for (var i = this.length - 1; walker !== null; i--) {\n    acc = fn(acc, walker.value, i)\n    walker = walker.prev\n  }\n\n  return acc\n}\n\nYallist.prototype.toArray = function () {\n  var arr = new Array(this.length)\n  for (var i = 0, walker = this.head; walker !== null; i++) {\n    arr[i] = walker.value\n    walker = walker.next\n  }\n  return arr\n}\n\nYallist.prototype.toArrayReverse = function () {\n  var arr = new Array(this.length)\n  for (var i = 0, walker = this.tail; walker !== null; i++) {\n    arr[i] = walker.value\n    walker = walker.prev\n  }\n  return arr\n}\n\nYallist.prototype.slice = function (from, to) {\n  to = to || this.length\n  if (to < 0) {\n    to += this.length\n  }\n  from = from || 0\n  if (from < 0) {\n    from += this.length\n  }\n  var ret = new Yallist()\n  if (to < from || to < 0) {\n    return ret\n  }\n  if (from < 0) {\n    from = 0\n  }\n  if (to > this.length) {\n    to = this.length\n  }\n  for (var i = 0, walker = this.head; walker !== null && i < from; i++) {\n    walker = walker.next\n  }\n  for (; walker !== null && i < to; i++, walker = walker.next) {\n    ret.push(walker.value)\n  }\n  return ret\n}\n\nYallist.prototype.sliceReverse = function (from, to) {\n  to = to || this.length\n  if (to < 0) {\n    to += this.length\n  }\n  from = from || 0\n  if (from < 0) {\n    from += this.length\n  }\n  var ret = new Yallist()\n  if (to < from || to < 0) {\n    return ret\n  }\n  if (from < 0) {\n    from = 0\n  }\n  if (to > this.length) {\n    to = this.length\n  }\n  for (var i = this.length, walker = this.tail; walker !== null && i > to; i--) {\n    walker = walker.prev\n  }\n  for (; walker !== null && i > from; i--, walker = walker.prev) {\n    ret.push(walker.value)\n  }\n  return ret\n}\n\nYallist.prototype.reverse = function () {\n  var head = this.head\n  var tail = this.tail\n  for (var walker = head; walker !== null; walker = walker.prev) {\n    var p = walker.prev\n    walker.prev = walker.next\n    walker.next = p\n  }\n  this.head = tail\n  this.tail = head\n  return this\n}\n\nfunction push (self, item) {\n  self.tail = new Node(item, self.tail, null, self)\n  if (!self.head) {\n    self.head = self.tail\n  }\n  self.length ++\n}\n\nfunction unshift (self, item) {\n  self.head = new Node(item, null, self.head, self)\n  if (!self.tail) {\n    self.tail = self.head\n  }\n  self.length ++\n}\n\nfunction Node (value, prev, next, list) {\n  if (!(this instanceof Node)) {\n    return new Node(value, prev, next, list)\n  }\n\n  this.list = list\n  this.value = value\n\n  if (prev) {\n    prev.next = this\n    this.prev = prev\n  } else {\n    this.prev = null\n  }\n\n  if (next) {\n    next.prev = this\n    this.next = next\n  } else {\n    this.next = null\n  }\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/yallist/yallist.js\n ** module id = 49\n ** module chunks = 0\n **/","import Tile from './Tile';\nimport BoxHelper from '../../vendor/BoxHelper';\nimport THREE from 'three';\n\n// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\nclass ImageTile extends Tile {\n  constructor(quadcode, path, layer) {\n    super(quadcode, path, layer);\n  }\n\n  // Request data for the tile\n  requestTileAsync() {\n    // Making this asynchronous really speeds up the LOD framerate\n    setTimeout(() => {\n      if (!this._mesh) {\n        this._mesh = this._createMesh();\n        this._requestTile();\n      }\n    }, 0);\n  }\n\n  destroy() {\n    // Cancel any pending requests\n    this._abortRequest();\n\n    // Clear image reference\n    this._image = null;\n\n    super.destroy();\n  }\n\n  _createMesh() {\n    // Something went wrong and the tile\n    //\n    // Possibly removed by the cache before loaded\n    if (!this._center) {\n      return;\n    }\n\n    var mesh = new THREE.Object3D();\n    var geom = new THREE.PlaneBufferGeometry(this._side, this._side, 1);\n\n    var material;\n    if (!this._world._environment._skybox) {\n      material = new THREE.MeshBasicMaterial({\n        depthWrite: false\n      });\n\n      // var material = new THREE.MeshPhongMaterial({\n      //   depthWrite: false\n      // });\n    } else {\n      // Other MeshStandardMaterial settings\n      //\n      // material.envMapIntensity will change the amount of colour reflected(?)\n      // from the environment map – can be greater than 1 for more intensity\n\n      material = new THREE.MeshStandardMaterial({\n        depthWrite: false\n      });\n      material.roughness = 1;\n      material.metalness = 0.1;\n      material.envMap = this._world._environment._skybox.getRenderTarget();\n    }\n\n    var localMesh = new THREE.Mesh(geom, material);\n    localMesh.rotation.x = -90 * Math.PI / 180;\n\n    localMesh.receiveShadow = true;\n\n    mesh.add(localMesh);\n    mesh.renderOrder = 0.1;\n\n    mesh.position.x = this._center[0];\n    mesh.position.z = this._center[1];\n\n    // var box = new BoxHelper(localMesh);\n    // mesh.add(box);\n    //\n    // mesh.add(this._createDebugMesh());\n\n    return mesh;\n  }\n\n  _createDebugMesh() {\n    var canvas = document.createElement('canvas');\n    canvas.width = 256;\n    canvas.height = 256;\n\n    var context = canvas.getContext('2d');\n    context.font = 'Bold 20px Helvetica Neue, Verdana, Arial';\n    context.fillStyle = '#ff0000';\n    context.fillText(this._quadcode, 20, canvas.width / 2 - 5);\n    context.fillText(this._tile.toString(), 20, canvas.width / 2 + 25);\n\n    var texture = new THREE.Texture(canvas);\n\n    // Silky smooth images when tilted\n    texture.magFilter = THREE.LinearFilter;\n    texture.minFilter = THREE.LinearMipMapLinearFilter;\n\n    // TODO: Set this to renderer.getMaxAnisotropy() / 4\n    texture.anisotropy = 4;\n\n    texture.needsUpdate = true;\n\n    var material = new THREE.MeshBasicMaterial({\n      map: texture,\n      transparent: true,\n      depthWrite: false\n    });\n\n    var geom = new THREE.PlaneBufferGeometry(this._side, this._side, 1);\n    var mesh = new THREE.Mesh(geom, material);\n\n    mesh.rotation.x = -90 * Math.PI / 180;\n    mesh.position.y = 0.1;\n\n    return mesh;\n  }\n\n  _requestTile() {\n    var urlParams = {\n      x: this._tile[0],\n      y: this._tile[1],\n      z: this._tile[2]\n    };\n\n    var url = this._getTileURL(urlParams);\n\n    var image = document.createElement('img');\n\n    image.addEventListener('load', event => {\n      var texture = new THREE.Texture();\n\n      texture.image = image;\n      texture.needsUpdate = true;\n\n      // Silky smooth images when tilted\n      texture.magFilter = THREE.LinearFilter;\n      texture.minFilter = THREE.LinearMipMapLinearFilter;\n\n      // TODO: Set this to renderer.getMaxAnisotropy() / 4\n      texture.anisotropy = 4;\n\n      texture.needsUpdate = true;\n\n      // Something went wrong and the tile or its material is missing\n      //\n      // Possibly removed by the cache before the image loaded\n      if (!this._mesh || !this._mesh.children[0] || !this._mesh.children[0].material) {\n        return;\n      }\n\n      this._mesh.children[0].material.map = texture;\n      this._mesh.children[0].material.needsUpdate = true;\n\n      this._texture = texture;\n      this._ready = true;\n    }, false);\n\n    // image.addEventListener('progress', event => {}, false);\n    // image.addEventListener('error', event => {}, false);\n\n    image.crossOrigin = '';\n\n    // Load image\n    image.src = url;\n\n    this._image = image;\n  }\n\n  _abortRequest() {\n    if (!this._image) {\n      return;\n    }\n\n    this._image.src = '';\n  }\n}\n\nexport default ImageTile;\n\nvar noNew = function(quadcode, path, layer) {\n  return new ImageTile(quadcode, path, layer);\n};\n\n// Initialise without requiring new keyword\nexport {noNew as imageTile};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/tile/ImageTile.js\n **/","import {point as Point} from '../../geo/Point';\nimport {latLon as LatLon} from '../../geo/LatLon';\nimport THREE from 'three';\n\n// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\n// Manages a single tile and its layers\n\nvar r2d = 180 / Math.PI;\n\nvar tileURLRegex = /\\{([szxy])\\}/g;\n\nclass Tile {\n  constructor(quadcode, path, layer) {\n    this._layer = layer;\n    this._world = layer._world;\n    this._quadcode = quadcode;\n    this._path = path;\n\n    this._ready = false;\n\n    this._tile = this._quadcodeToTile(quadcode);\n\n    // Bottom-left and top-right bounds in WGS84 coordinates\n    this._boundsLatLon = this._tileBoundsWGS84(this._tile);\n\n    // Bottom-left and top-right bounds in world coordinates\n    this._boundsWorld = this._tileBoundsFromWGS84(this._boundsLatLon);\n\n    // Tile center in world coordinates\n    this._center = this._boundsToCenter(this._boundsWorld);\n\n    // Tile center in projected coordinates\n    this._centerLatlon = this._world.pointToLatLon(Point(this._center[0], this._center[1]));\n\n    // Length of a tile side in world coorindates\n    this._side = this._getSide(this._boundsWorld);\n\n    // Point scale for tile (for unit conversion)\n    this._pointScale = this._world.pointScale(this._centerLatlon);\n  }\n\n  // Returns true if the tile mesh and texture are ready to be used\n  // Otherwise, returns false\n  isReady() {\n    return this._ready;\n  }\n\n  // Request data for the tile\n  requestTileAsync() {}\n\n  getQuadcode() {\n    return this._quadcode;\n  }\n\n  getBounds() {\n    return this._boundsWorld;\n  }\n\n  getCenter() {\n    return this._center;\n  }\n\n  getSide() {\n    return this._side;\n  }\n\n  getMesh() {\n    return this._mesh;\n  }\n\n  getPickingMesh() {\n    return this._pickingMesh;\n  }\n\n  // Destroys the tile and removes it from the layer and memory\n  //\n  // Ensure that this leaves no trace of the tile – no textures, no meshes,\n  // nothing in memory or the GPU\n  destroy() {\n    // Delete reference to layer and world\n    this._layer = null;\n    this._world = null;\n\n    // Delete location references\n    this._boundsLatLon = null;\n    this._boundsWorld = null;\n    this._center = null;\n\n    // Done if no mesh\n    if (!this._mesh) {\n      return;\n    }\n\n    if (this._mesh.children) {\n      // Dispose of mesh and materials\n      this._mesh.children.forEach(child => {\n        child.geometry.dispose();\n        child.geometry = null;\n\n        if (child.material.map) {\n          child.material.map.dispose();\n          child.material.map = null;\n        }\n\n        child.material.dispose();\n        child.material = null;\n      });\n    } else {\n      this._mesh.geometry.dispose();\n      this._mesh.geometry = null;\n\n      if (this._mesh.material.map) {\n        this._mesh.material.map.dispose();\n        this._mesh.material.map = null;\n      }\n\n      this._mesh.material.dispose();\n      this._mesh.material = null;\n    }\n  }\n\n  _createMesh() {}\n  _createDebugMesh() {}\n\n  _getTileURL(urlParams) {\n    if (!urlParams.s) {\n      // Default to a random choice of a, b or c\n      urlParams.s = String.fromCharCode(97 + Math.floor(Math.random() * 3));\n    }\n\n    tileURLRegex.lastIndex = 0;\n    return this._path.replace(tileURLRegex, function(value, key) {\n      // Replace with paramter, otherwise keep existing value\n      return urlParams[key];\n    });\n  }\n\n  // Convert from quadcode to TMS tile coordinates\n  _quadcodeToTile(quadcode) {\n    var x = 0;\n    var y = 0;\n    var z = quadcode.length;\n\n    for (var i = z; i > 0; i--) {\n      var mask = 1 << (i - 1);\n      var q = +quadcode[z - i];\n      if (q === 1) {\n        x |= mask;\n      }\n      if (q === 2) {\n        y |= mask;\n      }\n      if (q === 3) {\n        x |= mask;\n        y |= mask;\n      }\n    }\n\n    return [x, y, z];\n  }\n\n  // Convert WGS84 tile bounds to world coordinates\n  _tileBoundsFromWGS84(boundsWGS84) {\n    var sw = this._layer._world.latLonToPoint(LatLon(boundsWGS84[1], boundsWGS84[0]));\n    var ne = this._layer._world.latLonToPoint(LatLon(boundsWGS84[3], boundsWGS84[2]));\n\n    return [sw.x, sw.y, ne.x, ne.y];\n  }\n\n  // Get tile bounds in WGS84 coordinates\n  _tileBoundsWGS84(tile) {\n    var e = this._tile2lon(tile[0] + 1, tile[2]);\n    var w = this._tile2lon(tile[0], tile[2]);\n    var s = this._tile2lat(tile[1] + 1, tile[2]);\n    var n = this._tile2lat(tile[1], tile[2]);\n    return [w, s, e, n];\n  }\n\n  _tile2lon(x, z) {\n    return x / Math.pow(2, z) * 360 - 180;\n  }\n\n  _tile2lat(y, z) {\n    var n = Math.PI - 2 * Math.PI * y / Math.pow(2, z);\n    return r2d * Math.atan(0.5 * (Math.exp(n) - Math.exp(-n)));\n  }\n\n  _boundsToCenter(bounds) {\n    var x = bounds[0] + (bounds[2] - bounds[0]) / 2;\n    var y = bounds[1] + (bounds[3] - bounds[1]) / 2;\n\n    return [x, y];\n  }\n\n  _getSide(bounds) {\n    return (new THREE.Vector3(bounds[0], 0, bounds[3])).sub(new THREE.Vector3(bounds[0], 0, bounds[1])).length();\n  }\n}\n\nexport default Tile;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/tile/Tile.js\n **/","// jscs:disable\n/* eslint-disable */\n\nimport THREE from 'three';\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nBoxHelper = function ( object ) {\n\n\tvar indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\n\tvar positions = new Float32Array( 8 * 3 );\n\n\tvar geometry = new THREE.BufferGeometry();\n\tgeometry.setIndex( new THREE.BufferAttribute( indices, 1 ) );\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\n\n\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { linewidth: 2, color: 0xff0000 } ) );\n\n\tif ( object !== undefined ) {\n\n\t\tthis.update( object );\n\n\t}\n\n};\n\nBoxHelper.prototype = Object.create( THREE.LineSegments.prototype );\nBoxHelper.prototype.constructor = BoxHelper;\n\nBoxHelper.prototype.update = ( function () {\n\n\tvar box = new THREE.Box3();\n\n\treturn function ( object ) {\n\n\t\tbox.setFromObject( object );\n\n\t\tif ( box.isEmpty() ) return;\n\n\t\tvar min = box.min;\n\t\tvar max = box.max;\n\n\t\t/*\n\t\t  5____4\n\t\t1/___0/|\n\t\t| 6__|_7\n\t\t2/___3/\n\n\t\t0: max.x, max.y, max.z\n\t\t1: min.x, max.y, max.z\n\t\t2: min.x, min.y, max.z\n\t\t3: max.x, min.y, max.z\n\t\t4: max.x, max.y, min.z\n\t\t5: min.x, max.y, min.z\n\t\t6: min.x, min.y, min.z\n\t\t7: max.x, min.y, min.z\n\t\t*/\n\n\t\tvar position = this.geometry.attributes.position;\n\t\tvar array = position.array;\n\n\t\tarray[  0 ] = max.x; array[  1 ] = max.y; array[  2 ] = max.z;\n\t\tarray[  3 ] = min.x; array[  4 ] = max.y; array[  5 ] = max.z;\n\t\tarray[  6 ] = min.x; array[  7 ] = min.y; array[  8 ] = max.z;\n\t\tarray[  9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\n\t\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\n\t\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\n\t\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\n\t\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\n\n\t\tposition.needsUpdate = true;\n\n\t\tthis.geometry.computeBoundingSphere();\n\n\t};\n\n} )();\n\nexport default BoxHelper;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/BoxHelper.js\n **/","import THREE from 'three';\n\nexport default function(colour, skyboxTarget) {\n  var canvas = document.createElement('canvas');\n  canvas.width = 1;\n  canvas.height = 1;\n\n  var context = canvas.getContext('2d');\n  context.fillStyle = colour;\n  context.fillRect(0, 0, canvas.width, canvas.height);\n  // context.strokeStyle = '#D0D0CF';\n  // context.strokeRect(0, 0, canvas.width, canvas.height);\n\n  var texture = new THREE.Texture(canvas);\n\n  // // Silky smooth images when tilted\n  // texture.magFilter = THREE.LinearFilter;\n  // texture.minFilter = THREE.LinearMipMapLinearFilter;\n  // //\n  // // // TODO: Set this to renderer.getMaxAnisotropy() / 4\n  // texture.anisotropy = 4;\n\n  // texture.wrapS = THREE.RepeatWrapping;\n  // texture.wrapT = THREE.RepeatWrapping;\n  // texture.repeat.set(segments, segments);\n\n  texture.needsUpdate = true;\n\n  var material;\n\n  if (!skyboxTarget) {\n    material = new THREE.MeshBasicMaterial({\n      map: texture,\n      depthWrite: false\n    });\n  } else {\n    material = new THREE.MeshStandardMaterial({\n      map: texture,\n      depthWrite: false\n    });\n    material.roughness = 1;\n    material.metalness = 0.1;\n    material.envMap = skyboxTarget;\n  }\n\n  return material;\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/tile/ImageTileLayerBaseMaterial.js\n **/","import TileLayer from './TileLayer';\nimport extend from 'lodash.assign';\nimport GeoJSONTile from './GeoJSONTile';\nimport throttle from 'lodash.throttle';\nimport THREE from 'three';\n\n// TODO: Offer on-the-fly slicing of static, non-tile-based GeoJSON files into a\n// tile grid using geojson-vt\n//\n// See: https://github.com/mapbox/geojson-vt\n\n// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\n// TODO: Consider pausing per-frame output during movement so there's little to\n// no jank caused by previous tiles still processing\n\n// This tile layer only updates the quadtree after world movement has occurred\n//\n// Tiles from previous quadtree updates are updated and outputted every frame\n// (or at least every frame, throttled to some amount)\n//\n// This is because the complexity of TopoJSON tiles requires a lot of processing\n// and so makes movement janky if updates occur every frame – only updating\n// after movement means frame drops are less obvious due to heavy processing\n// occurring while the view is generally stationary\n//\n// The downside is that until new tiles are requested and outputted you will\n// see blank spaces as you orbit and move around\n//\n// An added benefit is that it dramatically reduces the number of tiles being\n// requested over a period of time and the time it takes to go from request to\n// screen output\n//\n// It may be possible to perform these updates per-frame once Web Worker\n// processing is added\n\nclass GeoJSONTileLayer extends TileLayer {\n  constructor(path, options) {\n    var defaults = {\n      maxLOD: 14,\n      distance: 30000\n    };\n\n    options = extend({}, defaults, options);\n\n    super(options);\n\n    this._path = path;\n  }\n\n  _onAdd(world) {\n    super._onAdd(world);\n\n    // Trigger initial quadtree calculation on the next frame\n    //\n    // TODO: This is a hack to ensure the camera is all set up - a better\n    // solution should be found\n    setTimeout(() => {\n      this._calculateLOD();\n      this._initEvents();\n    }, 0);\n  }\n\n  _initEvents() {\n    // Run LOD calculations based on render calls\n    //\n    // Throttled to 1 LOD calculation per 100ms\n    this._throttledWorldUpdate = throttle(this._onWorldUpdate, 100);\n\n    this._world.on('preUpdate', this._throttledWorldUpdate, this);\n    this._world.on('move', this._onWorldMove, this);\n    this._world.on('controlsMove', this._onControlsMove, this);\n  }\n\n  // Update and output tiles each frame (throttled)\n  _onWorldUpdate() {\n    if (this._pauseOutput) {\n      return;\n    }\n\n    this._outputTiles();\n  }\n\n  // Update tiles grid after world move, but don't output them\n  _onWorldMove(latlon, point) {\n    this._pauseOutput = false;\n    this._calculateLOD();\n  }\n\n  // Pause updates during control movement for less visual jank\n  _onControlsMove() {\n    this._pauseOutput = true;\n  }\n\n  _createTile(quadcode, layer) {\n    var options = {};\n\n    // if (this._options.filter) {\n    //   options.filter = this._options.filter;\n    // }\n    //\n    // if (this._options.style) {\n    //   options.style = this._options.style;\n    // }\n    //\n    // if (this._options.topojson) {\n    //   options.topojson = true;\n    // }\n    //\n    // if (this._options.interactive) {\n    //   options.interactive = true;\n    // }\n    //\n    // if (this._options.onClick) {\n    //   options.onClick = this._options.onClick;\n    // }\n\n    return new GeoJSONTile(quadcode, this._path, layer, this._options);\n  }\n\n  // Destroys the layer and removes it from the scene and memory\n  destroy() {\n    this._world.off('preUpdate', this._throttledWorldUpdate);\n    this._world.off('move', this._onWorldMove);\n\n    this._throttledWorldUpdate = null;\n\n    // Run common destruction logic from parent\n    super.destroy();\n  }\n}\n\nexport default GeoJSONTileLayer;\n\nvar noNew = function(path, options) {\n  return new GeoJSONTileLayer(path, options);\n};\n\n// Initialise without requiring new keyword\nexport {noNew as geoJSONTileLayer};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/tile/GeoJSONTileLayer.js\n **/","import Tile from './Tile';\nimport {geoJSONLayer as GeoJSONLayer} from '../GeoJSONLayer';\nimport BoxHelper from '../../vendor/BoxHelper';\nimport THREE from 'three';\nimport reqwest from 'reqwest';\nimport {point as Point} from '../../geo/Point';\nimport {latLon as LatLon} from '../../geo/LatLon';\nimport extend from 'lodash.assign';\n// import Offset from 'polygon-offset';\nimport GeoJSON from '../../util/GeoJSON';\nimport Buffer from '../../util/Buffer';\nimport PickingMaterial from '../../engine/PickingMaterial';\n\n// TODO: Map picking IDs to some reference within the tile data / geometry so\n// that something useful can be done when an object is picked / clicked on\n\n// TODO: Make sure nothing is left behind in the heap after calling destroy()\n\n// TODO: Perform tile request and processing in a Web Worker\n//\n// Use Operative (https://github.com/padolsey/operative)\n//\n// Would it make sense to have the worker functionality defined in a static\n// method so it only gets initialised once and not on every tile instance?\n//\n// Otherwise, worker processing logic would have to go in the tile layer so not\n// to waste loads of time setting up a brand new worker with three.js for each\n// tile every single time.\n//\n// Unsure of the best way to get three.js and VIZI into the worker\n//\n// Would need to set up a CRS / projection identical to the world instance\n//\n// Is it possible to bypass requirements on external script by having multiple\n// simple worker methods that each take enough inputs to perform a single task\n// without requiring VIZI or three.js? So long as the heaviest logic is done in\n// the worker and transferrable objects are used then it should be better than\n// nothing. Would probably still need things like earcut...\n//\n// After all, the three.js logic and object creation will still need to be\n// done on the main thread regardless so the worker should try to do as much as\n// possible with as few dependencies as possible.\n//\n// Have a look at how this is done in Tangram before implementing anything as\n// the approach there is pretty similar and robust.\n\nclass GeoJSONTile extends Tile {\n  constructor(quadcode, path, layer, options) {\n    super(quadcode, path, layer);\n\n    this._defaultStyle = GeoJSON.defaultStyle;\n\n    var defaults = {\n      output: true,\n      outputToScene: false,\n      interactive: false,\n      topojson: false,\n      filter: null,\n      onEachFeature: null,\n      polygonMaterial: null,\n      onPolygonMesh: null,\n      onPolygonBufferAttributes: null,\n      polylineMaterial: null,\n      onPolylineMesh: null,\n      onPolylineBufferAttributes: null,\n      pointGeometry: null,\n      pointMaterial: null,\n      onPointMesh: null,\n      style: GeoJSON.defaultStyle,\n      keepFeatures: false\n    };\n\n    var _options = extend({}, defaults, options);\n\n    if (typeof options.style === 'function') {\n      _options.style = options.style;\n    } else {\n      _options.style = extend({}, defaults.style, options.style);\n    }\n\n    this._options = _options;\n  }\n\n  // Request data for the tile\n  requestTileAsync() {\n    // Making this asynchronous really speeds up the LOD framerate\n    setTimeout(() => {\n      if (!this._mesh) {\n        this._mesh = this._createMesh();\n\n        // this._shadowCanvas = this._createShadowCanvas();\n\n        this._requestTile();\n      }\n    }, 0);\n  }\n\n  // TODO: Destroy GeoJSONLayer\n  destroy() {\n    // Cancel any pending requests\n    this._abortRequest();\n\n    // Clear request reference\n    this._request = null;\n\n    if (this._geojsonLayer) {\n      this._geojsonLayer.destroy();\n      this._geojsonLayer = null;\n    }\n\n    this._mesh = null;\n\n    // TODO: Properly dispose of picking mesh\n    this._pickingMesh = null;\n\n    super.destroy();\n  }\n\n  _createMesh() {\n    // Something went wrong and the tile\n    //\n    // Possibly removed by the cache before loaded\n    if (!this._center) {\n      return;\n    }\n\n    var mesh = new THREE.Object3D();\n    // mesh.add(this._createDebugMesh());\n\n    return mesh;\n  }\n\n  _createDebugMesh() {\n    var canvas = document.createElement('canvas');\n    canvas.width = 256;\n    canvas.height = 256;\n\n    var context = canvas.getContext('2d');\n    context.font = 'Bold 20px Helvetica Neue, Verdana, Arial';\n    context.fillStyle = '#ff0000';\n    context.fillText(this._quadcode, 20, canvas.width / 2 - 5);\n    context.fillText(this._tile.toString(), 20, canvas.width / 2 + 25);\n\n    var texture = new THREE.Texture(canvas);\n\n    // Silky smooth images when tilted\n    texture.magFilter = THREE.LinearFilter;\n    texture.minFilter = THREE.LinearMipMapLinearFilter;\n\n    // TODO: Set this to renderer.getMaxAnisotropy() / 4\n    texture.anisotropy = 4;\n\n    texture.needsUpdate = true;\n\n    var material = new THREE.MeshBasicMaterial({\n      map: texture,\n      transparent: true,\n      depthWrite: false\n    });\n\n    var geom = new THREE.PlaneBufferGeometry(this._side, this._side, 1);\n    var mesh = new THREE.Mesh(geom, material);\n\n    mesh.rotation.x = -90 * Math.PI / 180;\n    mesh.position.y = 0.1;\n\n    return mesh;\n  }\n\n  // _createShadowCanvas() {\n  //   var canvas = document.createElement('canvas');\n  //\n  //   // Rendered at a low resolution and later scaled up for a low-quality blur\n  //   canvas.width = 512;\n  //   canvas.height = 512;\n  //\n  //   return canvas;\n  // }\n\n  // _addShadow(coordinates) {\n  //   var ctx = this._shadowCanvas.getContext('2d');\n  //   var width = this._shadowCanvas.width;\n  //   var height = this._shadowCanvas.height;\n  //\n  //   var _coords;\n  //   var _offset;\n  //   var offset = new Offset();\n  //\n  //   // Transform coordinates to shadowCanvas space and draw on canvas\n  //   coordinates.forEach((ring, index) => {\n  //     ctx.beginPath();\n  //\n  //     _coords = ring.map(coord => {\n  //       var xFrac = (coord[0] - this._boundsWorld[0]) / this._side;\n  //       var yFrac = (coord[1] - this._boundsWorld[3]) / this._side;\n  //       return [xFrac * width, yFrac * height];\n  //     });\n  //\n  //     if (index > 0) {\n  //       _offset = _coords;\n  //     } else {\n  //       _offset = offset.data(_coords).padding(1.3);\n  //     }\n  //\n  //     // TODO: This is super flaky and crashes the browser if run on anything\n  //     // put the outer ring (potentially due to winding)\n  //     _offset.forEach((coord, index) => {\n  //       // var xFrac = (coord[0] - this._boundsWorld[0]) / this._side;\n  //       // var yFrac = (coord[1] - this._boundsWorld[3]) / this._side;\n  //\n  //       if (index === 0) {\n  //         ctx.moveTo(coord[0], coord[1]);\n  //       } else {\n  //         ctx.lineTo(coord[0], coord[1]);\n  //       }\n  //     });\n  //\n  //     ctx.closePath();\n  //   });\n  //\n  //   ctx.fillStyle = 'rgba(80, 80, 80, 0.7)';\n  //   ctx.fill();\n  // }\n\n  _requestTile() {\n    var urlParams = {\n      x: this._tile[0],\n      y: this._tile[1],\n      z: this._tile[2]\n    };\n\n    var url = this._getTileURL(urlParams);\n\n    this._request = reqwest({\n      url: url,\n      type: 'json',\n      crossOrigin: true\n    }).then(res => {\n      // Clear request reference\n      this._request = null;\n      this._processTileData(res);\n    }).catch(err => {\n      console.error(err);\n\n      // Clear request reference\n      this._request = null;\n    });\n  }\n\n  _processTileData(data) {\n    console.time(this._tile);\n\n    // Using this creates a huge amount of memory due to the quantity of tiles\n    this._geojsonLayer = GeoJSONLayer(data, this._options).addTo(this._world);\n\n    this._mesh = this._geojsonLayer._object3D;\n    this._pickingMesh = this._geojsonLayer._pickingMesh;\n\n    // Free the GeoJSON memory as we don't need it\n    //\n    // TODO: This should probably be a method within GeoJSONLayer\n    this._geojsonLayer._geojson = null;\n\n    // TODO: Fix or store shadow canvas stuff and get rid of this code\n    // Draw footprint on shadow canvas\n    //\n    // TODO: Disabled for the time-being until it can be sped up / moved to\n    // a worker\n    // this._addShadow(coordinates);\n\n    // Output shadow canvas\n\n    // TODO: Disabled for the time-being until it can be sped up / moved to\n    // a worker\n\n    // var texture = new THREE.Texture(this._shadowCanvas);\n    //\n    // // Silky smooth images when tilted\n    // texture.magFilter = THREE.LinearFilter;\n    // texture.minFilter = THREE.LinearMipMapLinearFilter;\n    //\n    // // TODO: Set this to renderer.getMaxAnisotropy() / 4\n    // texture.anisotropy = 4;\n    //\n    // texture.needsUpdate = true;\n    //\n    // var material;\n    // if (!this._world._environment._skybox) {\n    //   material = new THREE.MeshBasicMaterial({\n    //     map: texture,\n    //     transparent: true,\n    //     depthWrite: false\n    //   });\n    // } else {\n    //   material = new THREE.MeshStandardMaterial({\n    //     map: texture,\n    //     transparent: true,\n    //     depthWrite: false\n    //   });\n    //   material.roughness = 1;\n    //   material.metalness = 0.1;\n    //   material.envMap = this._world._environment._skybox.getRenderTarget();\n    // }\n    //\n    // var geom = new THREE.PlaneBufferGeometry(this._side, this._side, 1);\n    // var mesh = new THREE.Mesh(geom, material);\n    //\n    // mesh.castShadow = false;\n    // mesh.receiveShadow = false;\n    // mesh.renderOrder = 1;\n    //\n    // mesh.rotation.x = -90 * Math.PI / 180;\n    //\n    // this._mesh.add(mesh);\n\n    this._ready = true;\n    console.timeEnd(this._tile);\n  }\n\n  _abortRequest() {\n    if (!this._request) {\n      return;\n    }\n\n    this._request.abort();\n  }\n}\n\nexport default GeoJSONTile;\n\nvar noNew = function(quadcode, path, layer, options) {\n  return new GeoJSONTile(quadcode, path, layer, options);\n};\n\n// Initialise without requiring new keyword\nexport {noNew as geoJSONTile};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/tile/GeoJSONTile.js\n **/","// TODO: Consider adopting GeoJSON CSS\n// http://wiki.openstreetmap.org/wiki/Geojson_CSS\n\n// TODO: Allow interaction to be defined per-layer to save on resources\n//\n// For example, only allow polygons to be interactive via a polygonInteractive\n// option\n\nimport LayerGroup from './LayerGroup';\nimport extend from 'lodash.assign';\nimport reqwest from 'reqwest';\nimport GeoJSON from '../util/GeoJSON';\nimport Buffer from '../util/Buffer';\nimport PickingMaterial from '../engine/PickingMaterial';\nimport PolygonLayer from './geometry/PolygonLayer';\nimport PolylineLayer from './geometry/PolylineLayer';\nimport PointLayer from './geometry/PointLayer';\n\nclass GeoJSONLayer extends LayerGroup {\n  constructor(geojson, options) {\n    var defaults = {\n      output: false,\n      interactive: false,\n      topojson: false,\n      filter: null,\n      onEachFeature: null,\n      polygonMaterial: null,\n      onPolygonMesh: null,\n      onPolygonBufferAttributes: null,\n      polylineMaterial: null,\n      onPolylineMesh: null,\n      onPolylineBufferAttributes: null,\n      pointGeometry: null,\n      pointMaterial: null,\n      onPointMesh: null,\n      style: GeoJSON.defaultStyle,\n      keepFeatures: true\n    };\n\n    var _options = extend({}, defaults, options);\n\n    if (typeof options.style === 'function') {\n      _options.style = options.style;\n    } else {\n      _options.style = extend({}, defaults.style, options.style);\n    }\n\n    super(_options);\n\n    this._geojson = geojson;\n  }\n\n  _onAdd(world) {\n    // Only add to picking mesh if this layer is controlling output\n    //\n    // Otherwise, assume another component will eventually add a mesh to\n    // the picking scene\n    if (this.isOutput()) {\n      this._pickingMesh = new THREE.Object3D();\n      this.addToPicking(this._pickingMesh);\n    }\n\n    // Request data from URL if needed\n    if (typeof this._geojson === 'string') {\n      this._requestData(this._geojson);\n    } else {\n      // Process and add GeoJSON to layer\n      this._processData(this._geojson);\n    }\n  }\n\n  _requestData(url) {\n    this._request = reqwest({\n      url: url,\n      type: 'json',\n      crossOrigin: true\n    }).then(res => {\n      // Clear request reference\n      this._request = null;\n      this._processData(res);\n    }).catch(err => {\n      console.error(err);\n\n      // Clear request reference\n      this._request = null;\n    });\n  }\n\n  // TODO: Wrap into a helper method so this isn't duplicated in the tiled\n  // GeoJSON output layer\n  //\n  // Need to be careful as to not make it impossible to fork this off into a\n  // worker script at a later stage\n  _processData(data) {\n    // Collects features into a single FeatureCollection\n    //\n    // Also converts TopoJSON to GeoJSON if instructed\n    this._geojson = GeoJSON.collectFeatures(data, this._options.topojson);\n\n    // TODO: Check that GeoJSON is valid / usable\n\n    var features = this._geojson.features;\n\n    // Run filter, if provided\n    if (this._options.filter) {\n      features = this._geojson.features.filter(this._options.filter);\n    }\n\n    var defaults = {};\n\n    // Assume that a style won't be set per feature\n    var style = this._options.style;\n\n    var options;\n    features.forEach(feature => {\n      // Get per-feature style object, if provided\n      if (typeof this._options.style === 'function') {\n        style = extend({}, GeoJSON.defaultStyle, this._options.style(feature));\n      }\n\n      options = extend({}, defaults, {\n        // If merging feature layers, stop them outputting themselves\n        // If not, let feature layers output themselves to the world\n        output: !this.isOutput(),\n        interactive: this._options.interactive,\n        style: style\n      });\n\n      var layer = this._featureToLayer(feature, options);\n\n      if (!layer) {\n        return;\n      }\n\n      // Sometimes you don't want to store a reference to the feature\n      //\n      // For example, to save memory when being used by tile layers\n      if (this._options.keepFeatures) {\n        layer.feature = feature;\n      }\n\n      // If defined, call a function for each feature\n      //\n      // This is commonly used for adding event listeners from the user script\n      if (this._options.onEachFeature) {\n        this._options.onEachFeature(feature, layer);\n      }\n\n      this.addLayer(layer);\n    });\n\n    // If merging layers do that now, otherwise skip as the geometry layers\n    // should have already outputted themselves\n    if (!this.isOutput()) {\n      return;\n    }\n\n    // From here on we can assume that we want to merge the layers\n\n    var polygonAttributes = [];\n    var polygonFlat = true;\n\n    var polylineAttributes = [];\n    var pointAttributes = [];\n\n    this._layers.forEach(layer => {\n      if (layer instanceof PolygonLayer) {\n        polygonAttributes.push(layer.getBufferAttributes());\n\n        if (polygonFlat && !layer.isFlat()) {\n          polygonFlat = false;\n        }\n      } else if (layer instanceof PolylineLayer) {\n        polylineAttributes.push(layer.getBufferAttributes());\n      } else if (layer instanceof PointLayer) {\n        pointAttributes.push(layer.getBufferAttributes());\n      }\n    });\n\n    if (polygonAttributes.length > 0) {\n      var mergedPolygonAttributes = Buffer.mergeAttributes(polygonAttributes);\n      this._setPolygonMesh(mergedPolygonAttributes, polygonFlat);\n      this.add(this._polygonMesh);\n    }\n\n    if (polylineAttributes.length > 0) {\n      var mergedPolylineAttributes = Buffer.mergeAttributes(polylineAttributes);\n      this._setPolylineMesh(mergedPolylineAttributes);\n      this.add(this._polylineMesh);\n    }\n\n    if (pointAttributes.length > 0) {\n      var mergedPointAttributes = Buffer.mergeAttributes(pointAttributes);\n      this._setPointMesh(mergedPointAttributes);\n      this.add(this._pointMesh);\n    }\n\n    // Clean up layers\n    //\n    // TODO: Are there ever situations where the unmerged buffer attributes\n    // and coordinates would still be required?\n    this._layers.forEach(layer => {\n      layer.clearBufferAttributes();\n      layer.clearCoordinates();\n    });\n  }\n\n  // Create and store mesh from buffer attributes\n  //\n  // TODO: De-dupe this from the individual mesh creation logic within each\n  // geometry layer (materials, settings, etc)\n  //\n  // Could make this an abstract method for each geometry layer\n  _setPolygonMesh(attributes, flat) {\n    var geometry = new THREE.BufferGeometry();\n\n    // itemSize = 3 because there are 3 values (components) per vertex\n    geometry.addAttribute('position', new THREE.BufferAttribute(attributes.vertices, 3));\n    geometry.addAttribute('normal', new THREE.BufferAttribute(attributes.normals, 3));\n    geometry.addAttribute('color', new THREE.BufferAttribute(attributes.colours, 3));\n\n    if (attributes.pickingIds) {\n      geometry.addAttribute('pickingId', new THREE.BufferAttribute(attributes.pickingIds, 1));\n    }\n\n    geometry.computeBoundingBox();\n\n    // TODO: Make this work when style is a function per feature\n    var style = (typeof this._options.style === 'function') ? this._options.style(this._geojson.features[0]) : this._options.style;\n    style = extend({}, GeoJSON.defaultStyle, style);\n\n    var material;\n    if (this._options.polygonMaterial && this._options.polygonMaterial instanceof THREE.Material) {\n      material = this._options.polygonMaterial;\n    } else if (!this._world._environment._skybox) {\n      material = new THREE.MeshPhongMaterial({\n        vertexColors: THREE.VertexColors,\n        side: THREE.BackSide,\n        transparent: style.transparent,\n        opacity: style.opacity,\n        blending: style.blending\n      });\n    } else {\n      material = new THREE.MeshStandardMaterial({\n        vertexColors: THREE.VertexColors,\n        side: THREE.BackSide,\n        transparent: style.transparent,\n        opacity: style.opacity,\n        blending: style.blending\n      });\n      material.roughness = 1;\n      material.metalness = 0.1;\n      material.envMapIntensity = 3;\n      material.envMap = this._world._environment._skybox.getRenderTarget();\n    }\n\n    var mesh;\n\n    // Pass mesh through callback, if defined\n    if (typeof this._options.onPolygonMesh === 'function') {\n      mesh = this._options.onPolygonMesh(geometry, material);\n    } else {\n      mesh = new THREE.Mesh(geometry, material);\n\n      mesh.castShadow = true;\n      mesh.receiveShadow = true;\n    }\n\n    if (flat) {\n      material.depthWrite = false;\n      mesh.renderOrder = 1;\n    }\n\n    if (this._options.interactive && this._pickingMesh) {\n      material = new PickingMaterial();\n      material.side = THREE.BackSide;\n\n      var pickingMesh = new THREE.Mesh(geometry, material);\n      this._pickingMesh.add(pickingMesh);\n    }\n\n    this._polygonMesh = mesh;\n  }\n\n  _setPolylineMesh(attributes) {\n    var geometry = new THREE.BufferGeometry();\n\n    // itemSize = 3 because there are 3 values (components) per vertex\n    geometry.addAttribute('position', new THREE.BufferAttribute(attributes.vertices, 3));\n\n    if (attributes.normals) {\n      geometry.addAttribute('normal', new THREE.BufferAttribute(attributes.normals, 3));\n    }\n\n    geometry.addAttribute('color', new THREE.BufferAttribute(attributes.colours, 3));\n\n    if (attributes.pickingIds) {\n      geometry.addAttribute('pickingId', new THREE.BufferAttribute(attributes.pickingIds, 1));\n    }\n\n    geometry.computeBoundingBox();\n\n    // TODO: Make this work when style is a function per feature\n    var style = (typeof this._options.style === 'function') ? this._options.style(this._geojson.features[0]) : this._options.style;\n    style = extend({}, GeoJSON.defaultStyle, style);\n\n    var material;\n    if (this._options.polylineMaterial && this._options.polylineMaterial instanceof THREE.Material) {\n      material = this._options.polylineMaterial;\n    } else {\n      material = new THREE.LineBasicMaterial({\n        vertexColors: THREE.VertexColors,\n        linewidth: style.lineWidth,\n        transparent: style.lineTransparent,\n        opacity: style.lineOpacity,\n        blending: style.lineBlending\n      });\n    }\n\n    var mesh;\n\n    // Pass mesh through callback, if defined\n    if (typeof this._options.onPolylineMesh === 'function') {\n      mesh = this._options.onPolylineMesh(geometry, material);\n    } else {\n      mesh = new THREE.LineSegments(geometry, material);\n\n      if (style.lineRenderOrder !== undefined) {\n        material.depthWrite = false;\n        mesh.renderOrder = style.lineRenderOrder;\n      }\n\n      mesh.castShadow = true;\n      // mesh.receiveShadow = true;\n    }\n\n    // TODO: Allow this to be overridden, or copy mesh instead of creating a new\n    // one just for picking\n    if (this._options.interactive && this._pickingMesh) {\n      material = new PickingMaterial();\n      // material.side = THREE.BackSide;\n\n      // Make the line wider / easier to pick\n      material.linewidth = style.lineWidth + material.linePadding;\n\n      var pickingMesh = new THREE.LineSegments(geometry, material);\n      this._pickingMesh.add(pickingMesh);\n    }\n\n    this._polylineMesh = mesh;\n  }\n\n  _setPointMesh(attributes) {\n    var geometry = new THREE.BufferGeometry();\n\n    // itemSize = 3 because there are 3 values (components) per vertex\n    geometry.addAttribute('position', new THREE.BufferAttribute(attributes.vertices, 3));\n    geometry.addAttribute('normal', new THREE.BufferAttribute(attributes.normals, 3));\n    geometry.addAttribute('color', new THREE.BufferAttribute(attributes.colours, 3));\n\n    if (attributes.pickingIds) {\n      geometry.addAttribute('pickingId', new THREE.BufferAttribute(attributes.pickingIds, 1));\n    }\n\n    geometry.computeBoundingBox();\n\n    var material;\n    if (this._options.pointMaterial && this._options.pointMaterial instanceof THREE.Material) {\n      material = this._options.pointMaterial;\n    } else if (!this._world._environment._skybox) {\n      material = new THREE.MeshPhongMaterial({\n        vertexColors: THREE.VertexColors\n        // side: THREE.BackSide\n      });\n    } else {\n      material = new THREE.MeshStandardMaterial({\n        vertexColors: THREE.VertexColors\n        // side: THREE.BackSide\n      });\n      material.roughness = 1;\n      material.metalness = 0.1;\n      material.envMapIntensity = 3;\n      material.envMap = this._world._environment._skybox.getRenderTarget();\n    }\n\n    var mesh;\n\n    // Pass mesh callback, if defined\n    if (typeof this._options.onPointMesh === 'function') {\n      mesh = this._options.onPointMesh(geometry, material);\n    } else {\n      mesh = new THREE.Mesh(geometry, material);\n\n      mesh.castShadow = true;\n      // mesh.receiveShadow = true;\n    }\n\n    if (this._options.interactive && this._pickingMesh) {\n      material = new PickingMaterial();\n      // material.side = THREE.BackSide;\n\n      var pickingMesh = new THREE.Mesh(geometry, material);\n      this._pickingMesh.add(pickingMesh);\n    }\n\n    this._pointMesh = mesh;\n  }\n\n  // TODO: Support all GeoJSON geometry types\n  _featureToLayer(feature, options) {\n    var geometry = feature.geometry;\n    var coordinates = (geometry.coordinates) ? geometry.coordinates : null;\n\n    if (!coordinates || !geometry) {\n      return;\n    }\n\n    if (geometry.type === 'Polygon' || geometry.type === 'MultiPolygon') {\n      // Get material instance to use for polygon, if provided\n      if (typeof this._options.polygonMaterial === 'function') {\n        options.geometry = this._options.polygonMaterial(feature);\n      }\n\n      if (typeof this._options.onPolygonMesh === 'function') {\n        options.onMesh = this._options.onPolygonMesh;\n      }\n\n      // Pass onBufferAttributes callback, if defined\n      if (typeof this._options.onPolygonBufferAttributes === 'function') {\n        options.onBufferAttributes = this._options.onPolygonBufferAttributes;\n      }\n\n      return new PolygonLayer(coordinates, options);\n    }\n\n    if (geometry.type === 'LineString' || geometry.type === 'MultiLineString') {\n      // Get material instance to use for line, if provided\n      if (typeof this._options.lineMaterial === 'function') {\n        options.geometry = this._options.lineMaterial(feature);\n      }\n\n      if (typeof this._options.onPolylineMesh === 'function') {\n        options.onMesh = this._options.onPolylineMesh;\n      }\n\n      // Pass onBufferAttributes callback, if defined\n      if (typeof this._options.onPolylineBufferAttributes === 'function') {\n        options.onBufferAttributes = this._options.onPolylineBufferAttributes;\n      }\n\n      return new PolylineLayer(coordinates, options);\n    }\n\n    if (geometry.type === 'Point' || geometry.type === 'MultiPoint') {\n      // Get geometry object to use for point, if provided\n      if (typeof this._options.pointGeometry === 'function') {\n        options.geometry = this._options.pointGeometry(feature);\n      }\n\n      // Get material instance to use for point, if provided\n      if (typeof this._options.pointMaterial === 'function') {\n        options.geometry = this._options.pointMaterial(feature);\n      }\n\n      if (typeof this._options.onPointMesh === 'function') {\n        options.onMesh = this._options.onPointMesh;\n      }\n\n      return new PointLayer(coordinates, options);\n    }\n  }\n\n  _abortRequest() {\n    if (!this._request) {\n      return;\n    }\n\n    this._request.abort();\n  }\n\n  // Destroy the layers and remove them from the scene and memory\n  destroy() {\n    // Cancel any pending requests\n    this._abortRequest();\n\n    // Clear request reference\n    this._request = null;\n\n    this._geojson = null;\n\n    if (this._pickingMesh) {\n      // TODO: Properly dispose of picking mesh\n      this._pickingMesh = null;\n    }\n\n    if (this._polygonMesh) {\n      this._polygonMesh = null;\n    }\n\n    if (this._polylineMesh) {\n      this._polylineMesh = null;\n    }\n\n    if (this._pointMesh) {\n      this._pointMesh = null;\n    }\n\n    // Run common destruction logic from parent\n    super.destroy();\n  }\n}\n\nexport default GeoJSONLayer;\n\nvar noNew = function(geojson, options) {\n  return new GeoJSONLayer(geojson, options);\n};\n\nexport {noNew as geoJSONLayer};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/GeoJSONLayer.js\n **/","import Layer from './Layer';\nimport extend from 'lodash.assign';\n\nclass LayerGroup extends Layer {\n  constructor(options) {\n    var defaults = {\n      output: false\n    };\n\n    var _options = extend({}, defaults, options);\n\n    super(_options);\n\n    this._layers = [];\n  }\n\n  addLayer(layer) {\n    this._layers.push(layer);\n    this._world.addLayer(layer);\n  }\n\n  removeLayer(layer) {\n    var layerIndex = this._layers.indexOf(layer);\n\n    if (layerIndex > -1) {\n      // Remove from this._layers\n      this._layers.splice(layerIndex, 1);\n    };\n\n    this._world.removeLayer(layer);\n  }\n\n  _onAdd(world) {}\n\n  // Destroy the layers and remove them from the scene and memory\n  destroy() {\n    // TODO: Sometimes this is already null, find out why\n    if (this._layers) {\n      for (var i = 0; i < this._layers.length; i++) {\n        this._layers[i].destroy();\n      }\n\n      this._layers = null;\n    }\n\n    super.destroy();\n  }\n}\n\nexport default LayerGroup;\n\nvar noNew = function(options) {\n  return new LayerGroup(options);\n};\n\nexport {noNew as layerGroup};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/LayerGroup.js\n **/","/*!\n  * Reqwest! A general purpose XHR connection manager\n  * license MIT (c) Dustin Diaz 2015\n  * https://github.com/ded/reqwest\n  */\n\n!function (name, context, definition) {\n  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n  else if (typeof define == 'function' && define.amd) define(definition)\n  else context[name] = definition()\n}('reqwest', this, function () {\n\n  var context = this\n\n  if ('window' in context) {\n    var doc = document\n      , byTag = 'getElementsByTagName'\n      , head = doc[byTag]('head')[0]\n  } else {\n    var XHR2\n    try {\n      XHR2 = require('xhr2')\n    } catch (ex) {\n      throw new Error('Peer dependency `xhr2` required! Please npm install xhr2')\n    }\n  }\n\n\n  var httpsRe = /^http/\n    , protocolRe = /(^\\w+):\\/\\//\n    , twoHundo = /^(20\\d|1223)$/ //http://stackoverflow.com/questions/10046972/msie-returns-status-code-of-1223-for-ajax-request\n    , readyState = 'readyState'\n    , contentType = 'Content-Type'\n    , requestedWith = 'X-Requested-With'\n    , uniqid = 0\n    , callbackPrefix = 'reqwest_' + (+new Date())\n    , lastValue // data stored by the most recent JSONP callback\n    , xmlHttpRequest = 'XMLHttpRequest'\n    , xDomainRequest = 'XDomainRequest'\n    , noop = function () {}\n\n    , isArray = typeof Array.isArray == 'function'\n        ? Array.isArray\n        : function (a) {\n            return a instanceof Array\n          }\n\n    , defaultHeaders = {\n          'contentType': 'application/x-www-form-urlencoded'\n        , 'requestedWith': xmlHttpRequest\n        , 'accept': {\n              '*':  'text/javascript, text/html, application/xml, text/xml, */*'\n            , 'xml':  'application/xml, text/xml'\n            , 'html': 'text/html'\n            , 'text': 'text/plain'\n            , 'json': 'application/json, text/javascript'\n            , 'js':   'application/javascript, text/javascript'\n          }\n      }\n\n    , xhr = function(o) {\n        // is it x-domain\n        if (o['crossOrigin'] === true) {\n          var xhr = context[xmlHttpRequest] ? new XMLHttpRequest() : null\n          if (xhr && 'withCredentials' in xhr) {\n            return xhr\n          } else if (context[xDomainRequest]) {\n            return new XDomainRequest()\n          } else {\n            throw new Error('Browser does not support cross-origin requests')\n          }\n        } else if (context[xmlHttpRequest]) {\n          return new XMLHttpRequest()\n        } else if (XHR2) {\n          return new XHR2()\n        } else {\n          return new ActiveXObject('Microsoft.XMLHTTP')\n        }\n      }\n    , globalSetupOptions = {\n        dataFilter: function (data) {\n          return data\n        }\n      }\n\n  function succeed(r) {\n    var protocol = protocolRe.exec(r.url)\n    protocol = (protocol && protocol[1]) || context.location.protocol\n    return httpsRe.test(protocol) ? twoHundo.test(r.request.status) : !!r.request.response\n  }\n\n  function handleReadyState(r, success, error) {\n    return function () {\n      // use _aborted to mitigate against IE err c00c023f\n      // (can't read props on aborted request objects)\n      if (r._aborted) return error(r.request)\n      if (r._timedOut) return error(r.request, 'Request is aborted: timeout')\n      if (r.request && r.request[readyState] == 4) {\n        r.request.onreadystatechange = noop\n        if (succeed(r)) success(r.request)\n        else\n          error(r.request)\n      }\n    }\n  }\n\n  function setHeaders(http, o) {\n    var headers = o['headers'] || {}\n      , h\n\n    headers['Accept'] = headers['Accept']\n      || defaultHeaders['accept'][o['type']]\n      || defaultHeaders['accept']['*']\n\n    var isAFormData = typeof FormData !== 'undefined' && (o['data'] instanceof FormData);\n    // breaks cross-origin requests with legacy browsers\n    if (!o['crossOrigin'] && !headers[requestedWith]) headers[requestedWith] = defaultHeaders['requestedWith']\n    if (!headers[contentType] && !isAFormData) headers[contentType] = o['contentType'] || defaultHeaders['contentType']\n    for (h in headers)\n      headers.hasOwnProperty(h) && 'setRequestHeader' in http && http.setRequestHeader(h, headers[h])\n  }\n\n  function setCredentials(http, o) {\n    if (typeof o['withCredentials'] !== 'undefined' && typeof http.withCredentials !== 'undefined') {\n      http.withCredentials = !!o['withCredentials']\n    }\n  }\n\n  function generalCallback(data) {\n    lastValue = data\n  }\n\n  function urlappend (url, s) {\n    return url + (/\\?/.test(url) ? '&' : '?') + s\n  }\n\n  function handleJsonp(o, fn, err, url) {\n    var reqId = uniqid++\n      , cbkey = o['jsonpCallback'] || 'callback' // the 'callback' key\n      , cbval = o['jsonpCallbackName'] || reqwest.getcallbackPrefix(reqId)\n      , cbreg = new RegExp('((^|\\\\?|&)' + cbkey + ')=([^&]+)')\n      , match = url.match(cbreg)\n      , script = doc.createElement('script')\n      , loaded = 0\n      , isIE10 = navigator.userAgent.indexOf('MSIE 10.0') !== -1\n\n    if (match) {\n      if (match[3] === '?') {\n        url = url.replace(cbreg, '$1=' + cbval) // wildcard callback func name\n      } else {\n        cbval = match[3] // provided callback func name\n      }\n    } else {\n      url = urlappend(url, cbkey + '=' + cbval) // no callback details, add 'em\n    }\n\n    context[cbval] = generalCallback\n\n    script.type = 'text/javascript'\n    script.src = url\n    script.async = true\n    if (typeof script.onreadystatechange !== 'undefined' && !isIE10) {\n      // need this for IE due to out-of-order onreadystatechange(), binding script\n      // execution to an event listener gives us control over when the script\n      // is executed. See http://jaubourg.net/2010/07/loading-script-as-onclick-handler-of.html\n      script.htmlFor = script.id = '_reqwest_' + reqId\n    }\n\n    script.onload = script.onreadystatechange = function () {\n      if ((script[readyState] && script[readyState] !== 'complete' && script[readyState] !== 'loaded') || loaded) {\n        return false\n      }\n      script.onload = script.onreadystatechange = null\n      script.onclick && script.onclick()\n      // Call the user callback with the last value stored and clean up values and scripts.\n      fn(lastValue)\n      lastValue = undefined\n      head.removeChild(script)\n      loaded = 1\n    }\n\n    // Add the script to the DOM head\n    head.appendChild(script)\n\n    // Enable JSONP timeout\n    return {\n      abort: function () {\n        script.onload = script.onreadystatechange = null\n        err({}, 'Request is aborted: timeout', {})\n        lastValue = undefined\n        head.removeChild(script)\n        loaded = 1\n      }\n    }\n  }\n\n  function getRequest(fn, err) {\n    var o = this.o\n      , method = (o['method'] || 'GET').toUpperCase()\n      , url = typeof o === 'string' ? o : o['url']\n      // convert non-string objects to query-string form unless o['processData'] is false\n      , data = (o['processData'] !== false && o['data'] && typeof o['data'] !== 'string')\n        ? reqwest.toQueryString(o['data'])\n        : (o['data'] || null)\n      , http\n      , sendWait = false\n\n    // if we're working on a GET request and we have data then we should append\n    // query string to end of URL and not post data\n    if ((o['type'] == 'jsonp' || method == 'GET') && data) {\n      url = urlappend(url, data)\n      data = null\n    }\n\n    if (o['type'] == 'jsonp') return handleJsonp(o, fn, err, url)\n\n    // get the xhr from the factory if passed\n    // if the factory returns null, fall-back to ours\n    http = (o.xhr && o.xhr(o)) || xhr(o)\n\n    http.open(method, url, o['async'] === false ? false : true)\n    setHeaders(http, o)\n    setCredentials(http, o)\n    if (context[xDomainRequest] && http instanceof context[xDomainRequest]) {\n        http.onload = fn\n        http.onerror = err\n        // NOTE: see\n        // http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/30ef3add-767c-4436-b8a9-f1ca19b4812e\n        http.onprogress = function() {}\n        sendWait = true\n    } else {\n      http.onreadystatechange = handleReadyState(this, fn, err)\n    }\n    o['before'] && o['before'](http)\n    if (sendWait) {\n      setTimeout(function () {\n        http.send(data)\n      }, 200)\n    } else {\n      http.send(data)\n    }\n    return http\n  }\n\n  function Reqwest(o, fn) {\n    this.o = o\n    this.fn = fn\n\n    init.apply(this, arguments)\n  }\n\n  function setType(header) {\n    // json, javascript, text/plain, text/html, xml\n    if (header === null) return undefined; //In case of no content-type.\n    if (header.match('json')) return 'json'\n    if (header.match('javascript')) return 'js'\n    if (header.match('text')) return 'html'\n    if (header.match('xml')) return 'xml'\n  }\n\n  function init(o, fn) {\n\n    this.url = typeof o == 'string' ? o : o['url']\n    this.timeout = null\n\n    // whether request has been fulfilled for purpose\n    // of tracking the Promises\n    this._fulfilled = false\n    // success handlers\n    this._successHandler = function(){}\n    this._fulfillmentHandlers = []\n    // error handlers\n    this._errorHandlers = []\n    // complete (both success and fail) handlers\n    this._completeHandlers = []\n    this._erred = false\n    this._responseArgs = {}\n\n    var self = this\n\n    fn = fn || function () {}\n\n    if (o['timeout']) {\n      this.timeout = setTimeout(function () {\n        timedOut()\n      }, o['timeout'])\n    }\n\n    if (o['success']) {\n      this._successHandler = function () {\n        o['success'].apply(o, arguments)\n      }\n    }\n\n    if (o['error']) {\n      this._errorHandlers.push(function () {\n        o['error'].apply(o, arguments)\n      })\n    }\n\n    if (o['complete']) {\n      this._completeHandlers.push(function () {\n        o['complete'].apply(o, arguments)\n      })\n    }\n\n    function complete (resp) {\n      o['timeout'] && clearTimeout(self.timeout)\n      self.timeout = null\n      while (self._completeHandlers.length > 0) {\n        self._completeHandlers.shift()(resp)\n      }\n    }\n\n    function success (resp) {\n      var type = o['type'] || resp && setType(resp.getResponseHeader('Content-Type')) // resp can be undefined in IE\n      resp = (type !== 'jsonp') ? self.request : resp\n      // use global data filter on response text\n      var filteredResponse = globalSetupOptions.dataFilter(resp.responseText, type)\n        , r = filteredResponse\n      try {\n        resp.responseText = r\n      } catch (e) {\n        // can't assign this in IE<=8, just ignore\n      }\n      if (r) {\n        switch (type) {\n        case 'json':\n          try {\n            resp = context.JSON ? context.JSON.parse(r) : eval('(' + r + ')')\n          } catch (err) {\n            return error(resp, 'Could not parse JSON in response', err)\n          }\n          break\n        case 'js':\n          resp = eval(r)\n          break\n        case 'html':\n          resp = r\n          break\n        case 'xml':\n          resp = resp.responseXML\n              && resp.responseXML.parseError // IE trololo\n              && resp.responseXML.parseError.errorCode\n              && resp.responseXML.parseError.reason\n            ? null\n            : resp.responseXML\n          break\n        }\n      }\n\n      self._responseArgs.resp = resp\n      self._fulfilled = true\n      fn(resp)\n      self._successHandler(resp)\n      while (self._fulfillmentHandlers.length > 0) {\n        resp = self._fulfillmentHandlers.shift()(resp)\n      }\n\n      complete(resp)\n    }\n\n    function timedOut() {\n      self._timedOut = true\n      self.request.abort()\n    }\n\n    function error(resp, msg, t) {\n      resp = self.request\n      self._responseArgs.resp = resp\n      self._responseArgs.msg = msg\n      self._responseArgs.t = t\n      self._erred = true\n      while (self._errorHandlers.length > 0) {\n        self._errorHandlers.shift()(resp, msg, t)\n      }\n      complete(resp)\n    }\n\n    this.request = getRequest.call(this, success, error)\n  }\n\n  Reqwest.prototype = {\n    abort: function () {\n      this._aborted = true\n      this.request.abort()\n    }\n\n  , retry: function () {\n      init.call(this, this.o, this.fn)\n    }\n\n    /**\n     * Small deviation from the Promises A CommonJs specification\n     * http://wiki.commonjs.org/wiki/Promises/A\n     */\n\n    /**\n     * `then` will execute upon successful requests\n     */\n  , then: function (success, fail) {\n      success = success || function () {}\n      fail = fail || function () {}\n      if (this._fulfilled) {\n        this._responseArgs.resp = success(this._responseArgs.resp)\n      } else if (this._erred) {\n        fail(this._responseArgs.resp, this._responseArgs.msg, this._responseArgs.t)\n      } else {\n        this._fulfillmentHandlers.push(success)\n        this._errorHandlers.push(fail)\n      }\n      return this\n    }\n\n    /**\n     * `always` will execute whether the request succeeds or fails\n     */\n  , always: function (fn) {\n      if (this._fulfilled || this._erred) {\n        fn(this._responseArgs.resp)\n      } else {\n        this._completeHandlers.push(fn)\n      }\n      return this\n    }\n\n    /**\n     * `fail` will execute when the request fails\n     */\n  , fail: function (fn) {\n      if (this._erred) {\n        fn(this._responseArgs.resp, this._responseArgs.msg, this._responseArgs.t)\n      } else {\n        this._errorHandlers.push(fn)\n      }\n      return this\n    }\n  , 'catch': function (fn) {\n      return this.fail(fn)\n    }\n  }\n\n  function reqwest(o, fn) {\n    return new Reqwest(o, fn)\n  }\n\n  // normalize newline variants according to spec -> CRLF\n  function normalize(s) {\n    return s ? s.replace(/\\r?\\n/g, '\\r\\n') : ''\n  }\n\n  function serial(el, cb) {\n    var n = el.name\n      , t = el.tagName.toLowerCase()\n      , optCb = function (o) {\n          // IE gives value=\"\" even where there is no value attribute\n          // 'specified' ref: http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-862529273\n          if (o && !o['disabled'])\n            cb(n, normalize(o['attributes']['value'] && o['attributes']['value']['specified'] ? o['value'] : o['text']))\n        }\n      , ch, ra, val, i\n\n    // don't serialize elements that are disabled or without a name\n    if (el.disabled || !n) return\n\n    switch (t) {\n    case 'input':\n      if (!/reset|button|image|file/i.test(el.type)) {\n        ch = /checkbox/i.test(el.type)\n        ra = /radio/i.test(el.type)\n        val = el.value\n        // WebKit gives us \"\" instead of \"on\" if a checkbox has no value, so correct it here\n        ;(!(ch || ra) || el.checked) && cb(n, normalize(ch && val === '' ? 'on' : val))\n      }\n      break\n    case 'textarea':\n      cb(n, normalize(el.value))\n      break\n    case 'select':\n      if (el.type.toLowerCase() === 'select-one') {\n        optCb(el.selectedIndex >= 0 ? el.options[el.selectedIndex] : null)\n      } else {\n        for (i = 0; el.length && i < el.length; i++) {\n          el.options[i].selected && optCb(el.options[i])\n        }\n      }\n      break\n    }\n  }\n\n  // collect up all form elements found from the passed argument elements all\n  // the way down to child elements; pass a '<form>' or form fields.\n  // called with 'this'=callback to use for serial() on each element\n  function eachFormElement() {\n    var cb = this\n      , e, i\n      , serializeSubtags = function (e, tags) {\n          var i, j, fa\n          for (i = 0; i < tags.length; i++) {\n            fa = e[byTag](tags[i])\n            for (j = 0; j < fa.length; j++) serial(fa[j], cb)\n          }\n        }\n\n    for (i = 0; i < arguments.length; i++) {\n      e = arguments[i]\n      if (/input|select|textarea/i.test(e.tagName)) serial(e, cb)\n      serializeSubtags(e, [ 'input', 'select', 'textarea' ])\n    }\n  }\n\n  // standard query string style serialization\n  function serializeQueryString() {\n    return reqwest.toQueryString(reqwest.serializeArray.apply(null, arguments))\n  }\n\n  // { 'name': 'value', ... } style serialization\n  function serializeHash() {\n    var hash = {}\n    eachFormElement.apply(function (name, value) {\n      if (name in hash) {\n        hash[name] && !isArray(hash[name]) && (hash[name] = [hash[name]])\n        hash[name].push(value)\n      } else hash[name] = value\n    }, arguments)\n    return hash\n  }\n\n  // [ { name: 'name', value: 'value' }, ... ] style serialization\n  reqwest.serializeArray = function () {\n    var arr = []\n    eachFormElement.apply(function (name, value) {\n      arr.push({name: name, value: value})\n    }, arguments)\n    return arr\n  }\n\n  reqwest.serialize = function () {\n    if (arguments.length === 0) return ''\n    var opt, fn\n      , args = Array.prototype.slice.call(arguments, 0)\n\n    opt = args.pop()\n    opt && opt.nodeType && args.push(opt) && (opt = null)\n    opt && (opt = opt.type)\n\n    if (opt == 'map') fn = serializeHash\n    else if (opt == 'array') fn = reqwest.serializeArray\n    else fn = serializeQueryString\n\n    return fn.apply(null, args)\n  }\n\n  reqwest.toQueryString = function (o, trad) {\n    var prefix, i\n      , traditional = trad || false\n      , s = []\n      , enc = encodeURIComponent\n      , add = function (key, value) {\n          // If value is a function, invoke it and return its value\n          value = ('function' === typeof value) ? value() : (value == null ? '' : value)\n          s[s.length] = enc(key) + '=' + enc(value)\n        }\n    // If an array was passed in, assume that it is an array of form elements.\n    if (isArray(o)) {\n      for (i = 0; o && i < o.length; i++) add(o[i]['name'], o[i]['value'])\n    } else {\n      // If traditional, encode the \"old\" way (the way 1.3.2 or older\n      // did it), otherwise encode params recursively.\n      for (prefix in o) {\n        if (o.hasOwnProperty(prefix)) buildParams(prefix, o[prefix], traditional, add)\n      }\n    }\n\n    // spaces should be + according to spec\n    return s.join('&').replace(/%20/g, '+')\n  }\n\n  function buildParams(prefix, obj, traditional, add) {\n    var name, i, v\n      , rbracket = /\\[\\]$/\n\n    if (isArray(obj)) {\n      // Serialize array item.\n      for (i = 0; obj && i < obj.length; i++) {\n        v = obj[i]\n        if (traditional || rbracket.test(prefix)) {\n          // Treat each array item as a scalar.\n          add(prefix, v)\n        } else {\n          buildParams(prefix + '[' + (typeof v === 'object' ? i : '') + ']', v, traditional, add)\n        }\n      }\n    } else if (obj && obj.toString() === '[object Object]') {\n      // Serialize object item.\n      for (name in obj) {\n        buildParams(prefix + '[' + name + ']', obj[name], traditional, add)\n      }\n\n    } else {\n      // Serialize scalar item.\n      add(prefix, obj)\n    }\n  }\n\n  reqwest.getcallbackPrefix = function () {\n    return callbackPrefix\n  }\n\n  // jQuery and Zepto compatibility, differences can be remapped here so you can call\n  // .ajax.compat(options, callback)\n  reqwest.compat = function (o, fn) {\n    if (o) {\n      o['type'] && (o['method'] = o['type']) && delete o['type']\n      o['dataType'] && (o['type'] = o['dataType'])\n      o['jsonpCallback'] && (o['jsonpCallbackName'] = o['jsonpCallback']) && delete o['jsonpCallback']\n      o['jsonp'] && (o['jsonpCallback'] = o['jsonp'])\n    }\n    return new Reqwest(o, fn)\n  }\n\n  reqwest.ajaxSetup = function (options) {\n    options = options || {}\n    for (var k in options) {\n      globalSetupOptions[k] = options[k]\n    }\n  }\n\n  return reqwest\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/reqwest/reqwest.js\n ** module id = 58\n ** module chunks = 0\n **/","/*\n * GeoJSON helpers for handling data and generating objects\n */\n\nimport THREE from 'three';\nimport topojson from 'topojson';\nimport geojsonMerge from 'geojson-merge';\nimport earcut from 'earcut';\nimport extrudePolygon from './extrudePolygon';\n\n// TODO: Make it so height can be per-coordinate / point but connected together\n// as a linestring (eg. GPS points with an elevation at each point)\n//\n// This isn't really valid GeoJSON so perhaps something best left to an external\n// component for now, until a better approach can be considered\n//\n// See: http://lists.geojson.org/pipermail/geojson-geojson.org/2009-June/000489.html\n\n// Light and dark colours used for poor-mans AO gradient on object sides\nvar light = new THREE.Color(0xffffff);\nvar shadow  = new THREE.Color(0x666666);\n\nvar GeoJSON = (function() {\n  var defaultStyle = {\n    color: '#ffffff',\n    transparent: false,\n    opacity: 1,\n    blending: THREE.NormalBlending,\n    height: 0,\n    lineOpacity: 1,\n    lineTransparent: false,\n    lineColor: '#ffffff',\n    lineWidth: 1,\n    lineBlending: THREE.NormalBlending\n  };\n\n  // Attempts to merge together multiple GeoJSON Features or FeatureCollections\n  // into a single FeatureCollection\n  var collectFeatures = function(data, _topojson) {\n    var collections = [];\n\n    if (_topojson) {\n      // TODO: Allow TopoJSON objects to be overridden as an option\n\n      // If not overridden, merge all features from all objects\n      for (var tk in data.objects) {\n        collections.push(topojson.feature(data, data.objects[tk]));\n      }\n\n      return geojsonMerge(collections);\n    } else {\n      // If root doesn't have a type then let's see if there are features in the\n      // next step down\n      if (!data.type) {\n        // TODO: Allow GeoJSON objects to be overridden as an option\n\n        // If not overridden, merge all features from all objects\n        for (var gk in data) {\n          if (!data[gk].type) {\n            continue;\n          }\n\n          collections.push(data[gk]);\n        }\n\n        return geojsonMerge(collections);\n      } else if (Array.isArray(data)) {\n        return geojsonMerge(data);\n      } else {\n        return data;\n      }\n    }\n  };\n\n  // TODO: This is only used by GeoJSONTile so either roll it into that or\n  // update GeoJSONTile to use the new GeoJSONLayer or geometry layers\n  var lineStringAttributes = function(coordinates, colour, height) {\n    var _coords = [];\n    var _colours = [];\n\n    var nextCoord;\n\n    // Connect coordinate with the next to make a pair\n    //\n    // LineSegments requires pairs of vertices so repeat the last point if\n    // there's an odd number of vertices\n    coordinates.forEach((coordinate, index) => {\n      _colours.push([colour.r, colour.g, colour.b]);\n      _coords.push([coordinate[0], height, coordinate[1]]);\n\n      nextCoord = (coordinates[index + 1]) ? coordinates[index + 1] : coordinate;\n\n      _colours.push([colour.r, colour.g, colour.b]);\n      _coords.push([nextCoord[0], height, nextCoord[1]]);\n    });\n\n    return {\n      vertices: _coords,\n      colours: _colours\n    };\n  };\n\n  // TODO: This is only used by GeoJSONTile so either roll it into that or\n  // update GeoJSONTile to use the new GeoJSONLayer or geometry layers\n  var multiLineStringAttributes = function(coordinates, colour, height) {\n    var _coords = [];\n    var _colours = [];\n\n    var result;\n    coordinates.forEach(coordinate => {\n      result = lineStringAttributes(coordinate, colour, height);\n\n      result.vertices.forEach(coord => {\n        _coords.push(coord);\n      });\n\n      result.colours.forEach(colour => {\n        _colours.push(colour);\n      });\n    });\n\n    return {\n      vertices: _coords,\n      colours: _colours\n    };\n  };\n\n  // TODO: This is only used by GeoJSONTile so either roll it into that or\n  // update GeoJSONTile to use the new GeoJSONLayer or geometry layers\n  var polygonAttributes = function(coordinates, colour, height) {\n    var earcutData = _toEarcut(coordinates);\n\n    var faces = _triangulate(earcutData.vertices, earcutData.holes, earcutData.dimensions);\n\n    var groupedVertices = [];\n    for (i = 0, il = earcutData.vertices.length; i < il; i += earcutData.dimensions) {\n      groupedVertices.push(earcutData.vertices.slice(i, i + earcutData.dimensions));\n    }\n\n    var extruded = extrudePolygon(groupedVertices, faces, {\n      bottom: 0,\n      top: height\n    });\n\n    var topColor = colour.clone().multiply(light);\n    var bottomColor = colour.clone().multiply(shadow);\n\n    var _vertices = extruded.positions;\n    var _faces = [];\n    var _colours = [];\n\n    var _colour;\n    extruded.top.forEach((face, fi) => {\n      _colour = [];\n\n      _colour.push([colour.r, colour.g, colour.b]);\n      _colour.push([colour.r, colour.g, colour.b]);\n      _colour.push([colour.r, colour.g, colour.b]);\n\n      _faces.push(face);\n      _colours.push(_colour);\n    });\n\n    var allFlat = true;\n\n    if (extruded.sides) {\n      if (allFlat) {\n        allFlat = false;\n      }\n\n      // Set up colours for every vertex with poor-mans AO on the sides\n      extruded.sides.forEach((face, fi) => {\n        _colour = [];\n\n        // First face is always bottom-bottom-top\n        if (fi % 2 === 0) {\n          _colour.push([bottomColor.r, bottomColor.g, bottomColor.b]);\n          _colour.push([bottomColor.r, bottomColor.g, bottomColor.b]);\n          _colour.push([topColor.r, topColor.g, topColor.b]);\n        // Reverse winding for the second face\n        // top-top-bottom\n        } else {\n          _colour.push([topColor.r, topColor.g, topColor.b]);\n          _colour.push([topColor.r, topColor.g, topColor.b]);\n          _colour.push([bottomColor.r, bottomColor.g, bottomColor.b]);\n        }\n\n        _faces.push(face);\n        _colours.push(_colour);\n      });\n    }\n\n    // Skip bottom as there's no point rendering it\n    // allFaces.push(extruded.faces);\n\n    return {\n      vertices: _vertices,\n      faces: _faces,\n      colours: _colours,\n      flat: allFlat\n    };\n  };\n\n  // TODO: This is only used by GeoJSONTile so either roll it into that or\n  // update GeoJSONTile to use the new GeoJSONLayer or geometry layers\n  var _toEarcut = function(data) {\n    var dim = data[0][0].length;\n    var result = {vertices: [], holes: [], dimensions: dim};\n    var holeIndex = 0;\n\n    for (var i = 0; i < data.length; i++) {\n      for (var j = 0; j < data[i].length; j++) {\n        for (var d = 0; d < dim; d++) {\n          result.vertices.push(data[i][j][d]);\n        }\n      }\n      if (i > 0) {\n        holeIndex += data[i - 1].length;\n        result.holes.push(holeIndex);\n      }\n    }\n\n    return result;\n  };\n\n  // TODO: This is only used by GeoJSONTile so either roll it into that or\n  // update GeoJSONTile to use the new GeoJSONLayer or geometry layers\n  var _triangulate = function(contour, holes, dim) {\n    // console.time('earcut');\n\n    var faces = earcut(contour, holes, dim);\n    var result = [];\n\n    for (i = 0, il = faces.length; i < il; i += 3) {\n      result.push(faces.slice(i, i + 3));\n    }\n\n    // console.timeEnd('earcut');\n\n    return result;\n  };\n\n  return {\n    defaultStyle: defaultStyle,\n    collectFeatures: collectFeatures,\n    lineStringAttributes: lineStringAttributes,\n    multiLineStringAttributes: multiLineStringAttributes,\n    polygonAttributes: polygonAttributes\n  };\n})();\n\nexport default GeoJSON;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/GeoJSON.js\n **/","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (factory((global.topojson = global.topojson || {})));\n}(this, (function (exports) { 'use strict';\n\nfunction noop() {}\n\nfunction transformAbsolute(transform) {\n  if (!transform) return noop;\n  var x0,\n      y0,\n      kx = transform.scale[0],\n      ky = transform.scale[1],\n      dx = transform.translate[0],\n      dy = transform.translate[1];\n  return function(point, i) {\n    if (!i) x0 = y0 = 0;\n    point[0] = (x0 += point[0]) * kx + dx;\n    point[1] = (y0 += point[1]) * ky + dy;\n  };\n}\n\nfunction transformRelative(transform) {\n  if (!transform) return noop;\n  var x0,\n      y0,\n      kx = transform.scale[0],\n      ky = transform.scale[1],\n      dx = transform.translate[0],\n      dy = transform.translate[1];\n  return function(point, i) {\n    if (!i) x0 = y0 = 0;\n    var x1 = Math.round((point[0] - dx) / kx),\n        y1 = Math.round((point[1] - dy) / ky);\n    point[0] = x1 - x0;\n    point[1] = y1 - y0;\n    x0 = x1;\n    y0 = y1;\n  };\n}\n\nfunction reverse(array, n) {\n  var t, j = array.length, i = j - n;\n  while (i < --j) t = array[i], array[i++] = array[j], array[j] = t;\n}\n\nfunction bisect(a, x) {\n  var lo = 0, hi = a.length;\n  while (lo < hi) {\n    var mid = lo + hi >>> 1;\n    if (a[mid] < x) lo = mid + 1;\n    else hi = mid;\n  }\n  return lo;\n}\n\nfunction feature(topology, o) {\n  return o.type === \"GeometryCollection\" ? {\n    type: \"FeatureCollection\",\n    features: o.geometries.map(function(o) { return feature$1(topology, o); })\n  } : feature$1(topology, o);\n}\n\nfunction feature$1(topology, o) {\n  var f = {\n    type: \"Feature\",\n    id: o.id,\n    properties: o.properties || {},\n    geometry: object(topology, o)\n  };\n  if (o.id == null) delete f.id;\n  return f;\n}\n\nfunction object(topology, o) {\n  var absolute = transformAbsolute(topology.transform),\n      arcs = topology.arcs;\n\n  function arc(i, points) {\n    if (points.length) points.pop();\n    for (var a = arcs[i < 0 ? ~i : i], k = 0, n = a.length, p; k < n; ++k) {\n      points.push(p = a[k].slice());\n      absolute(p, k);\n    }\n    if (i < 0) reverse(points, n);\n  }\n\n  function point(p) {\n    p = p.slice();\n    absolute(p, 0);\n    return p;\n  }\n\n  function line(arcs) {\n    var points = [];\n    for (var i = 0, n = arcs.length; i < n; ++i) arc(arcs[i], points);\n    if (points.length < 2) points.push(points[0].slice());\n    return points;\n  }\n\n  function ring(arcs) {\n    var points = line(arcs);\n    while (points.length < 4) points.push(points[0].slice());\n    return points;\n  }\n\n  function polygon(arcs) {\n    return arcs.map(ring);\n  }\n\n  function geometry(o) {\n    var t = o.type;\n    return t === \"GeometryCollection\" ? {type: t, geometries: o.geometries.map(geometry)}\n        : t in geometryType ? {type: t, coordinates: geometryType[t](o)}\n        : null;\n  }\n\n  var geometryType = {\n    Point: function(o) { return point(o.coordinates); },\n    MultiPoint: function(o) { return o.coordinates.map(point); },\n    LineString: function(o) { return line(o.arcs); },\n    MultiLineString: function(o) { return o.arcs.map(line); },\n    Polygon: function(o) { return polygon(o.arcs); },\n    MultiPolygon: function(o) { return o.arcs.map(polygon); }\n  };\n\n  return geometry(o);\n}\n\nfunction stitchArcs(topology, arcs) {\n  var stitchedArcs = {},\n      fragmentByStart = {},\n      fragmentByEnd = {},\n      fragments = [],\n      emptyIndex = -1;\n\n  // Stitch empty arcs first, since they may be subsumed by other arcs.\n  arcs.forEach(function(i, j) {\n    var arc = topology.arcs[i < 0 ? ~i : i], t;\n    if (arc.length < 3 && !arc[1][0] && !arc[1][1]) {\n      t = arcs[++emptyIndex], arcs[emptyIndex] = i, arcs[j] = t;\n    }\n  });\n\n  arcs.forEach(function(i) {\n    var e = ends(i),\n        start = e[0],\n        end = e[1],\n        f, g;\n\n    if (f = fragmentByEnd[start]) {\n      delete fragmentByEnd[f.end];\n      f.push(i);\n      f.end = end;\n      if (g = fragmentByStart[end]) {\n        delete fragmentByStart[g.start];\n        var fg = g === f ? f : f.concat(g);\n        fragmentByStart[fg.start = f.start] = fragmentByEnd[fg.end = g.end] = fg;\n      } else {\n        fragmentByStart[f.start] = fragmentByEnd[f.end] = f;\n      }\n    } else if (f = fragmentByStart[end]) {\n      delete fragmentByStart[f.start];\n      f.unshift(i);\n      f.start = start;\n      if (g = fragmentByEnd[start]) {\n        delete fragmentByEnd[g.end];\n        var gf = g === f ? f : g.concat(f);\n        fragmentByStart[gf.start = g.start] = fragmentByEnd[gf.end = f.end] = gf;\n      } else {\n        fragmentByStart[f.start] = fragmentByEnd[f.end] = f;\n      }\n    } else {\n      f = [i];\n      fragmentByStart[f.start = start] = fragmentByEnd[f.end = end] = f;\n    }\n  });\n\n  function ends(i) {\n    var arc = topology.arcs[i < 0 ? ~i : i], p0 = arc[0], p1;\n    if (topology.transform) p1 = [0, 0], arc.forEach(function(dp) { p1[0] += dp[0], p1[1] += dp[1]; });\n    else p1 = arc[arc.length - 1];\n    return i < 0 ? [p1, p0] : [p0, p1];\n  }\n\n  function flush(fragmentByEnd, fragmentByStart) {\n    for (var k in fragmentByEnd) {\n      var f = fragmentByEnd[k];\n      delete fragmentByStart[f.start];\n      delete f.start;\n      delete f.end;\n      f.forEach(function(i) { stitchedArcs[i < 0 ? ~i : i] = 1; });\n      fragments.push(f);\n    }\n  }\n\n  flush(fragmentByEnd, fragmentByStart);\n  flush(fragmentByStart, fragmentByEnd);\n  arcs.forEach(function(i) { if (!stitchedArcs[i < 0 ? ~i : i]) fragments.push([i]); });\n\n  return fragments;\n}\n\nfunction mesh(topology) {\n  return object(topology, meshArcs.apply(this, arguments));\n}\n\nfunction meshArcs(topology, o, filter) {\n  var arcs = [];\n\n  function arc(i) {\n    var j = i < 0 ? ~i : i;\n    (geomsByArc[j] || (geomsByArc[j] = [])).push({i: i, g: geom});\n  }\n\n  function line(arcs) {\n    arcs.forEach(arc);\n  }\n\n  function polygon(arcs) {\n    arcs.forEach(line);\n  }\n\n  function geometry(o) {\n    if (o.type === \"GeometryCollection\") o.geometries.forEach(geometry);\n    else if (o.type in geometryType) geom = o, geometryType[o.type](o.arcs);\n  }\n\n  if (arguments.length > 1) {\n    var geomsByArc = [],\n        geom;\n\n    var geometryType = {\n      LineString: line,\n      MultiLineString: polygon,\n      Polygon: polygon,\n      MultiPolygon: function(arcs) { arcs.forEach(polygon); }\n    };\n\n    geometry(o);\n\n    geomsByArc.forEach(arguments.length < 3\n        ? function(geoms) { arcs.push(geoms[0].i); }\n        : function(geoms) { if (filter(geoms[0].g, geoms[geoms.length - 1].g)) arcs.push(geoms[0].i); });\n  } else {\n    for (var i = 0, n = topology.arcs.length; i < n; ++i) arcs.push(i);\n  }\n\n  return {type: \"MultiLineString\", arcs: stitchArcs(topology, arcs)};\n}\n\nfunction cartesianTriangleArea(triangle) {\n  var a = triangle[0], b = triangle[1], c = triangle[2];\n  return Math.abs((a[0] - c[0]) * (b[1] - a[1]) - (a[0] - b[0]) * (c[1] - a[1]));\n}\n\nfunction ring(ring) {\n  var i = -1,\n      n = ring.length,\n      a,\n      b = ring[n - 1],\n      area = 0;\n\n  while (++i < n) {\n    a = b;\n    b = ring[i];\n    area += a[0] * b[1] - a[1] * b[0];\n  }\n\n  return area / 2;\n}\n\nfunction merge(topology) {\n  return object(topology, mergeArcs.apply(this, arguments));\n}\n\nfunction mergeArcs(topology, objects) {\n  var polygonsByArc = {},\n      polygons = [],\n      components = [];\n\n  objects.forEach(function(o) {\n    if (o.type === \"Polygon\") register(o.arcs);\n    else if (o.type === \"MultiPolygon\") o.arcs.forEach(register);\n  });\n\n  function register(polygon) {\n    polygon.forEach(function(ring$$) {\n      ring$$.forEach(function(arc) {\n        (polygonsByArc[arc = arc < 0 ? ~arc : arc] || (polygonsByArc[arc] = [])).push(polygon);\n      });\n    });\n    polygons.push(polygon);\n  }\n\n  function area(ring$$) {\n    return Math.abs(ring(object(topology, {type: \"Polygon\", arcs: [ring$$]}).coordinates[0]));\n  }\n\n  polygons.forEach(function(polygon) {\n    if (!polygon._) {\n      var component = [],\n          neighbors = [polygon];\n      polygon._ = 1;\n      components.push(component);\n      while (polygon = neighbors.pop()) {\n        component.push(polygon);\n        polygon.forEach(function(ring$$) {\n          ring$$.forEach(function(arc) {\n            polygonsByArc[arc < 0 ? ~arc : arc].forEach(function(polygon) {\n              if (!polygon._) {\n                polygon._ = 1;\n                neighbors.push(polygon);\n              }\n            });\n          });\n        });\n      }\n    }\n  });\n\n  polygons.forEach(function(polygon) {\n    delete polygon._;\n  });\n\n  return {\n    type: \"MultiPolygon\",\n    arcs: components.map(function(polygons) {\n      var arcs = [], n;\n\n      // Extract the exterior (unique) arcs.\n      polygons.forEach(function(polygon) {\n        polygon.forEach(function(ring$$) {\n          ring$$.forEach(function(arc) {\n            if (polygonsByArc[arc < 0 ? ~arc : arc].length < 2) {\n              arcs.push(arc);\n            }\n          });\n        });\n      });\n\n      // Stitch the arcs into one or more rings.\n      arcs = stitchArcs(topology, arcs);\n\n      // If more than one ring is returned,\n      // at most one of these rings can be the exterior;\n      // choose the one with the greatest absolute area.\n      if ((n = arcs.length) > 1) {\n        for (var i = 1, k = area(arcs[0]), ki, t; i < n; ++i) {\n          if ((ki = area(arcs[i])) > k) {\n            t = arcs[0], arcs[0] = arcs[i], arcs[i] = t, k = ki;\n          }\n        }\n      }\n\n      return arcs;\n    })\n  };\n}\n\nfunction neighbors(objects) {\n  var indexesByArc = {}, // arc index -> array of object indexes\n      neighbors = objects.map(function() { return []; });\n\n  function line(arcs, i) {\n    arcs.forEach(function(a) {\n      if (a < 0) a = ~a;\n      var o = indexesByArc[a];\n      if (o) o.push(i);\n      else indexesByArc[a] = [i];\n    });\n  }\n\n  function polygon(arcs, i) {\n    arcs.forEach(function(arc) { line(arc, i); });\n  }\n\n  function geometry(o, i) {\n    if (o.type === \"GeometryCollection\") o.geometries.forEach(function(o) { geometry(o, i); });\n    else if (o.type in geometryType) geometryType[o.type](o.arcs, i);\n  }\n\n  var geometryType = {\n    LineString: line,\n    MultiLineString: polygon,\n    Polygon: polygon,\n    MultiPolygon: function(arcs, i) { arcs.forEach(function(arc) { polygon(arc, i); }); }\n  };\n\n  objects.forEach(geometry);\n\n  for (var i in indexesByArc) {\n    for (var indexes = indexesByArc[i], m = indexes.length, j = 0; j < m; ++j) {\n      for (var k = j + 1; k < m; ++k) {\n        var ij = indexes[j], ik = indexes[k], n;\n        if ((n = neighbors[ij])[i = bisect(n, ik)] !== ik) n.splice(i, 0, ik);\n        if ((n = neighbors[ik])[i = bisect(n, ij)] !== ij) n.splice(i, 0, ij);\n      }\n    }\n  }\n\n  return neighbors;\n}\n\nfunction compareArea(a, b) {\n  return a[1][2] - b[1][2];\n}\n\nfunction minAreaHeap() {\n  var heap = {},\n      array = [],\n      size = 0;\n\n  heap.push = function(object) {\n    up(array[object._ = size] = object, size++);\n    return size;\n  };\n\n  heap.pop = function() {\n    if (size <= 0) return;\n    var removed = array[0], object;\n    if (--size > 0) object = array[size], down(array[object._ = 0] = object, 0);\n    return removed;\n  };\n\n  heap.remove = function(removed) {\n    var i = removed._, object;\n    if (array[i] !== removed) return; // invalid request\n    if (i !== --size) object = array[size], (compareArea(object, removed) < 0 ? up : down)(array[object._ = i] = object, i);\n    return i;\n  };\n\n  function up(object, i) {\n    while (i > 0) {\n      var j = ((i + 1) >> 1) - 1,\n          parent = array[j];\n      if (compareArea(object, parent) >= 0) break;\n      array[parent._ = i] = parent;\n      array[object._ = i = j] = object;\n    }\n  }\n\n  function down(object, i) {\n    while (true) {\n      var r = (i + 1) << 1,\n          l = r - 1,\n          j = i,\n          child = array[j];\n      if (l < size && compareArea(array[l], child) < 0) child = array[j = l];\n      if (r < size && compareArea(array[r], child) < 0) child = array[j = r];\n      if (j === i) break;\n      array[child._ = i] = child;\n      array[object._ = i = j] = object;\n    }\n  }\n\n  return heap;\n}\n\nfunction presimplify(topology, triangleArea) {\n  var absolute = transformAbsolute(topology.transform),\n      relative = transformRelative(topology.transform),\n      heap = minAreaHeap();\n\n  if (!triangleArea) triangleArea = cartesianTriangleArea;\n\n  topology.arcs.forEach(function(arc) {\n    var triangles = [],\n        maxArea = 0,\n        triangle,\n        i,\n        n,\n        p;\n\n    // To store each point’s effective area, we create a new array rather than\n    // extending the passed-in point to workaround a Chrome/V8 bug (getting\n    // stuck in smi mode). For midpoints, the initial effective area of\n    // Infinity will be computed in the next step.\n    for (i = 0, n = arc.length; i < n; ++i) {\n      p = arc[i];\n      absolute(arc[i] = [p[0], p[1], Infinity], i);\n    }\n\n    for (i = 1, n = arc.length - 1; i < n; ++i) {\n      triangle = arc.slice(i - 1, i + 2);\n      triangle[1][2] = triangleArea(triangle);\n      triangles.push(triangle);\n      heap.push(triangle);\n    }\n\n    for (i = 0, n = triangles.length; i < n; ++i) {\n      triangle = triangles[i];\n      triangle.previous = triangles[i - 1];\n      triangle.next = triangles[i + 1];\n    }\n\n    while (triangle = heap.pop()) {\n      var previous = triangle.previous,\n          next = triangle.next;\n\n      // If the area of the current point is less than that of the previous point\n      // to be eliminated, use the latter's area instead. This ensures that the\n      // current point cannot be eliminated without eliminating previously-\n      // eliminated points.\n      if (triangle[1][2] < maxArea) triangle[1][2] = maxArea;\n      else maxArea = triangle[1][2];\n\n      if (previous) {\n        previous.next = next;\n        previous[2] = triangle[2];\n        update(previous);\n      }\n\n      if (next) {\n        next.previous = previous;\n        next[0] = triangle[0];\n        update(next);\n      }\n    }\n\n    arc.forEach(relative);\n  });\n\n  function update(triangle) {\n    heap.remove(triangle);\n    triangle[1][2] = triangleArea(triangle);\n    heap.push(triangle);\n  }\n\n  return topology;\n}\n\nvar version = \"1.6.27\";\n\nexports.version = version;\nexports.mesh = mesh;\nexports.meshArcs = meshArcs;\nexports.merge = merge;\nexports.mergeArcs = mergeArcs;\nexports.feature = feature;\nexports.neighbors = neighbors;\nexports.presimplify = presimplify;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/topojson/build/topojson.js\n ** module id = 61\n ** module chunks = 0\n **/","var normalize = require('geojson-normalize');\n\nmodule.exports = function(inputs) {\n    return {\n        type: 'FeatureCollection',\n        features: inputs.reduce(function(memo, input) {\n            return memo.concat(normalize(input).features);\n        }, [])\n    };\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/geojson-merge/index.js\n ** module id = 62\n ** module chunks = 0\n **/","module.exports = normalize;\n\nvar types = {\n    Point: 'geometry',\n    MultiPoint: 'geometry',\n    LineString: 'geometry',\n    MultiLineString: 'geometry',\n    Polygon: 'geometry',\n    MultiPolygon: 'geometry',\n    GeometryCollection: 'geometry',\n    Feature: 'feature',\n    FeatureCollection: 'featurecollection'\n};\n\n/**\n * Normalize a GeoJSON feature into a FeatureCollection.\n *\n * @param {object} gj geojson data\n * @returns {object} normalized geojson data\n */\nfunction normalize(gj) {\n    if (!gj || !gj.type) return null;\n    var type = types[gj.type];\n    if (!type) return null;\n\n    if (type === 'geometry') {\n        return {\n            type: 'FeatureCollection',\n            features: [{\n                type: 'Feature',\n                properties: {},\n                geometry: gj\n            }]\n        };\n    } else if (type === 'feature') {\n        return {\n            type: 'FeatureCollection',\n            features: [gj]\n        };\n    } else if (type === 'featurecollection') {\n        return gj;\n    }\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/geojson-normalize/index.js\n ** module id = 63\n ** module chunks = 0\n **/","'use strict';\n\nmodule.exports = earcut;\n\nfunction earcut(data, holeIndices, dim) {\n\n    dim = dim || 2;\n\n    var hasHoles = holeIndices && holeIndices.length,\n        outerLen = hasHoles ? holeIndices[0] * dim : data.length,\n        outerNode = linkedList(data, 0, outerLen, dim, true),\n        triangles = [];\n\n    if (!outerNode) return triangles;\n\n    var minX, minY, maxX, maxY, x, y, size;\n\n    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\n\n    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n    if (data.length > 80 * dim) {\n        minX = maxX = data[0];\n        minY = maxY = data[1];\n\n        for (var i = dim; i < outerLen; i += dim) {\n            x = data[i];\n            y = data[i + 1];\n            if (x < minX) minX = x;\n            if (y < minY) minY = y;\n            if (x > maxX) maxX = x;\n            if (y > maxY) maxY = y;\n        }\n\n        // minX, minY and size are later used to transform coords into integers for z-order calculation\n        size = Math.max(maxX - minX, maxY - minY);\n    }\n\n    earcutLinked(outerNode, triangles, dim, minX, minY, size);\n\n    return triangles;\n}\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList(data, start, end, dim, clockwise) {\n    var i, last;\n\n    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\n        for (i = start; i < end; i += dim) last = insertNode(i, data[i], data[i + 1], last);\n    } else {\n        for (i = end - dim; i >= start; i -= dim) last = insertNode(i, data[i], data[i + 1], last);\n    }\n\n    if (last && equals(last, last.next)) {\n        removeNode(last);\n        last = last.next;\n    }\n\n    return last;\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints(start, end) {\n    if (!start) return start;\n    if (!end) end = start;\n\n    var p = start,\n        again;\n    do {\n        again = false;\n\n        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\n            removeNode(p);\n            p = end = p.prev;\n            if (p === p.next) return null;\n            again = true;\n\n        } else {\n            p = p.next;\n        }\n    } while (again || p !== end);\n\n    return end;\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked(ear, triangles, dim, minX, minY, size, pass) {\n    if (!ear) return;\n\n    // interlink polygon nodes in z-order\n    if (!pass && size) indexCurve(ear, minX, minY, size);\n\n    var stop = ear,\n        prev, next;\n\n    // iterate through ears, slicing them one by one\n    while (ear.prev !== ear.next) {\n        prev = ear.prev;\n        next = ear.next;\n\n        if (size ? isEarHashed(ear, minX, minY, size) : isEar(ear)) {\n            // cut off the triangle\n            triangles.push(prev.i / dim);\n            triangles.push(ear.i / dim);\n            triangles.push(next.i / dim);\n\n            removeNode(ear);\n\n            // skipping the next vertice leads to less sliver triangles\n            ear = next.next;\n            stop = next.next;\n\n            continue;\n        }\n\n        ear = next;\n\n        // if we looped through the whole remaining polygon and can't find any more ears\n        if (ear === stop) {\n            // try filtering points and slicing again\n            if (!pass) {\n                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, size, 1);\n\n            // if this didn't work, try curing all small self-intersections locally\n            } else if (pass === 1) {\n                ear = cureLocalIntersections(ear, triangles, dim);\n                earcutLinked(ear, triangles, dim, minX, minY, size, 2);\n\n            // as a last resort, try splitting the remaining polygon into two\n            } else if (pass === 2) {\n                splitEarcut(ear, triangles, dim, minX, minY, size);\n            }\n\n            break;\n        }\n    }\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar(ear) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // now make sure we don't have other points inside the potential ear\n    var p = ear.next.next;\n\n    while (p !== ear.prev) {\n        if (pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.next;\n    }\n\n    return true;\n}\n\nfunction isEarHashed(ear, minX, minY, size) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // triangle bbox; min & max are calculated like this for speed\n    var minTX = a.x < b.x ? (a.x < c.x ? a.x : c.x) : (b.x < c.x ? b.x : c.x),\n        minTY = a.y < b.y ? (a.y < c.y ? a.y : c.y) : (b.y < c.y ? b.y : c.y),\n        maxTX = a.x > b.x ? (a.x > c.x ? a.x : c.x) : (b.x > c.x ? b.x : c.x),\n        maxTY = a.y > b.y ? (a.y > c.y ? a.y : c.y) : (b.y > c.y ? b.y : c.y);\n\n    // z-order range for the current triangle bbox;\n    var minZ = zOrder(minTX, minTY, minX, minY, size),\n        maxZ = zOrder(maxTX, maxTY, minX, minY, size);\n\n    // first look for points inside the triangle in increasing z-order\n    var p = ear.nextZ;\n\n    while (p && p.z <= maxZ) {\n        if (p !== ear.prev && p !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.nextZ;\n    }\n\n    // then look for points in decreasing z-order\n    p = ear.prevZ;\n\n    while (p && p.z >= minZ) {\n        if (p !== ear.prev && p !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n    }\n\n    return true;\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections(start, triangles, dim) {\n    var p = start;\n    do {\n        var a = p.prev,\n            b = p.next.next;\n\n        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\n\n            triangles.push(a.i / dim);\n            triangles.push(p.i / dim);\n            triangles.push(b.i / dim);\n\n            // remove two nodes involved\n            removeNode(p);\n            removeNode(p.next);\n\n            p = start = b;\n        }\n        p = p.next;\n    } while (p !== start);\n\n    return p;\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut(start, triangles, dim, minX, minY, size) {\n    // look for a valid diagonal that divides the polygon into two\n    var a = start;\n    do {\n        var b = a.next.next;\n        while (b !== a.prev) {\n            if (a.i !== b.i && isValidDiagonal(a, b)) {\n                // split the polygon in two by the diagonal\n                var c = splitPolygon(a, b);\n\n                // filter colinear points around the cuts\n                a = filterPoints(a, a.next);\n                c = filterPoints(c, c.next);\n\n                // run earcut on each half\n                earcutLinked(a, triangles, dim, minX, minY, size);\n                earcutLinked(c, triangles, dim, minX, minY, size);\n                return;\n            }\n            b = b.next;\n        }\n        a = a.next;\n    } while (a !== start);\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles(data, holeIndices, outerNode, dim) {\n    var queue = [],\n        i, len, start, end, list;\n\n    for (i = 0, len = holeIndices.length; i < len; i++) {\n        start = holeIndices[i] * dim;\n        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n        list = linkedList(data, start, end, dim, false);\n        if (list === list.next) list.steiner = true;\n        queue.push(getLeftmost(list));\n    }\n\n    queue.sort(compareX);\n\n    // process holes from left to right\n    for (i = 0; i < queue.length; i++) {\n        eliminateHole(queue[i], outerNode);\n        outerNode = filterPoints(outerNode, outerNode.next);\n    }\n\n    return outerNode;\n}\n\nfunction compareX(a, b) {\n    return a.x - b.x;\n}\n\n// find a bridge between vertices that connects hole with an outer ring and and link it\nfunction eliminateHole(hole, outerNode) {\n    outerNode = findHoleBridge(hole, outerNode);\n    if (outerNode) {\n        var b = splitPolygon(outerNode, hole);\n        filterPoints(b, b.next);\n    }\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge(hole, outerNode) {\n    var p = outerNode,\n        hx = hole.x,\n        hy = hole.y,\n        qx = -Infinity,\n        m;\n\n    // find a segment intersected by a ray from the hole's leftmost point to the left;\n    // segment's endpoint with lesser x will be potential connection point\n    do {\n        if (hy <= p.y && hy >= p.next.y) {\n            var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\n            if (x <= hx && x > qx) {\n                qx = x;\n                if (x === hx) {\n                    if (hy === p.y) return p;\n                    if (hy === p.next.y) return p.next;\n                }\n                m = p.x < p.next.x ? p : p.next;\n            }\n        }\n        p = p.next;\n    } while (p !== outerNode);\n\n    if (!m) return null;\n\n    if (hx === qx) return m.prev; // hole touches outer segment; pick lower endpoint\n\n    // look for points inside the triangle of hole point, segment intersection and endpoint;\n    // if there are no points found, we have a valid connection;\n    // otherwise choose the point of the minimum angle with the ray as connection point\n\n    var stop = m,\n        mx = m.x,\n        my = m.y,\n        tanMin = Infinity,\n        tan;\n\n    p = m.next;\n\n    while (p !== stop) {\n        if (hx >= p.x && p.x >= mx &&\n                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\n\n            tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\n\n            if ((tan < tanMin || (tan === tanMin && p.x > m.x)) && locallyInside(p, hole)) {\n                m = p;\n                tanMin = tan;\n            }\n        }\n\n        p = p.next;\n    }\n\n    return m;\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve(start, minX, minY, size) {\n    var p = start;\n    do {\n        if (p.z === null) p.z = zOrder(p.x, p.y, minX, minY, size);\n        p.prevZ = p.prev;\n        p.nextZ = p.next;\n        p = p.next;\n    } while (p !== start);\n\n    p.prevZ.nextZ = null;\n    p.prevZ = null;\n\n    sortLinked(p);\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked(list) {\n    var i, p, q, e, tail, numMerges, pSize, qSize,\n        inSize = 1;\n\n    do {\n        p = list;\n        list = null;\n        tail = null;\n        numMerges = 0;\n\n        while (p) {\n            numMerges++;\n            q = p;\n            pSize = 0;\n            for (i = 0; i < inSize; i++) {\n                pSize++;\n                q = q.nextZ;\n                if (!q) break;\n            }\n\n            qSize = inSize;\n\n            while (pSize > 0 || (qSize > 0 && q)) {\n\n                if (pSize === 0) {\n                    e = q;\n                    q = q.nextZ;\n                    qSize--;\n                } else if (qSize === 0 || !q) {\n                    e = p;\n                    p = p.nextZ;\n                    pSize--;\n                } else if (p.z <= q.z) {\n                    e = p;\n                    p = p.nextZ;\n                    pSize--;\n                } else {\n                    e = q;\n                    q = q.nextZ;\n                    qSize--;\n                }\n\n                if (tail) tail.nextZ = e;\n                else list = e;\n\n                e.prevZ = tail;\n                tail = e;\n            }\n\n            p = q;\n        }\n\n        tail.nextZ = null;\n        inSize *= 2;\n\n    } while (numMerges > 1);\n\n    return list;\n}\n\n// z-order of a point given coords and size of the data bounding box\nfunction zOrder(x, y, minX, minY, size) {\n    // coords are transformed into non-negative 15-bit integer range\n    x = 32767 * (x - minX) / size;\n    y = 32767 * (y - minY) / size;\n\n    x = (x | (x << 8)) & 0x00FF00FF;\n    x = (x | (x << 4)) & 0x0F0F0F0F;\n    x = (x | (x << 2)) & 0x33333333;\n    x = (x | (x << 1)) & 0x55555555;\n\n    y = (y | (y << 8)) & 0x00FF00FF;\n    y = (y | (y << 4)) & 0x0F0F0F0F;\n    y = (y | (y << 2)) & 0x33333333;\n    y = (y | (y << 1)) & 0x55555555;\n\n    return x | (y << 1);\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost(start) {\n    var p = start,\n        leftmost = start;\n    do {\n        if (p.x < leftmost.x) leftmost = p;\n        p = p.next;\n    } while (p !== start);\n\n    return leftmost;\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\n    return (cx - px) * (ay - py) - (ax - px) * (cy - py) >= 0 &&\n           (ax - px) * (by - py) - (bx - px) * (ay - py) >= 0 &&\n           (bx - px) * (cy - py) - (cx - px) * (by - py) >= 0;\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal(a, b) {\n    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) &&\n           locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b);\n}\n\n// signed area of a triangle\nfunction area(p, q, r) {\n    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\n}\n\n// check if two points are equal\nfunction equals(p1, p2) {\n    return p1.x === p2.x && p1.y === p2.y;\n}\n\n// check if two segments intersect\nfunction intersects(p1, q1, p2, q2) {\n    if ((equals(p1, q1) && equals(p2, q2)) ||\n        (equals(p1, q2) && equals(p2, q1))) return true;\n    return area(p1, q1, p2) > 0 !== area(p1, q1, q2) > 0 &&\n           area(p2, q2, p1) > 0 !== area(p2, q2, q1) > 0;\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon(a, b) {\n    var p = a;\n    do {\n        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n                intersects(p, p.next, a, b)) return true;\n        p = p.next;\n    } while (p !== a);\n\n    return false;\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside(a, b) {\n    return area(a.prev, a, a.next) < 0 ?\n        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\n        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside(a, b) {\n    var p = a,\n        inside = false,\n        px = (a.x + b.x) / 2,\n        py = (a.y + b.y) / 2;\n    do {\n        if (((p.y > py) !== (p.next.y > py)) && (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\n            inside = !inside;\n        p = p.next;\n    } while (p !== a);\n\n    return inside;\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon(a, b) {\n    var a2 = new Node(a.i, a.x, a.y),\n        b2 = new Node(b.i, b.x, b.y),\n        an = a.next,\n        bp = b.prev;\n\n    a.next = b;\n    b.prev = a;\n\n    a2.next = an;\n    an.prev = a2;\n\n    b2.next = a2;\n    a2.prev = b2;\n\n    bp.next = b2;\n    b2.prev = bp;\n\n    return b2;\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode(i, x, y, last) {\n    var p = new Node(i, x, y);\n\n    if (!last) {\n        p.prev = p;\n        p.next = p;\n\n    } else {\n        p.next = last.next;\n        p.prev = last;\n        last.next.prev = p;\n        last.next = p;\n    }\n    return p;\n}\n\nfunction removeNode(p) {\n    p.next.prev = p.prev;\n    p.prev.next = p.next;\n\n    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\n    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\n}\n\nfunction Node(i, x, y) {\n    // vertice index in coordinates array\n    this.i = i;\n\n    // vertex coordinates\n    this.x = x;\n    this.y = y;\n\n    // previous and next vertice nodes in a polygon ring\n    this.prev = null;\n    this.next = null;\n\n    // z-order curve value\n    this.z = null;\n\n    // previous and next nodes in z-order\n    this.prevZ = null;\n    this.nextZ = null;\n\n    // indicates whether this is a steiner point\n    this.steiner = false;\n}\n\n// return a percentage difference between the polygon area and its triangulation area;\n// used to verify correctness of triangulation\nearcut.deviation = function (data, holeIndices, dim, triangles) {\n    var hasHoles = holeIndices && holeIndices.length;\n    var outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n\n    var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\n    if (hasHoles) {\n        for (var i = 0, len = holeIndices.length; i < len; i++) {\n            var start = holeIndices[i] * dim;\n            var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n            polygonArea -= Math.abs(signedArea(data, start, end, dim));\n        }\n    }\n\n    var trianglesArea = 0;\n    for (i = 0; i < triangles.length; i += 3) {\n        var a = triangles[i] * dim;\n        var b = triangles[i + 1] * dim;\n        var c = triangles[i + 2] * dim;\n        trianglesArea += Math.abs(\n            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\n            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\n    }\n\n    return polygonArea === 0 && trianglesArea === 0 ? 0 :\n        Math.abs((trianglesArea - polygonArea) / polygonArea);\n};\n\nfunction signedArea(data, start, end, dim) {\n    var sum = 0;\n    for (var i = start, j = end - dim; i < end; i += dim) {\n        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\n        j = i;\n    }\n    return sum;\n}\n\n// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\nearcut.flatten = function (data) {\n    var dim = data[0][0].length,\n        result = {vertices: [], holes: [], dimensions: dim},\n        holeIndex = 0;\n\n    for (var i = 0; i < data.length; i++) {\n        for (var j = 0; j < data[i].length; j++) {\n            for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);\n        }\n        if (i > 0) {\n            holeIndex += data[i - 1].length;\n            result.holes.push(holeIndex);\n        }\n    }\n    return result;\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/earcut/src/earcut.js\n ** module id = 64\n ** module chunks = 0\n **/","/*\n * Extrude a polygon given its vertices and triangulated faces\n *\n * Based on:\n * https://github.com/freeman-lab/extrude\n */\n\nimport extend from 'lodash.assign';\n\nvar extrudePolygon = function(points, faces, _options) {\n  var defaults = {\n    top: 1,\n    bottom: 0,\n    closed: true\n  };\n\n  var options = extend({}, defaults, _options);\n\n  var n = points.length;\n  var positions;\n  var cells;\n  var topCells;\n  var bottomCells;\n  var sideCells;\n\n  // If bottom and top values are identical then return the flat shape\n  (options.top === options.bottom) ? flat() : full();\n\n  function flat() {\n    positions = points.map(function(p) { return [p[0], options.top, p[1]]; });\n    cells = faces;\n    topCells = faces;\n  }\n\n  function full() {\n    positions = [];\n    points.forEach(function(p) { positions.push([p[0], options.top, p[1]]); });\n    points.forEach(function(p) { positions.push([p[0], options.bottom, p[1]]); });\n\n    cells = [];\n    for (var i = 0; i < n; i++) {\n      if (i === (n - 1)) {\n        cells.push([i + n, n, i]);\n        cells.push([0, i, n]);\n      } else {\n        cells.push([i + n, i + n + 1, i]);\n        cells.push([i + 1, i, i + n + 1]);\n      }\n    }\n\n    sideCells = [].concat(cells);\n\n    if (options.closed) {\n      var top = faces;\n      var bottom = top.map(function(p) { return p.map(function(v) { return v + n; }); });\n      bottom = bottom.map(function(p) { return [p[0], p[2], p[1]]; });\n      cells = cells.concat(top).concat(bottom);\n\n      topCells = top;\n      bottomCells = bottom;\n    }\n  }\n\n  return {\n    positions: positions,\n    faces: cells,\n    top: topCells,\n    bottom: bottomCells,\n    sides: sideCells\n  };\n};\n\nexport default extrudePolygon;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/extrudePolygon.js\n **/","/*\n * BufferGeometry helpers\n */\n\nimport THREE from 'three';\n\nvar Buffer = (function() {\n  // Merge multiple attribute objects into a single attribute object\n  //\n  // Attribute objects must all use the same attribute keys\n  var mergeAttributes = function(attributes) {\n    var lengths = {};\n\n    // Find array lengths\n    attributes.forEach(_attributes => {\n      for (var k in _attributes) {\n        if (!lengths[k]) {\n          lengths[k] = 0;\n        }\n\n        lengths[k] += _attributes[k].length;\n      }\n    });\n\n    var mergedAttributes = {};\n\n    // Set up arrays to merge into\n    for (var k in lengths) {\n      mergedAttributes[k] = new Float32Array(lengths[k]);\n    }\n\n    var lastLengths = {};\n\n    attributes.forEach(_attributes => {\n      for (var k in _attributes) {\n        if (!lastLengths[k]) {\n          lastLengths[k] = 0;\n        }\n\n        mergedAttributes[k].set(_attributes[k], lastLengths[k]);\n\n        lastLengths[k] += _attributes[k].length;\n      }\n    });\n\n    return mergedAttributes;\n  };\n\n  var createLineGeometry = function(lines, offset) {\n    var geometry = new THREE.BufferGeometry();\n\n    var vertices = new Float32Array(lines.verticesCount * 3);\n    var colours = new Float32Array(lines.verticesCount * 3);\n\n    var pickingIds;\n    if (lines.pickingIds) {\n      // One component per vertex (1)\n      pickingIds = new Float32Array(lines.verticesCount);\n    }\n\n    var _vertices;\n    var _colour;\n    var _pickingId;\n\n    var lastIndex = 0;\n\n    for (var i = 0; i < lines.vertices.length; i++) {\n      _vertices = lines.vertices[i];\n      _colour = lines.colours[i];\n\n      if (pickingIds) {\n        _pickingId = lines.pickingIds[i];\n      }\n\n      for (var j = 0; j < _vertices.length; j++) {\n        var ax = _vertices[j][0] + offset.x;\n        var ay = _vertices[j][1];\n        var az = _vertices[j][2] + offset.y;\n\n        var c1 = _colour[j];\n\n        vertices[lastIndex * 3 + 0] = ax;\n        vertices[lastIndex * 3 + 1] = ay;\n        vertices[lastIndex * 3 + 2] = az;\n\n        colours[lastIndex * 3 + 0] = c1[0];\n        colours[lastIndex * 3 + 1] = c1[1];\n        colours[lastIndex * 3 + 2] = c1[2];\n\n        if (pickingIds) {\n          pickingIds[lastIndex] = _pickingId;\n        }\n\n        lastIndex++;\n      }\n    }\n\n    // itemSize = 3 because there are 3 values (components) per vertex\n    geometry.addAttribute('position', new THREE.BufferAttribute(vertices, 3));\n    geometry.addAttribute('color', new THREE.BufferAttribute(colours, 3));\n\n    if (pickingIds) {\n      geometry.addAttribute('pickingId', new THREE.BufferAttribute(pickingIds, 1));\n    }\n\n    geometry.computeBoundingBox();\n\n    return geometry;\n  };\n\n  // TODO: Make picking IDs optional\n  var createGeometry = function(attributes, offset) {\n    var geometry = new THREE.BufferGeometry();\n\n    // Three components per vertex per face (3 x 3 = 9)\n    var vertices = new Float32Array(attributes.facesCount * 9);\n    var normals = new Float32Array(attributes.facesCount * 9);\n    var colours = new Float32Array(attributes.facesCount * 9);\n\n    var pickingIds;\n    if (attributes.pickingIds) {\n      // One component per vertex per face (1 x 3 = 3)\n      pickingIds = new Float32Array(attributes.facesCount * 3);\n    }\n\n    var pA = new THREE.Vector3();\n    var pB = new THREE.Vector3();\n    var pC = new THREE.Vector3();\n\n    var cb = new THREE.Vector3();\n    var ab = new THREE.Vector3();\n\n    var index;\n    var _faces;\n    var _vertices;\n    var _colour;\n    var _pickingId;\n    var lastIndex = 0;\n    for (var i = 0; i < attributes.faces.length; i++) {\n      _faces = attributes.faces[i];\n      _vertices = attributes.vertices[i];\n      _colour = attributes.colours[i];\n\n      if (pickingIds) {\n        _pickingId = attributes.pickingIds[i];\n      }\n\n      for (var j = 0; j < _faces.length; j++) {\n        // Array of vertex indexes for the face\n        index = _faces[j][0];\n\n        var ax = _vertices[index][0] + offset.x;\n        var ay = _vertices[index][1];\n        var az = _vertices[index][2] + offset.y;\n\n        var c1 = _colour[j][0];\n\n        index = _faces[j][1];\n\n        var bx = _vertices[index][0] + offset.x;\n        var by = _vertices[index][1];\n        var bz = _vertices[index][2] + offset.y;\n\n        var c2 = _colour[j][1];\n\n        index = _faces[j][2];\n\n        var cx = _vertices[index][0] + offset.x;\n        var cy = _vertices[index][1];\n        var cz = _vertices[index][2] + offset.y;\n\n        var c3 = _colour[j][2];\n\n        // Flat face normals\n        // From: http://threejs.org/examples/webgl_buffergeometry.html\n        pA.set(ax, ay, az);\n        pB.set(bx, by, bz);\n        pC.set(cx, cy, cz);\n\n        cb.subVectors(pC, pB);\n        ab.subVectors(pA, pB);\n        cb.cross(ab);\n\n        cb.normalize();\n\n        var nx = cb.x;\n        var ny = cb.y;\n        var nz = cb.z;\n\n        vertices[lastIndex * 9 + 0] = ax;\n        vertices[lastIndex * 9 + 1] = ay;\n        vertices[lastIndex * 9 + 2] = az;\n\n        normals[lastIndex * 9 + 0] = nx;\n        normals[lastIndex * 9 + 1] = ny;\n        normals[lastIndex * 9 + 2] = nz;\n\n        colours[lastIndex * 9 + 0] = c1[0];\n        colours[lastIndex * 9 + 1] = c1[1];\n        colours[lastIndex * 9 + 2] = c1[2];\n\n        vertices[lastIndex * 9 + 3] = bx;\n        vertices[lastIndex * 9 + 4] = by;\n        vertices[lastIndex * 9 + 5] = bz;\n\n        normals[lastIndex * 9 + 3] = nx;\n        normals[lastIndex * 9 + 4] = ny;\n        normals[lastIndex * 9 + 5] = nz;\n\n        colours[lastIndex * 9 + 3] = c2[0];\n        colours[lastIndex * 9 + 4] = c2[1];\n        colours[lastIndex * 9 + 5] = c2[2];\n\n        vertices[lastIndex * 9 + 6] = cx;\n        vertices[lastIndex * 9 + 7] = cy;\n        vertices[lastIndex * 9 + 8] = cz;\n\n        normals[lastIndex * 9 + 6] = nx;\n        normals[lastIndex * 9 + 7] = ny;\n        normals[lastIndex * 9 + 8] = nz;\n\n        colours[lastIndex * 9 + 6] = c3[0];\n        colours[lastIndex * 9 + 7] = c3[1];\n        colours[lastIndex * 9 + 8] = c3[2];\n\n        if (pickingIds) {\n          pickingIds[lastIndex * 3 + 0] = _pickingId;\n          pickingIds[lastIndex * 3 + 1] = _pickingId;\n          pickingIds[lastIndex * 3 + 2] = _pickingId;\n        }\n\n        lastIndex++;\n      }\n    }\n\n    // itemSize = 3 because there are 3 values (components) per vertex\n    geometry.addAttribute('position', new THREE.BufferAttribute(vertices, 3));\n    geometry.addAttribute('normal', new THREE.BufferAttribute(normals, 3));\n    geometry.addAttribute('color', new THREE.BufferAttribute(colours, 3));\n\n    if (pickingIds) {\n      geometry.addAttribute('pickingId', new THREE.BufferAttribute(pickingIds, 1));\n    }\n\n    geometry.computeBoundingBox();\n\n    return geometry;\n  };\n\n  return {\n    mergeAttributes: mergeAttributes,\n    createLineGeometry: createLineGeometry,\n    createGeometry: createGeometry\n  };\n})();\n\nexport default Buffer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/Buffer.js\n **/","import THREE from 'three';\nimport PickingShader from './PickingShader';\n\n// FROM: https://github.com/brianxu/GPUPicker/blob/master/GPUPicker.js\n\nvar PickingMaterial = function() {\n  THREE.ShaderMaterial.call(this, {\n    uniforms: {\n      size: {\n        type: 'f',\n        value: 0.01,\n      },\n      scale: {\n        type: 'f',\n        value: 400,\n      }\n    },\n    // attributes: ['position', 'id'],\n    vertexShader: PickingShader.vertexShader,\n    fragmentShader: PickingShader.fragmentShader\n  });\n\n  this.linePadding = 2;\n};\n\nPickingMaterial.prototype = Object.create(THREE.ShaderMaterial.prototype);\n\nPickingMaterial.prototype.constructor = PickingMaterial;\n\nPickingMaterial.prototype.setPointSize = function(size) {\n  this.uniforms.size.value = size;\n};\n\nPickingMaterial.prototype.setPointScale = function(scale) {\n  this.uniforms.scale.value = scale;\n};\n\nexport default PickingMaterial;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/engine/PickingMaterial.js\n **/","// FROM: https://github.com/brianxu/GPUPicker/blob/master/GPUPicker.js\n\nvar PickingShader = {\n  vertexShader: [\n\t\t'attribute float pickingId;',\n\t\t// '',\n\t\t// 'uniform float size;',\n\t\t// 'uniform float scale;',\n\t\t'',\n\t\t'varying vec4 worldId;',\n\t\t'',\n\t\t'void main() {',\n\t\t'  vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',\n\t\t// '  gl_PointSize = size * ( scale / length( mvPosition.xyz ) );',\n\t\t'  vec3 a = fract(vec3(1.0/255.0, 1.0/(255.0*255.0), 1.0/(255.0*255.0*255.0)) * pickingId);',\n\t\t'  a -= a.xxy * vec3(0.0, 1.0/255.0, 1.0/255.0);',\n\t\t'  worldId = vec4(a,1);',\n\t\t'  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\n\t\t'}'\n\t].join('\\n'),\n\n  fragmentShader: [\n\t\t'#ifdef GL_ES\\n',\n\t\t'precision highp float;\\n',\n\t\t'#endif\\n',\n\t\t'',\n\t\t'varying vec4 worldId;',\n\t\t'',\n\t\t'void main() {',\n\t\t'  gl_FragColor = worldId;',\n\t\t'}'\n\t].join('\\n')\n};\n\nexport default PickingShader;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/engine/PickingShader.js\n **/","// TODO: Move duplicated logic between geometry layrs into GeometryLayer\n\n// TODO: Look at ways to drop unneeded references to array buffers, etc to\n// reduce memory footprint\n\n// TODO: Support dynamic updating / hiding / animation of geometry\n//\n// This could be pretty hard as it's all packed away within BufferGeometry and\n// may even be merged by another layer (eg. GeoJSONLayer)\n//\n// How much control should this layer support? Perhaps a different or custom\n// layer would be better suited for animation, for example.\n\n// TODO: Allow _setBufferAttributes to use a custom function passed in to\n// generate a custom mesh\n\nimport Layer from '../Layer';\nimport extend from 'lodash.assign';\nimport THREE from 'three';\nimport {latLon as LatLon} from '../../geo/LatLon';\nimport {point as Point} from '../../geo/Point';\nimport earcut from 'earcut';\nimport extrudePolygon from '../../util/extrudePolygon';\nimport PickingMaterial from '../../engine/PickingMaterial';\nimport Buffer from '../../util/Buffer';\n\nclass PolygonLayer extends Layer {\n  constructor(coordinates, options) {\n    var defaults = {\n      output: true,\n      interactive: false,\n      // Custom material override\n      //\n      // TODO: Should this be in the style object?\n      material: null,\n      onMesh: null,\n      onBufferAttributes: null,\n      // This default style is separate to Util.GeoJSON.defaultStyle\n      style: {\n        color: '#ffffff',\n        transparent: false,\n        opacity: 1,\n        blending: THREE.NormalBlending,\n        height: 0\n      }\n    };\n\n    var _options = extend({}, defaults, options);\n\n    super(_options);\n\n    // Return coordinates as array of polygons so it's easy to support\n    // MultiPolygon features (a single polygon would be a MultiPolygon with a\n    // single polygon in the array)\n    this._coordinates = (PolygonLayer.isSingle(coordinates)) ? [coordinates] : coordinates;\n  }\n\n  _onAdd(world) {\n    this._setCoordinates();\n\n    if (this._options.interactive) {\n      // Only add to picking mesh if this layer is controlling output\n      //\n      // Otherwise, assume another component will eventually add a mesh to\n      // the picking scene\n      if (this.isOutput()) {\n        this._pickingMesh = new THREE.Object3D();\n        this.addToPicking(this._pickingMesh);\n      }\n\n      this._setPickingId();\n      this._addPickingEvents();\n    }\n\n    // Store geometry representation as instances of THREE.BufferAttribute\n    this._setBufferAttributes();\n\n    if (this.isOutput()) {\n      // Set mesh if not merging elsewhere\n      this._setMesh(this._bufferAttributes);\n\n      // Output mesh\n      this.add(this._mesh);\n    }\n  }\n\n  // Return center of polygon as a LatLon\n  //\n  // This is used for things like placing popups / UI elements on the layer\n  //\n  // TODO: Find proper center position instead of returning first coordinate\n  // SEE: https://github.com/Leaflet/Leaflet/blob/master/src/layer/vector/Polygon.js#L15\n  getCenter() {\n    return this._center;\n  }\n\n  // Return polygon bounds in geographic coordinates\n  //\n  // TODO: Implement getBounds()\n  getBounds() {}\n\n  // Get unique ID for picking interaction\n  _setPickingId() {\n    this._pickingId = this.getPickingId();\n  }\n\n  // Set up and re-emit interaction events\n  _addPickingEvents() {\n    // TODO: Find a way to properly remove this listener on destroy\n    this._world.on('pick-' + this._pickingId, (point2d, point3d, intersects) => {\n      // Re-emit click event from the layer\n      this.emit('click', this, point2d, point3d, intersects);\n    });\n  }\n\n  // Create and store reference to THREE.BufferAttribute data for this layer\n  _setBufferAttributes() {\n    var attributes;\n\n    // Only use this if you know what you're doing\n    if (typeof this._options.onBufferAttributes === 'function') {\n      // TODO: Probably want to pass something less general as arguments,\n      // though passing the instance will do for now (it's everything)\n      attributes = this._options.onBufferAttributes(this);\n    } else {\n      var height = 0;\n\n      // Convert height into world units\n      if (this._options.style.height && this._options.style.height !== 0) {\n        height = this._world.metresToWorld(this._options.style.height, this._pointScale);\n      }\n\n      var colour = new THREE.Color();\n      colour.set(this._options.style.color);\n\n      // Light and dark colours used for poor-mans AO gradient on object sides\n      var light = new THREE.Color(0xffffff);\n      var shadow  = new THREE.Color(0x666666);\n\n      // For each polygon\n      attributes = this._projectedCoordinates.map(_projectedCoordinates => {\n        // Convert coordinates to earcut format\n        var _earcut = this._toEarcut(_projectedCoordinates);\n\n        // Triangulate faces using earcut\n        var faces = this._triangulate(_earcut.vertices, _earcut.holes, _earcut.dimensions);\n\n        var groupedVertices = [];\n        for (i = 0, il = _earcut.vertices.length; i < il; i += _earcut.dimensions) {\n          groupedVertices.push(_earcut.vertices.slice(i, i + _earcut.dimensions));\n        }\n\n        var extruded = extrudePolygon(groupedVertices, faces, {\n          bottom: 0,\n          top: height\n        });\n\n        var topColor = colour.clone().multiply(light);\n        var bottomColor = colour.clone().multiply(shadow);\n\n        var _vertices = extruded.positions;\n        var _faces = [];\n        var _colours = [];\n\n        var _colour;\n        extruded.top.forEach((face, fi) => {\n          _colour = [];\n\n          _colour.push([colour.r, colour.g, colour.b]);\n          _colour.push([colour.r, colour.g, colour.b]);\n          _colour.push([colour.r, colour.g, colour.b]);\n\n          _faces.push(face);\n          _colours.push(_colour);\n        });\n\n        this._flat = true;\n\n        if (extruded.sides) {\n          this._flat = false;\n\n          // Set up colours for every vertex with poor-mans AO on the sides\n          extruded.sides.forEach((face, fi) => {\n            _colour = [];\n\n            // First face is always bottom-bottom-top\n            if (fi % 2 === 0) {\n              _colour.push([bottomColor.r, bottomColor.g, bottomColor.b]);\n              _colour.push([bottomColor.r, bottomColor.g, bottomColor.b]);\n              _colour.push([topColor.r, topColor.g, topColor.b]);\n            // Reverse winding for the second face\n            // top-top-bottom\n            } else {\n              _colour.push([topColor.r, topColor.g, topColor.b]);\n              _colour.push([topColor.r, topColor.g, topColor.b]);\n              _colour.push([bottomColor.r, bottomColor.g, bottomColor.b]);\n            }\n\n            _faces.push(face);\n            _colours.push(_colour);\n          });\n        }\n\n        // Skip bottom as there's no point rendering it\n        // allFaces.push(extruded.faces);\n\n        var polygon = {\n          vertices: _vertices,\n          faces: _faces,\n          colours: _colours,\n          facesCount: _faces.length\n        };\n\n        if (this._options.interactive && this._pickingId) {\n          // Inject picking ID\n          polygon.pickingId = this._pickingId;\n        }\n\n        // Convert polygon representation to proper attribute arrays\n        return this._toAttributes(polygon);\n      });\n    }\n\n    this._bufferAttributes = Buffer.mergeAttributes(attributes);\n\n    // Original attributes are no longer required so free the memory\n    attributes = null;\n  }\n\n  getBufferAttributes() {\n    return this._bufferAttributes;\n  }\n\n  // Used by external components to clear some memory when the attributes\n  // are no longer required to be stored in this layer\n  //\n  // For example, you would want to clear the attributes here after merging them\n  // using something like the GeoJSONLayer\n  clearBufferAttributes() {\n    this._bufferAttributes = null;\n  }\n\n  // Used by external components to clear some memory when the coordinates\n  // are no longer required to be stored in this layer\n  //\n  // For example, you would want to clear the coordinates here after this\n  // layer is merged in something like the GeoJSONLayer\n  clearCoordinates() {\n    this._coordinates = null;\n    this._projectedCoordinates = null;\n  }\n\n  // Create and store mesh from buffer attributes\n  //\n  // This is only called if the layer is controlling its own output\n  _setMesh(attributes) {\n    var geometry = new THREE.BufferGeometry();\n\n    // itemSize = 3 because there are 3 values (components) per vertex\n    geometry.addAttribute('position', new THREE.BufferAttribute(attributes.vertices, 3));\n    geometry.addAttribute('normal', new THREE.BufferAttribute(attributes.normals, 3));\n    geometry.addAttribute('color', new THREE.BufferAttribute(attributes.colours, 3));\n\n    if (attributes.pickingIds) {\n      geometry.addAttribute('pickingId', new THREE.BufferAttribute(attributes.pickingIds, 1));\n    }\n\n    geometry.computeBoundingBox();\n\n    var material;\n    if (this._options.material && this._options.material instanceof THREE.Material) {\n      material = this._options.material;\n    } else if (!this._world._environment._skybox) {\n      material = new THREE.MeshPhongMaterial({\n        vertexColors: THREE.VertexColors,\n        side: THREE.BackSide,\n        transparent: this._options.style.transparent,\n        opacity: this._options.style.opacity,\n        blending: this._options.style.blending\n      });\n    } else {\n      material = new THREE.MeshStandardMaterial({\n        vertexColors: THREE.VertexColors,\n        side: THREE.BackSide,\n        transparent: this._options.style.transparent,\n        opacity: this._options.style.opacity,\n        blending: this._options.style.blending\n      });\n      material.roughness = 1;\n      material.metalness = 0.1;\n      material.envMapIntensity = 3;\n      material.envMap = this._world._environment._skybox.getRenderTarget();\n    }\n\n    var mesh;\n\n    // Pass mesh through callback, if defined\n    if (typeof this._options.onMesh === 'function') {\n      mesh = this._options.onMesh(geometry, material);\n    } else {\n      mesh = new THREE.Mesh(geometry, material);\n\n      mesh.castShadow = true;\n      mesh.receiveShadow = true;\n    }\n\n    if (this.isFlat()) {\n      material.depthWrite = false;\n      mesh.renderOrder = 1;\n    }\n\n    if (this._options.interactive && this._pickingMesh) {\n      material = new PickingMaterial();\n      material.side = THREE.BackSide;\n\n      var pickingMesh = new THREE.Mesh(geometry, material);\n      this._pickingMesh.add(pickingMesh);\n    }\n\n    this._mesh = mesh;\n  }\n\n  // Convert and project coordinates\n  //\n  // TODO: Calculate bounds\n  _setCoordinates() {\n    this._bounds = [];\n    this._coordinates = this._convertCoordinates(this._coordinates);\n\n    this._projectedBounds = [];\n    this._projectedCoordinates = this._projectCoordinates();\n\n    this._center = this._coordinates[0][0][0];\n  }\n\n  // Recursively convert input coordinates into LatLon objects\n  //\n  // Calculate geographic bounds at the same time\n  //\n  // TODO: Calculate geographic bounds\n  _convertCoordinates(coordinates) {\n    return coordinates.map(_coordinates => {\n      return _coordinates.map(ring => {\n        return ring.map(coordinate => {\n          return LatLon(coordinate[1], coordinate[0]);\n        });\n      });\n    });\n  }\n\n  // Recursively project coordinates into world positions\n  //\n  // Calculate world bounds, offset and pointScale at the same time\n  //\n  // TODO: Calculate world bounds\n  _projectCoordinates() {\n    var point;\n    return this._coordinates.map(_coordinates => {\n      return _coordinates.map(ring => {\n        return ring.map(latlon => {\n          point = this._world.latLonToPoint(latlon);\n\n          // TODO: Is offset ever being used or needed?\n          if (!this._offset) {\n            this._offset = Point(0, 0);\n            this._offset.x = -1 * point.x;\n            this._offset.y = -1 * point.y;\n\n            this._pointScale = this._world.pointScale(latlon);\n          }\n\n          return point;\n        });\n      });\n    });\n  }\n\n  // Convert coordinates array to something earcut can understand\n  _toEarcut(coordinates) {\n    var dim = 2;\n    var result = {vertices: [], holes: [], dimensions: dim};\n    var holeIndex = 0;\n\n    for (var i = 0; i < coordinates.length; i++) {\n      for (var j = 0; j < coordinates[i].length; j++) {\n        // for (var d = 0; d < dim; d++) {\n        result.vertices.push(coordinates[i][j].x);\n        result.vertices.push(coordinates[i][j].y);\n        // }\n      }\n      if (i > 0) {\n        holeIndex += coordinates[i - 1].length;\n        result.holes.push(holeIndex);\n      }\n    }\n\n    return result;\n  }\n\n  // Triangulate earcut-based input using earcut\n  _triangulate(contour, holes, dim) {\n    // console.time('earcut');\n\n    var faces = earcut(contour, holes, dim);\n    var result = [];\n\n    for (i = 0, il = faces.length; i < il; i += 3) {\n      result.push(faces.slice(i, i + 3));\n    }\n\n    // console.timeEnd('earcut');\n\n    return result;\n  }\n\n  // Transform polygon representation into attribute arrays that can be used by\n  // THREE.BufferGeometry\n  //\n  // TODO: Can this be simplified? It's messy and huge\n  _toAttributes(polygon) {\n    // Three components per vertex per face (3 x 3 = 9)\n    var vertices = new Float32Array(polygon.facesCount * 9);\n    var normals = new Float32Array(polygon.facesCount * 9);\n    var colours = new Float32Array(polygon.facesCount * 9);\n\n    var pickingIds;\n    if (polygon.pickingId) {\n      // One component per vertex per face (1 x 3 = 3)\n      pickingIds = new Float32Array(polygon.facesCount * 3);\n    }\n\n    var pA = new THREE.Vector3();\n    var pB = new THREE.Vector3();\n    var pC = new THREE.Vector3();\n\n    var cb = new THREE.Vector3();\n    var ab = new THREE.Vector3();\n\n    var index;\n\n    var _faces = polygon.faces;\n    var _vertices = polygon.vertices;\n    var _colour = polygon.colours;\n\n    var _pickingId;\n    if (pickingIds) {\n      _pickingId = polygon.pickingId;\n    }\n\n    var lastIndex = 0;\n\n    for (var i = 0; i < _faces.length; i++) {\n      // Array of vertex indexes for the face\n      index = _faces[i][0];\n\n      var ax = _vertices[index][0];\n      var ay = _vertices[index][1];\n      var az = _vertices[index][2];\n\n      var c1 = _colour[i][0];\n\n      index = _faces[i][1];\n\n      var bx = _vertices[index][0];\n      var by = _vertices[index][1];\n      var bz = _vertices[index][2];\n\n      var c2 = _colour[i][1];\n\n      index = _faces[i][2];\n\n      var cx = _vertices[index][0];\n      var cy = _vertices[index][1];\n      var cz = _vertices[index][2];\n\n      var c3 = _colour[i][2];\n\n      // Flat face normals\n      // From: http://threejs.org/examples/webgl_buffergeometry.html\n      pA.set(ax, ay, az);\n      pB.set(bx, by, bz);\n      pC.set(cx, cy, cz);\n\n      cb.subVectors(pC, pB);\n      ab.subVectors(pA, pB);\n      cb.cross(ab);\n\n      cb.normalize();\n\n      var nx = cb.x;\n      var ny = cb.y;\n      var nz = cb.z;\n\n      vertices[lastIndex * 9 + 0] = ax;\n      vertices[lastIndex * 9 + 1] = ay;\n      vertices[lastIndex * 9 + 2] = az;\n\n      normals[lastIndex * 9 + 0] = nx;\n      normals[lastIndex * 9 + 1] = ny;\n      normals[lastIndex * 9 + 2] = nz;\n\n      colours[lastIndex * 9 + 0] = c1[0];\n      colours[lastIndex * 9 + 1] = c1[1];\n      colours[lastIndex * 9 + 2] = c1[2];\n\n      vertices[lastIndex * 9 + 3] = bx;\n      vertices[lastIndex * 9 + 4] = by;\n      vertices[lastIndex * 9 + 5] = bz;\n\n      normals[lastIndex * 9 + 3] = nx;\n      normals[lastIndex * 9 + 4] = ny;\n      normals[lastIndex * 9 + 5] = nz;\n\n      colours[lastIndex * 9 + 3] = c2[0];\n      colours[lastIndex * 9 + 4] = c2[1];\n      colours[lastIndex * 9 + 5] = c2[2];\n\n      vertices[lastIndex * 9 + 6] = cx;\n      vertices[lastIndex * 9 + 7] = cy;\n      vertices[lastIndex * 9 + 8] = cz;\n\n      normals[lastIndex * 9 + 6] = nx;\n      normals[lastIndex * 9 + 7] = ny;\n      normals[lastIndex * 9 + 8] = nz;\n\n      colours[lastIndex * 9 + 6] = c3[0];\n      colours[lastIndex * 9 + 7] = c3[1];\n      colours[lastIndex * 9 + 8] = c3[2];\n\n      if (pickingIds) {\n        pickingIds[lastIndex * 3 + 0] = _pickingId;\n        pickingIds[lastIndex * 3 + 1] = _pickingId;\n        pickingIds[lastIndex * 3 + 2] = _pickingId;\n      }\n\n      lastIndex++;\n    }\n\n    var attributes = {\n      vertices: vertices,\n      normals: normals,\n      colours: colours\n    };\n\n    if (pickingIds) {\n      attributes.pickingIds = pickingIds;\n    }\n\n    return attributes;\n  }\n\n  // Returns true if the polygon is flat (has no height)\n  isFlat() {\n    return this._flat;\n  }\n\n  // Returns true if coordinates refer to a single geometry\n  //\n  // For example, not coordinates for a MultiPolygon GeoJSON feature\n  static isSingle(coordinates) {\n    return !Array.isArray(coordinates[0][0][0]);\n  }\n\n  // TODO: Make sure this is cleaning everything\n  destroy() {\n    if (this._pickingMesh) {\n      // TODO: Properly dispose of picking mesh\n      this._pickingMesh = null;\n    }\n\n    this.clearCoordinates();\n    this.clearBufferAttributes();\n\n    // Run common destruction logic from parent\n    super.destroy();\n  }\n}\n\nexport default PolygonLayer;\n\nvar noNew = function(coordinates, options) {\n  return new PolygonLayer(coordinates, options);\n};\n\nexport {noNew as polygonLayer};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/geometry/PolygonLayer.js\n **/","// TODO: Move duplicated logic between geometry layrs into GeometryLayer\n\n// TODO: Look at ways to drop unneeded references to array buffers, etc to\n// reduce memory footprint\n\n// TODO: Provide alternative output using tubes and splines / curves\n\n// TODO: Support dynamic updating / hiding / animation of geometry\n//\n// This could be pretty hard as it's all packed away within BufferGeometry and\n// may even be merged by another layer (eg. GeoJSONLayer)\n//\n// How much control should this layer support? Perhaps a different or custom\n// layer would be better suited for animation, for example.\n\n// TODO: Allow _setBufferAttributes to use a custom function passed in to\n// generate a custom mesh\n\nimport Layer from '../Layer';\nimport extend from 'lodash.assign';\nimport THREE from 'three';\nimport {latLon as LatLon} from '../../geo/LatLon';\nimport {point as Point} from '../../geo/Point';\nimport PickingMaterial from '../../engine/PickingMaterial';\nimport Buffer from '../../util/Buffer';\n\nclass PolylineLayer extends Layer {\n  constructor(coordinates, options) {\n    var defaults = {\n      output: true,\n      interactive: false,\n      // Custom material override\n      //\n      // TODO: Should this be in the style object?\n      material: null,\n      onMesh: null,\n      onBufferAttributes: null,\n      // This default style is separate to Util.GeoJSON.defaultStyle\n      style: {\n        lineOpacity: 1,\n        lineTransparent: false,\n        lineColor: '#ffffff',\n        lineWidth: 1,\n        lineBlending: THREE.NormalBlending\n      }\n    };\n\n    var _options = extend({}, defaults, options);\n\n    super(_options);\n\n    // Return coordinates as array of lines so it's easy to support\n    // MultiLineString features (a single line would be a MultiLineString with a\n    // single line in the array)\n    this._coordinates = (PolylineLayer.isSingle(coordinates)) ? [coordinates] : coordinates;\n\n    // Polyline features are always flat (for now at least)\n    this._flat = true;\n  }\n\n  _onAdd(world) {\n    this._setCoordinates();\n\n    if (this._options.interactive) {\n      // Only add to picking mesh if this layer is controlling output\n      //\n      // Otherwise, assume another component will eventually add a mesh to\n      // the picking scene\n      if (this.isOutput()) {\n        this._pickingMesh = new THREE.Object3D();\n        this.addToPicking(this._pickingMesh);\n      }\n\n      this._setPickingId();\n      this._addPickingEvents();\n    }\n\n    // Store geometry representation as instances of THREE.BufferAttribute\n    this._setBufferAttributes();\n\n    if (this.isOutput()) {\n      // Set mesh if not merging elsewhere\n      this._setMesh(this._bufferAttributes);\n\n      // Output mesh\n      this.add(this._mesh);\n    }\n  }\n\n  // Return center of polyline as a LatLon\n  //\n  // This is used for things like placing popups / UI elements on the layer\n  //\n  // TODO: Find proper center position instead of returning first coordinate\n  // SEE: https://github.com/Leaflet/Leaflet/blob/master/src/layer/vector/Polyline.js#L59\n  getCenter() {\n    return this._center;\n  }\n\n  // Return line bounds in geographic coordinates\n  //\n  // TODO: Implement getBounds()\n  getBounds() {}\n\n  // Get unique ID for picking interaction\n  _setPickingId() {\n    this._pickingId = this.getPickingId();\n  }\n\n  // Set up and re-emit interaction events\n  _addPickingEvents() {\n    // TODO: Find a way to properly remove this listener on destroy\n    this._world.on('pick-' + this._pickingId, (point2d, point3d, intersects) => {\n      // Re-emit click event from the layer\n      this.emit('click', this, point2d, point3d, intersects);\n    });\n  }\n\n  // Create and store reference to THREE.BufferAttribute data for this layer\n  _setBufferAttributes() {\n    var attributes;\n\n    // Only use this if you know what you're doing\n    if (typeof this._options.onBufferAttributes === 'function') {\n      // TODO: Probably want to pass something less general as arguments,\n      // though passing the instance will do for now (it's everything)\n      attributes = this._options.onBufferAttributes(this);\n    } else {\n      var height = 0;\n\n      // Convert height into world units\n      if (this._options.style.lineHeight) {\n        height = this._world.metresToWorld(this._options.style.lineHeight, this._pointScale);\n      }\n\n      var colour = new THREE.Color();\n      colour.set(this._options.style.lineColor);\n\n      // For each line\n      attributes = this._projectedCoordinates.map(_projectedCoordinates => {\n        var _vertices = [];\n        var _colours = [];\n\n        // Connect coordinate with the next to make a pair\n        //\n        // LineSegments requires pairs of vertices so repeat the last point if\n        // there's an odd number of vertices\n        var nextCoord;\n        _projectedCoordinates.forEach((coordinate, index) => {\n          _colours.push([colour.r, colour.g, colour.b]);\n          _vertices.push([coordinate.x, height, coordinate.y]);\n\n          nextCoord = (_projectedCoordinates[index + 1]) ? _projectedCoordinates[index + 1] : coordinate;\n\n          _colours.push([colour.r, colour.g, colour.b]);\n          _vertices.push([nextCoord.x, height, nextCoord.y]);\n        });\n\n        var line = {\n          vertices: _vertices,\n          colours: _colours,\n          verticesCount: _vertices.length\n        };\n\n        if (this._options.interactive && this._pickingId) {\n          // Inject picking ID\n          line.pickingId = this._pickingId;\n        }\n\n        // Convert line representation to proper attribute arrays\n        return this._toAttributes(line);\n      });\n    }\n\n    this._bufferAttributes = Buffer.mergeAttributes(attributes);\n\n    // Original attributes are no longer required so free the memory\n    attributes = null;\n  }\n\n  getBufferAttributes() {\n    return this._bufferAttributes;\n  }\n\n  // Used by external components to clear some memory when the attributes\n  // are no longer required to be stored in this layer\n  //\n  // For example, you would want to clear the attributes here after merging them\n  // using something like the GeoJSONLayer\n  clearBufferAttributes() {\n    this._bufferAttributes = null;\n  }\n\n  // Used by external components to clear some memory when the coordinates\n  // are no longer required to be stored in this layer\n  //\n  // For example, you would want to clear the coordinates here after this\n  // layer is merged in something like the GeoJSONLayer\n  clearCoordinates() {\n    this._coordinates = null;\n    this._projectedCoordinates = null;\n  }\n\n  // Create and store mesh from buffer attributes\n  //\n  // This is only called if the layer is controlling its own output\n  _setMesh(attributes) {\n    var geometry = new THREE.BufferGeometry();\n\n    // itemSize = 3 because there are 3 values (components) per vertex\n    geometry.addAttribute('position', new THREE.BufferAttribute(attributes.vertices, 3));\n\n    if (attributes.normals) {\n      geometry.addAttribute('normal', new THREE.BufferAttribute(attributes.normals, 3));\n    }\n\n    geometry.addAttribute('color', new THREE.BufferAttribute(attributes.colours, 3));\n\n    if (attributes.pickingIds) {\n      geometry.addAttribute('pickingId', new THREE.BufferAttribute(attributes.pickingIds, 1));\n    }\n\n    geometry.computeBoundingBox();\n\n    var style = this._options.style;\n    var material;\n\n    if (this._options.material && this._options.material instanceof THREE.Material) {\n      material = this._options.material;\n    } else {\n      material = new THREE.LineBasicMaterial({\n        vertexColors: THREE.VertexColors,\n        linewidth: style.lineWidth,\n        transparent: style.lineTransparent,\n        opacity: style.lineOpacity,\n        blending: style.lineBlending\n      });\n    }\n\n    var mesh;\n\n    // Pass mesh through callback, if defined\n    if (typeof this._options.onMesh === 'function') {\n      mesh = this._options.onMesh(geometry, material);\n    } else {\n      mesh = new THREE.LineSegments(geometry, material);\n\n      if (style.lineRenderOrder !== undefined) {\n        material.depthWrite = false;\n        mesh.renderOrder = style.lineRenderOrder;\n      }\n\n      mesh.castShadow = true;\n      // mesh.receiveShadow = true;\n    }\n\n    // TODO: Allow this to be overridden, or copy mesh instead of creating a new\n    // one just for picking\n    if (this._options.interactive && this._pickingMesh) {\n      material = new PickingMaterial();\n      // material.side = THREE.BackSide;\n\n      // Make the line wider / easier to pick\n      material.linewidth = style.lineWidth + material.linePadding;\n\n      var pickingMesh = new THREE.LineSegments(geometry, material);\n      this._pickingMesh.add(pickingMesh);\n    }\n\n    this._mesh = mesh;\n  }\n\n  // Convert and project coordinates\n  //\n  // TODO: Calculate bounds\n  _setCoordinates() {\n    this._bounds = [];\n    this._coordinates = this._convertCoordinates(this._coordinates);\n\n    this._projectedBounds = [];\n    this._projectedCoordinates = this._projectCoordinates();\n\n    this._center = this._coordinates[0][0];\n  }\n\n  // Recursively convert input coordinates into LatLon objects\n  //\n  // Calculate geographic bounds at the same time\n  //\n  // TODO: Calculate geographic bounds\n  _convertCoordinates(coordinates) {\n    return coordinates.map(_coordinates => {\n      return _coordinates.map(coordinate => {\n        return LatLon(coordinate[1], coordinate[0]);\n      });\n    });\n  }\n\n  // Recursively project coordinates into world positions\n  //\n  // Calculate world bounds, offset and pointScale at the same time\n  //\n  // TODO: Calculate world bounds\n  _projectCoordinates() {\n    var point;\n    return this._coordinates.map(_coordinates => {\n      return _coordinates.map(latlon => {\n        point = this._world.latLonToPoint(latlon);\n\n        // TODO: Is offset ever being used or needed?\n        if (!this._offset) {\n          this._offset = Point(0, 0);\n          this._offset.x = -1 * point.x;\n          this._offset.y = -1 * point.y;\n\n          this._pointScale = this._world.pointScale(latlon);\n        }\n\n        return point;\n      });\n    });\n  }\n\n  // Transform line representation into attribute arrays that can be used by\n  // THREE.BufferGeometry\n  //\n  // TODO: Can this be simplified? It's messy and huge\n  _toAttributes(line) {\n    // Three components per vertex\n    var vertices = new Float32Array(line.verticesCount * 3);\n    var colours = new Float32Array(line.verticesCount * 3);\n\n    var pickingIds;\n    if (line.pickingId) {\n      // One component per vertex\n      pickingIds = new Float32Array(line.verticesCount);\n    }\n\n    var _vertices = line.vertices;\n    var _colour = line.colours;\n\n    var normals;\n    var _normals;\n    if (line.normals) {\n      normals = new Float32Array(line.verticesCount * 3);\n      _normals = line.normals;\n    }\n\n    var _pickingId;\n    if (pickingIds) {\n      _pickingId = line.pickingId;\n    }\n\n    var lastIndex = 0;\n\n    for (var i = 0; i < _vertices.length; i++) {\n      var ax = _vertices[i][0];\n      var ay = _vertices[i][1];\n      var az = _vertices[i][2];\n\n      var nx;\n      var ny;\n      var nz;\n      if (_normals) {\n        nx = _normals[i][0];\n        ny = _normals[i][1];\n        nz = _normals[i][2];\n      }\n\n      var c1 = _colour[i];\n\n      vertices[lastIndex * 3 + 0] = ax;\n      vertices[lastIndex * 3 + 1] = ay;\n      vertices[lastIndex * 3 + 2] = az;\n\n      if (normals) {\n        normals[lastIndex * 3 + 0] = nx;\n        normals[lastIndex * 3 + 1] = ny;\n        normals[lastIndex * 3 + 2] = nz;\n      }\n\n      colours[lastIndex * 3 + 0] = c1[0];\n      colours[lastIndex * 3 + 1] = c1[1];\n      colours[lastIndex * 3 + 2] = c1[2];\n\n      if (pickingIds) {\n        pickingIds[lastIndex] = _pickingId;\n      }\n\n      lastIndex++;\n    }\n\n    var attributes = {\n      vertices: vertices,\n      colours: colours\n    };\n\n    if (normals) {\n      attributes.normals = normals;\n    }\n\n    if (pickingIds) {\n      attributes.pickingIds = pickingIds;\n    }\n\n    return attributes;\n  }\n\n  // Returns true if the line is flat (has no height)\n  isFlat() {\n    return this._flat;\n  }\n\n  // Returns true if coordinates refer to a single geometry\n  //\n  // For example, not coordinates for a MultiLineString GeoJSON feature\n  static isSingle(coordinates) {\n    return !Array.isArray(coordinates[0][0]);\n  }\n\n  destroy() {\n    if (this._pickingMesh) {\n      // TODO: Properly dispose of picking mesh\n      this._pickingMesh = null;\n    }\n\n    this.clearCoordinates();\n    this.clearBufferAttributes();\n\n    // Run common destruction logic from parent\n    super.destroy();\n  }\n}\n\nexport default PolylineLayer;\n\nvar noNew = function(coordinates, options) {\n  return new PolylineLayer(coordinates, options);\n};\n\nexport {noNew as polylineLayer};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/geometry/PolylineLayer.js\n **/","// TODO: Move duplicated logic between geometry layrs into GeometryLayer\n\n// TODO: Look at ways to drop unneeded references to array buffers, etc to\n// reduce memory footprint\n\n// TODO: Point features may be using custom models / meshes and so an approach\n// needs to be found to allow these to be brokwn down into buffer attributes for\n// merging\n//\n// Can probably use fromGeometry() or setFromObject() from THREE.BufferGeometry\n// and pull out the attributes\n\n// TODO: Support sprite objects using textures\n\n// TODO: Provide option to billboard geometry so it always faces the camera\n\n// TODO: Support dynamic updating / hiding / animation of geometry\n//\n// This could be pretty hard as it's all packed away within BufferGeometry and\n// may even be merged by another layer (eg. GeoJSONLayer)\n//\n// How much control should this layer support? Perhaps a different or custom\n// layer would be better suited for animation, for example.\n\nimport Layer from '../Layer';\nimport extend from 'lodash.assign';\nimport THREE from 'three';\nimport {latLon as LatLon} from '../../geo/LatLon';\nimport {point as Point} from '../../geo/Point';\nimport PickingMaterial from '../../engine/PickingMaterial';\nimport Buffer from '../../util/Buffer';\n\nclass PointLayer extends Layer {\n  constructor(coordinates, options) {\n    var defaults = {\n      output: true,\n      interactive: false,\n      // THREE.Geometry or THREE.BufferGeometry to use for point output\n      geometry: null,\n      // Custom material override\n      //\n      // TODO: Should this be in the style object?\n      material: null,\n      onMesh: null,\n      // This default style is separate to Util.GeoJSON.defaultStyle\n      style: {\n        pointColor: '#ff0000'\n      }\n    };\n\n    var _options = extend({}, defaults, options);\n\n    super(_options);\n\n    // Return coordinates as array of points so it's easy to support\n    // MultiPoint features (a single point would be a MultiPoint with a\n    // single point in the array)\n    this._coordinates = (PointLayer.isSingle(coordinates)) ? [coordinates] : coordinates;\n\n    // Point features are always flat (for now at least)\n    //\n    // This won't always be the case once custom point objects / meshes are\n    // added\n    this._flat = true;\n  }\n\n  _onAdd(world) {\n    this._setCoordinates();\n\n    if (this._options.interactive) {\n      // Only add to picking mesh if this layer is controlling output\n      //\n      // Otherwise, assume another component will eventually add a mesh to\n      // the picking scene\n      if (this.isOutput()) {\n        this._pickingMesh = new THREE.Object3D();\n        this.addToPicking(this._pickingMesh);\n      }\n\n      this._setPickingId();\n      this._addPickingEvents();\n    }\n\n    // Store geometry representation as instances of THREE.BufferAttribute\n    this._setBufferAttributes();\n\n    if (this.isOutput()) {\n      // Set mesh if not merging elsewhere\n      this._setMesh(this._bufferAttributes);\n\n      // Output mesh\n      this.add(this._mesh);\n    }\n  }\n\n  // Return center of point as a LatLon\n  //\n  // This is used for things like placing popups / UI elements on the layer\n  getCenter() {\n    return this._center;\n  }\n\n  // Return point bounds in geographic coordinates\n  //\n  // While not useful for single points, it could be useful for MultiPoint\n  //\n  // TODO: Implement getBounds()\n  getBounds() {}\n\n  // Get unique ID for picking interaction\n  _setPickingId() {\n    this._pickingId = this.getPickingId();\n  }\n\n  // Set up and re-emit interaction events\n  _addPickingEvents() {\n    // TODO: Find a way to properly remove this listener on destroy\n    this._world.on('pick-' + this._pickingId, (point2d, point3d, intersects) => {\n      // Re-emit click event from the layer\n      this.emit('click', this, point2d, point3d, intersects);\n    });\n  }\n\n  // Create and store reference to THREE.BufferAttribute data for this layer\n  _setBufferAttributes() {\n    var height = 0;\n\n    // Convert height into world units\n    if (this._options.style.pointHeight) {\n      height = this._world.metresToWorld(this._options.style.pointHeight, this._pointScale);\n    }\n\n    var colour = new THREE.Color();\n    colour.set(this._options.style.pointColor);\n\n    var geometry;\n\n    // Use default geometry if none has been provided or the provided geometry\n    // isn't valid\n    if (!this._options.geometry || (!this._options.geometry instanceof THREE.Geometry || !this._options.geometry instanceof THREE.BufferGeometry)) {\n      // Debug geometry for points is a thin bar\n      //\n      // TODO: Allow point geometry to be customised / overridden\n      var geometryWidth = this._world.metresToWorld(25, this._pointScale);\n      var geometryHeight = this._world.metresToWorld(200, this._pointScale);\n      var _geometry = new THREE.BoxGeometry(geometryWidth, geometryHeight, geometryWidth);\n\n      // Shift geometry up so it sits on the ground\n      _geometry.translate(0, geometryHeight * 0.5, 0);\n\n      // Pull attributes out of debug geometry\n      geometry = new THREE.BufferGeometry().fromGeometry(_geometry);\n    } else {\n      if (this._options.geometry instanceof THREE.BufferGeometry) {\n        geometry = this._options.geometry;\n      } else {\n        geometry = new THREE.BufferGeometry().fromGeometry(this._options.geometry);\n      }\n    }\n\n    // For each point\n    var attributes = this._projectedCoordinates.map(coordinate => {\n      var _vertices = [];\n      var _normals = [];\n      var _colours = [];\n\n      var _geometry = geometry.clone();\n\n      _geometry.translate(coordinate.x, height, coordinate.y);\n\n      var _vertices = _geometry.attributes.position.clone().array;\n      var _normals = _geometry.attributes.normal.clone().array;\n      var _colours = _geometry.attributes.color.clone().array;\n\n      for (var i = 0; i < _colours.length; i += 3) {\n        _colours[i] = colour.r;\n        _colours[i + 1] = colour.g;\n        _colours[i + 2] = colour.b;\n      }\n\n      var _point = {\n        vertices: _vertices,\n        normals: _normals,\n        colours: _colours\n      };\n\n      if (this._options.interactive && this._pickingId) {\n        // Inject picking ID\n        // point.pickingId = this._pickingId;\n        _point.pickingIds = new Float32Array(_vertices.length / 3);\n        for (var i = 0; i < _point.pickingIds.length; i++) {\n          _point.pickingIds[i] = this._pickingId;\n        }\n      }\n\n      // Convert point representation to proper attribute arrays\n      // return this._toAttributes(_point);\n      return _point;\n    });\n\n    this._bufferAttributes = Buffer.mergeAttributes(attributes);\n\n    // Original attributes are no longer required so free the memory\n    attributes = null;\n  }\n\n  getBufferAttributes() {\n    return this._bufferAttributes;\n  }\n\n  // Used by external components to clear some memory when the attributes\n  // are no longer required to be stored in this layer\n  //\n  // For example, you would want to clear the attributes here after merging them\n  // using something like the GeoJSONLayer\n  clearBufferAttributes() {\n    this._bufferAttributes = null;\n  }\n\n  // Used by external components to clear some memory when the coordinates\n  // are no longer required to be stored in this layer\n  //\n  // For example, you would want to clear the coordinates here after this\n  // layer is merged in something like the GeoJSONLayer\n  clearCoordinates() {\n    this._coordinates = null;\n    this._projectedCoordinates = null;\n  }\n\n  // Create and store mesh from buffer attributes\n  //\n  // This is only called if the layer is controlling its own output\n  _setMesh(attributes) {\n    var geometry = new THREE.BufferGeometry();\n\n    // itemSize = 3 because there are 3 values (components) per vertex\n    geometry.addAttribute('position', new THREE.BufferAttribute(attributes.vertices, 3));\n    geometry.addAttribute('normal', new THREE.BufferAttribute(attributes.normals, 3));\n    geometry.addAttribute('color', new THREE.BufferAttribute(attributes.colours, 3));\n\n    if (attributes.pickingIds) {\n      geometry.addAttribute('pickingId', new THREE.BufferAttribute(attributes.pickingIds, 1));\n    }\n\n    geometry.computeBoundingBox();\n\n    var material;\n\n    if (this._options.material && this._options.material instanceof THREE.Material) {\n      material = this._options.material;\n    } else if (!this._world._environment._skybox) {\n      material = new THREE.MeshBasicMaterial({\n        vertexColors: THREE.VertexColors\n        // side: THREE.BackSide\n      });\n    } else {\n      material = new THREE.MeshStandardMaterial({\n        vertexColors: THREE.VertexColors\n        // side: THREE.BackSide\n      });\n      material.roughness = 1;\n      material.metalness = 0.1;\n      material.envMapIntensity = 3;\n      material.envMap = this._world._environment._skybox.getRenderTarget();\n    }\n\n    var mesh;\n\n    // Pass mesh through callback, if defined\n    if (typeof this._options.onMesh === 'function') {\n      mesh = this._options.onMesh(geometry, material);\n    } else {\n      mesh = new THREE.Mesh(geometry, material);\n\n      mesh.castShadow = true;\n      // mesh.receiveShadow = true;\n    }\n\n    if (this._options.interactive && this._pickingMesh) {\n      material = new PickingMaterial();\n      // material.side = THREE.BackSide;\n\n      var pickingMesh = new THREE.Mesh(geometry, material);\n      this._pickingMesh.add(pickingMesh);\n    }\n\n    this._mesh = mesh;\n  }\n\n  // Convert and project coordinates\n  //\n  // TODO: Calculate bounds\n  _setCoordinates() {\n    this._bounds = [];\n    this._coordinates = this._convertCoordinates(this._coordinates);\n\n    this._projectedBounds = [];\n    this._projectedCoordinates = this._projectCoordinates();\n\n    this._center = this._coordinates;\n  }\n\n  // Recursively convert input coordinates into LatLon objects\n  //\n  // Calculate geographic bounds at the same time\n  //\n  // TODO: Calculate geographic bounds\n  _convertCoordinates(coordinates) {\n    return coordinates.map(coordinate => {\n      return LatLon(coordinate[1], coordinate[0]);\n    });\n  }\n\n  // Recursively project coordinates into world positions\n  //\n  // Calculate world bounds, offset and pointScale at the same time\n  //\n  // TODO: Calculate world bounds\n  _projectCoordinates() {\n    var _point;\n    return this._coordinates.map(latlon => {\n      _point = this._world.latLonToPoint(latlon);\n\n      // TODO: Is offset ever being used or needed?\n      if (!this._offset) {\n        this._offset = Point(0, 0);\n        this._offset.x = -1 * _point.x;\n        this._offset.y = -1 * _point.y;\n\n        this._pointScale = this._world.pointScale(latlon);\n      }\n\n      return _point;\n    });\n  }\n\n  // Transform line representation into attribute arrays that can be used by\n  // THREE.BufferGeometry\n  //\n  // TODO: Can this be simplified? It's messy and huge\n  _toAttributes(line) {\n    // Three components per vertex\n    var vertices = new Float32Array(line.verticesCount * 3);\n    var colours = new Float32Array(line.verticesCount * 3);\n\n    var pickingIds;\n    if (line.pickingId) {\n      // One component per vertex\n      pickingIds = new Float32Array(line.verticesCount);\n    }\n\n    var _vertices = line.vertices;\n    var _colour = line.colours;\n\n    var _pickingId;\n    if (pickingIds) {\n      _pickingId = line.pickingId;\n    }\n\n    var lastIndex = 0;\n\n    for (var i = 0; i < _vertices.length; i++) {\n      var ax = _vertices[i][0];\n      var ay = _vertices[i][1];\n      var az = _vertices[i][2];\n\n      var c1 = _colour[i];\n\n      vertices[lastIndex * 3 + 0] = ax;\n      vertices[lastIndex * 3 + 1] = ay;\n      vertices[lastIndex * 3 + 2] = az;\n\n      colours[lastIndex * 3 + 0] = c1[0];\n      colours[lastIndex * 3 + 1] = c1[1];\n      colours[lastIndex * 3 + 2] = c1[2];\n\n      if (pickingIds) {\n        pickingIds[lastIndex] = _pickingId;\n      }\n\n      lastIndex++;\n    }\n\n    var attributes = {\n      vertices: vertices,\n      colours: colours\n    };\n\n    if (pickingIds) {\n      attributes.pickingIds = pickingIds;\n    }\n\n    return attributes;\n  }\n\n  // Returns true if the line is flat (has no height)\n  isFlat() {\n    return this._flat;\n  }\n\n  // Returns true if coordinates refer to a single geometry\n  //\n  // For example, not coordinates for a MultiPoint GeoJSON feature\n  static isSingle(coordinates) {\n    return !Array.isArray(coordinates[0]);\n  }\n\n  destroy() {\n    if (this._pickingMesh) {\n      // TODO: Properly dispose of picking mesh\n      this._pickingMesh = null;\n    }\n\n    this.clearCoordinates();\n    this.clearBufferAttributes();\n\n    // Run common destruction logic from parent\n    super.destroy();\n  }\n}\n\nexport default PointLayer;\n\nvar noNew = function(coordinates, options) {\n  return new PointLayer(coordinates, options);\n};\n\nexport {noNew as pointLayer};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/geometry/PointLayer.js\n **/","import GeoJSONTileLayer from './GeoJSONTileLayer';\nimport extend from 'lodash.assign';\n\nclass TopoJSONTileLayer extends GeoJSONTileLayer {\n  constructor(path, options) {\n    var defaults = {\n      topojson: true\n    };\n\n    options = extend({}, defaults, options);\n\n    super(path, options);\n  }\n}\n\nexport default TopoJSONTileLayer;\n\nvar noNew = function(path, options) {\n  return new TopoJSONTileLayer(path, options);\n};\n\nexport {noNew as topoJSONTileLayer};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/tile/TopoJSONTileLayer.js\n **/","import GeoJSONLayer from './GeoJSONLayer';\nimport extend from 'lodash.assign';\n\nclass TopoJSONLayer extends GeoJSONLayer {\n  constructor(topojson, options) {\n    var defaults = {\n      topojson: true\n    };\n\n    options = extend({}, defaults, options);\n\n    super(topojson, options);\n  }\n}\n\nexport default TopoJSONLayer;\n\nvar noNew = function(topojson, options) {\n  return new TopoJSONLayer(topojson, options);\n};\n\n// Initialise without requiring new keyword\nexport {noNew as topoJSONLayer};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/TopoJSONLayer.js\n **/","/**\n * Created by masayuki on 20/07/2016.\n */\nimport SimObjectLayer from './SimObjectLayer';\nimport extend from 'lodash.assign';\nimport THREE from 'three';\nimport modelRepository from './ModelRepository';\nimport PedestrianModel from './PedestrianModel';\nimport Pedestrian from './Pedestrian';\n\nconst MODEL_PREFIX = 'pedestrian:';\n\nclass PedestrianLayer extends SimObjectLayer {\n  constructor(models, options) {\n    var defaults = {\n      output: true,\n    };\n\n    var _options = extend({}, defaults, options);\n\n    super(_options);\n\n    var modelDefaults = {\n      file: {\n        body: null,\n      },\n      scale: 1,\n      translation: {x: 0, y: 0, z: 0},\n      rotation: {rx: 0, ry: 0, rz: 0}\n    };\n    for (key in models) {\n      models[key] = extend({}, modelDefaults, models[key]);\n    }\n\n    this._modelsLoaded = false;\n    this._models = extend({}, models);\n    this._entries = [];\n  }\n\n  _onAdd(world) {\n    super._onAdd(world);\n\n    if (this.isOutput()) {\n      // add callback\n      this.on('loadCompleted', this._onLoadCompleted);\n\n      // load models\n      this._loadModels();\n    }\n  }\n\n  _loadModels() {\n    var self = this;\n\n    // load models iteratively\n    var models = this._models;\n    Object.keys(models).forEach(function(modelName) {\n      var model = models[modelName];\n\n      var scale = 1.0;\n      var translation = new THREE.Vector3();\n      var rotation = new THREE.Vector3();\n\n      if (model.scale) {\n        scale = model.scale;\n      }\n      if (model.translation) {\n        translation.set(model.translation.x, model.translation.y, model.translation.z);\n      }\n      if (model.rotation) {\n        rotation.set(model.rotation.x, model.rotation.y, model.rotation.z);\n      }\n\n      // create a model\n      var pedestrianModel = new PedestrianModel({\n        bodyURL: model.file.body,\n        scale: scale,\n        translation: translation,\n        rotation: rotation\n      }, callback);\n\n      // register to the repos\n      modelRepository.add(MODEL_PREFIX + modelName, pedestrianModel);\n    });\n\n    // callback\n    var counter = 0;\n    var len = Object.keys(models).length;\n    function callback(scope) {\n      if (++counter >= len) {\n        // loaded all models\n        self.emit('loadCompleted');\n      }\n    }\n  }\n\n  _onLoadCompleted() {\n    this._modelsLoaded = true;\n\n    // iterate over all the pedestrians already added and add meshes to the world\n    for (var i = 0; i < this._entries.length; i++) {\n      var entry = this._entries[i];\n      if (entry.pedestrian === null) {\n        this._addPedestrianInternal(entry);\n      }\n    }\n  }\n\n  addPedestrian(modelName, latlon, angle, options) {\n    if (!modelRepository.contains(MODEL_PREFIX + modelName)) {\n      throw new Error('Pedestrian model ' + modelName + ' does not exist.');\n    }\n\n    var self = this;\n\n    var entry = {\n      id: undefined,\n      modelName: modelName,\n      latlon: latlon,\n      angle: angle,\n      options: options,\n      pedestrian: null\n    };\n    var total = this._entries.push(entry);\n    entry.id = (total - 1);\n\n    // add pedestrian if the model is already loaded\n    this._addPedestrianInternal(entry);\n\n    return entry;\n  }\n\n  _addPedestrianInternal(entry) {\n    if (this._modelsLoaded) {\n\n      // instantiate the pedestrian\n      var pedestrianModel = modelRepository.get(MODEL_PREFIX + entry.modelName);\n      var pedestrian = new Pedestrian(pedestrianModel);\n\n      // add the pedestrian to the layer\n      this.add(pedestrian);\n      entry.pedestrian = pedestrian;\n\n      // set the pedestrian's location\n      this.setLocation(entry.id, entry.latlon.lat, entry.latlon.lon, entry.angle);\n    }\n  }\n\n  getPedestrian(id) {\n    if (id in this._entries) {\n      return this._entries[id];\n    }\n    return null;\n  }\n\n  destroy() {\n    // Run common destruction logic from parent\n    super.destroy();\n  }\n}\n\nexport default PedestrianLayer;\n\nvar noNew = function(models, options) {\n  return new PedestrianLayer(models, options);\n};\n\nexport {noNew as pedestrianLayer};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/object/PedestrianLayer.js\n **/","import Layer from '../Layer';\nimport extend from 'lodash.assign';\nimport THREE from 'three';\nimport {latLon as LatLon} from '../../geo/LatLon';\nimport {point as Point} from '../../geo/Point';\nimport earcut from 'earcut';\nimport extrudePolygon from '../../util/extrudePolygon';\nimport Buffer from '../../util/Buffer';\nimport GPUComputationRenderer from '../../vendor/GPUComputationRenderer';\nimport SimObject from './SimObject';\nimport VehicleVelocityShader from './VehicleVelocityShader';\nimport VehiclePositionShader from './VehiclePositionShader';\nimport VehicleShader from './VehicleShader';\nimport ObjectUtils from '../../util/ObjectUtils';\n\n/**\n * Object Layer that supports GPGPU object extrapolations\n */\nclass SimObjectLayer extends Layer {\n  constructor(options) {\n    var defaults = {\n      output: true,\n      dynamic: true, // indicates if each object needs to be updated in every frame update\n      // simulation:\n      enableGpuComputation: false,\n      simWidth: 2\n    };\n\n    var _options = extend({}, defaults, options);\n\n    super(_options);\n\n    this._simObjects = [];\n    this._gpuCompute = null;\n  }\n\n  _initComputeRenderer(world) {\n    var gpuCompute = new GPUComputationRenderer(this._options.simWidth, this._options.simWidth, world._engine._renderer);\n\n    // create textures\n    var textureAcceleration = gpuCompute.createTexture();\n    var textureVelocity = gpuCompute.createTexture();\n    var texturePosition = gpuCompute.createTexture();\n\n    var velocityVariable = gpuCompute.addVariable('textureVelocity', VehicleVelocityShader, textureVelocity);\n    var positionVariable = gpuCompute.addVariable('texturePosition', VehiclePositionShader, texturePosition);\n\n    gpuCompute.setVariableDependencies(velocityVariable, [positionVariable, velocityVariable]);\n    gpuCompute.setVariableDependencies(positionVariable, [positionVariable, velocityVariable]);\n\n    var positionUniforms = positionVariable.material.uniforms;\n    var velocityUniforms = velocityVariable.material.uniforms;\n\n    velocityVariable.wrapS = THREE.RepeatWrapping;\n    velocityVariable.wrapT = THREE.RepeatWrapping;\n    positionVariable.wrapS = THREE.RepeatWrapping;\n    positionVariable.wrapT = THREE.RepeatWrapping;\n\n    velocityUniforms.textureAcceleration.value = textureAcceleration;\n\n    var error = gpuCompute.init();\n    if (error !== null) {\n      console.error(error);\n    }\n\n    this._gpuCompute = gpuCompute;\n    this._textureAcceleration = textureAcceleration;\n    this._textureVelocity = textureVelocity;\n    this._texturePosition = texturePosition;\n    this._positionVariable = positionVariable;\n    this._velocityVariable = velocityVariable;\n    this._positionUniforms = positionUniforms;\n    this._velocityUniforms = velocityUniforms;\n  }\n\n  // add SimObject\n  add(simObject) {\n    // push to the array\n    var total = this._simObjects.push(simObject);\n    simObject.id = (total - 1);\n\n    // enable cpu update if necessary\n    simObject.updatePosition = this._options.dynamic && !this._options.enableGpuComputation;\n\n    // add Object3D to the layer\n    super.add(simObject.root);\n\n    // add CSS2DObject to the DOM2D layer\n    this.addDOM2D(simObject.label);\n  }\n\n  // remove SimObject\n  remove(simObject) {\n    // remove from the array\n    this._simObjects.splice(this._simObjects.indexOf(simObject), 1);\n\n    // remove Object3D from the layer\n    super.remove(simObject.root);\n\n    // remove CSS2DObject from the DOM2D layer\n    this.removeDOM2D(simObject.label);\n  }\n\n  _onAdd(world) {\n    super._onAdd(world);\n\n    var self = this;\n\n    if (this.isOutput()) {\n      if (this._options.enableGpuComputation) {\n        // initialize GPUComputationRenderer\n        this._initComputeRenderer(world);\n      }\n\n      // add listener\n      world.on('preUpdate', (delta) => {\n        self._onWorldUpdate(delta);\n      });\n    }\n  }\n\n  _onWorldUpdate(delta) {\n    this._performUpdate(delta);\n    this._performSimUpdate(delta);\n  }\n\n  _performUpdate(delta) {\n    for (var i = 0; i < this._simObjects.length; i++) {\n      this._simObjects[i].update(delta);\n    }\n  }\n\n  _performSimUpdate(delta) {\n    if (this._gpuCompute) {\n      var now = performance.now();\n\n      this._positionUniforms.time.value = now;\n      this._positionUniforms.delta.value = delta;\n      this._velocityUniforms.time.value = now;\n      this._velocityUniforms.delta.value = delta;\n\n      this._gpuCompute.compute();\n\n      // transfer objects' velocity parameters from gpu to cpu\n      var texturePosition = this._gpuCompute.readVariable(this._positionVariable, this._texturePosition);\n      var textureVelocity = this._gpuCompute.readVariable(this._velocityVariable, this._textureVelocity);\n      for (var i = 0; i < this._simObjects.length; i++) {\n        var object = this._simObjects[i];\n\n        var x = texturePosition.image.data[i * 4 + 0];\n        var y = texturePosition.image.data[i * 4 + 1];\n        var z = texturePosition.image.data[i * 4 + 2];\n        var angle = texturePosition.image.data[i * 4 + 3];\n        var velocity = textureVelocity.image.data[i * 4 + 0];\n\n        object.setPosition(x, y, z);\n        object.setAngle(-angle);\n        object.setVelocity(velocity);\n      }\n\n      // (for gpgpu rendering (no transfer to cpu))\n      // for (var i = 0; i < this._vehicles.length; i++) {\n      //   var vehicle = this._vehicles[i];\n      //   if (vehicle.mesh) {\n      //     vehicle.mesh.material.uniforms.texturePosition.value = this._gpuCompute.getCurrentRenderTarget(this._positionVariable).texture;\n      //     if (vehicle.mesh.material.uniforms.texture) {\n      //       vehicle.mesh.material.uniforms.texture.value = this._textures[vehicle.modelName];\n      //     }\n      //   }\n      // }\n    }\n  }\n\n  /**\n   * Set the location of a specific object\n   *\n   * @param {number} id SimObject id\n   * @param {number} lat latitude\n   * @param {number} lon longitude\n   * @param {number} angle angle\n   */\n  setLocation(id, lat, lon, angle) {\n    // calculate the position\n    var point = this._world.latLonToPoint(LatLon(lat, lon));\n    this.setPosition(id, point.x, 0, point.y, angle);\n  }\n\n  /**\n   * Set the position of a specific object\n   *\n   * @param {number} id SimObject id\n   * @param {number} x x\n   * @param {number} y y\n   * @param {number} z z\n   * @param {number} angle angle\n   */\n  setPosition(id, x, y, z, angle) {\n    this._setPosition(id, x, y, z, angle);\n    this._setSimPosition(id, x, y, z, angle);\n  }\n\n  _setPosition(id, x, y, z, angle) {\n    // if the vehicle exists\n    if (id in this._simObjects) {\n      var simObject = this._simObjects[id];\n\n      // update the vehicle\n      simObject.setPosition(x, y, z);\n      simObject.setAngle(angle);\n    }\n  }\n\n  _setSimPosition(id, x, y, z, angle) {\n    if (this._gpuCompute) {\n      console.log('_setSimPosition: ' + id + ', ' + x + ', ' + y + ', ' + z + ', ' + angle + ')');\n\n      // transmit from gpu to cpu\n      var texturePosition = this._gpuCompute.readVariable(this._positionVariable, this._texturePosition);\n\n      // (for extrapolation) update data\n      texturePosition.image.data[id * 4 + 0] = x;\n      texturePosition.image.data[id * 4 + 1] = y;\n      texturePosition.image.data[id * 4 + 2] = z;\n      texturePosition.image.data[id * 4 + 3] = angle;\n      texturePosition.needsUpdate = true;\n\n      // transmit from cpu to gpu\n      this._gpuCompute.updateVariable(this._positionVariable, texturePosition);\n    }\n  }\n\n  /**\n   * Set the velocity of a specific object\n   *\n   * @param {number} id SimObject id\n   * @param {number} vx x\n   * @param {number} vy y\n   * @param {number} vz z\n   * @param {number} wheel wheel\n   */\n  setVelocity(id, vx, vy, vz, wheel) {\n    this._setVelocity(id, vx, vy, vz, wheel);\n    this._setSimVelocity(id, vx, vy, vz, wheel);\n  }\n\n  _setVelocity(id, vx, vy, vz, wheel) {\n    // if the vehicle exists\n    if (id in this._simObjects) {\n      var simObject = this._simObjects[id];\n\n      // update the vehicle\n      simObject.setVelocity(vx); // TODO: use vy, vz?\n    }\n  }\n\n  _setSimVelocity(id, vx, vy, vz, wheel) {\n    if (this._gpuCompute) {\n      console.log('_setSimVelocity: ' + id + ', ' + vx + ', ' + vy + ', ' + vz + ', ' + wheel + ')');\n\n      // transmit from gpu to cpu\n      var textureVelocity = this._gpuCompute.readVariable(this._velocityVariable, this._textureVelocity);\n\n      // update data\n      textureVelocity.image.data[id * 4 + 0] = vx;\n      textureVelocity.image.data[id * 4 + 1] = vy;\n      textureVelocity.image.data[id * 4 + 2] = vz;\n      textureVelocity.image.data[id * 4 + 3] = wheel;\n      textureVelocity.needsUpdate = true;\n\n      // transmit from cpu to gpu\n      this._gpuCompute.updateVariable(this._velocityVariable, textureVelocity);\n    }\n  }\n\n  _setSimAcceleration(id, ax, ay, az, aw) {\n    if (this._gpuCompute) {\n      // update data in cpu-memory\n      this._velocityUniforms.textureAcceleration.value.image.data[id * 4 + 0] = ax;\n      this._velocityUniforms.textureAcceleration.value.image.data[id * 4 + 1] = ay;\n      this._velocityUniforms.textureAcceleration.value.image.data[id * 4 + 2] = az;\n      this._velocityUniforms.textureAcceleration.value.image.data[id * 4 + 3] = aw;\n      this._velocityUniforms.textureAcceleration.value.needsUpdate = true;\n    }\n  }\n\n  //\n  // locations = {\n  //   0: {lat: 0.0, lon: 0.0, angle: 0.0},\n  //   1: {lat: 1.0, lon: 1.0, angle: 0.0},\n  //   ...\n  //   id: {lat: lat, lon: lon, angle: angle}\n  // }\n  //\n  _setSimLocations(locations) {\n    var self = this;\n\n    var positions = {};\n    Object.keys(locations).forEach(function(id) {\n      var point = self._world.latLonToPoint(LatLon(locations[id].lat, locations[id].lon));\n      positions[id] = {x: point.x, y: 0.0, z: point.y, angle: locations[id].angle};\n    });\n\n    this._setSimPositions(positions);\n  }\n\n  //\n  // positions = {\n  //   0: {x: 0.0, y: 0.0, z: 0.0, angle: 0.0},\n  //   1: {x: 1.0, y: 1.0, z: 1.0, angle: 0.0},\n  //   ...\n  //   id: {x: x, y: y, z: z, angle: angle}\n  // }\n  //\n  _setSimPositions(positions) {\n    if (this._gpuCompute) {\n      // transmit from gpu to cpu\n      var texturePosition = this._gpuCompute.readVariable(this._positionVariable, this._texturePosition);\n\n      // update data\n      Object.keys(positions).forEach(function(id) {\n        // (for extrapolation)\n        texturePosition.image.data[id * 4 + 0] = positions[id].x;\n        texturePosition.image.data[id * 4 + 1] = positions[id].y;\n        texturePosition.image.data[id * 4 + 2] = positions[id].z;\n        texturePosition.image.data[id * 4 + 3] = positions[id].angle;\n      });\n      texturePosition.needsUpdate = true;\n\n      // transmit from cpu to gpu\n      this._gpuCompute.updateVariable(this._positionVariable, texturePosition);\n    }\n  }\n\n  //\n  // velocities = {\n  //   0: {vx: 0.0, vy: 0.0, vz: 0.0, wheel: 0.0},\n  //   1: {vx: 1.0, vy: 1.0, vz: 1.0, wheel: 0.0},\n  //   ...\n  //   id: {vx: vx, vy: vy, vz: vz, wheel: wheel}\n  // }\n  //\n  _setSimVelocities(velocities) {\n    if (this._gpuCompute) {\n      // transmit from gpu to cpu\n      var textureVelocity = this._gpuCompute.readVariable(this._velocityVariable, this._textureVelocity);\n\n      // update data\n      Object.keys(velocities).forEach(function(id) {\n        textureVelocity.image.data[id * 4 + 0] = velocities[id].vx;\n        textureVelocity.image.data[id * 4 + 1] = velocities[id].vy;\n        textureVelocity.image.data[id * 4 + 2] = velocities[id].vz;\n        textureVelocity.image.data[id * 4 + 3] = velocities[id].wheel;\n      });\n      textureVelocity.needsUpdate = true;\n\n      // transmit from cpu to gpu\n      this._gpuCompute.updateVariable(this._velocityVariable, textureVelocity);\n    }\n  }\n\n  _setSimAccelerations(accelerations) {\n    // TODO: implement a function to update all of the vehicles' accelerations\n  }\n\n  /**\n   * Set the label class\n   *\n   * @param {number} id\n   * @param {string} className\n   */\n  setLabelClass(id, className) {\n    // if the vehicle exists\n    if (id in this._simObjects) {\n      var simObject = this._simObjects[id];\n\n      // update the text\n      simObject.setLabelClass(className);\n    }\n  }\n\n  /**\n   * Set the label text\n   *\n   * @param {number} id\n   * @param {string} text\n   */\n  setLabelText(id, text) {\n    // if the vehicle exists\n    if (id in this._simObjects) {\n      var simObject = this._simObjects[id];\n\n      // update the text\n      simObject.setLabelText(text);\n    }\n  }\n\n  /**\n   * Sets the label offset\n   *\n   * @param {Number} id id\n   * @param {Number} x x\n   * @param {Number} y y\n   * @param {Number} z z\n   */\n  setLabelOffset(id, x, y, z) {\n    // if the object exists\n    if (id in this._simObjects) {\n      var simObject = this._simObjects[id];\n\n      // update the offset\n      simObject.setLabelOffset(x, y, z);\n    }\n  }\n\n  _debug() {\n    var texturePosition = this._gpuCompute.readVariable(this._positionVariable);\n    var textureVelocity = this._gpuCompute.readVariable(this._velocityVariable);\n\n    console.log('texturePosition:');\n    console.log(texturePosition.image.data);\n    console.log('textureVelocity:');\n    console.log(textureVelocity.image.data);\n  }\n\n  destroy() {\n    // Run common destruction logic from parent\n    super.destroy();\n  }\n\n}\n\nexport default SimObjectLayer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/object/SimObjectLayer.js\n **/","// jscs:disable\n/* eslint-disable */\n/**\n * @author yomboprime https://github.com/yomboprime\n *\n * GPUComputationRenderer, based on SimulationRenderer by zz85\n *\n * The GPUComputationRenderer uses the concept of variables. These variables are RGBA float textures that hold 4 floats\n * for each compute element (texel)\n *\n * Each variable has a fragment shader that defines the computation made to obtain the variable in question.\n * You can use as many variables you need, and make dependencies so you can use textures of other variables in the shader\n * (the sampler uniforms are added automatically) Most of the variables will need themselves as dependency.\n *\n * The renderer has actually two render targets per variable, to make ping-pong. Textures from the current frame are used\n * as inputs to render the textures of the next frame.\n *\n * The render targets of the variables can be used as input textures for your visualization shaders.\n *\n * Variable names should be valid identifiers and should not collide with THREE GLSL used identifiers.\n * a common approach could be to use 'texture' prefixing the variable name; i.e texturePosition, textureVelocity...\n *\n * The size of the computation (sizeX * sizeY) is defined as 'resolution' automatically in the shader. For example:\n * #DEFINE resolution vec2( 1024.0, 1024.0 )\n *\n * -------------\n *\n * Basic use:\n *\n * // Initialization...\n *\n * // Create computation renderer\n * var gpuCompute = new GPUComputationRenderer( 1024, 1024, renderer );\n *\n * // Create initial state float textures\n * var pos0 = gpuCompute.createTexture();\n * var vel0 = gpuCompute.createTexture();\n * // and fill in here the texture data...\n *\n * // Add texture variables\n * var velVar = gpuCompute.addVariable( \"textureVelocity\", fragmentShaderVel, pos0 );\n * var posVar = gpuCompute.addVariable( \"texturePosition\", fragmentShaderPos, vel0 );\n *\n * // Add variable dependencies\n * gpuCompute.setVariableDependencies( velVar, [ velVar, posVar ] );\n * gpuCompute.setVariableDependencies( posVar, [ velVar, posVar ] );\n *\n * // Add custom uniforms\n * velVar.material.uniforms.time = { value: 0.0 };\n *\n * // Check for completeness\n * var error = gpuCompute.init();\n * if ( error !== null ) {\n *\t\tconsole.error( error );\n * }\n *\n *\n * // In each frame...\n *\n * // Compute!\n * gpuCompute.compute();\n *\n * // Update texture uniforms in your visualization materials with the gpu renderer output\n * myMaterial.uniforms.myTexture.value = gpuCompute.getCurrentRenderTarget( posVar ).texture;\n *\n * // Do your rendering\n * renderer.render( myScene, myCamera );\n *\n *\n * // If needed...\n *\n * // transmit texture data from gpu-memory to cpu-memory\n * var vel = gpuCompute.readVariable( velVar );\n * var pos = gpuCompute.readVariable( posVar );\n *\n * // update texture in cpu-memory\n * vel.image.data[0] += 1.0;\n * pos.image.data[0] += 2.0;\n *\n * // transmit texture data from cpu-memory to gpu-memory\n * gpuCompute.updateVariable( velVar, vel );\n * gpuCompute.updateVariable( posVar, pos );\n *\n * -------------\n *\n * Also, you can use utility functions to create ShaderMaterial and perform computations (rendering between textures)\n * Note that the shaders can have multiple input textures.\n *\n * var myFilter1 = gpuCompute.createShaderMaterial( myFilterFragmentShader1, { theTexture: { value: null } } );\n * var myFilter2 = gpuCompute.createShaderMaterial( myFilterFragmentShader2, { theTexture: { value: null } } );\n *\n * var inputTexture = gpuCompute.createTexture();\n *\n * // Fill in here inputTexture...\n *\n * myFilter1.uniforms.theTexture.value = inputTexture;\n *\n * var myRenderTarget = gpuCompute.createRenderTarget();\n * myFilter2.uniforms.theTexture.value = myRenderTarget.texture;\n *\n * var outputRenderTarget = gpuCompute.createRenderTarget();\n *\n * // Now use the output texture where you want:\n * myMaterial.uniforms.map.value = outputRenderTarget.texture;\n *\n * // And compute each frame, before rendering to screen:\n * gpuCompute.doRenderTarget( myFilter1, myRenderTarget );\n * gpuCompute.doRenderTarget( myFilter2, outputRenderTarget );\n *\n *\n *\n * @param {int} sizeX Computation problem size is always 2d: sizeX * sizeY elements.\n * @param {int} sizeY Computation problem size is always 2d: sizeX * sizeY elements.\n * @param {WebGLRenderer} renderer The renderer\n */\n\nfunction GPUComputationRenderer( sizeX, sizeY, renderer ) {\n\n  this.variables = [];\n\n  this.currentTextureIndex = 0;\n\n  var scene = new THREE.Scene();\n\n  var camera = new THREE.Camera();\n  camera.position.z = 1;\n\n  var passThruUniforms = {\n    texture: { value: null }\n  };\n\n  var passThruShader = createShaderMaterial( getPassThroughFragmentShader(), passThruUniforms );\n\n  var mesh = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), passThruShader );\n  scene.add( mesh );\n\n  // modified by Masayuki (2016-07-12)\n  this.addVariable = function( variableName, shader, initialValueTexture ) {\n\n    if (shader.vertexShader) {\n      console.warn(\"GPUComputationRenderer: Shader's property vertexShader will be ignored\");\n    }\n    if (!shader.fragmentShader) {\n      throw new Error(\"Shader does not have the property: fragmentShader\");\n    }\n\n    var material = this.createShaderMaterial( shader.fragmentShader, shader.uniforms );\n\n    var variable = {\n      name: variableName,\n      initialValueTexture: initialValueTexture,\n      material: material,\n      dependencies: null,\n      renderTargets: [],\n      wrapS: null,\n      wrapT: null,\n      minFilter: THREE.NearestFilter,\n      magFilter: THREE.NearestFilter\n    };\n\n    this.variables.push( variable );\n\n    return variable;\n\n  };\n\n  // this.addVariable = function( variableName, computeFragmentShader, initialValueTexture ) {\n  //\n  //   var material = this.createShaderMaterial( computeFragmentShader );\n  //\n  //   var variable = {\n  //     name: variableName,\n  //     initialValueTexture: initialValueTexture,\n  //     material: material,\n  //     dependencies: null,\n  //     renderTargets: [],\n  //     wrapS: null,\n  //     wrapT: null,\n  //     minFilter: THREE.NearestFilter,\n  //     magFilter: THREE.NearestFilter\n  //   };\n  //\n  //   this.variables.push( variable );\n  //\n  //   return variable;\n  //\n  // };\n\n  this.setVariableDependencies = function( variable, dependencies ) {\n\n    variable.dependencies = dependencies;\n\n  };\n\n  this.init = function() {\n\n    if ( ! renderer.extensions.get( \"OES_texture_float\" ) ) {\n\n      return \"No OES_texture_float support for float textures.\";\n\n    }\n\n    if ( renderer.capabilities.maxVertexTextures === 0 ) {\n\n      return \"No support for vertex shader textures.\";\n\n    }\n\n    for ( var i = 0; i < this.variables.length; i++ ) {\n\n      var variable = this.variables[ i ];\n\n      // Creates rendertargets and initialize them with input texture\n      variable.renderTargets[ 0 ] = this.createRenderTarget( sizeX, sizeY, variable.wrapS, variable.wrapT, variable.minFilter, variable.magFilter );\n      variable.renderTargets[ 1 ] = this.createRenderTarget( sizeX, sizeY, variable.wrapS, variable.wrapT, variable.minFilter, variable.magFilter );\n      this.renderTexture( variable.initialValueTexture, variable.renderTargets[ 0 ] );\n      this.renderTexture( variable.initialValueTexture, variable.renderTargets[ 1 ] );\n\n      // Adds dependencies uniforms to the ShaderMaterial\n      var material = variable.material;\n      var uniforms = material.uniforms;\n      if ( variable.dependencies !== null ) {\n\n        for ( var d = 0; d < variable.dependencies.length; d++ ) {\n\n          var depVar = variable.dependencies[ d ];\n\n          if ( depVar.name !== variable.name ) {\n\n            // Checks if variable exists\n            var found = false;\n            for ( var j = 0; j < this.variables.length; j++ ) {\n\n              if ( depVar.name === this.variables[ j ].name ) {\n                found = true;\n                break;\n              }\n\n            }\n            if ( ! found ) {\n              return \"Variable dependency not found. Variable=\" + variable.name + \", dependency=\" + depVar.name;\n            }\n\n          }\n\n          uniforms[ depVar.name ] = { value: null };\n\n          material.fragmentShader = \"\\nuniform sampler2D \" + depVar.name + \";\\n\" + material.fragmentShader;\n\n        }\n      }\n    }\n\n    this.currentTextureIndex = 0;\n\n    return null;\n\n  };\n\n  this.compute = function() {\n\n    var currentTextureIndex = this.currentTextureIndex;\n    var nextTextureIndex = this.currentTextureIndex === 0 ? 1 : 0;\n\n    for ( var i = 0, il = this.variables.length; i < il; i++ ) {\n\n      var variable = this.variables[ i ];\n\n      // Sets texture dependencies uniforms\n      if ( variable.dependencies !== null ) {\n\n        var uniforms = variable.material.uniforms;\n        for ( var d = 0, dl = variable.dependencies.length; d < dl; d++ ) {\n\n          var depVar = variable.dependencies[ d ];\n\n          uniforms[ depVar.name ].value = depVar.renderTargets[ currentTextureIndex ].texture;\n\n        }\n\n      }\n\n      // Performs the computation for this variable\n      this.doRenderTarget( variable.material, variable.renderTargets[ nextTextureIndex ] );\n\n    }\n\n    this.currentTextureIndex = nextTextureIndex;\n  };\n\n  this.getCurrentRenderTarget = function( variable ) {\n\n    return variable.renderTargets[ this.currentTextureIndex ];\n\n  };\n\n  this.getAlternateRenderTarget = function( variable ) {\n\n    return variable.renderTargets[ this.currentTextureIndex === 0 ? 1 : 0 ];\n\n  };\n\n  function addResolutionDefine( materialShader ) {\n\n    materialShader.defines.resolution = 'vec2( ' + sizeX.toFixed( 1 ) + ', ' + sizeY.toFixed( 1 ) + \" )\";\n\n  };\n  this.addResolutionDefine = addResolutionDefine;\n\n\n  // The following functions can be used to compute things manually\n\n  function createShaderMaterial( computeFragmentShader, uniforms ) {\n\n    uniforms = uniforms || {};\n\n    var material = new THREE.ShaderMaterial( {\n      uniforms: uniforms,\n      vertexShader: getPassThroughVertexShader(),\n      fragmentShader: computeFragmentShader\n    } );\n\n    addResolutionDefine( material );\n\n    return material;\n  };\n  this.createShaderMaterial = createShaderMaterial;\n\n  this.createRenderTarget = function( sizeXTexture, sizeYTexture, wrapS, wrapT, minFilter, magFilter ) {\n\n    sizeXTexture = sizeXTexture || sizeX;\n    sizeYTexture = sizeYTexture || sizeY;\n\n    wrapS = wrapS || THREE.ClampToEdgeWrapping;\n    wrapT = wrapT || THREE.ClampToEdgeWrapping;\n\n    minFilter = minFilter || THREE.NearestFilter;\n    magFilter = magFilter || THREE.NearestFilter;\n\n    var renderTarget = new THREE.WebGLRenderTarget( sizeXTexture, sizeYTexture, {\n      wrapS: wrapS,\n      wrapT: wrapT,\n      minFilter: minFilter,\n      magFilter: magFilter,\n      format: THREE.RGBAFormat,\n      type: THREE.FloatType,\n      stencilBuffer: false\n    } );\n\n    return renderTarget;\n\n  };\n\n  this.createTexture = function( sizeXTexture, sizeYTexture ) {\n\n    sizeXTexture = sizeXTexture || sizeX;\n    sizeYTexture = sizeYTexture || sizeY;\n\n    var a = new Float32Array( sizeXTexture * sizeYTexture * 4 );\n    var texture = new THREE.DataTexture( a, sizeX, sizeY, THREE.RGBAFormat, THREE.FloatType );\n    texture.needsUpdate = true;\n\n    return texture;\n\n  };\n\n\n  this.renderTexture = function( input, output ) {\n\n    // Takes a texture, and render out in rendertarget\n    // input = Texture\n    // output = RenderTarget\n\n    passThruUniforms.texture.value = input;\n\n    this.doRenderTarget( passThruShader, output );\n\n    passThruUniforms.texture.value = null;\n\n  };\n\n  this.doRenderTarget = function( material, output, forceClear ) {\n\n    mesh.material = material;\n    renderer.render( scene, camera, output, forceClear || false );\n    mesh.material = passThruShader;\n\n  };\n\n  // The following functions are added by Masayuki (2016-07-13)\n\n  this.readVariable = function( variable, output ) {\n\n    // reads pixels in a texture on gpu into a buffer on cpu\n    // variable = Variable\n    // output = Texture\n    \n    var renderTarget = this.getCurrentRenderTarget( variable );\n    var texture = renderTarget.texture;\n    output = output || this.createTexture( renderTarget.width, renderTarget.height );\n\n    this.renderTexture( texture, this.getAlternateRenderTarget( variable ) );\n\n    var gl = renderer.getContext();\n    gl.readPixels( 0, 0, renderTarget.width, renderTarget.height, gl.RGBA, gl.FLOAT, output.image.data );\n    output.needsUpdate = true;\n\n    return output;\n\n  };\n\n  this.updateVariable = function( variable, texture ) {\n    this.renderTexture( texture, variable.renderTargets[ 0 ] );\n    this.renderTexture( texture, variable.renderTargets[ 1 ] );\n  };\n\n  // Shaders\n\n  function getPassThroughVertexShader() {\n\n    return\t\"void main()\t{\\n\" +\n      \"\\n\" +\n      \"\tgl_Position = vec4( position, 1.0 );\\n\" +\n      \"\\n\" +\n      \"}\\n\";\n\n  }\n\n  function getPassThroughFragmentShader() {\n\n    return\t\"uniform sampler2D texture;\\n\" +\n      \"\\n\" +\n      \"void main() {\\n\" +\n      \"\\n\" +\n      \"\tvec2 uv = gl_FragCoord.xy / resolution.xy;\\n\" +\n      \"\\n\" +\n      \"\tgl_FragColor = texture2D( texture, uv );\\n\" +\n      \"\\n\" +\n      \"}\\n\";\n\n  }\n\n}\n\nexport default GPUComputationRenderer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/GPUComputationRenderer.js\n **/","// jscs:disable\n/* eslint-disable */\n\n/**\n * Created by masayuki on 20/07/2016.\n */\nimport THREE from 'three';\n\nclass SimObject {\n  constructor() {\n\n    // properties\n    this.id                   = undefined;\n    this.angle                = 0.0;\n    this.velocity             = 0.0;\n    this.updatePosition       = false;\n\n    // 3D Object\n    this.root                 = undefined;\n\n    // 2D Object\n    this.label                = undefined;\n    this.labelOffset          = new THREE.Vector3();\n\n    // --- construct\n    this._createSimObject();\n\n  }\n\n  // --- API\n  /**\n   * Add THREE.Object3D object directly\n   * @param {object} object\n   */\n  add(object) {\n    this.root.add(object);\n  }\n\n  /**\n   * Remove THREE.Object3D object directly\n   * @param {object} object\n   */\n  remove(object) {\n    this.root.remove(object);\n  }\n\n  /**\n   * sets the object position\n   * @param {Number} x x\n   * @param {Number} y y\n   * @param {Number} z z\n   */\n  setPosition(x, y, z) {\n    this.root.position.set(x, y, z);\n    this.label.position.copy(this.root.position).add(this.labelOffset);\n  }\n\n  /**\n   * sets the object angle\n   * @param {Number} angle angle in [rad]\n   */\n  setAngle(angle) {\n    this.angle = angle;\n    this.root.rotation.y = angle;\n  }\n\n  /**\n   * sets the vehicle's velocity\n   * @param {Number} velocity velocity in [m/s]\n   */\n  setVelocity(velocity) {\n    this.velocity = velocity;\n  }\n\n  /**\n   * sets the label class\n   * @param className\n   */\n  setLabelClass(className) {\n    this.label.element.className = className;\n  }\n\n  /**\n   * sets the label text\n   * @param text\n   */\n  setLabelText(text) {\n    this.label.element.textContent = text;\n  }\n\n  /**\n   * sets the label offset\n   *\n   * @param {Number} x x\n   * @param {Number} y y\n   * @param {Number} z z\n   */\n  setLabelOffset(x, y, z) {\n    this.labelOffset.set(x, y, z);\n  }\n\n  /**\n   * update the object\n   * @param {Number} delta\n   */\n  update(delta) {\n\n    var forwardDelta = delta * this.velocity;\n\n    // position\n    if (this.updatePosition) {\n      this.root.position.x += Math.cos( -this.angle ) * forwardDelta;\n      this.root.position.z += Math.sin( -this.angle ) * forwardDelta;\n      this.label.position.copy(this.root.position).add(this.labelOffset);\n\n      this.root.rotation.y = this.angle;\n    }\n\n  }\n\n  // --- internal helper methods\n  _createSimObject() {\n    // construct this object\n\n    // root\n    this.root = new THREE.Object3D();\n\n    // [DEBUG] arrow\n    var from = new THREE.Vector3(0,0,0);\n    var to = new THREE.Vector3(50,0,0);\n    var direction = to.clone().sub(from);\n    var length = direction.length();\n    var arrowHelper = new THREE.ArrowHelper(direction.normalize(), from, length, 0xff0000);\n    this.root.add(arrowHelper);\n\n    // label\n    var text = document.createElement('div');\n    this.label = new THREE.CSS2DObject(text);\n  }\n\n  _adjustLabelOffset() {\n    var bbox = new THREE.Box3().setFromObject(this.root);\n    this.setLabelOffset(0, bbox.max.y + 1, 0);\n  }\n  // ---\n\n}\n\nexport default SimObject;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/object/SimObject.js\n **/","// jscs:disable\n/* eslint-disable */\n\n/* To be used by GPUComputationRenderer */\nvar VehicleVelocityShader = {\n\n  uniforms: {\n\n    \"time\":                 {type: \"f\", value: 0.0},\n    \"delta\":                {type: \"f\", value: 0.0},\n    \"textureAcceleration\":  {type: \"t\", value: null}\n\n  },\n\n  vertexShader: [\n\n  ].join('\\n'),\n\n  fragmentShader: [\n\n    \"uniform float time;\",\n    \"uniform float delta; // about 0.016\",\n    \"uniform sampler2D textureAcceleration;\",\n\n    \"const float PI = 3.141592653589793;\",\n    \"const float PI_05 = PI / 2.0;\",\n    \"const float PI_2 = PI * 2.0;\",\n\n    \"const float L = 2.0;\",\n\n    \"const float SPEED_LIMIT = 10.0;\",\n\n    \"void main() {\",\n\n    \" vec2 uv = gl_FragCoord.xy / resolution.xy;\",\n\n    \" vec4 selfVelocity = texture2D( textureVelocity, uv );\",\n    \" vec4 selfAcceleration = texture2D( textureAcceleration, uv );\",\n    \" float velocity = selfVelocity.x;\",\n    \" float wheel = selfVelocity.w;\",\n    \" float acceleration = selfAcceleration.x;\",\n\n    \" // update velocity\",\n    \" velocity += acceleration;\",\n\n    \" gl_FragColor = vec4(velocity, 0.0, 0.0, wheel);\",\n\n    // \" vec4 selfVelocity = texture2D( textureVelocity, uv );\",\n    // \" vec3 velocity = selfVelocity.xyz;\",\n    // \" float velocityScalar = length( velocity );\",\n    // \" float wheel = selfVelocity.w;\",\n    //\n    // \" vec3 selfAcceleration = texture2D( textureAcceleration, uv ).xyz;\",\n    //\n    // \" // update the velocity in accordance with the centripetal force\",\n    // \" float a = wheel / L * velocityScalar * velocityScalar;\",\n    // \" vec3 centripetalAcceleration = vec3( - a / velocityScalar * velocity.z, 0.0, a / velocityScalar * velocity.x );\",\n    // \" velocity += delta * centripetalAcceleration;\",\n    // \" velocity *= velocityScalar / length( velocity );\",\n    //\n    // \" // update velocity\",\n    // \" velocity += delta * selfAcceleration;\",\n    //\n    // \"\tfloat limit = SPEED_LIMIT;\",\n    //\n    // \"\t// Speed Limits\",\n    // \"\t//if ( length( velocity ) > limit ) {\",\n    // \"\t//\tvelocity = normalize( velocity ) * limit;\",\n    // \"\t//}\",\n    //\n    // \"\tgl_FragColor = vec4( velocity, wheel );\",\n\n    \"}\"\n\n  ].join('\\n')\n\n};\n\nexport default VehicleVelocityShader;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/object/VehicleVelocityShader.js\n **/","// jscs:disable\n/* eslint-disable */\n\nvar VehiclePositionShader = {\n\n  uniforms: {\n\n    \"time\":             {type: \"f\", value: 0.0},\n    \"delta\":            {type: \"f\", value: 0.0},\n    // \"textureTargetPosition\":  {type: \"t\", value: null}, // (for interpolation)\n    // \"t\":                {type: \"f\", value: 0.0}, // (for interpolation)\n\n  },\n\n  vertexShader: [\n\n  ].join('\\n'),\n\n  fragmentShader: [\n\n    \"uniform float time;\",\n    \"uniform float delta;\",\n    \"uniform sampler2D textureTargetPosition;\",\n    \"uniform float t;\",\n\n    \"const float PI = 3.141592653589793;\",\n    \"const float L = 2.0;\",\n    \"const float T = 1.0;\",\n\n    \"void main() {\",\n\n    \" vec2 uv = gl_FragCoord.xy / resolution.xy;\",\n\n    // (for extrapolation)\n    \" vec4 selfPosition = texture2D( texturePosition, uv );\",\n    \" vec4 selfVelocity = texture2D( textureVelocity, uv );\",\n\n    \" vec3 position = selfPosition.xyz;\",\n    \" float velocity = selfVelocity.x;\",\n    \" float angle = selfPosition.w;\",\n    \" float wheel = selfVelocity.w;\",\n\n    \" float angular_velocity = wheel / L * velocity;\",\n    \" angle += delta * angular_velocity;\",\n    \" if( angle >  PI ) { angle -= 2.0 * PI; }\",\n    \" if( angle < -PI ) { angle += 2.0 * PI; }\",\n\n    \" position.x += delta * velocity * cos( angle );\",\n    \" position.z += delta * velocity * sin( angle );\",\n\n    \" gl_FragColor = vec4( position, angle );\",\n\n    // (for interpolation)\n    // \" vec4 selfPosition = texture2D( texturePosition, uv );\",\n    // \" vec4 selfTargetPosition = texture2D( textureTargetPosition, uv );\",\n    //\n    // \" selfPosition.x = mix( selfPosition.x, selfTargetPosition.x, t / T );\",\n    // \" selfPosition.y = mix( selfPosition.y, selfTargetPosition.y, t / T );\",\n    // \" selfPosition.z = mix( selfPosition.z, selfTargetPosition.z, t / T );\",\n    // \" selfPosition.w = mix( selfPosition.w, selfTargetPosition.w, t / T );\",\n    //\n    // \" gl_FragColor = selfPosition;\",\n\n    // \" vec4 selfPosition = texture2D( texturePosition, uv );\",\n    // \" vec4 selfVelocity = texture2D( textureVelocity, uv );\",\n    //\n    // \" vec3 position = selfPosition.xyz;\",\n    // \" vec3 velocity = selfVelocity.xyz;\",\n    // \" float angle = selfPosition.w;\",\n    // \" float wheel = selfVelocity.w;\",\n    //\n    // \" // calculate the angular velocity\",\n    // \" float angular_velocity = wheel / L * length( velocity );\",\n    //\n    // \" // update the position\",\n    // \" position += delta * velocity;\",\n    // \" angle += delta * angular_velocity;\",\n    // \" if ( angle >  PI ) { angle -= 2.*PI; }\",\n    // \" if ( angle < -PI ) { angle += 2.*PI; }\",\n    //\n    // \" gl_FragColor = vec4( position, angle );\",\n\n    \"}\"\n\n  ].join('\\n')\n\n};\n\nexport default VehiclePositionShader;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/object/VehiclePositionShader.js\n **/","// jscs:disable\n/* eslint-disable */\nimport THREE from 'three';\n\nvar VehicleShader = {\n\n  uniforms: {\n\n    \"reference\":        { type: \"v2\", value: null },\n    \"texturePosition\":  { type: \"t\",  value: null },\n    \"texture\":          { type: \"t\",  value: null },\n    \"color\":            { type: \"c\",  value: new THREE.Color(0xff2200) }\n\n  },\n\n  vertexShader: [\n\n    \"uniform vec2 reference;\",\n\n    \"uniform sampler2D texturePosition;\",\n\n    \"varying vec2 vUv;\",\n\n    \"mat4 rotationMatrix(vec3 axis, float angle)\",\n    \"{\",\n    \"    axis = normalize(axis);\",\n    \"    float s = sin(angle);\",\n    \"    float c = cos(angle);\",\n    \"    float oc = 1.0 - c;\",\n    \"    \",\n    \"    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\",\n    \"                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\",\n    \"                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\",\n    \"                0.0,                                0.0,                                0.0,                                1.0);\",\n    \"}\",\n\n    \"void main() {\",\n\n    \" vUv = uv;\",\n\n    \" // retrieve the simulated position of this vehicle\",\n    \" vec4 selfPosition = texture2D( texturePosition, reference );\",\n    \"\tvec3 simPos = selfPosition.xyz;\",\n    \" float angle = selfPosition.w;\",\n\n    \" // tmp\",\n    \" vec4 newPosition = vec4( position, 1.0 );\",\n\n    \" // rotate\",\n    \" mat4 rotYMatrix = rotationMatrix( vec3( 0., 1., 0. ), angle );\",\n    \" newPosition = rotYMatrix * newPosition;\",\n\n    \" // calcuate the actual position by adding the simulated position\",\n    \"\tnewPosition = modelMatrix * newPosition;\",\n    \" newPosition.xyz += simPos;\",\n\n    \"\tgl_Position = projectionMatrix * viewMatrix * newPosition;\",\n\n    \"}\"\n\n\n  ].join('\\n'),\n\n  fragmentShader: [\n\n    \"uniform sampler2D texture;\",\n    \"uniform vec3 color;\",\n\n    \"varying vec2 vUv;\",\n\n    \"void main() {\",\n\n    \" gl_FragColor = texture2D( texture, vUv );\",\n    \"// gl_FragColor = vec4( color, 1. );\",\n\n    \"}\"\n\n  ].join('\\n')\n\n};\n\nexport default VehicleShader;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/object/VehicleShader.js\n **/","/*\n * Object helpers\n */\n\nimport THREE from 'three';\nimport operative from 'operative';\nimport SimplifyModifier from '../vendor/SimplifyModifier';\nimport WorkerUtils from './WorkerUtils';\n\nvar ObjectUtils = (function() {\n\n  // Create UV from geometry's faces\n  var createUV = function(geometry) {\n    geometry.computeBoundingBox();\n\n    var max = geometry.boundingBox.max;\n    var min = geometry.boundingBox.min;\n    var offset = new THREE.Vector2(0 - min.x, 0 - min.y);\n    var range = new THREE.Vector2(max.x - min.x, max.y - min.y);\n    var faces = geometry.faces;\n\n    geometry.faceVertexUvs[0] = [];\n\n    for (var i = 0; i < faces.length ; i++) {\n      var v1 = geometry.vertices[faces[i].a];\n      var v2 = geometry.vertices[faces[i].b];\n      var v3 = geometry.vertices[faces[i].c];\n\n      geometry.faceVertexUvs[0].push([\n        new THREE.Vector2((v1.x + offset.x) / range.x ,(v1.y + offset.y) / range.y),\n        new THREE.Vector2((v2.x + offset.x) / range.x ,(v2.y + offset.y) / range.y),\n        new THREE.Vector2((v3.x + offset.x) / range.x ,(v3.y + offset.y) / range.y)\n      ]);\n    }\n\n    geometry.uvsNeedUpdate = true;\n  };\n\n  var objectToGeometry = function(geometry) {\n    var newGeo = new THREE.Geometry();\n\n    for (i = 0; i < geometry.vertices.length; i++) {\n      var v = geometry.vertices[i];\n      newGeo.vertices.push(new THREE.Vector3(v.x, v.y, v.z));\n    }\n    for (i = 0; i < geometry.faces.length; i++) {\n      var f = geometry.faces[i];\n      newGeo.faces.push(new THREE.Face3(f.a, f.b, f.c, f.normal, f.color, f.materialIndex));\n    }\n\n    return newGeo;\n  };\n\n  // Reduce vertices and simplify a geometry\n  var simplifyGeometry = function(geometry, reduceCount, callback) {\n\n    reduceCount = reduceCount | geometry.vertices.length * 0.5;\n    var func = operative(function(geometry, reduceCount, cb) {\n      // NOTE these codes run on a webworker thread, so all of the variables outside this scope are unavailable.\n\n      // hack\n      console.assert = function(b) {\n        if (!b) { throw new Error('assertion failed'); }\n      };\n\n      // deferred\n      var d = this.deferred();\n\n      // convert \"[Object object]\" to \"[THREE.Geometry]\"\n      geometry = VIZI.Util.ObjectUtils.objectToGeometry(geometry);\n\n      // modify the geometry\n      var modifier = new VIZI.Util.ObjectUtils.SimplifyModifier();\n      var geometry = modifier.modify(geometry, reduceCount | 0);\n\n      // return to the main thread\n      cb(geometry);\n    }, WorkerUtils.getDependencies());\n\n    // call the webworker procedure from the main thread\n    func(geometry, reduceCount, function(geometry) {\n      // callback called on the main thread\n\n      // convert \"[Object object]\" to \"[THREE.Geometry]\"\n      geometry = objectToGeometry(geometry);\n\n      // callback to the function caller\n      if (callback) {\n        callback(geometry);\n      }\n    });\n  };\n\n  return {\n    createUV: createUV,\n    objectToGeometry: objectToGeometry,\n    simplifyGeometry: simplifyGeometry,\n    SimplifyModifier: SimplifyModifier\n  };\n})();\n\nexport default ObjectUtils;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/ObjectUtils.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_82__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"operative\"\n ** module id = 82\n ** module chunks = 0\n **/","// jscs:disable\n/* eslint-disable */\n\nimport THREE from 'three';\n\n/*\n *\t@author zz85 / http://twitter.com/blurspline / http://www.lab4games.net/zz85/blog\n *\n *\tSimplification Geometry Modifier\n *    - based on code and technique\n *\t  - by Stan Melax in 1998\n *\t  - Progressive Mesh type Polygon Reduction Algorithm\n *    - http://www.melax.com/polychop/\n */\n\nvar SimplifyModifier = function() {\n\n};\n\n(function() {\n\n  var cb = new THREE.Vector3(), ab = new THREE.Vector3();\n\n  function pushIfUnique( array, object ) {\n\n    if ( array.indexOf( object ) === -1 ) array.push( object );\n\n  }\n\n  function removeFromArray( array, object ) {\n\n    var k = array.indexOf( object );\n    if ( k > -1 ) array.splice( k, 1 );\n\n  }\n\n  function computeEdgeCollapseCost( u, v ) {\n\n    // if we collapse edge uv by moving u to v then how\n    // much different will the model change, i.e. the \"error\".\n\n    var edgelength = v.position.distanceTo( u.position );\n    var curvature = 0;\n\n    var sideFaces = [];\n    var i, uFaces = u.faces, il = u.faces.length, face, sideFace;\n\n    // find the \"sides\" triangles that are on the edge uv\n    for ( i = 0 ; i < il; i ++ ) {\n\n      face = u.faces[ i ];\n\n      if ( face.hasVertex(v) ) {\n\n        sideFaces.push( face );\n\n      }\n\n    }\n\n    // use the triangle facing most away from the sides\n    // to determine our curvature term\n    for ( i = 0 ; i < il; i ++ ) {\n\n      var minCurvature = 1;\n      face = u.faces[ i ];\n\n      for( var j = 0; j < sideFaces.length; j ++ ) {\n\n        sideFace = sideFaces[ j ];\n        // use dot product of face normals.\n        var dotProd = face.normal.dot( sideFace.normal );\n        minCurvature = Math.min( minCurvature, ( 1.001 - dotProd ) / 2);\n      }\n\n      curvature = Math.max( curvature, minCurvature );\n    }\n\n    // crude approach in attempt to preserve borders\n    // though it seems not to be totally correct\n    var borders = 0;\n    if ( sideFaces.length < 2 ) {\n\n      // we add some arbitrary cost for borders,\n      // borders += 10;\n      curvature = 1;\n    }\n\n    var amt = edgelength * curvature + borders;\n\n    return amt;\n\n  }\n\n  function computeEdgeCostAtVertex( v ) {\n    // compute the edge collapse cost for all edges that start\n    // from vertex v.  Since we are only interested in reducing\n    // the object by selecting the min cost edge at each step, we\n    // only cache the cost of the least cost edge at this vertex\n    // (in member variable collapse) as well as the value of the\n    // cost (in member variable collapseCost).\n\n    if ( v.neighbors.length === 0 ) {\n\n      // collapse if no neighbors.\n      v.collapseNeighbor = null;\n      v.collapseCost = - 0.01;\n\n      return;\n\n    }\n\n    v.collapseCost = 100000;\n    v.collapseNeighbor = null;\n\n    // search all neighboring edges for \"least cost\" edge\n    for ( var i = 0; i < v.neighbors.length; i ++ ) {\n\n      var collapseCost = computeEdgeCollapseCost( v, v.neighbors[ i ] );\n\n      if ( !v.collapseNeighbor ) {\n        v.collapseNeighbor = v.neighbors[ i ];\n        v.collapseCost = collapseCost;\n        v.minCost = collapseCost;\n        v.totalCost = 0;\n        v.costCount = 0;\n      }\n\n      v.costCount ++;\n      v.totalCost += collapseCost;\n\n      if ( collapseCost < v.minCost ) {\n\n        v.collapseNeighbor = v.neighbors[ i ];\n        v.minCost = collapseCost;\n\n      }\n\n    }\n\n    // we average the cost of collapsing at this vertex\n    v.collapseCost = v.totalCost / v.costCount;\n    // v.collapseCost = v.minCost;\n\n  }\n\n  function removeVertex( v, vertices ) {\n\n    console.assert( v.faces.length === 0 );\n\n    while ( v.neighbors.length ) {\n\n      var n = v.neighbors.pop();\n      removeFromArray( n.neighbors, v );\n\n    }\n\n    removeFromArray( vertices, v );\n\n  }\n\n  function removeFace( f, faces ) {\n\n    removeFromArray( faces, f );\n\n    if ( f.v1 ) removeFromArray( f.v1.faces, f );\n    if ( f.v2 ) removeFromArray( f.v2.faces, f );\n    if ( f.v3 ) removeFromArray( f.v3.faces, f );\n\n    // TODO optimize this!\n    var vs = [ this.v1, this.v2, this.v3 ];\n    var v1, v2;\n\n    for( var i = 0 ; i < 3 ; i ++ ) {\n      v1 = vs[ i ];\n      v2 = vs[( i+1) % 3 ];\n\n      if( !v1 || !v2 ) continue;\n      v1.removeIfNonNeighbor( v2 );\n      v2.removeIfNonNeighbor( v1 );\n    }\n\n  }\n\n  function collapse( vertices, faces, u, v ) { // u and v are pointers to vertices of an edge\n\n    // Collapse the edge uv by moving vertex u onto v\n\n    if ( !v ) {\n\n      // u is a vertex all by itself so just delete it..\n      removeVertex( u, vertices );\n      return;\n\n    }\n\n    var i;\n    var tmpVertices = [];\n\n    for( i = 0 ; i < u.neighbors.length; i ++ ) {\n\n      tmpVertices.push( u.neighbors[ i ] );\n\n    }\n\n\n    // delete triangles on edge uv:\n    for( i = u.faces.length - 1; i >= 0; i -- ) {\n\n      if ( u.faces[ i ].hasVertex( v ) ) {\n\n        removeFace( u.faces[ i ], faces );\n\n      }\n\n    }\n\n    // update remaining triangles to have v instead of u\n    for( i = u.faces.length -1 ; i >= 0; i -- ) {\n\n      u.faces[i].replaceVertex( u, v );\n\n    }\n\n\n    removeVertex( u, vertices );\n\n    // recompute the edge collapse costs in neighborhood\n    for( i = 0; i < tmpVertices.length; i ++ ) {\n\n      computeEdgeCostAtVertex( tmpVertices[ i ] );\n\n    }\n\n  }\n\n\n\n  function minimumCostEdge( vertices ) {\n\n    // O(n * n) approach. TODO optimize this\n\n    var least = vertices[ 0 ];\n\n    for (var i = 0; i < vertices.length; i ++ ) {\n\n      if ( vertices[ i ].collapseCost < least.collapseCost ) {\n\n        least = vertices[ i ];\n\n      }\n    }\n\n    return least;\n\n  }\n\n  // we use a triangle class to represent structure of face slightly differently\n\n  function Triangle( v1, v2, v3, a, b, c ) {\n    this.a = a;\n    this.b = b;\n    this.c = c;\n\n    this.v1 = v1;\n    this.v2 = v2;\n    this.v3 = v3;\n\n    this.normal = new THREE.Vector3();\n\n    this.computeNormal();\n\n    v1.faces.push( this );\n    v1.addUniqueNeighbor( v2 );\n    v1.addUniqueNeighbor( v3 );\n\n    v2.faces.push( this );\n    v2.addUniqueNeighbor( v1 );\n    v2.addUniqueNeighbor( v3 );\n\n\n    v3.faces.push( this );\n    v3.addUniqueNeighbor( v1 );\n    v3.addUniqueNeighbor( v2 );\n\n  }\n\n  Triangle.prototype.computeNormal = function() {\n\n    var vA = this.v1.position;\n    var vB = this.v2.position;\n    var vC = this.v3.position;\n\n    cb.subVectors( vC, vB );\n    ab.subVectors( vA, vB );\n    cb.cross( ab ).normalize();\n\n    this.normal.copy( cb );\n\n  };\n\n  Triangle.prototype.hasVertex = function( v ) {\n\n    return v === this.v1 || v === this.v2 || v === this.v3;\n\n  };\n\n  Triangle.prototype.replaceVertex = function( oldv, newv ) {\n\n    if ( oldv === this.v1 ) this.v1 = newv;\n    else if ( oldv === this.v2 ) this.v2 = newv;\n    else if ( oldv === this.v3 ) this.v3 = newv;\n\n    removeFromArray( oldv.faces, this );\n    newv.faces.push( this );\n\n\n    oldv.removeIfNonNeighbor( this.v1 );\n    this.v1.removeIfNonNeighbor( oldv );\n\n    oldv.removeIfNonNeighbor( this.v2 );\n    this.v2.removeIfNonNeighbor( oldv );\n\n    oldv.removeIfNonNeighbor( this.v3 );\n    this.v3.removeIfNonNeighbor( oldv );\n\n    this.v1.addUniqueNeighbor( this.v2 );\n    this.v1.addUniqueNeighbor( this.v3 );\n\n    this.v2.addUniqueNeighbor( this.v1 );\n    this.v2.addUniqueNeighbor( this.v3 );\n\n    this.v3.addUniqueNeighbor( this.v1 );\n    this.v3.addUniqueNeighbor( this.v2 );\n\n    this.computeNormal();\n\n  };\n\n  function Vertex( v, id ) {\n\n    this.position = v;\n\n    this.id = id; // old index id\n\n    this.faces = []; // faces vertex is connected\n    this.neighbors = []; // neighbouring vertices aka \"adjacentVertices\"\n\n    // these will be computed in computeEdgeCostAtVertex()\n    this.collapseCost = 0; // cost of collapsing this vertex, the less the better. aka objdist\n    this.collapseNeighbor = null; // best candinate for collapsing\n\n  }\n\n  Vertex.prototype.addUniqueNeighbor = function( vertex ) {\n    pushIfUnique(this.neighbors, vertex);\n  };\n\n  Vertex.prototype.removeIfNonNeighbor = function( n ) {\n\n    var neighbors = this.neighbors;\n    var faces = this.faces;\n\n    var offset = neighbors.indexOf( n );\n    if ( offset === -1 ) return;\n    for ( var i = 0; i < faces.length; i ++ ) {\n\n      if ( faces[ i ].hasVertex( n ) ) return;\n\n    }\n\n    neighbors.splice( offset, 1 );\n  };\n\n  SimplifyModifier.prototype.modify = function( geometry, count ) {\n\n    if ( geometry instanceof THREE.BufferGeometry && !geometry.vertices && !geometry.faces ) {\n      console.log('converting BufferGeometry to Geometry');\n      geometry = new THREE.Geometry().fromBufferGeometry( geometry );\n    }\n\n    geometry.mergeVertices();\n\n    var oldVertices = geometry.vertices; // Three Position\n    var oldFaces = geometry.faces; // Three Face\n\n    var newGeometry = new THREE.Geometry();\n\n    // conversion\n    var vertices = new Array( oldVertices.length ); // Simplify Custom Vertex Struct\n    var faces = new Array( oldFaces.length ); // Simplify Custom Traignle Struct\n\n    var i, il, face;\n\n    //\n    // put data of original geometry in different data structures\n    //\n\n    // add vertices\n    for ( i = 0, il = oldVertices.length; i < il; i ++ ) {\n\n      vertices[ i ] = new Vertex( oldVertices[ i ], i );\n\n    }\n\n    // add faces\n    for ( i = 0, il = oldFaces.length; i < il; i ++ ) {\n\n      face = oldFaces[ i ];\n      faces[ i ] = new Triangle( vertices[ face.a ], vertices[ face.b ], vertices[ face.c ], face.a, face.b, face.c );\n\n    }\n\n    // compute all edge collapse costs\n    for ( i = 0, il = vertices.length; i < il; i ++ ) {\n\n      computeEdgeCostAtVertex( vertices[ i ] );\n\n    }\n\n    var permutation = new Array( vertices.length );\n    var map = new Array( vertices.length );\n\n    var nextVertex;\n\n    var z = count;\n\n    // console.time('z')\n    // console.profile('zz');\n\n    while( z-- ) {\n      nextVertex = minimumCostEdge( vertices );\n      if (!nextVertex) {\n        console.log('no next vertex');\n        break;\n      }\n      collapse( vertices, faces, nextVertex, nextVertex.collapseNeighbor );\n    }\n\n    // console.profileEnd('zz');\n    // console.timeEnd('z')\n\n    // TODO convert to buffer geometry.\n    var newGeo = new THREE.Geometry();\n\n    for ( i = 0; i < vertices.length; i ++ ) {\n\n      var v = vertices[ i ];\n      newGeo.vertices.push( v.position )\n\n    }\n\n    for ( i = 0; i < faces.length; i ++ ) {\n\n      var tri = faces[ i ];\n      newGeo.faces.push( new THREE.Face3(\n        vertices.indexOf(tri.v1),\n        vertices.indexOf(tri.v2),\n        vertices.indexOf(tri.v3)\n      ) )\n\n    }\n\n    return newGeo;\n  };\n})();\n\nexport default SimplifyModifier;\nTHREE.SimplifyModifier = SimplifyModifier;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/SimplifyModifier.js\n **/","/**\n * Worker Utils\n */\n\nvar WorkerUtils = (function() {\n\n  var self = this;\n\n  /** base directory */\n  var base = (function() {\n    var current = (function() {\n      if (!self.isWorker) {\n        if (document.currentScript) {\n          return document.currentScript.src;\n        } else {\n          var scripts = document.getElementsByTagName('script');\n          var script = scripts[scripts.length - 1];\n          if (script.src) {\n            return script.src;\n          }\n        }\n      }\n    })();\n    if (current) {\n      return dirname(current);\n    }\n  })();\n\n  /** Definition: Worker dependencies */\n  var dependencies = [\n    base + '/three.min.js',\n    base + '/vizicities-worker.min.js'\n  ];\n\n  /**\n   * Returns worker dependencies\n   *\n   * @returns {string[]}\n   */\n  var getDependencies = function() {\n    return dependencies;\n  };\n\n  // --- internal helper methods\n  function basename(path) {\n    return path.replace(/\\\\/g, '/').replace(/.*\\//, '');\n  }\n  function dirname(path) {\n    return path.replace(/\\\\/g, '/').replace(/\\/[^\\/]*$/, '');;\n  }\n  // ---\n\n  // return the utility object\n  return {\n    getDependencies: getDependencies\n  };\n})();\n\nexport default WorkerUtils;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/WorkerUtils.js\n **/","/**\n * Created by masayuki on 17/07/2016.\n */\n\nclass ModelRepository {\n  constructor() {\n    this._map = {};\n  }\n\n  add(modelName, model) {\n    this._map[modelName] = model;\n  }\n\n  get(modelName) {\n    return this._map[modelName];\n  }\n\n  contains(modelName) {\n    return (modelName in this._map);\n  }\n}\n\nvar modelRepository = new ModelRepository();\n\nexport default modelRepository;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/object/ModelRepository.js\n **/","/**\n * Created by masayuki on 20/07/2016.\n */\nimport THREE from 'three';\nimport BinaryLoader from '../../vendor/BinaryLoader';\n\nvar PedestrianModel = function(parameters, callback) {\n\n  var scope = this;\n  var p = parameters;\n\n  // file paths\n  this.bodyURL  = p.bodyURL   || null;\n\n  // parameters\n  this.scale           = p.scale           || 1.0;\n  this.translation     = p.translation     || new THREE.Vector3();\n  this.rotation        = p.rotation        || new THREE.Vector3();\n\n  // callback\n  this.callback = callback;\n\n  // status\n  this.loaded   = false;\n\n  // internal use\n  this.bodyGeometry   = null;\n  this.bodyMaterials  = null;\n\n  // construct\n  if (scope.bodyURL) {\n    // load binaries\n    var jloader = new THREE.JSONLoader();\n    jloader.load(scope.bodyURL, function(geometry, materials) {\n      createBody(geometry, materials);\n    });\n  }\n\n  // internal helper methods\n  function createBody(geometry, materials) {\n    scope.bodyGeometry = geometry;\n    scope.bodyMaterials = materials;\n\n    for (i = 0, max = materials.length; i < max; i = i + 1) {\n      materials[i].morphTargets = true;\n    }\n\n    onCreated();\n  }\n  function onCreated() {\n    if (scope.bodyGeometry) {\n      scope.loaded = true;\n\n      // callback\n      if (scope.callback) {\n        scope.callback(scope);\n      }\n    }\n  }\n\n};\n\nexport default PedestrianModel;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/object/PedestrianModel.js\n **/","// jscs:disable\n/* eslint-disable */\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nimport THREE from 'three';\n\nvar BinaryLoader = function ( manager ) {\n\n  if ( typeof manager === 'boolean' ) {\n\n    console.warn( 'THREE.BinaryLoader: showStatus parameter has been removed from constructor.' );\n    manager = undefined;\n\n  }\n\n  this.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n};\n\nBinaryLoader.prototype = {\n\n  constructor: THREE.BinaryLoader,\n\n  // Load models generated by slim OBJ converter with BINARY option (converter_obj_three_slim.py -t binary)\n  //  - binary models consist of two files: JS and BIN\n  //  - parameters\n  //\t\t- url (required)\n  //\t\t- callback (required)\n  //\t\t- texturePath (optional: if not specified, textures will be assumed to be in the same folder as JS model file)\n  //\t\t- binaryPath (optional: if not specified, binary file will be assumed to be in the same folder as JS model file)\n  load: function ( url, onLoad, onProgress, onError ) {\n\n    // todo: unify load API to for easier SceneLoader use\n\n    var texturePath = this.texturePath || THREE.Loader.prototype.extractUrlBase( url );\n    var binaryPath  = this.binaryPath || THREE.Loader.prototype.extractUrlBase( url );\n\n    // #1 load JS part via web worker\n\n    var scope = this;\n\n    var jsonloader = new THREE.XHRLoader( this.manager );\n    jsonloader.load( url, function ( data ) {\n\n      var json = JSON.parse( data );\n\n      var bufferUrl = binaryPath + json.buffers;\n\n      var bufferLoader = new THREE.XHRLoader( scope.manager );\n      bufferLoader.setResponseType( 'arraybuffer' );\n      bufferLoader.load( bufferUrl, function ( bufData ) {\n\n        // IEWEBGL needs this ???\n        //buffer = ( new Uint8Array( xhr.responseBody ) ).buffer;\n\n        //// iOS and other XMLHttpRequest level 1 ???\n\n        scope.parse( bufData, onLoad, texturePath, json.materials );\n\n      }, onProgress, onError );\n\n    }, onProgress, onError );\n\n  },\n\n  setBinaryPath: function ( value ) {\n\n    this.binaryPath = value;\n\n  },\n\n  setCrossOrigin: function ( value ) {\n\n    this.crossOrigin = value;\n\n  },\n\n  setTexturePath: function ( value ) {\n\n    this.texturePath = value;\n\n  },\n\n  parse: function ( data, callback, texturePath, jsonMaterials ) {\n\n    var Model = function ( texturePath ) {\n\n      var scope = this,\n        currentOffset = 0,\n        md,\n        normals = [],\n        uvs = [],\n        start_tri_flat, start_tri_smooth, start_tri_flat_uv, start_tri_smooth_uv,\n        start_quad_flat, start_quad_smooth, start_quad_flat_uv, start_quad_smooth_uv,\n        tri_size, quad_size,\n        len_tri_flat, len_tri_smooth, len_tri_flat_uv, len_tri_smooth_uv,\n        len_quad_flat, len_quad_smooth, len_quad_flat_uv, len_quad_smooth_uv;\n\n\n      THREE.Geometry.call( this );\n\n      md = parseMetaData( data, currentOffset );\n\n      currentOffset += md.header_bytes;\n      /*\n       md.vertex_index_bytes = Uint32Array.BYTES_PER_ELEMENT;\n       md.material_index_bytes = Uint16Array.BYTES_PER_ELEMENT;\n       md.normal_index_bytes = Uint32Array.BYTES_PER_ELEMENT;\n       md.uv_index_bytes = Uint32Array.BYTES_PER_ELEMENT;\n       */\n      // buffers sizes\n\n      tri_size =  md.vertex_index_bytes * 3 + md.material_index_bytes;\n      quad_size = md.vertex_index_bytes * 4 + md.material_index_bytes;\n\n      len_tri_flat      = md.ntri_flat      * ( tri_size );\n      len_tri_smooth    = md.ntri_smooth    * ( tri_size + md.normal_index_bytes * 3 );\n      len_tri_flat_uv   = md.ntri_flat_uv   * ( tri_size + md.uv_index_bytes * 3 );\n      len_tri_smooth_uv = md.ntri_smooth_uv * ( tri_size + md.normal_index_bytes * 3 + md.uv_index_bytes * 3 );\n\n      len_quad_flat      = md.nquad_flat      * ( quad_size );\n      len_quad_smooth    = md.nquad_smooth    * ( quad_size + md.normal_index_bytes * 4 );\n      len_quad_flat_uv   = md.nquad_flat_uv   * ( quad_size + md.uv_index_bytes * 4 );\n      len_quad_smooth_uv = md.nquad_smooth_uv * ( quad_size + md.normal_index_bytes * 4 + md.uv_index_bytes * 4 );\n\n      // read buffers\n\n      currentOffset += init_vertices( currentOffset );\n\n      currentOffset += init_normals( currentOffset );\n      currentOffset += handlePadding( md.nnormals * 3 );\n\n      currentOffset += init_uvs( currentOffset );\n\n      start_tri_flat \t\t= currentOffset;\n      start_tri_smooth    = start_tri_flat    + len_tri_flat    + handlePadding( md.ntri_flat * 2 );\n      start_tri_flat_uv   = start_tri_smooth  + len_tri_smooth  + handlePadding( md.ntri_smooth * 2 );\n      start_tri_smooth_uv = start_tri_flat_uv + len_tri_flat_uv + handlePadding( md.ntri_flat_uv * 2 );\n\n      start_quad_flat     = start_tri_smooth_uv + len_tri_smooth_uv  + handlePadding( md.ntri_smooth_uv * 2 );\n      start_quad_smooth   = start_quad_flat     + len_quad_flat\t   + handlePadding( md.nquad_flat * 2 );\n      start_quad_flat_uv  = start_quad_smooth   + len_quad_smooth    + handlePadding( md.nquad_smooth * 2 );\n      start_quad_smooth_uv = start_quad_flat_uv  + len_quad_flat_uv   + handlePadding( md.nquad_flat_uv * 2 );\n\n      // have to first process faces with uvs\n      // so that face and uv indices match\n\n      init_triangles_flat_uv( start_tri_flat_uv );\n      init_triangles_smooth_uv( start_tri_smooth_uv );\n\n      init_quads_flat_uv( start_quad_flat_uv );\n      init_quads_smooth_uv( start_quad_smooth_uv );\n\n      // now we can process untextured faces\n\n      init_triangles_flat( start_tri_flat );\n      init_triangles_smooth( start_tri_smooth );\n\n      init_quads_flat( start_quad_flat );\n      init_quads_smooth( start_quad_smooth );\n\n      this.computeFaceNormals();\n\n      function handlePadding( n ) {\n\n        return ( n % 4 ) ? ( 4 - n % 4 ) : 0;\n\n      }\n\n      function parseMetaData( data, offset ) {\n\n        var metaData = {\n\n          'signature'               : parseString( data, offset,  12 ),\n          'header_bytes'            : parseUChar8( data, offset + 12 ),\n\n          'vertex_coordinate_bytes' : parseUChar8( data, offset + 13 ),\n          'normal_coordinate_bytes' : parseUChar8( data, offset + 14 ),\n          'uv_coordinate_bytes'     : parseUChar8( data, offset + 15 ),\n\n          'vertex_index_bytes'      : parseUChar8( data, offset + 16 ),\n          'normal_index_bytes'      : parseUChar8( data, offset + 17 ),\n          'uv_index_bytes'          : parseUChar8( data, offset + 18 ),\n          'material_index_bytes'    : parseUChar8( data, offset + 19 ),\n\n          'nvertices'    : parseUInt32( data, offset + 20 ),\n          'nnormals'     : parseUInt32( data, offset + 20 + 4 * 1 ),\n          'nuvs'         : parseUInt32( data, offset + 20 + 4 * 2 ),\n\n          'ntri_flat'      : parseUInt32( data, offset + 20 + 4 * 3 ),\n          'ntri_smooth'    : parseUInt32( data, offset + 20 + 4 * 4 ),\n          'ntri_flat_uv'   : parseUInt32( data, offset + 20 + 4 * 5 ),\n          'ntri_smooth_uv' : parseUInt32( data, offset + 20 + 4 * 6 ),\n\n          'nquad_flat'      : parseUInt32( data, offset + 20 + 4 * 7 ),\n          'nquad_smooth'    : parseUInt32( data, offset + 20 + 4 * 8 ),\n          'nquad_flat_uv'   : parseUInt32( data, offset + 20 + 4 * 9 ),\n          'nquad_smooth_uv' : parseUInt32( data, offset + 20 + 4 * 10 )\n\n        };\n        /*\n         console.log( \"signature: \" + metaData.signature );\n\n         console.log( \"header_bytes: \" + metaData.header_bytes );\n         console.log( \"vertex_coordinate_bytes: \" + metaData.vertex_coordinate_bytes );\n         console.log( \"normal_coordinate_bytes: \" + metaData.normal_coordinate_bytes );\n         console.log( \"uv_coordinate_bytes: \" + metaData.uv_coordinate_bytes );\n\n         console.log( \"vertex_index_bytes: \" + metaData.vertex_index_bytes );\n         console.log( \"normal_index_bytes: \" + metaData.normal_index_bytes );\n         console.log( \"uv_index_bytes: \" + metaData.uv_index_bytes );\n         console.log( \"material_index_bytes: \" + metaData.material_index_bytes );\n\n         console.log( \"nvertices: \" + metaData.nvertices );\n         console.log( \"nnormals: \" + metaData.nnormals );\n         console.log( \"nuvs: \" + metaData.nuvs );\n\n         console.log( \"ntri_flat: \" + metaData.ntri_flat );\n         console.log( \"ntri_smooth: \" + metaData.ntri_smooth );\n         console.log( \"ntri_flat_uv: \" + metaData.ntri_flat_uv );\n         console.log( \"ntri_smooth_uv: \" + metaData.ntri_smooth_uv );\n\n         console.log( \"nquad_flat: \" + metaData.nquad_flat );\n         console.log( \"nquad_smooth: \" + metaData.nquad_smooth );\n         console.log( \"nquad_flat_uv: \" + metaData.nquad_flat_uv );\n         console.log( \"nquad_smooth_uv: \" + metaData.nquad_smooth_uv );\n\n         var total = metaData.header_bytes\n         + metaData.nvertices * metaData.vertex_coordinate_bytes * 3\n         + metaData.nnormals * metaData.normal_coordinate_bytes * 3\n         + metaData.nuvs * metaData.uv_coordinate_bytes * 2\n         + metaData.ntri_flat * ( metaData.vertex_index_bytes*3 + metaData.material_index_bytes )\n         + metaData.ntri_smooth * ( metaData.vertex_index_bytes*3 + metaData.material_index_bytes + metaData.normal_index_bytes*3 )\n         + metaData.ntri_flat_uv * ( metaData.vertex_index_bytes*3 + metaData.material_index_bytes + metaData.uv_index_bytes*3 )\n         + metaData.ntri_smooth_uv * ( metaData.vertex_index_bytes*3 + metaData.material_index_bytes + metaData.normal_index_bytes*3 + metaData.uv_index_bytes*3 )\n         + metaData.nquad_flat * ( metaData.vertex_index_bytes*4 + metaData.material_index_bytes )\n         + metaData.nquad_smooth * ( metaData.vertex_index_bytes*4 + metaData.material_index_bytes + metaData.normal_index_bytes*4 )\n         + metaData.nquad_flat_uv * ( metaData.vertex_index_bytes*4 + metaData.material_index_bytes + metaData.uv_index_bytes*4 )\n         + metaData.nquad_smooth_uv * ( metaData.vertex_index_bytes*4 + metaData.material_index_bytes + metaData.normal_index_bytes*4 + metaData.uv_index_bytes*4 );\n         console.log( \"total bytes: \" + total );\n         */\n\n        return metaData;\n\n      }\n\n      function parseString( data, offset, length ) {\n\n        var charArray = new Uint8Array( data, offset, length );\n\n        var text = \"\";\n\n        for ( var i = 0; i < length; i ++ ) {\n\n          text += String.fromCharCode( charArray[ offset + i ] );\n\n        }\n\n        return text;\n\n      }\n\n      function parseUChar8( data, offset ) {\n\n        var charArray = new Uint8Array( data, offset, 1 );\n\n        return charArray[ 0 ];\n\n      }\n\n      function parseUInt32( data, offset ) {\n\n        var intArray = new Uint32Array( data, offset, 1 );\n\n        return intArray[ 0 ];\n\n      }\n\n      function init_vertices( start ) {\n\n        var nElements = md.nvertices;\n\n        var coordArray = new Float32Array( data, start, nElements * 3 );\n\n        var i, x, y, z;\n\n        for ( i = 0; i < nElements; i ++ ) {\n\n          x = coordArray[ i * 3 ];\n          y = coordArray[ i * 3 + 1 ];\n          z = coordArray[ i * 3 + 2 ];\n\n          scope.vertices.push( new THREE.Vector3( x, y, z ) );\n\n        }\n\n        return nElements * 3 * Float32Array.BYTES_PER_ELEMENT;\n\n      }\n\n      function init_normals( start ) {\n\n        var nElements = md.nnormals;\n\n        if ( nElements ) {\n\n          var normalArray = new Int8Array( data, start, nElements * 3 );\n\n          var i, x, y, z;\n\n          for ( i = 0; i < nElements; i ++ ) {\n\n            x = normalArray[ i * 3 ];\n            y = normalArray[ i * 3 + 1 ];\n            z = normalArray[ i * 3 + 2 ];\n\n            normals.push( x / 127, y / 127, z / 127 );\n\n          }\n\n        }\n\n        return nElements * 3 * Int8Array.BYTES_PER_ELEMENT;\n\n      }\n\n      function init_uvs( start ) {\n\n        var nElements = md.nuvs;\n\n        if ( nElements ) {\n\n          var uvArray = new Float32Array( data, start, nElements * 2 );\n\n          var i, u, v;\n\n          for ( i = 0; i < nElements; i ++ ) {\n\n            u = uvArray[ i * 2 ];\n            v = uvArray[ i * 2 + 1 ];\n\n            uvs.push( u, v );\n\n          }\n\n        }\n\n        return nElements * 2 * Float32Array.BYTES_PER_ELEMENT;\n\n      }\n\n      function init_uvs3( nElements, offset ) {\n\n        var i, uva, uvb, uvc, u1, u2, u3, v1, v2, v3;\n\n        var uvIndexBuffer = new Uint32Array( data, offset, 3 * nElements );\n\n        for ( i = 0; i < nElements; i ++ ) {\n\n          uva = uvIndexBuffer[ i * 3 ];\n          uvb = uvIndexBuffer[ i * 3 + 1 ];\n          uvc = uvIndexBuffer[ i * 3 + 2 ];\n\n          u1 = uvs[ uva * 2 ];\n          v1 = uvs[ uva * 2 + 1 ];\n\n          u2 = uvs[ uvb * 2 ];\n          v2 = uvs[ uvb * 2 + 1 ];\n\n          u3 = uvs[ uvc * 2 ];\n          v3 = uvs[ uvc * 2 + 1 ];\n\n          scope.faceVertexUvs[ 0 ].push( [\n            new THREE.Vector2( u1, v1 ),\n            new THREE.Vector2( u2, v2 ),\n            new THREE.Vector2( u3, v3 )\n          ] );\n\n        }\n\n      }\n\n      function init_uvs4( nElements, offset ) {\n\n        var i, uva, uvb, uvc, uvd, u1, u2, u3, u4, v1, v2, v3, v4;\n\n        var uvIndexBuffer = new Uint32Array( data, offset, 4 * nElements );\n\n        for ( i = 0; i < nElements; i ++ ) {\n\n          uva = uvIndexBuffer[ i * 4 ];\n          uvb = uvIndexBuffer[ i * 4 + 1 ];\n          uvc = uvIndexBuffer[ i * 4 + 2 ];\n          uvd = uvIndexBuffer[ i * 4 + 3 ];\n\n          u1 = uvs[ uva * 2 ];\n          v1 = uvs[ uva * 2 + 1 ];\n\n          u2 = uvs[ uvb * 2 ];\n          v2 = uvs[ uvb * 2 + 1 ];\n\n          u3 = uvs[ uvc * 2 ];\n          v3 = uvs[ uvc * 2 + 1 ];\n\n          u4 = uvs[ uvd * 2 ];\n          v4 = uvs[ uvd * 2 + 1 ];\n\n          scope.faceVertexUvs[ 0 ].push( [\n            new THREE.Vector2( u1, v1 ),\n            new THREE.Vector2( u2, v2 ),\n            new THREE.Vector2( u4, v4 )\n          ] );\n\n          scope.faceVertexUvs[ 0 ].push( [\n            new THREE.Vector2( u2, v2 ),\n            new THREE.Vector2( u3, v3 ),\n            new THREE.Vector2( u4, v4 )\n          ] );\n\n        }\n\n      }\n\n      function init_faces3_flat( nElements, offsetVertices, offsetMaterials ) {\n\n        var i, a, b, c, m;\n\n        var vertexIndexBuffer = new Uint32Array( data, offsetVertices, 3 * nElements );\n        var materialIndexBuffer = new Uint16Array( data, offsetMaterials, nElements );\n\n        for ( i = 0; i < nElements; i ++ ) {\n\n          a = vertexIndexBuffer[ i * 3 ];\n          b = vertexIndexBuffer[ i * 3 + 1 ];\n          c = vertexIndexBuffer[ i * 3 + 2 ];\n\n          m = materialIndexBuffer[ i ];\n\n          scope.faces.push( new THREE.Face3( a, b, c, null, null, m ) );\n\n        }\n\n      }\n\n      function init_faces4_flat( nElements, offsetVertices, offsetMaterials ) {\n\n        var i, a, b, c, d, m;\n\n        var vertexIndexBuffer = new Uint32Array( data, offsetVertices, 4 * nElements );\n        var materialIndexBuffer = new Uint16Array( data, offsetMaterials, nElements );\n\n        for ( i = 0; i < nElements; i ++ ) {\n\n          a = vertexIndexBuffer[ i * 4 ];\n          b = vertexIndexBuffer[ i * 4 + 1 ];\n          c = vertexIndexBuffer[ i * 4 + 2 ];\n          d = vertexIndexBuffer[ i * 4 + 3 ];\n\n          m = materialIndexBuffer[ i ];\n\n          scope.faces.push( new THREE.Face3( a, b, d, null, null, m ) );\n          scope.faces.push( new THREE.Face3( b, c, d, null, null, m ) );\n\n        }\n\n      }\n\n      function init_faces3_smooth( nElements, offsetVertices, offsetNormals, offsetMaterials ) {\n\n        var i, a, b, c, m;\n        var na, nb, nc;\n\n        var vertexIndexBuffer = new Uint32Array( data, offsetVertices, 3 * nElements );\n        var normalIndexBuffer = new Uint32Array( data, offsetNormals, 3 * nElements );\n        var materialIndexBuffer = new Uint16Array( data, offsetMaterials, nElements );\n\n        for ( i = 0; i < nElements; i ++ ) {\n\n          a = vertexIndexBuffer[ i * 3 ];\n          b = vertexIndexBuffer[ i * 3 + 1 ];\n          c = vertexIndexBuffer[ i * 3 + 2 ];\n\n          na = normalIndexBuffer[ i * 3 ];\n          nb = normalIndexBuffer[ i * 3 + 1 ];\n          nc = normalIndexBuffer[ i * 3 + 2 ];\n\n          m = materialIndexBuffer[ i ];\n\n          var nax = normals[ na * 3 ],\n            nay = normals[ na * 3 + 1 ],\n            naz = normals[ na * 3 + 2 ],\n\n            nbx = normals[ nb * 3 ],\n            nby = normals[ nb * 3 + 1 ],\n            nbz = normals[ nb * 3 + 2 ],\n\n            ncx = normals[ nc * 3 ],\n            ncy = normals[ nc * 3 + 1 ],\n            ncz = normals[ nc * 3 + 2 ];\n\n          scope.faces.push( new THREE.Face3( a, b, c, [\n            new THREE.Vector3( nax, nay, naz ),\n            new THREE.Vector3( nbx, nby, nbz ),\n            new THREE.Vector3( ncx, ncy, ncz )\n          ], null, m ) );\n\n        }\n\n      }\n\n      function init_faces4_smooth( nElements, offsetVertices, offsetNormals, offsetMaterials ) {\n\n        var i, a, b, c, d, m;\n        var na, nb, nc, nd;\n\n        var vertexIndexBuffer = new Uint32Array( data, offsetVertices, 4 * nElements );\n        var normalIndexBuffer = new Uint32Array( data, offsetNormals, 4 * nElements );\n        var materialIndexBuffer = new Uint16Array( data, offsetMaterials, nElements );\n\n        for ( i = 0; i < nElements; i ++ ) {\n\n          a = vertexIndexBuffer[ i * 4 ];\n          b = vertexIndexBuffer[ i * 4 + 1 ];\n          c = vertexIndexBuffer[ i * 4 + 2 ];\n          d = vertexIndexBuffer[ i * 4 + 3 ];\n\n          na = normalIndexBuffer[ i * 4 ];\n          nb = normalIndexBuffer[ i * 4 + 1 ];\n          nc = normalIndexBuffer[ i * 4 + 2 ];\n          nd = normalIndexBuffer[ i * 4 + 3 ];\n\n          m = materialIndexBuffer[ i ];\n\n          var nax = normals[ na * 3 ],\n            nay = normals[ na * 3 + 1 ],\n            naz = normals[ na * 3 + 2 ],\n\n            nbx = normals[ nb * 3 ],\n            nby = normals[ nb * 3 + 1 ],\n            nbz = normals[ nb * 3 + 2 ],\n\n            ncx = normals[ nc * 3 ],\n            ncy = normals[ nc * 3 + 1 ],\n            ncz = normals[ nc * 3 + 2 ],\n\n            ndx = normals[ nd * 3 ],\n            ndy = normals[ nd * 3 + 1 ],\n            ndz = normals[ nd * 3 + 2 ];\n\n          scope.faces.push( new THREE.Face3( a, b, d, [\n            new THREE.Vector3( nax, nay, naz ),\n            new THREE.Vector3( nbx, nby, nbz ),\n            new THREE.Vector3( ndx, ndy, ndz )\n          ], null, m ) );\n\n          scope.faces.push( new THREE.Face3( b, c, d, [\n            new THREE.Vector3( nbx, nby, nbz ),\n            new THREE.Vector3( ncx, ncy, ncz ),\n            new THREE.Vector3( ndx, ndy, ndz )\n          ], null, m ) );\n\n        }\n\n      }\n\n      function init_triangles_flat( start ) {\n\n        var nElements = md.ntri_flat;\n\n        if ( nElements ) {\n\n          var offsetMaterials = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n          init_faces3_flat( nElements, start, offsetMaterials );\n\n        }\n\n      }\n\n      function init_triangles_flat_uv( start ) {\n\n        var nElements = md.ntri_flat_uv;\n\n        if ( nElements ) {\n\n          var offsetUvs = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n          var offsetMaterials = offsetUvs + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n\n          init_faces3_flat( nElements, start, offsetMaterials );\n          init_uvs3( nElements, offsetUvs );\n\n        }\n\n      }\n\n      function init_triangles_smooth( start ) {\n\n        var nElements = md.ntri_smooth;\n\n        if ( nElements ) {\n\n          var offsetNormals = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n          var offsetMaterials = offsetNormals + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n\n          init_faces3_smooth( nElements, start, offsetNormals, offsetMaterials );\n\n        }\n\n      }\n\n      function init_triangles_smooth_uv( start ) {\n\n        var nElements = md.ntri_smooth_uv;\n\n        if ( nElements ) {\n\n          var offsetNormals = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n          var offsetUvs = offsetNormals + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n          var offsetMaterials = offsetUvs + nElements * Uint32Array.BYTES_PER_ELEMENT * 3;\n\n          init_faces3_smooth( nElements, start, offsetNormals, offsetMaterials );\n          init_uvs3( nElements, offsetUvs );\n\n        }\n\n      }\n\n      function init_quads_flat( start ) {\n\n        var nElements = md.nquad_flat;\n\n        if ( nElements ) {\n\n          var offsetMaterials = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n          init_faces4_flat( nElements, start, offsetMaterials );\n\n        }\n\n      }\n\n      function init_quads_flat_uv( start ) {\n\n        var nElements = md.nquad_flat_uv;\n\n        if ( nElements ) {\n\n          var offsetUvs = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n          var offsetMaterials = offsetUvs + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n\n          init_faces4_flat( nElements, start, offsetMaterials );\n          init_uvs4( nElements, offsetUvs );\n\n        }\n\n      }\n\n      function init_quads_smooth( start ) {\n\n        var nElements = md.nquad_smooth;\n\n        if ( nElements ) {\n\n          var offsetNormals = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n          var offsetMaterials = offsetNormals + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n\n          init_faces4_smooth( nElements, start, offsetNormals, offsetMaterials );\n\n        }\n\n      }\n\n      function init_quads_smooth_uv( start ) {\n\n        var nElements = md.nquad_smooth_uv;\n\n        if ( nElements ) {\n\n          var offsetNormals = start + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n          var offsetUvs = offsetNormals + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n          var offsetMaterials = offsetUvs + nElements * Uint32Array.BYTES_PER_ELEMENT * 4;\n\n          init_faces4_smooth( nElements, start, offsetNormals, offsetMaterials );\n          init_uvs4( nElements, offsetUvs );\n\n        }\n\n      }\n\n    };\n\n    Model.prototype = Object.create( THREE.Geometry.prototype );\n    Model.prototype.constructor = Model;\n\n    var geometry = new Model( texturePath );\n    var materials = THREE.Loader.prototype.initMaterials( jsonMaterials, texturePath, this.crossOrigin );\n\n    callback( geometry, materials );\n\n  }\n\n};\n\nexport default BinaryLoader;\nTHREE.BinaryLoader = BinaryLoader;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vendor/BinaryLoader.js\n **/","// jscs:disable\n/* eslint-disable */\n\n/**\n * Created by masayuki on 20/07/2016.\n */\nimport SimObject from './SimObject';\nimport THREE from 'three';\n\nconst TOTAL_FRAMES = 60;\n\nclass Pedestrian extends SimObject {\n  constructor(pedestrianModel, callback) {\n    super();\n\n    // parameters\n    this.model    = pedestrianModel;\n    this.callback = callback || function(self){};\n\n    // properties\n    this.lastKeyFrame         = 0;\n    this.currentKeyFrame      = 0;\n    this.updateMorph          = true;\n\n    // Meshes\n    this.bodyMesh             = null;\n\n    // --- make a pedestrian\n    this._createPedestrian();\n  }\n\n  update(delta) {\n    super.update(delta);\n\n    // morph animation\n    if (this.updateMorph) {\n      this.bodyMesh.update(delta);\n    }\n  }\n\n  _createPedestrian() {\n    var self = this;\n\n    if (this.model.loaded) {\n      var root = new THREE.Object3D();\n\n      // retrieve parameters from vehicleModel\n      var modelScale           = this.model.scale;\n      var modelTranslation     = this.model.translation;\n      var modelRotation        = this.model.rotation;\n      var bodyGeometry         = this.model.bodyGeometry;\n      var bodyMaterials        = this.model.bodyMaterials;\n\n      // temporary variables\n      var s = modelScale, t = modelTranslation, r = modelRotation;\n      var delta = new THREE.Vector3();\n\n      // materials\n      var bodyFaceMaterial = new THREE.MeshFaceMaterial(bodyMaterials);\n\n      // create body mesh\n      this.bodyMesh = new THREE.MorphBlendMesh(bodyGeometry, bodyFaceMaterial);\n      this.bodyMesh.scale.set(s, s, s);\n      this.bodyMesh.animationsList.forEach((animation) => {\n        animation.active = true; // activate all animations\n      });\n      root.add(this.bodyMesh);\n\n      // translation and rotation\n      root.position.set(t.x, t.y, t.z);\n      root.rotation.set(r.x, r.y, r.z);\n\n      // finish\n      this.add(root);\n\n      // adjust the label\n      this._adjustLabelOffset();\n\n      // callback\n      if (this.callback) {\n        this.callback(self);\n      }\n    }\n  }\n}\n\nexport default Pedestrian;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/object/Pedestrian.js\n **/","// TODO: Move duplicated logic between geometry layrs into GeometryLayer\n\n// TODO: Look at ways to drop unneeded references to array buffers, etc to\n// reduce memory footprint\n\n// TODO: Support dynamic updating / hiding / animation of geometry\n//\n// This could be pretty hard as it's all packed away within BufferGeometry and\n// may even be merged by another layer (eg. GeoJSONLayer)\n//\n// How much control should this layer support? Perhaps a different or custom\n// layer would be better suited for animation, for example.\n\n// TODO: Allow _setBufferAttributes to use a custom function passed in to\n// generate a custom mesh\n\nimport SimObjectLayer from './SimObjectLayer';\nimport extend from 'lodash.assign';\nimport THREE from 'three';\nimport {latLon as LatLon} from '../../geo/LatLon';\nimport {point as Point} from '../../geo/Point';\nimport earcut from 'earcut';\nimport extrudePolygon from '../../util/extrudePolygon';\nimport Buffer from '../../util/Buffer';\nimport GPUComputationRenderer from '../../vendor/GPUComputationRenderer';\nimport VehicleModel from './VehicleModel';\nimport modelRepository from './ModelRepository';\nimport Vehicle from './Vehicle';\nimport BinaryLoader from '../../vendor/BinaryLoader';\nimport VehicleVelocityShader from './VehicleVelocityShader';\nimport VehiclePositionShader from './VehiclePositionShader';\nimport VehicleShader from './VehicleShader';\nimport ObjectUtils from '../../util/ObjectUtils';\n\nconst MODEL_PREFIX = 'vehicle:';\n\nclass VehicleLayer extends SimObjectLayer {\n  constructor(models, options) {\n    var defaults = {\n      output: true,\n    };\n\n    var _options = extend({}, defaults, options);\n\n    super(_options);\n\n    var modelDefaults = {\n      file: {\n        body: null,\n        wheel: null\n      },\n      scale: 1,\n      translation: {x: 0, y: 0, z: 0},\n      rotation: {rx: 0, ry: 0, rz: 0}\n    };\n    for (key in models) {\n      models[key] = extend({}, modelDefaults, models[key]);\n    }\n\n    this._modelsLoaded = false;\n    this._models = extend({}, models);\n    this._entries = [];\n  }\n\n  _onAdd(world) {\n    super._onAdd(world);\n\n    if (this.isOutput()) {\n      // add callback\n      this.on('loadCompleted', this._onLoadCompleted);\n\n      // load models\n      this._loadModels();\n    }\n  }\n\n  _loadModels() {\n    var self = this;\n\n    // load models iteratively\n    var models = this._models;\n    Object.keys(models).forEach(function(modelName) {\n      var model = models[modelName];\n\n      var scale = 1.0;\n      var translation = new THREE.Vector3();\n      var rotation = new THREE.Vector3();\n      var wheelOffset = null;\n\n      if (model.scale) {\n        scale = model.scale;\n      }\n      if (model.translation) {\n        translation.set(model.translation.x, model.translation.y, model.translation.z);\n      }\n      if (model.rotation) {\n        rotation.set(model.rotation.x, model.rotation.y, model.rotation.z);\n      }\n      if (model.wheelOffset) {\n        wheelOffset = new THREE.Vector3(model.wheelOffset.x, model.wheelOffset.y, model.wheelOffset.z);\n      }\n\n      // create a model\n      var vehicleModel = new VehicleModel({\n        bodyURL: model.file.body,\n        wheelURL: model.file.wheel,\n        scale: scale,\n        translation: translation,\n        rotation: rotation,\n        wheelOffset: wheelOffset\n      }, callback);\n\n      // register to the repos\n      modelRepository.add(MODEL_PREFIX + modelName, vehicleModel);\n    });\n\n    // callback\n    var counter = 0;\n    var len = Object.keys(models).length;\n    function callback(scope) {\n      if (++counter >= len) {\n        // loaded all models\n        self.emit('loadCompleted');\n      }\n    }\n  }\n\n  _onLoadCompleted() {\n    this._modelsLoaded = true;\n\n    // iterate over all the vehicles already added and add meshes to the world\n    for (var i = 0; i < this._entries.length; i++) {\n      var entry = this._entries[i];\n      if (entry.vehicle === null) {\n        this._addVehicleInternal(entry);\n      }\n    }\n  }\n\n  addVehicle(modelName, latlon, angle, options) {\n    if (!modelRepository.contains(MODEL_PREFIX + modelName)) {\n      throw new Error('Vehicle model ' + modelName + ' does not exist.');\n    }\n\n    var self = this;\n\n    var entry = {\n      id: undefined,\n      modelName: modelName,\n      latlon: latlon,\n      angle: angle,\n      options: options,\n      vehicle: null\n    };\n    var total = this._entries.push(entry);\n    entry.id = (total - 1);\n\n    // add vehicle if the model is already loaded\n    this._addVehicleInternal(entry);\n\n    return entry;\n  }\n\n  _addVehicleInternal(entry) {\n    if (this._modelsLoaded) {\n\n      // instantiate the vehicle\n      var vehicleModel = modelRepository.get(MODEL_PREFIX + entry.modelName);\n      var vehicle = new Vehicle(vehicleModel);\n\n      // add the vehicle to the layer\n      this.add(vehicle);\n      entry.vehicle = vehicle;\n\n      // set the vehicle's location\n      this.setLocation(entry.id, entry.latlon.lat, entry.latlon.lon, entry.angle);\n\n      // var id = vehicle.id;\n      //\n      // var model = this._models[vehicle.modelName];\n      // var geometry = this._geometries[vehicle.modelName];\n      //\n      // var material = new THREE.MeshLambertMaterial({ color: 0x995500, opacity: 1.0, transparent: false });\n      // // var material = new THREE.ShaderMaterial({\n      // //   uniforms: {\n      // //     'reference':        { type: 'v2', value: null },\n      // //     'texturePosition':  { type: 't',  value: null },\n      // //     'texture':          { type: 't',  value: null },\n      // //     'color':            { type: 'c',  value: new THREE.Color(0x995500) }\n      // //   },\n      // //   vertexShader: VehicleShader.vertexShader,\n      // //   fragmentShader: VehicleShader.fragmentShader\n      // // });\n      // // material.uniforms.reference.value = new THREE.Vector2(x, y);\n      //\n      // var mesh = new THREE.Mesh(geometry, material);\n      // mesh.scale.x = mesh.scale.y = mesh.scale.z = model.scale;\n      // mesh.rotation.set(model.rotation.rx, model.rotation.ry, model.rotation.rz);\n      // mesh.position.set(model.translation.x, model.translation.y, model.translation.z);\n      //\n      // this.add(mesh);\n      // vehicle.model = model;\n      // vehicle.mesh = mesh;\n      // vehicle.setLocation(vehicle.latlon.lat, vehicle.latlon.lon, vehicle.angle);\n    }\n  }\n\n  getVehicle(id) {\n    if (id in this._entries) {\n      return this._entries[id];\n    }\n    return null;\n  }\n\n  _setVelocity(id, vx, vy, vz, wheel) {\n    super._setVelocity(id, vx, vy, vz, wheel);\n\n    // if the vehicle exists\n    if (id in this._simObjects) {\n      var simObject = this._simObjects[id];\n      simObject.setWheelAngle(wheel);\n    }\n  }\n\n  destroy() {\n    // Run common destruction logic from parent\n    super.destroy();\n  }\n\n}\n\nexport default VehicleLayer;\n\nvar noNew = function(models, options) {\n  return new VehicleLayer(models, options);\n};\n\nexport {noNew as vehicleLayer};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/object/VehicleLayer.js\n **/","/**\n * Created by masayuki on 17/07/2016.\n */\n\nimport THREE from 'three';\nimport BinaryLoader from '../../vendor/BinaryLoader';\nimport ObjectUtils from '../../util/ObjectUtils';\n\nvar VehicleModel = function(parameters, callback) {\n\n  var scope = this;\n  var p = parameters;\n\n  // file paths\n  this.bodyURL  = p.bodyURL   || null;\n  this.wheelURL = p.wheelURL  || null;\n\n  // parameters\n  this.scale           = p.scale           || 1.0;\n  this.translation     = p.translation     || new THREE.Vector3();\n  this.rotation        = p.rotation        || new THREE.Vector3();\n  this.wheelOffset     = p.wheelOffset     || new THREE.Vector3();\n  this.autoWheelOffset = p.autoWheelOffset || true;\n\n  // properties\n  this.wheelDiameter   = 1.0;\n\n  // callback\n  this.callback = callback;\n\n  // status\n  this.loaded   = false;\n\n  // internal use\n  this.bodyGeometry   = null;\n  this.bodyMaterials  = null;\n\n  this.wheelGeometry  = null;\n  this.wheelMaterials = null;\n\n  // construct\n  if (scope.bodyURL && scope.wheelURL) {\n    // load binaries\n    var bloader = new THREE.BinaryLoader();\n    bloader.load(scope.bodyURL, function(geometry, materials) {\n      createBody(geometry, materials);\n    });\n    bloader.load(scope.wheelURL, function(geometry, materials) {\n      createWheel(geometry, materials);\n    });\n  }\n\n  // internal helper methods\n  function createBody(geometry, materials) {\n    geometry.sortFacesByMaterialIndex();\n    geometry.computeVertexNormals();\n\n    scope.bodyGeometry = geometry;\n    scope.bodyMaterials = materials;\n\n    onCreated();\n  }\n  function createWheel(geometry, materials) {\n    geometry.sortFacesByMaterialIndex();\n    geometry.computeVertexNormals();\n\n    scope.wheelGeometry = geometry;\n    scope.wheelMaterials = materials;\n\n    onCreated();\n  }\n  function onCreated() {\n    if (scope.bodyGeometry && scope.wheelGeometry) {\n      scope.loaded = true;\n\n      // wheel\n      scope.wheelGeometry.computeBoundingBox();\n      var wbb = scope.wheelGeometry.boundingBox;\n\n      // compute wheel diameter\n      scope.wheelDiameter = wbb.max.y - wbb.min.y;\n\n      // compute wheel offsets\n      if (scope.autoWheelOffset) {\n        scope.wheelOffset.addVectors(wbb.min, wbb.max);\n        scope.wheelOffset.multiplyScalar(0.5);\n\n        scope.wheelGeometry.center();\n      }\n\n      // callback\n      if (scope.callback) {\n        scope.callback(scope);\n      }\n    }\n  }\n\n};\n\nexport default VehicleModel;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/object/VehicleModel.js\n **/","// jscs:disable\n/* eslint-disable */\n\n/**\n * Created by masayuki on 17/07/2016.\n */\nimport SimObject from './SimObject';\n\nclass Vehicle extends SimObject {\n  constructor(vehicleModel, callback){\n    super();\n\n    // parameters\n    this.model    = vehicleModel;\n    this.callback = callback || function(self){};\n\n    // properties\n    this.wheelAngle           = 0.0;\n    this.wheelDiameter        = 1.0;\n    this.updateWheel          = true;\n\n    // 3D Object\n    this.frontLeftWheelRoot   = new THREE.Object3D();\n    this.frontRightWheelRoot  = new THREE.Object3D();\n\n    // Meshes\n    this.bodyMesh             = null;\n    this.frontLeftWheelMesh   = null;\n    this.frontRightWheelMesh  = null;\n    this.rearLeftWheelMesh    = null;\n    this.rearRightWheelMesh   = null;\n\n    // --- constants\n    this.STEERING_RADIUS_RATIO = 0.0023 / vehicleModel.scale;\n\n    // --- make a vehicle\n    this._createVehicle();\n  }\n\n  // --- API\n  /**\n   * sets the vehicle's wheel angle, relative to the vehicle\n   * @param wheelAngle angle in [rad]\n   */\n  setWheelAngle(wheelAngle) {\n    this.wheelAngle = wheelAngle;\n\n    this.frontLeftWheelRoot.rotation.y = wheelAngle;\n    this.frontRightWheelRoot.rotation.y = wheelAngle;\n  };\n\n  /**\n   * sets the vehicle's velocity\n   * @param velocity velocity in [m/s]\n   */\n  setVelocity(velocity) {\n    super.setVelocity(velocity);\n  }\n\n  /**\n   * update the vehicle\n   * @param delta\n   */\n  update(delta) {\n\n    var forwardDelta = delta * this.velocity;\n\n    // position\n    if (this.updatePosition) {\n      this.angle += ( forwardDelta * this.STEERING_RADIUS_RATIO ) * this.wheelAngle;\n    }\n\n    super.update(delta);\n\n    // wheels rolling\n    if (this.updateWheel) {\n      var angularSpeedRatio = 1 / ( this.model.scale * ( this.wheelDiameter / 2. ) );\n      var wheelDelta = forwardDelta * angularSpeedRatio;\n\n      this.frontLeftWheelMesh.rotation.x += wheelDelta;\n      this.frontRightWheelMesh.rotation.x += wheelDelta;\n      this.rearLeftWheelMesh.rotation.x += wheelDelta;\n      this.rearRightWheelMesh.rotation.x += wheelDelta;\n    }\n\n  }\n\n  // --- internal helper methods\n  _createVehicle() {\n    var self = this;\n\n    if (this.model.loaded) {\n      var root = new THREE.Object3D();\n\n      // retrieve parameters from vehicleModel\n      var modelScale           = this.model.scale;\n      var modelTranslation     = this.model.translation;\n      var modelRotation        = this.model.rotation;\n      var wheelOffset          = this.model.wheelOffset;\n      var wheelDiameter        = this.model.wheelDiameter;\n      var bodyGeometry         = this.model.bodyGeometry;\n      var bodyMaterials        = this.model.bodyMaterials;\n      var wheelGeometry        = this.model.wheelGeometry;\n      var wheelMaterials       = this.model.wheelMaterials;\n\n      // properties\n      this.wheelDiameter = wheelDiameter;\n\n      // temporary variables\n      var s = modelScale, t = modelTranslation, r = modelRotation;\n      var delta = new THREE.Vector3();\n\n      // setup combined materials\n      var bodyFaceMaterial = new THREE.MultiMaterial(bodyMaterials);\n      var wheelFaceMaterial = new THREE.MultiMaterial(wheelMaterials);\n      // var bodyFaceMaterial = new THREE.MeshFaceMaterial(bodyMaterials);\n      // var wheelFaceMaterial = new THREE.MeshFaceMaterial(wheelMaterials);\n      // var bodyFaceMaterial = new THREE.MeshPhongMaterial({ color: 0x00000bb });\n      // var wheelFaceMaterial = new THREE.MeshPhongMaterial({ color: 0x333333 });\n\n      // create body mesh\n      this.bodyMesh = new THREE.Mesh(bodyGeometry, bodyFaceMaterial);\n      this.bodyMesh.scale.set(s, s, s);\n      root.add(this.bodyMesh);\n\n      // create wheel meshes\n      // front left\n      delta.multiplyVectors(wheelOffset, new THREE.Vector3( s, s, s));\n      this.frontLeftWheelRoot.position.add(delta);\n      this.frontLeftWheelMesh = new THREE.Mesh(wheelGeometry, wheelFaceMaterial);\n      this.frontLeftWheelMesh.scale.set(s, s, s);\n      this.frontLeftWheelMesh.rotateY(0.0);\n      this.frontLeftWheelRoot.add(this.frontLeftWheelMesh);\n      root.add(this.frontLeftWheelRoot);\n      // front right\n      delta.multiplyVectors(wheelOffset, new THREE.Vector3(-s, s, s));\n      this.frontRightWheelRoot.position.add(delta);\n      this.frontRightWheelMesh = new THREE.Mesh(wheelGeometry, wheelFaceMaterial);\n      this.frontRightWheelMesh.scale.set(s, s, s);\n      this.frontRightWheelMesh.rotateY(Math.PI);\n      this.frontRightWheelRoot.add(this.frontRightWheelMesh);\n      root.add(this.frontRightWheelRoot);\n      // rear left\n      delta.multiplyVectors(wheelOffset, new THREE.Vector3( s, s,-s));\n      this.rearLeftWheelMesh = new THREE.Mesh(wheelGeometry, wheelFaceMaterial);\n      this.rearLeftWheelMesh.scale.set(s, s, s);\n      this.rearLeftWheelMesh.rotateY(0.0);\n      this.rearLeftWheelMesh.position.add(delta);\n      root.add(this.rearLeftWheelMesh);\n      // rear right\n      delta.multiplyVectors(wheelOffset, new THREE.Vector3(-s, s,-s));\n      this.rearRightWheelMesh = new THREE.Mesh(wheelGeometry, wheelFaceMaterial);\n      this.rearRightWheelMesh.scale.set(s, s, s);\n      this.rearRightWheelMesh.rotateY(Math.PI);\n      this.rearRightWheelMesh.position.add(delta);\n      root.add(this.rearRightWheelMesh);\n\n      // translation and rotation\n      root.position.set(t.x, t.y, t.z);\n      root.rotation.set(r.x, r.y, r.z);\n\n      // finish\n      this.add(root);\n\n      // adjust the label\n      this._adjustLabelOffset();\n\n      // callback\n      if (this.callback) {\n        this.callback(self);\n      }\n    }\n  }\n  // ---\n\n}\n\nexport default Vehicle;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layer/object/Vehicle.js\n **/","// TODO: A lot of these utils don't need to be in separate, tiny files\n\nimport wrapNum from './wrapNum';\nimport extrudePolygon from './extrudePolygon';\nimport GeoJSON from './GeoJSON';\nimport Buffer from './Buffer';\nimport ObjectUtils from './ObjectUtils';\nimport WorkerUtils from './WorkerUtils';\n\nconst Util = {};\n\nUtil.wrapNum = wrapNum;\nUtil.extrudePolygon = extrudePolygon;\nUtil.GeoJSON = GeoJSON;\nUtil.Buffer = Buffer;\nUtil.ObjectUtils = ObjectUtils;\nUtil.WorkerUtils = WorkerUtils;\n\nexport default Util;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/index.js\n **/","/*\n * Wrap the given number to lie within a certain range (eg. longitude)\n *\n * Based on:\n * https://github.com/Leaflet/Leaflet/blob/master/src/core/Util.js\n */\n\nvar wrapNum = function(x, range, includeMax) {\n  var max = range[1];\n  var min = range[0];\n  var d = max - min;\n  return x === max && includeMax ? x : ((x - min) % d + d) % d + min;\n};\n\nexport default wrapNum;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/wrapNum.js\n **/"]}